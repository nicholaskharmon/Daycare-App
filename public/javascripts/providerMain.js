/** vim: et:ts=4:sw=4:sts=4
 * @license RequireJS 2.1.9 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/requirejs for details
 */

/**
 * @license
 * Lo-Dash 2.3.0 (Custom Build) lodash.com/license | Underscore.js 1.5.2 underscorejs.org/LICENSE
 * Build: `lodash -o ./dist/lodash.compat.js`
 */

/*!
 * jQuery JavaScript Library v1.11.1
 * http://jquery.com/
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * Copyright 2005, 2014 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2014-05-01T17:42Z
 */

/*!
 * Sizzle CSS Selector Engine v1.10.19
 * http://sizzlejs.com/
 *
 * Copyright 2013 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2014-04-18
 */

/*!
 * Knockout JavaScript library v3.4.0
 * (c) Steven Sanderson - http://knockoutjs.com/
 * License: MIT (http://www.opensource.org/licenses/mit-license.php)
 */

// From https://github.com/petkaantonov/bluebird * Copyright (c) 2014 Petka Antonov * License: MIT

// From https://github.com/YuzuJS/setImmediate * Copyright (c) 2012 Barnesandnoble.com, llc, Donavon West, and Domenic Denicola * License: MIT

/*!
 * EventEmitter v4.2.7 - git.io/ee
 * Oliver Caldwell
 * MIT license
 * @preserve
 */

/*! jQuery UI - v1.11.0 - 2014-07-24
* http://jqueryui.com
* Includes: core.js, widget.js, mouse.js, position.js, draggable.js, droppable.js, selectable.js, sortable.js, datepicker.js, effect.js, effect-blind.js, effect-bounce.js, effect-clip.js, effect-drop.js, effect-explode.js, effect-fade.js, effect-fold.js, effect-highlight.js, effect-puff.js, effect-pulsate.js, effect-scale.js, effect-shake.js, effect-size.js, effect-slide.js, effect-transfer.js
* Copyright 2014 jQuery Foundation and other contributors; Licensed MIT */

/*!
 * jQuery UI Core 1.11.0
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/ui-core/
 */

/*!
 * jQuery UI Widget 1.11.0
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/jQuery.widget/
 */

/*!
 * jQuery UI Mouse 1.11.0
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/mouse/
 */

/*!
 * jQuery UI Position 1.11.0
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/position/
 */

/*!
 * jQuery UI Draggable 1.11.0
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/draggable/
 */

/*!
 * jQuery UI Droppable 1.11.0
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/droppable/
 */

/*!
 * jQuery UI Selectable 1.11.0
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/selectable/
 */

/*!
 * jQuery UI Sortable 1.11.0
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/sortable/
 */

/*!
 * jQuery UI Datepicker 1.11.0
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/datepicker/
 */

/*!
 * jQuery UI Effects 1.11.0
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/effects-core/
 */

/*!
 * jQuery Color Animations v2.1.2
 * https://github.com/jquery/jquery-color
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * Date: Wed Jan 16 08:47:09 2013 -0600
 */

/*!
 * jQuery UI Effects Blind 1.11.0
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/blind-effect/
 */

/*!
 * jQuery UI Effects Bounce 1.11.0
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/bounce-effect/
 */

/*!
 * jQuery UI Effects Clip 1.11.0
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/clip-effect/
 */

/*!
 * jQuery UI Effects Drop 1.11.0
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/drop-effect/
 */

/*!
 * jQuery UI Effects Explode 1.11.0
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/explode-effect/
 */

/*!
 * jQuery UI Effects Fade 1.11.0
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/fade-effect/
 */

/*!
 * jQuery UI Effects Fold 1.11.0
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/fold-effect/
 */

/*!
 * jQuery UI Effects Highlight 1.11.0
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/highlight-effect/
 */

/*!
 * jQuery UI Effects Size 1.11.0
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/size-effect/
 */

/*!
 * jQuery UI Effects Scale 1.11.0
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/scale-effect/
 */

/*!
 * jQuery UI Effects Puff 1.11.0
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/puff-effect/
 */

/*!
 * jQuery UI Effects Pulsate 1.11.0
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/pulsate-effect/
 */

/*!
 * jQuery UI Effects Shake 1.11.0
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/shake-effect/
 */

/*!
 * jQuery UI Effects Slide 1.11.0
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/slide-effect/
 */

/*!
 * jQuery UI Effects Transfer 1.11.0
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/transfer-effect/
 */

// -----------------------------------------------------------------------
// Eros Fratini - eros@recoding.it
// jqprint 0.3
//
// - 19/06/2009 - some new implementations, added Opera support
// - 11/05/2009 - first sketch
//
// Printing plug-in for jQuery, evolution of jPrintArea: http://plugins.jquery.com/project/jPrintArea
// requires jQuery 1.3.x
//
// Licensed under the MIT license: http://www.opensource.org/licenses/mit-license.php
//------------------------------------------------------------------------

/**
 * This script gives you the zone info key representing your device's time zone setting.
 *
 * @name jsTimezoneDetect
 * @version 1.0.6
 * @author Jon Nylander
 * @license MIT License - https://bitbucket.org/pellepim/jstimezonedetect/src/default/LICENCE.txt
 *
 * For usage and examples, visit:
 * http://pellepim.bitbucket.org/jstz/
 *
 * Copyright (c) Jon Nylander
 */

/*
 * jQuery UI Widget 1.10.0+amd
 * https://github.com/blueimp/jQuery-File-Upload
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/jQuery.widget/
 */

/*
 * jQuery File Upload Plugin 5.21.1
 * https://github.com/blueimp/jQuery-File-Upload
 *
 * Copyright 2010, Sebastian Tschan
 * https://blueimp.net
 *
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/MIT
 */

// knockout-sortable 0.8.8 | (c) 2014 Ryan Niemeyer |  http://www.opensource.org/licenses/mit-license

/* ===================================================
 * bootstrap-transition.js v2.0.2
 * http://twitter.github.com/bootstrap/javascript.html#transitions
 * ===================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================== */

/* =========================================================
     * bootstrap-modal.js v2.0.2
     * http://twitter.github.com/bootstrap/javascript.html#modals
     * =========================================================
     * Copyright 2012 Twitter, Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     * http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     * ========================================================= */

/* ============================================================
     * bootstrap-dropdown.js v2.0.2
     * http://twitter.github.com/bootstrap/javascript.html#dropdowns
     * ============================================================
     * Copyright 2012 Twitter, Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     * http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     * ============================================================ */

/* =============================================================
     * bootstrap-scrollspy.js v2.0.2
     * http://twitter.github.com/bootstrap/javascript.html#scrollspy
     * =============================================================
     * Copyright 2012 Twitter, Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     * http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     * ============================================================== */

/* ========================================================
     * bootstrap-tab.js v2.0.2
     * http://twitter.github.com/bootstrap/javascript.html#tabs
     * ========================================================
     * Copyright 2012 Twitter, Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     * http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     * ======================================================== */

/* ===========================================================
     * bootstrap-tooltip.js v2.0.2
     * http://twitter.github.com/bootstrap/javascript.html#tooltips
     * Inspired by the original jQuery.tipsy by Jason Frame
     * ===========================================================
     * Copyright 2012 Twitter, Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     * http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     * ========================================================== */

/* ===========================================================
     * bootstrap-popover.js v2.0.2
     * http://twitter.github.com/bootstrap/javascript.html#popovers
     * ===========================================================
     * Copyright 2012 Twitter, Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     * http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     * =========================================================== */

/* ==========================================================
     * bootstrap-alert.js v2.0.2
     * http://twitter.github.com/bootstrap/javascript.html#alerts
     * ==========================================================
     * Copyright 2012 Twitter, Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     * http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     * ========================================================== */

/* ============================================================
     * bootstrap-button.js v2.0.2
     * http://twitter.github.com/bootstrap/javascript.html#buttons
     * ============================================================
     * Copyright 2012 Twitter, Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     * http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     * ============================================================ */

/* =============================================================
     * bootstrap-collapse.js v2.0.2
     * http://twitter.github.com/bootstrap/javascript.html#collapse
     * =============================================================
     * Copyright 2012 Twitter, Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     * http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     * ============================================================ */

/* ==========================================================
     * bootstrap-carousel.js v2.0.2
     * http://twitter.github.com/bootstrap/javascript.html#carousel
     * ==========================================================
     * Copyright 2012 Twitter, Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     * http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     * ========================================================== */

/* =============================================================
     * bootstrap-typeahead.js v2.3.0
     * http://twitter.github.com/bootstrap/javascript.html#typeahead
     * =============================================================
     * Copyright 2012 Twitter, Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     * http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     * ============================================================ */

/*
 * jQuery UI Monthpicker
 *
 * @licensed MIT <see below>
 * @licensed GPL <see below>
 *
 * @author Luciano Costa
 * http://lucianocosta.info/jquery.mtz.monthpicker/
 *
 * Depends:
 *  jquery.ui.core.js
 */

/**
 * MIT License
 * Copyright (c) 2011, Luciano Costa
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy 
 * of this software and associated documentation files (the "Software"), to deal 
 * in the Software without restriction, including without limitation the rights 
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell 
 * copies of the Software, and to permit persons to whom the Software is 
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */

/**
 * GPL LIcense
 * Copyright (c) 2011, Luciano Costa
 * 
 * This program is free software: you can redistribute it and/or modify it 
 * under the terms of the GNU General Public License as published by the 
 * Free Software Foundation, either version 3 of the License, or 
 * (at your option) any later version.
 * 
 * This program is distributed in the hope that it will be useful, but 
 * WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY 
 * or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License 
 * for more details.
 * 
 * You should have received a copy of the GNU General Public License along 
 * with this program. If not, see <http://www.gnu.org/licenses/>.
 */

/**
   * Copyright (c) 2011 Felix Gnass [fgnass at neteye dot de]
   * Licensed under the MIT license
   */

// knockout-amd-helpers 0.7.0 | (c) 2014 Ryan Niemeyer |  http://www.opensource.org/licenses/mit-license

/**
 * @license RequireJS text 2.0.0 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

/*!
 * fancyBox - jQuery Plugin
 * version: 2.1.5 (Fri, 14 Jun 2013)
 * @requires jQuery v1.6 or later
 *
 * Examples at http://fancyapps.com/fancybox/
 * License: www.fancyapps.com/fancybox/#license
 *
 * Copyright 2012 Janis Skarnelis - janis@fancyapps.com
 *
 */

/*!
 * Buttons helper for fancyBox
 * version: 1.0.5 (Mon, 15 Oct 2012)
 * @requires fancyBox v2.0 or later
 *
 * Usage:
 *     $(".fancybox").fancybox({
 *         helpers : {
 *             buttons: {
 *                 position : 'top'
 *             }
 *         }
 *     });
 *
 */

/*!
 * "f" is for Format & WHAT THE diff?? v0.5.0
 *
 * Copyright (c) 2009 Joshua Faulkenberry
 * Dual licensed under the MIT and GPL licenses.
 * http://docs.jquery.com/License
 *
 * Date: 2009-03-20 22:15:23 -0700 (Fri, 20 Mar 2009)
 * Revision: 6
 */

/*
 * Date Format 1.2.3
 * (c) 2007-2009 Steven Levithan <stevenlevithan.com>
 * MIT license
 *
 * Includes enhancements by Scott Trenda <scott.trenda.net>
 * and Kris Kowal <cixar.com/~kris.kowal/>
 *
 * Accepts a date, a mask, or a date and a mask.
 * Returns a formatted version of the given date.
 * The date defaults to the current date/time.
 * The mask defaults to dateFormat.masks.default.
 */

/*! Video.js v4.12.15 Copyright 2014 Brightcove, Inc. https://github.com/videojs/video.js/blob/master/LICENSE */

//knockout-delegatedEvents v0.1.1 | (c) 2012 Ryan Niemeyer | http://www.opensource.org/licenses/mit-license

var tadpoles;(function(){if(!tadpoles||!tadpoles.requirejs){tadpoles?require=tadpoles:tadpoles={};var requirejs,require,define;(function(global){function isFunction(e){return ostring.call(e)==="[object Function]"}function isArray(e){return ostring.call(e)==="[object Array]"}function each(e,t){if(e){var n;for(n=0;n<e.length;n+=1)if(e[n]&&t(e[n],n,e))break}}function eachReverse(e,t){if(e){var n;for(n=e.length-1;n>-1;n-=1)if(e[n]&&t(e[n],n,e))break}}function hasProp(e,t){return hasOwn.call(e,t)}function getOwn(e,t){return hasProp(e,t)&&e[t]}function eachProp(e,t){var n;for(n in e)if(hasProp(e,n)&&t(e[n],n))break}function mixin(e,t,n,r){return t&&eachProp(t,function(t,i){if(n||!hasProp(e,i))r&&typeof t!="string"?(e[i]||(e[i]={}),mixin(e[i],t,n,r)):e[i]=t}),e}function bind(e,t){return function(){return t.apply(e,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(e){throw e}function getGlobal(e){if(!e)return e;var t=global;return each(e.split("."),function(e){t=t[e]}),t}function makeError(e,t,n,r){var i=new Error(t+"\nhttp://requirejs.org/docs/errors.html#"+e);return i.requireType=e,i.requireModules=r,n&&(i.originalError=n),i}function newContext(e){function v(e){var t,n;for(t=0;e[t];t+=1){n=e[t];if(n===".")e.splice(t,1),t-=1;else if(n===".."){if(t===1&&(e[2]===".."||e[0]===".."))break;t>0&&(e.splice(t-1,2),t-=2)}}}function m(e,t,n){var r,i,s,u,a,f,l,c,h,p,d,m=t&&t.split("/"),g=m,y=o.map,b=y&&y["*"];e&&e.charAt(0)==="."&&(t?(getOwn(o.pkgs,t)?g=m=[t]:g=m.slice(0,m.length-1),e=g.concat(e.split("/")),v(e),i=getOwn(o.pkgs,r=e[0]),e=e.join("/"),i&&e===r+"/"+i.main&&(e=r)):e.indexOf("./")===0&&(e=e.substring(2)));if(n&&y&&(m||b)){u=e.split("/");for(a=u.length;a>0;a-=1){l=u.slice(0,a).join("/");if(m)for(f=m.length;f>0;f-=1){s=getOwn(y,m.slice(0,f).join("/"));if(s){s=getOwn(s,l);if(s){c=s,h=a;break}}}if(c)break;!p&&b&&getOwn(b,l)&&(p=getOwn(b,l),d=a)}!c&&p&&(c=p,h=d),c&&(u.splice(0,h,c),e=u.join("/"))}return e}function g(e){isBrowser&&each(scripts(),function(t){if(t.getAttribute("data-requiremodule")===e&&t.getAttribute("data-requirecontext")===r.contextName)return t.parentNode.removeChild(t),!0})}function y(e){var t=getOwn(o.paths,e);if(t&&isArray(t)&&t.length>1)return t.shift(),r.require.undef(e),r.require([e]),!0}function b(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function w(e,t,n,i){var s,o,u,a,f=null,l=t?t.name:null,h=e,v=!0,g="";return e||(v=!1,e="_@r"+(p+=1)),a=b(e),f=a[0],e=a[1],f&&(f=m(f,l,i),o=getOwn(c,f)),e&&(f?o&&o.normalize?g=o.normalize(e,function(e){return m(e,l,i)}):g=m(e,l,i):(g=m(e,l,i),a=b(g),f=a[0],g=a[1],n=!0,s=r.nameToUrl(g))),u=f&&!o&&!n?"_unnormalized"+(d+=1):"",{prefix:f,name:g,parentMap:t,unnormalized:!!u,url:s,originalName:h,isDefine:v,id:(f?f+"!"+g:g)+u}}function E(e){var t=e.id,n=getOwn(u,t);return n||(n=u[t]=new r.Module(e)),n}function S(e,t,n){var r=e.id,i=getOwn(u,r);hasProp(c,r)&&(!i||i.defineEmitComplete)?t==="defined"&&n(c[r]):(i=E(e),i.error&&t==="error"?n(i.error):i.on(t,n))}function x(e,t){var n=e.requireModules,r=!1;t?t(e):(each(n,function(t){var n=getOwn(u,t);n&&(n.error=e,n.events.error&&(r=!0,n.emit("error",e)))}),r||req.onError(e))}function T(){globalDefQueue.length&&(apsp.apply(l,[l.length-1,0].concat(globalDefQueue)),globalDefQueue=[])}function N(e){delete u[e],delete a[e]}function C(e,t,n){var r=e.map.id;e.error?e.emit("error",e.error):(t[r]=!0,each(e.depMaps,function(r,i){var s=r.id,o=getOwn(u,s);o&&!e.depMatched[i]&&!n[s]&&(getOwn(t,s)?(e.defineDep(i,c[s]),e.check()):C(o,t,n))}),n[r]=!0)}function k(){var e,n,i,u,f=o.waitSeconds*1e3,l=f&&r.startTime+f<(new Date).getTime(),c=[],h=[],p=!1,d=!0;if(t)return;t=!0,eachProp(a,function(t){e=t.map,n=e.id;if(!t.enabled)return;e.isDefine||h.push(t);if(!t.error)if(!t.inited&&l)y(n)?(u=!0,p=!0):(c.push(n),g(n));else if(!t.inited&&t.fetched&&e.isDefine){p=!0;if(!e.prefix)return d=!1}});if(l&&c.length)return i=makeError("timeout","Load timeout for modules: "+c,null,c),i.contextName=r.contextName,x(i);d&&each(h,function(e){C(e,{},{})}),(!l||u)&&p&&(isBrowser||isWebWorker)&&!s&&(s=setTimeout(function(){s=0,k()},50)),t=!1}function L(e){hasProp(c,e[0])||E(w(e[0],null,!0)).init(e[1],e[2])}function A(e,t,n,r){e.detachEvent&&!isOpera?r&&e.detachEvent(r,t):e.removeEventListener(n,t,!1)}function O(e){var t=e.currentTarget||e.srcElement;return A(t,r.onScriptLoad,"load","onreadystatechange"),A(t,r.onScriptError,"error"),{node:t,id:t&&t.getAttribute("data-requiremodule")}}function M(){var e;T();while(l.length){e=l.shift();if(e[0]===null)return x(makeError("mismatch","Mismatched anonymous define() module: "+e[e.length-1]));L(e)}}var t,n,r,i,s,o={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},shim:{},config:{}},u={},a={},f={},l=[],c={},h={},p=1,d=1;return i={require:function(e){return e.require?e.require:e.require=r.makeRequire(e.map)},exports:function(e){e.usingExports=!0;if(e.map.isDefine)return e.exports?e.exports:e.exports=c[e.map.id]={}},module:function(e){return e.module?e.module:e.module={id:e.map.id,uri:e.map.url,config:function(){var t,n=getOwn(o.pkgs,e.map.id);return t=n?getOwn(o.config,e.map.id+"/"+n.main):getOwn(o.config,e.map.id),t||{}},exports:c[e.map.id]}}},n=function(e){this.events=getOwn(f,e.id)||{},this.map=e,this.shim=getOwn(o.shim,e.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},n.prototype={init:function(e,t,n,r){r=r||{};if(this.inited)return;this.factory=t,n?this.on("error",n):this.events.error&&(n=bind(this,function(e){this.emit("error",e)})),this.depMaps=e&&e.slice(0),this.errback=n,this.inited=!0,this.ignore=r.ignore,r.enabled||this.enabled?this.enable():this.check()},defineDep:function(e,t){this.depMatched[e]||(this.depMatched[e]=!0,this.depCount-=1,this.depExports[e]=t)},fetch:function(){if(this.fetched)return;this.fetched=!0,r.startTime=(new Date).getTime();var e=this.map;if(!this.shim)return e.prefix?this.callPlugin():this.load();r.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return e.prefix?this.callPlugin():this.load()}))},load:function(){var e=this.map.url;h[e]||(h[e]=!0,r.load(this.map.id,e))},check:function(){if(!this.enabled||this.enabling)return;var e,t,n=this.map.id,i=this.depExports,s=this.exports,o=this.factory;if(!this.inited)this.fetch();else if(this.error)this.emit("error",this.error);else if(!this.defining){this.defining=!0;if(this.depCount<1&&!this.defined){if(isFunction(o)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)try{s=r.execCb(n,o,i,s)}catch(u){e=u}else s=r.execCb(n,o,i,s);this.map.isDefine&&(t=this.module,t&&t.exports!==undefined&&t.exports!==this.exports?s=t.exports:s===undefined&&this.usingExports&&(s=this.exports));if(e)return e.requireMap=this.map,e.requireModules=this.map.isDefine?[this.map.id]:null,e.requireType=this.map.isDefine?"define":"require",x(this.error=e)}else s=o;this.exports=s,this.map.isDefine&&!this.ignore&&(c[n]=s,req.onResourceLoad&&req.onResourceLoad(r,this.map,this.depMaps)),N(n),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}},callPlugin:function(){var e=this.map,t=e.id,n=w(e.prefix);this.depMaps.push(n),S(n,"defined",bind(this,function(n){var i,s,a,f=this.map.name,l=this.map.parentMap?this.map.parentMap.name:null,c=r.makeRequire(e.parentMap,{enableBuildCallback:!0});if(this.map.unnormalized){n.normalize&&(f=n.normalize(f,function(e){return m(e,l,!0)})||""),s=w(e.prefix+"!"+f,this.map.parentMap),S(s,"defined",bind(this,function(e){this.init([],function(){return e},null,{enabled:!0,ignore:!0})})),a=getOwn(u,s.id),a&&(this.depMaps.push(s),this.events.error&&a.on("error",bind(this,function(e){this.emit("error",e)})),a.enable());return}i=bind(this,function(e){this.init([],function(){return e},null,{enabled:!0})}),i.error=bind(this,function(e){this.inited=!0,this.error=e,e.requireModules=[t],eachProp(u,function(e){e.map.id.indexOf(t+"_unnormalized")===0&&N(e.map.id)}),x(e)}),i.fromText=bind(this,function(n,s){var u=e.name,a=w(u),f=useInteractive;s&&(n=s),f&&(useInteractive=!1),E(a),hasProp(o.config,t)&&(o.config[u]=o.config[t]);try{req.exec(n)}catch(l){return x(makeError("fromtexteval","fromText eval for "+t+" failed: "+l,l,[t]))}f&&(useInteractive=!0),this.depMaps.push(a),r.completeLoad(u),c([u],i)}),n.load(e.name,c,i,o)})),r.enable(n,this),this.pluginMaps[n.id]=n},enable:function(){a[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(e,t){var n,s,o;if(typeof e=="string"){e=w(e,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[t]=e,o=getOwn(i,e.id);if(o){this.depExports[t]=o(this);return}this.depCount+=1,S(e,"defined",bind(this,function(e){this.defineDep(t,e),this.check()})),this.errback&&S(e,"error",bind(this,this.errback))}n=e.id,s=u[n],!hasProp(i,n)&&s&&!s.enabled&&r.enable(e,this)})),eachProp(this.pluginMaps,bind(this,function(e){var t=getOwn(u,e.id);t&&!t.enabled&&r.enable(e,this)})),this.enabling=!1,this.check()},on:function(e,t){var n=this.events[e];n||(n=this.events[e]=[]),n.push(t)},emit:function(e,t){each(this.events[e],function(e){e(t)}),e==="error"&&delete this.events[e]}},r={config:o,contextName:e,registry:u,defined:c,urlFetched:h,defQueue:l,Module:n,makeModuleMap:w,nextTick:req.nextTick,onError:x,configure:function(e){e.baseUrl&&e.baseUrl.charAt(e.baseUrl.length-1)!=="/"&&(e.baseUrl+="/");var t=o.pkgs,n=o.shim,i={paths:!0,config:!0,map:!0};eachProp(e,function(e,t){i[t]?t==="map"?(o.map||(o.map={}),mixin(o[t],e,!0,!0)):mixin(o[t],e,!0):o[t]=e}),e.shim&&(eachProp(e.shim,function(e,t){isArray(e)&&(e={deps:e}),(e.exports||e.init)&&!e.exportsFn&&(e.exportsFn=r.makeShimExports(e)),n[t]=e}),o.shim=n),e.packages&&(each(e.packages,function(e){var n;e=typeof e=="string"?{name:e}:e,n=e.location,t[e.name]={name:e.name,location:n||e.name,main:(e.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}}),o.pkgs=t),eachProp(u,function(e,t){!e.inited&&!e.map.unnormalized&&(e.map=w(t))}),(e.deps||e.callback)&&r.require(e.deps||[],e.callback)},makeShimExports:function(e){function t(){var t;return e.init&&(t=e.init.apply(global,arguments)),t||e.exports&&getGlobal(e.exports)}return t},makeRequire:function(t,n){function s(o,a,f){var l,h,p;return n.enableBuildCallback&&a&&isFunction(a)&&(a.__requireJsBuild=!0),typeof o=="string"?isFunction(a)?x(makeError("requireargs","Invalid require call"),f):t&&hasProp(i,o)?i[o](u[t.id]):req.get?req.get(r,o,t,s):(h=w(o,t,!1,!0),l=h.id,hasProp(c,l)?c[l]:x(makeError("notloaded",'Module name "'+l+'" has not been loaded yet for context: '+e+(t?"":". Use require([])")))):(M(),r.nextTick(function(){M(),p=E(w(null,t)),p.skipMap=n.skipMap,p.init(o,a,f,{enabled:!0}),k()}),s)}return n=n||{},mixin(s,{isBrowser:isBrowser,toUrl:function(e){var n,i=e.lastIndexOf("."),s=e.split("/")[0],o=s==="."||s==="..";return i!==-1&&(!o||i>1)&&(n=e.substring(i,e.length),e=e.substring(0,i)),r.nameToUrl(m(e,t&&t.id,!0),n,!0)},defined:function(e){return hasProp(c,w(e,t,!1,!0).id)},specified:function(e){return e=w(e,t,!1,!0).id,hasProp(c,e)||hasProp(u,e)}}),t||(s.undef=function(e){T();var n=w(e,t,!0),r=getOwn(u,e);g(e),delete c[e],delete h[n.url],delete f[e],r&&(r.events.defined&&(f[e]=r.events),N(e))}),s},enable:function(e){var t=getOwn(u,e.id);t&&E(e).enable()},completeLoad:function(e){var t,n,r,i=getOwn(o.shim,e)||{},s=i.exports;T();while(l.length){n=l.shift();if(n[0]===null){n[0]=e;if(t)break;t=!0}else n[0]===e&&(t=!0);L(n)}r=getOwn(u,e);if(!t&&!hasProp(c,e)&&r&&!r.inited){if(o.enforceDefine&&(!s||!getGlobal(s))){if(y(e))return;return x(makeError("nodefine","No define call for "+e,null,[e]))}L([e,i.deps||[],i.exportsFn])}k()},nameToUrl:function(e,t,n){var r,i,s,u,a,f,l,c,h;if(req.jsExtRegExp.test(e))c=e+(t||"");else{r=o.paths,i=o.pkgs,a=e.split("/");for(f=a.length;f>0;f-=1){l=a.slice(0,f).join("/"),s=getOwn(i,l),h=getOwn(r,l);if(h){isArray(h)&&(h=h[0]),a.splice(0,f,h);break}if(s){e===s.name?u=s.location+"/"+s.main:u=s.location,a.splice(0,f,u);break}}c=a.join("/"),c+=t||(/^data\:|\?/.test(c)||n?"":".js"),c=(c.charAt(0)==="/"||c.match(/^[\w\+\.\-]+:/)?"":o.baseUrl)+c}return o.urlArgs?c+((c.indexOf("?")===-1?"?":"&")+o.urlArgs):c},load:function(e,t){req.load(r,e,t)},execCb:function(e,t,n,r){return t.apply(r,n)},onScriptLoad:function(e){if(e.type==="load"||readyRegExp.test((e.currentTarget||e.srcElement).readyState)){interactiveScript=null;var t=O(e);r.completeLoad(t.id)}},onScriptError:function(e){var t=O(e);if(!y(t.id))return x(makeError("scripterror","Script error for: "+t.id,e,[t.id]))}},r.require=r.makeRequire(),r}function getInteractiveScript(){return interactiveScript&&interactiveScript.readyState==="interactive"?interactiveScript:(eachReverse(scripts(),function(e){if(e.readyState==="interactive")return interactiveScript=e}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.1.9",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/mg,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,ap=Array.prototype,apsp=ap.splice,isBrowser=typeof window!="undefined"&&typeof navigator!="undefined"&&!!window.document,isWebWorker=!isBrowser&&typeof importScripts!="undefined",readyRegExp=isBrowser&&navigator.platform==="PLAYSTATION 3"?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera=typeof opera!="undefined"&&opera.toString()==="[object Opera]",contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if(typeof define!="undefined")return;if(typeof requirejs!="undefined"){if(isFunction(requirejs))return;cfg=requirejs,requirejs=undefined}typeof require!="undefined"&&!isFunction(require)&&(cfg=require,require=undefined),req=requirejs=function(e,t,n,r){var i,s,o=defContextName;return!isArray(e)&&typeof e!="string"&&(s=e,isArray(t)?(e=t,t=n,n=r):e=[]),s&&s.context&&(o=s.context),i=getOwn(contexts,o),i||(i=contexts[o]=req.s.newContext(o)),s&&i.configure(s),i.require(e,t,n)},req.config=function(e){return req(e)},req.nextTick=typeof setTimeout!="undefined"?function(e){setTimeout(e,4)}:function(e){e()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(e){req[e]=function(){var t=contexts[defContextName];return t.require[e].apply(t,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(e,t,n){var r=e.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return r.type=e.scriptType||"text/javascript",r.charset="utf-8",r.async=!0,r},req.load=function(e,t,n){var r=e&&e.config||{},i;if(isBrowser)return i=req.createNode(r,t,n),i.setAttribute("data-requirecontext",e.contextName),i.setAttribute("data-requiremodule",t),i.attachEvent&&!(i.attachEvent.toString&&i.attachEvent.toString().indexOf("[native code")<0)&&!isOpera?(useInteractive=!0,i.attachEvent("onreadystatechange",e.onScriptLoad)):(i.addEventListener("load",e.onScriptLoad,!1),i.addEventListener("error",e.onScriptError,!1)),i.src=n,currentlyAddingScript=i,baseElement?head.insertBefore(i,baseElement):head.appendChild(i),currentlyAddingScript=null,i;if(isWebWorker)try{importScripts(n),e.completeLoad(t)}catch(s){e.onError(makeError("importscripts","importScripts failed for "+t+" at "+n,s,[t]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),function(e){head||(head=e.parentNode),dataMain=e.getAttribute("data-main");if(dataMain)return mainScript=dataMain,cfg.baseUrl||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0}),define=function(e,t,n){var r,i;typeof e!="string"&&(n=t,t=e,e=null),isArray(t)||(n=t,t=null),!t&&isFunction(n)&&(t=[],n.length&&(n.toString().replace(commentRegExp,"").replace(cjsRequireRegExp,function(e,n){t.push(n)}),t=(n.length===1?["require"]:["require","exports","module"]).concat(t))),useInteractive&&(r=currentlyAddingScript||getInteractiveScript(),r&&(e||(e=r.getAttribute("data-requiremodule")),i=contexts[r.getAttribute("data-requirecontext")])),(i?i.defQueue:globalDefQueue).push([e,t,n])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)})(this),tadpoles.requirejs=requirejs,tadpoles.require=require,tadpoles.define=define}})(),tadpoles.define("requireLib",function(){}),tadpoles.define("compat",["require"],function(e){function t(){(function(e){function t(){}for(var n="assert,count,debug,dir,dirxml,error,exception,group,groupCollapsed,groupEnd,info,log,markTimeline,profile,profileEnd,time,timeEnd,trace,warn".split(","),r;!!(r=n.pop());)e[r]=e[r]||t})(function(){try{return console.log(),window.console}catch(e){return window.console={}}}())}function n(){IE=function(){var e,t=3,n=document.createElement("div"),r=n.getElementsByTagName("i");while(n.innerHTML="<!--[if gt IE "+ ++t+"]><i></i><![endif]-->",r[0]);return t>4?t:e}()}function r(){Object.create||(Object.create=function(e,t){function r(){var e,n=1,r,i;for(e in t)i=t[e],this[e]=i.value}var n=arguments;return r.prototype=e,new r}),Object.freeze||(Object.freeze=function(e){return e})}function i(){if(IE&&IE<9){"forEach"in Array.prototype||(Array.prototype.forEach=function(e,t){for(var n=0,r=this.length;n<r;n++)n in this&&e.call(t,this[n],n,this)}),typeof Object.getOwnPropertyNames!="function"&&(Object.getOwnPropertyNames=function(e){var t=[];if(typeof e=="object"&&e!==null)for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t});var e=Object.getOwnPropertyDescriptor;Object.getOwnPropertyDescriptor=function(t,n){var r=null;try{r=e.call(Object,t,n)}catch(i){r={value:t[n]}}return r},Object.defineProperty=function(e,t,n){e[t]=n.value},Object.defineProperties=function(e,t){for(var n in t)t.hasOwnProperty(n)&&Object.defineProperty(e,n,t[n])},Date.prototype.toISOString||function(){function e(e){var t=String(e);return t.length===1&&(t="0"+t),t}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}()}}function s(){navigator.userAgent.match(/(iPod|iPhone|iPad)/)&&!Object.freeze&&$("body").addClass("ios4")}function o(){Number.toFixed||(Number.prototype.toFixed=function(e){return e=e||0,Math.round(this*Math.pow(10,e))/Math.pow(10,e)})}function u(){return IE&&IE<9}return s(),n(),t(),r(),i(),o(),{isIE8OrEarlier:u}}),function(){function e(e,t,n){n=(n||0)-1;for(var r=e?e.length:0;++n<r;)if(e[n]===t)return n;return-1}function t(t,n){var r=typeof n;if(t=t.l,"boolean"==r||null==n)return t[n]?0:-1;"number"!=r&&"string"!=r&&(r="object");var i="number"==r?n:b+n;return t=(t=t[r])&&t[i],"object"==r?t&&-1<e(t,n)?0:-1:t?0:-1}function n(e){var t=this.l,n=typeof e;if("boolean"==n||null==e)t[e]=!0;else{"number"!=n&&"string"!=n&&(n="object");var r="number"==n?e:b+e,t=t[n]||(t[n]={});"object"==n?(t[r]||(t[r]=[])).push(e):t[r]=!0}}function r(e){return e.charCodeAt(0)}function i(e,t){var n=e.m,r=t.m;if(n!==r){if(n>r||typeof n=="undefined")return 1;if(n<r||typeof r=="undefined")return-1}return e.n-t.n}function s(e){var t=-1,r=e.length,i=e[0],s=e[r/2|0],o=e[r-1];if(i&&typeof i=="object"&&s&&typeof s=="object"&&o&&typeof o=="object")return!1;for(i=a(),i["false"]=i["null"]=i["true"]=i.undefined=!1,s=a(),s.k=e,s.l=i,s.push=n;++t<r;)s.push(e[t]);return s}function o(e){return"\\"+Y[e]}function u(){return v.pop()||[]}function a(){return m.pop()||{k:null,l:null,m:null,"false":!1,n:0,"null":!1,number:null,object:null,push:null,string:null,"true":!1,"undefined":!1,o:null}}function f(e){return typeof e.toString!="function"&&typeof (e+"")=="string"}function l(e){e.length=0,v.length<E&&v.push(e)}function c(e){var t=e.l;t&&c(t),e.k=e.l=e.m=e.object=e.number=e.string=e.o=null,m.length<E&&m.push(e)}function h(e,t,n){t||(t=0),typeof n=="undefined"&&(n=e?e.length:0);var r=-1;n=n-t||0;for(var i=Array(0>n?0:n);++r<n;)i[r]=e[t+r];return i}function p(n){function v(e){return e&&typeof e=="object"&&!Xn(e)&&Tn.call(e,"__wrapped__")?e:new m(e)}function m(e,t){this.__chain__=!!t,this.__wrapped__=e}function E(e){function t(){if(r){var e=r.slice();Cn.apply(e,arguments)}if(this instanceof t){var s=et(n.prototype),e=n.apply(s,e||arguments);return Nt(e)?e:s}return n.apply(i,e||arguments)}var n=e[0],r=e[2],i=e[4];return Wn(t,e),t}function Y(e,t,n,r,i){if(n){var s=n(e);if(typeof s!="undefined")return s}if(!Nt(e))return e;var o=gn.call(e);if(!$[o]||!zn.nodeClass&&f(e))return e;var a=Rn[o];switch(o){case I:case q:return new a(+e);case z:case V:return new a(e);case X:return s=a(e.source,L.exec(e)),s.lastIndex=e.lastIndex,s}if(o=Xn(e),t){var c=!r;r||(r=u()),i||(i=u());for(var p=r.length;p--;)if(r[p]==e)return i[p];s=o?a(e.length):{}}else s=o?h(e):nr({},e);return o&&(Tn.call(e,"index")&&(s.index=e.index),Tn.call(e,"input")&&(s.input=e.input)),t?(r.push(e),i.push(s),(o?tr:sr)(e,function(e,o){s[o]=Y(e,t,n,r,i)}),c&&(l(r),l(i)),s):s}function et(e){return Nt(e)?_n(e):{}}function tt(e,t,n){if(typeof e!="function")return Gt;if(typeof t!="undefined"&&"prototype"in e){var r=e.__bindData__;if(typeof r=="undefined"&&(zn.funcNames&&(r=!e.name),r=r||!zn.funcDecomp,!r)){var i=Sn.call(e);zn.funcNames||(r=!A.test(i)),r||(r=D.test(i),Wn(e,r))}if(!1===r||!0!==r&&1&r[1])return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)};case 4:return function(n,r,i,s){return e.call(t,n,r,i,s)}}return Jt(e,t)}return e}function st(e){function t(){var e=a?o:this;if(i){var d=i.slice();Cn.apply(d,arguments)}return(s||l)&&(d||(d=h(arguments)),s&&Cn.apply(d,s),l&&d.length<u)?(r|=16,st([n,c?r:-4&r,d,null,o,u])):(d||(d=arguments),f&&(n=e[p]),this instanceof t?(e=et(n.prototype),d=n.apply(e,d),Nt(d)?d:e):n.apply(e,d))}var n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],u=e[5],a=1&r,f=2&r,l=4&r,c=8&r,p=n;return Wn(t,e),t}function ot(n,r){var i=-1,o=gt(),u=n?n.length:0,a=u>=w&&o===e,f=[];if(a){var l=s(r);l?(o=t,r=l):a=!1}for(;++i<u;)l=n[i],0>o(r,l)&&f.push(l);return a&&c(r),f}function at(e,t,n,r){r=(r||0)-1;for(var i=e?e.length:0,s=[];++r<i;){var o=e[r];if(o&&typeof o=="object"&&typeof o.length=="number"&&(Xn(o)||wt(o))){t||(o=at(o,t,n));var u=-1,a=o.length,f=s.length;for(s.length+=a;++u<a;)s[f++]=o[u]}else n||s.push(o)}return s}function ft(e,t,n,r,i,s){if(n){var o=n(e,t);if(typeof o!="undefined")return!!o}if(e===t)return 0!==e||1/e==1/t;if(e===e&&!(e&&G[typeof e]||t&&G[typeof t]))return!1;if(null==e||null==t)return e===t;var a=gn.call(e),c=gn.call(t);if(a==j&&(a=W),c==j&&(c=W),a!=c)return!1;switch(a){case I:case q:return+e==+t;case z:return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case X:case V:return e==ln(t)}if(c=a==F,!c){var h=Tn.call(e,"__wrapped__"),p=Tn.call(t,"__wrapped__");if(h||p)return ft(h?e.__wrapped__:e,p?t.__wrapped__:t,n,r,i,s);if(a!=W||!zn.nodeClass&&(f(e)||f(t)))return!1;if(a=!zn.argsObject&&wt(e)?an:e.constructor,h=!zn.argsObject&&wt(t)?an:t.constructor,a!=h&&!(Tt(a)&&a instanceof a&&Tt(h)&&h instanceof h)&&"constructor"in e&&"constructor"in t)return!1}for(h=!i,i||(i=u()),s||(s=u()),a=i.length;a--;)if(i[a]==e)return s[a]==t;var d=0,o=!0;if(i.push(e),s.push(t),c){if(a=e.length,d=t.length,o=d==e.length,!o&&!r)return o;for(;d--;)if(c=a,h=t[d],r)for(;c--&&!(o=ft(e[c],h,n,r,i,s)););else if(!(o=ft(e[d],h,n,r,i,s)))break;return o}return ir(t,function(t,u,a){return Tn.call(a,u)?(d++,o=Tn.call(e,u)&&ft(e[u],t,n,r,i,s)):void 0}),o&&!r&&ir(e,function(e,t,n){return Tn.call(n,t)?o=-1<--d:void 0}),h&&(l(i),l(s)),o}function lt(e,t,n,r,i){(Xn(t)?Dt:sr)(t,function(t,s){var o,u,a=t,f=e[s];if(t&&((u=Xn(t))||or(t))){for(a=r.length;a--;)if(o=r[a]==t){f=i[a];break}if(!o){var l;n&&(a=n(f,t),l=typeof a!="undefined")&&(f=a),l||(f=u?Xn(f)?f:[]:or(f)?f:{}),r.push(t),i.push(f),l||lt(f,t,n,r,i)}}else n&&(a=n(f,t),typeof a=="undefined"&&(a=t)),typeof a!="undefined"&&(f=a);e[s]=f})}function ct(e,t){return e+En(qn()*(t-e+1))}function ht(n,r,i){var o=-1,a=gt(),f=n?n.length:0,h=[],p=!r&&f>=w&&a===e,d=i||p?u():h;if(p){var v=s(d);v?(a=t,d=v):(p=!1,d=i?d:(l(d),h))}for(;++o<f;){var v=n[o],m=i?i(v,o,n):v;(r?!o||d[d.length-1]!==m:0>a(d,m))&&((i||p)&&d.push(m),h.push(v))}return p?(l(d.k),c(d)):i&&l(d),h}function pt(e){return function(t,n,r){var i={};if(n=v.createCallback(n,r,3),Xn(t)){r=-1;for(var s=t.length;++r<s;){var o=t[r];e(i,o,n(o,r,t),t)}}else tr(t,function(t,r,s){e(i,t,n(t,r,s),s)});return i}}function dt(e,t,n,r,i,s){var o=1&t,u=4&t,a=16&t,f=32&t;if(!(2&t||Tt(e)))throw new cn;a&&!n.length&&(t&=-17,a=n=!1),f&&!r.length&&(t&=-33,f=r=!1);var l=e&&e.__bindData__;return l&&!0!==l?(l=l.slice(),!o||1&l[1]||(l[4]=i),!o&&1&l[1]&&(t|=8),!u||4&l[1]||(l[5]=s),a&&Cn.apply(l[2]||(l[2]=[]),n),f&&Cn.apply(l[3]||(l[3]=[]),r),l[1]|=t,dt.apply(null,l)):(1==t||17===t?E:st)([e,t,n,r,i,s])}function vt(){Q.h=B,Q.b=Q.c=Q.g=Q.i="",Q.e="t",Q.j=!0;for(var e,t=0;e=arguments[t];t++)for(var n in e)Q[n]=e[n];t=Q.a,Q.d=/^[^,]+/.exec(t)[0],e=sn,t="return function("+t+"){",n=Q;var r="var n,t="+n.d+",E="+n.e+";if(!t)return E;"+n.i+";";n.b?(r+="var u=t.length;n=-1;if("+n.b+"){",zn.unindexedChars&&(r+="if(s(t)){t=t.split('')}"),r+="while(++n<u){"+n.g+";}}else{"):zn.nonEnumArgs&&(r+="var u=t.length;n=-1;if(u&&p(t)){while(++n<u){n+='';"+n.g+";}}else{"),zn.enumPrototypes&&(r+="var G=typeof t=='function';"),zn.enumErrorProps&&(r+="var F=t===k||t instanceof Error;");var i=[];if(zn.enumPrototypes&&i.push('!(G&&n=="prototype")'),zn.enumErrorProps&&i.push('!(F&&(n=="message"||n=="name"))'),n.j&&n.f)r+="var C=-1,D=B[typeof t]&&v(t),u=D?D.length:0;while(++C<u){n=D[C];",i.length&&(r+="if("+i.join("&&")+"){"),r+=n.g+";",i.length&&(r+="}"),r+="}";else if(r+="for(n in t){",n.j&&i.push("m.call(t, n)"),i.length&&(r+="if("+i.join("&&")+"){"),r+=n.g+";",i.length&&(r+="}"),r+="}",zn.nonEnumShadows){for(r+="if(t!==A){var i=t.constructor,r=t===(i&&i.prototype),f=t===J?I:t===k?j:L.call(t),x=y[f];",k=0;7>k;k++)r+="n='"+n.h[k]+"';if((!(r&&x[n])&&m.call(t,n))",n.j||(r+="||(!x[n]&&t[n]!==A[n])"),r+="){"+n.g+"}";r+="}"}return(n.b||zn.nonEnumArgs)&&(r+="}"),r+=n.c+";return E",e("d,j,k,m,o,p,q,s,v,A,B,y,I,J,L",t+r+"}")(tt,R,pn,Tn,y,wt,Xn,kt,Q.f,dn,G,Un,V,vn,gn)}function mt(e){return Gn[e]}function gt(){var t=(t=v.indexOf)===Ut?e:t;return t}function yt(e){var t,n;return!e||gn.call(e)!=W||(t=e.constructor,Tt(t)&&!(t instanceof t))||!zn.argsClass&&wt(e)||!zn.nodeClass&&f(e)?!1:zn.ownLast?(ir(e,function(e,t,r){return n=Tn.call(r,t),!1}),!1!==n):(ir(e,function(e,t){n=t}),typeof n=="undefined"||Tn.call(e,n))}function bt(e){return Yn[e]}function wt(e){return e&&typeof e=="object"&&typeof e.length=="number"&&gn.call(e)==j||!1}function Et(e,t,n){var r=$n(e),i=r.length;for(t=tt(t,n,3);i--&&(n=r[i],!1!==t(e[n],n,e)););return e}function St(e){var t=[];return ir(e,function(e,n){Tt(e)&&t.push(n)}),t.sort()}function xt(e){for(var t=-1,n=$n(e),r=n.length,i={};++t<r;){var s=n[t];i[e[s]]=s}return i}function Tt(e){return typeof e=="function"}function Nt(e){return!!e&&!!G[typeof e]}function Ct(e){return typeof e=="number"||e&&typeof e=="object"&&gn.call(e)==z||!1}function kt(e){return typeof e=="string"||e&&typeof e=="object"&&gn.call(e)==V||!1}function Lt(e){for(var t=-1,n=$n(e),r=n.length,i=tn(r);++t<r;)i[t]=e[n[t]];return i}function At(e,t,n){var r=-1,i=gt(),s=e?e.length:0,o=!1;return n=(0>n?jn(0,s+n):n)||0,Xn(e)?o=-1<i(e,t,n):typeof s=="number"?o=-1<(kt(e)?e.indexOf(t,n):i(e,t,n)):tr(e,function(e){return++r<n?void 0:!(o=e===t)}),o}function Ot(e,t,n){var r=!0;if(t=v.createCallback(t,n,3),Xn(e)){n=-1;for(var i=e.length;++n<i&&(r=!!t(e[n],n,e)););}else tr(e,function(e,n,i){return r=!!t(e,n,i)});return r}function Mt(e,t,n){var r=[];if(t=v.createCallback(t,n,3),Xn(e)){n=-1;for(var i=e.length;++n<i;){var s=e[n];t(s,n,e)&&r.push(s)}}else tr(e,function(e,n,i){t(e,n,i)&&r.push(e)});return r}function _t(e,t,n){if(t=v.createCallback(t,n,3),!Xn(e)){var r;return tr(e,function(e,n,i){return t(e,n,i)?(r=e,!1):void 0}),r}n=-1;for(var i=e.length;++n<i;){var s=e[n];if(t(s,n,e))return s}}function Dt(e,t,n){if(t&&typeof n=="undefined"&&Xn(e)){n=-1;for(var r=e.length;++n<r&&!1!==t(e[n],n,e););}else tr(e,t,n);return e}function Pt(e,t,n){var r=e,i=e?e.length:0;if(t=t&&typeof n=="undefined"?t:tt(t,n,3),Xn(e))for(;i--&&!1!==t(e[i],i,e););else{if(typeof i!="number")var s=$n(e),i=s.length;else zn.unindexedChars&&kt(e)&&(r=e.split(""));tr(e,function(e,n,o){return n=s?s[--i]:--i,t(r[n],n,o)})}return e}function Ht(e,t,n){var r=-1,i=e?e.length:0,s=tn(typeof i=="number"?i:0);if(t=v.createCallback(t,n,3),Xn(e))for(;++r<i;)s[r]=t(e[r],r,e);else tr(e,function(e,n,i){s[++r]=t(e,n,i)});return s}function Bt(e,t,n){var i=-1/0,s=i;if(typeof t!="function"&&n&&n[t]===e&&(t=null),null==t&&Xn(e)){n=-1;for(var o=e.length;++n<o;){var u=e[n];u>s&&(s=u)}}else t=null==t&&kt(e)?r:v.createCallback(t,n,3),tr(e,function(e,n,r){n=t(e,n,r),n>i&&(i=n,s=e)});return s}function jt(e,t,n,r){var i=3>arguments.length;if(t=v.createCallback(t,r,4),Xn(e)){var s=-1,o=e.length;for(i&&(n=e[++s]);++s<o;)n=t(n,e[s],s,e)}else tr(e,function(e,r,s){n=i?(i=!1,e):t(n,e,r,s)});return n}function Ft(e,t,n,r){var i=3>arguments.length;return t=v.createCallback(t,r,4),Pt(e,function(e,r,s){n=i?(i=!1,e):t(n,e,r,s)}),n}function It(e){var t=-1,n=e?e.length:0,r=tn(typeof n=="number"?n:0);return Dt(e,function(e){var n=ct(0,++t);r[t]=r[n],r[n]=e}),r}function qt(e,t,n){var r;if(t=v.createCallback(t,n,3),Xn(e)){n=-1;for(var i=e.length;++n<i&&!(r=t(e[n],n,e)););}else tr(e,function(e,n,i){return!(r=t(e,n,i))});return!!r}function Rt(e,t,n){var r=0,i=e?e.length:0;if(typeof t!="number"&&null!=t){var s=-1;for(t=v.createCallback(t,n,3);++s<i&&t(e[s],s,e);)r++}else if(r=t,null==r||n)return e?e[0]:d;return h(e,0,Fn(jn(0,r),i))}function Ut(t,n,r){if(typeof r=="number"){var i=t?t.length:0;r=0>r?jn(0,i+r):r||0}else if(r)return r=Wt(t,n),t[r]===n?r:-1;return e(t,n,r)}function zt(e,t,n){if(typeof t!="number"&&null!=t){var r=0,i=-1,s=e?e.length:0;for(t=v.createCallback(t,n,3);++i<s&&t(e[i],i,e);)r++}else r=null==t||n?1:jn(0,t);return h(e,r)}function Wt(e,t,n,r){var i=0,s=e?e.length:i;for(n=n?v.createCallback(n,r,1):Gt,t=n(t);i<s;)r=i+s>>>1,n(e[r])<t?i=r+1:s=r;return i}function Xt(e,t,n,r){return typeof t!="boolean"&&null!=t&&(r=n,n=typeof t!="function"&&r&&r[t]===e?null:t,t=!1),null!=n&&(n=v.createCallback(n,r,3)),ht(e,t,n)}function Vt(){for(var e=1<arguments.length?arguments:arguments[0],t=-1,n=e?Bt(lr(e,"length")):0,r=tn(0>n?0:n);++t<n;)r[t]=lr(e,t);return r}function $t(e,t){for(var n=-1,r=e?e.length:0,i={};++n<r;){var s=e[n];t?i[s]=t[n]:s&&(i[s[0]]=s[1])}return i}function Jt(e,t){return 2<arguments.length?dt(e,17,h(arguments,2),null,t):dt(e,1,null,null,t)}function Kt(e,t,n){var r,i,s,o,u,a,f,l=0,c=!1,h=!0;if(!Tt(e))throw new cn;if(t=jn(0,t)||0,!0===n)var p=!0,h=!1;else Nt(n)&&(p=n.leading,c="maxWait"in n&&(jn(t,n.maxWait)||0),h="trailing"in n?n.trailing:h);var v=function(){var n=t-(Nn()-o);0<n?a=Ln(v,n):(i&&wn(i),n=f,i=a=f=d,n&&(l=Nn(),s=e.apply(u,r),a||i||(r=u=null)))},m=function(){a&&wn(a),i=a=f=d,(h||c!==t)&&(l=Nn(),s=e.apply(u,r),a||i||(r=u=null))};return function(){if(r=arguments,o=Nn(),u=this,f=h&&(a||!p),!1===c)var n=p&&!a;else{i||p||(l=o);var d=c-(o-l),g=0>=d;g?(i&&(i=wn(i)),l=o,s=e.apply(u,r)):i||(i=Ln(m,d))}return g&&a?a=wn(a):a||t===c||(a=Ln(v,t)),n&&(g=!0,s=e.apply(u,r)),!g||a||i||(r=u=null),s}}function Qt(e){if(!Tt(e))throw new cn;var t=h(arguments,1);return Ln(function(){e.apply(d,t)},1)}function Gt(e){return e}function Yt(e,t){var n=e,r=!t||Tt(n);t||(n=m,t=e,e=v),Dt(St(t),function(i){var s=e[i]=t[i];r&&(n.prototype[i]=function(){var t=this.__wrapped__,r=[t];return Cn.apply(r,arguments),r=s.apply(e,r),t&&typeof t=="object"&&t===r?this:(r=new n(r),r.__chain__=this.__chain__,r)})})}function Zt(){}function en(){return this.__wrapped__}n=n?it.defaults(Z.Object(),n,it.pick(Z,H)):Z;var tn=n.Array,nn=n.Boolean,rn=n.Date,sn=n.Function,on=n.Math,un=n.Number,an=n.Object,fn=n.RegExp,ln=n.String,cn=n.TypeError,hn=[],pn=n.Error.prototype,dn=an.prototype,vn=ln.prototype,mn=n._,gn=dn.toString,yn=fn("^"+ln(gn).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),bn=on.ceil,wn=n.clearTimeout,En=on.floor,Sn=sn.prototype.toString,xn=yn.test(xn=an.getPrototypeOf)&&xn,Tn=dn.hasOwnProperty,Nn=yn.test(Nn=rn.now)&&Nn||function(){return+(new rn)},Cn=hn.push,kn=dn.propertyIsEnumerable,Ln=n.setTimeout,An=hn.splice,On=typeof (On=rt&&nt&&rt.setImmediate)=="function"&&!yn.test(On)&&On,Mn=function(){try{var e={},t=yn.test(t=an.defineProperty)&&t,n=t(e,e,e)&&t}catch(r){}return n}(),_n=yn.test(_n=an.create)&&_n,Dn=yn.test(Dn=tn.isArray)&&Dn,Pn=n.isFinite,Hn=n.isNaN,Bn=yn.test(Bn=an.keys)&&Bn,jn=on.max,Fn=on.min,In=n.parseInt,qn=on.random,Rn={};Rn[F]=tn,Rn[I]=nn,Rn[q]=rn,Rn[U]=sn,Rn[W]=an,Rn[z]=un,Rn[X]=fn,Rn[V]=ln;var Un={};Un[F]=Un[q]=Un[z]={constructor:!0,toLocaleString:!0,toString:!0,valueOf:!0},Un[I]=Un[V]={constructor:!0,toString:!0,valueOf:!0},Un[R]=Un[U]=Un[X]={constructor:!0,toString:!0},Un[W]={constructor:!0},function(){for(var e=B.length;e--;){var t,n=B[e];for(t in Un)Tn.call(Un,t)&&!Tn.call(Un[t],n)&&(Un[t][n]=!1)}}(),m.prototype=v.prototype;var zn=v.support={};!function(){var e=function(){this.x=1},t={0:1,length:1},r=[];e.prototype={valueOf:1,y:1};for(var i in new e)r.push(i);for(i in arguments);zn.argsClass=gn.call(arguments)==j,zn.argsObject=arguments.constructor==an&&!(arguments instanceof tn),zn.enumErrorProps=kn.call(pn,"message")||kn.call(pn,"name"),zn.enumPrototypes=kn.call(e,"prototype"),zn.funcDecomp=!yn.test(n.WinRTError)&&D.test(p),zn.funcNames=typeof sn.name=="string",zn.nonEnumArgs=0!=i,zn.nonEnumShadows=!/valueOf/.test(r),zn.ownLast="x"!=r[0],zn.spliceObjects=(hn.splice.call(t,0,1),!t[0]),zn.unindexedChars="xx"!="x"[0]+an("x")[0];try{zn.nodeClass=gn.call(document)!=W||!!({toString:0}+"")}catch(s){zn.nodeClass=!0}}(1),v.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:O,variable:"",imports:{_:v}},_n||(et=function(){function e(){}return function(t){if(Nt(t)){e.prototype=t;var r=new e;e.prototype=null}return r||n.Object()}}());var Wn=Mn?function(e,t){K.value=t,Mn(e,"__bindData__",K)}:Zt;zn.argsClass||(wt=function(e){return e&&typeof e=="object"&&typeof e.length=="number"&&Tn.call(e,"callee")&&!kn.call(e,"callee")||!1});var Xn=Dn||function(e){return e&&typeof e=="object"&&typeof e.length=="number"&&gn.call(e)==F||!1},Vn=vt({a:"z",e:"[]",i:"if(!(B[typeof z]))return E",g:"E.push(n)"}),$n=Bn?function(e){return Nt(e)?zn.enumPrototypes&&typeof e=="function"||zn.nonEnumArgs&&e.length&&wt(e)?Vn(e):Bn(e):[]}:Vn,Jn={a:"g,e,K",i:"e=e&&typeof K=='undefined'?e:d(e,K,3)",b:"typeof u=='number'",v:$n,g:"if(e(t[n],n,g)===false)return E"},Kn={a:"z,H,l",i:"var a=arguments,b=0,c=typeof l=='number'?2:a.length;while(++b<c){t=a[b];if(t&&B[typeof t]){",v:$n,g:"if(typeof E[n]=='undefined')E[n]=t[n]",c:"}}"},Qn={i:"if(!B[typeof t])return E;"+Jn.i,b:!1},Gn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Yn=xt(Gn),Zn=fn("("+$n(Yn).join("|")+")","g"),er=fn("["+$n(Gn).join("")+"]","g"),tr=vt(Jn),nr=vt(Kn,{i:Kn.i.replace(";",";if(c>3&&typeof a[c-2]=='function'){var e=d(a[--c-1],a[c--],2)}else if(c>2&&typeof a[c-1]=='function'){e=a[--c]}"),g:"E[n]=e?e(E[n],t[n]):t[n]"}),rr=vt(Kn),ir=vt(Jn,Qn,{j:!1}),sr=vt(Jn,Qn);Tt(/x/)&&(Tt=function(e){return typeof e=="function"&&gn.call(e)==U});var or=xn?function(e){if(!e||gn.call(e)!=W||!zn.argsClass&&wt(e))return!1;var t=e.valueOf,n=typeof t=="function"&&(n=xn(t))&&xn(n);return n?e==n||xn(e)==n:yt(e)}:yt,ur=pt(function(e,t,n){Tn.call(e,n)?e[n]++:e[n]=1}),ar=pt(function(e,t,n){(Tn.call(e,n)?e[n]:e[n]=[]).push(t)}),fr=pt(function(e,t,n){e[n]=t}),lr=Ht;On&&(Qt=function(e){if(!Tt(e))throw new cn;return On.apply(n,arguments)});var cr=8==In(S+"08")?In:function(e,t){return In(kt(e)?e.replace(M,""):e,t||0)};return v.after=function(e,t){if(!Tt(t))throw new cn;return function(){return 1>--e?t.apply(this,arguments):void 0}},v.assign=nr,v.at=function(e){var t=arguments,n=-1,r=at(t,!0,!1,1),t=t[2]&&t[2][t[1]]===e?1:r.length,i=tn(t);for(zn.unindexedChars&&kt(e)&&(e=e.split(""));++n<t;)i[n]=e[r[n]];return i},v.bind=Jt,v.bindAll=function(e){for(var t=1<arguments.length?at(arguments,!0,!1,1):St(e),n=-1,r=t.length;++n<r;){var i=t[n];e[i]=dt(e[i],1,null,null,e)}return e},v.bindKey=function(e,t){return 2<arguments.length?dt(t,19,h(arguments,2),null,e):dt(t,3,null,null,e)},v.chain=function(e){return e=new m(e),e.__chain__=!0,e},v.compact=function(e){for(var t=-1,n=e?e.length:0,r=[];++t<n;){var i=e[t];i&&r.push(i)}return r},v.compose=function(){for(var e=arguments,t=e.length;t--;)if(!Tt(e[t]))throw new cn;return function(){for(var t=arguments,n=e.length;n--;)t=[e[n].apply(this,t)];return t[0]}},v.countBy=ur,v.create=function(e,t){var n=et(e);return t?nr(n,t):n},v.createCallback=function(e,t,n){var r=typeof e;if(null==e||"function"==r)return tt(e,t,n);if("object"!=r)return function(t){return t[e]};var i=$n(e),s=i[0],o=e[s];return 1!=i.length||o!==o||Nt(o)?function(t){for(var n=i.length,r=!1;n--&&(r=ft(t[i[n]],e[i[n]],null,!0)););return r}:function(e){return e=e[s],o===e&&(0!==o||1/o==1/e)}},v.curry=function(e,t){return t=typeof t=="number"?t:+t||e.length,dt(e,4,null,null,null,t)},v.debounce=Kt,v.defaults=rr,v.defer=Qt,v.delay=function(e,t){if(!Tt(e))throw new cn;var n=h(arguments,2);return Ln(function(){e.apply(d,n)},t)},v.difference=function(e){return ot(e,at(arguments,!0,!0,1))},v.filter=Mt,v.flatten=function(e,t,n,r){return typeof t!="boolean"&&null!=t&&(r=n,n=typeof t!="function"&&r&&r[t]===e?null:t,t=!1),null!=n&&(e=Ht(e,n,r)),at(e,t)},v.forEach=Dt,v.forEachRight=Pt,v.forIn=ir,v.forInRight=function(e,t,n){var r=[];ir(e,function(e,t){r.push(t,e)});var i=r.length;for(t=tt(t,n,3);i--&&!1!==t(r[i--],r[i],e););return e},v.forOwn=sr,v.forOwnRight=Et,v.functions=St,v.groupBy=ar,v.indexBy=fr,v.initial=function(e,t,n){var r=0,i=e?e.length:0;if(typeof t!="number"&&null!=t){var s=i;for(t=v.createCallback(t,n,3);s--&&t(e[s],s,e);)r++}else r=null==t||n?1:t||r;return h(e,0,Fn(jn(0,i-r),i))},v.intersection=function(n){for(var r=arguments,i=r.length,o=-1,a=u(),f=-1,h=gt(),p=n?n.length:0,d=[],v=u();++o<i;){var m=r[o];a[o]=h===e&&(m?m.length:0)>=w&&s(o?r[o]:v)}e:for(;++f<p;){var g=a[0],m=n[f];if(0>(g?t(g,m):h(v,m))){for(o=i,(g||v).push(m);--o;)if(g=a[o],0>(g?t(g,m):h(r[o],m)))continue e;d.push(m)}}for(;i--;)(g=a[i])&&c(g);return l(a),l(v),d},v.invert=xt,v.invoke=function(e,t){var n=h(arguments,2),r=-1,i=typeof t=="function",s=e?e.length:0,o=tn(typeof s=="number"?s:0);return Dt(e,function(e){o[++r]=(i?t:e[t]).apply(e,n)}),o},v.keys=$n,v.map=Ht,v.max=Bt,v.memoize=function(e,t){if(!Tt(e))throw new cn;var n=function(){var r=n.cache,i=t?t.apply(this,arguments):b+arguments[0];return Tn.call(r,i)?r[i]:r[i]=e.apply(this,arguments)};return n.cache={},n},v.merge=function(e){var t=arguments,n=2;if(!Nt(e))return e;if("number"!=typeof t[2]&&(n=t.length),3<n&&"function"==typeof t[n-2])var r=tt(t[--n-1],t[n--],2);else 2<n&&"function"==typeof t[n-1]&&(r=t[--n]);for(var t=h(arguments,1,n),i=-1,s=u(),o=u();++i<n;)lt(e,t[i],r,s,o);return l(s),l(o),e},v.min=function(e,t,n){var i=1/0,s=i;if(typeof t!="function"&&n&&n[t]===e&&(t=null),null==t&&Xn(e)){n=-1;for(var o=e.length;++n<o;){var u=e[n];u<s&&(s=u)}}else t=null==t&&kt(e)?r:v.createCallback(t,n,3),tr(e,function(e,n,r){n=t(e,n,r),n<i&&(i=n,s=e)});return s},v.omit=function(e,t,n){var r={};if(typeof t!="function"){var i=[];ir(e,function(e,t){i.push(t)});for(var i=ot(i,at(arguments,!0,!1,1)),s=-1,o=i.length;++s<o;){var u=i[s];r[u]=e[u]}}else t=v.createCallback(t,n,3),ir(e,function(e,n,i){t(e,n,i)||(r[n]=e)});return r},v.once=function(e){var t,n;if(!Tt(e))throw new cn;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}},v.pairs=function(e){for(var t=-1,n=$n(e),r=n.length,i=tn(r);++t<r;){var s=n[t];i[t]=[s,e[s]]}return i},v.partial=function(e){return dt(e,16,h(arguments,1))},v.partialRight=function(e){return dt(e,32,null,h(arguments,1))},v.pick=function(e,t,n){var r={};if(typeof t!="function")for(var i=-1,s=at(arguments,!0,!1,1),o=Nt(e)?s.length:0;++i<o;){var u=s[i];u in e&&(r[u]=e[u])}else t=v.createCallback(t,n,3),ir(e,function(e,n,i){t(e,n,i)&&(r[n]=e)});return r},v.pluck=lr,v.pull=function(e){for(var t=arguments,n=0,r=t.length,i=e?e.length:0;++n<r;)for(var s=-1,o=t[n];++s<i;)e[s]===o&&(An.call(e,s--,1),i--);return e},v.range=function(e,t,n){e=+e||0,n=typeof n=="number"?n:+n||1,null==t&&(t=e,e=0);var r=-1;t=jn(0,bn((t-e)/(n||1)));for(var i=tn(t);++r<t;)i[r]=e,e+=n;return i},v.reject=function(e,t,n){return t=v.createCallback(t,n,3),Mt(e,function(e,n,r){return!t(e,n,r)})},v.remove=function(e,t,n){var r=-1,i=e?e.length:0,s=[];for(t=v.createCallback(t,n,3);++r<i;)n=e[r],t(n,r,e)&&(s.push(n),An.call(e,r--,1),i--);return s},v.rest=zt,v.shuffle=It,v.sortBy=function(e,t,n){var r=-1,s=e?e.length:0,o=tn(typeof s=="number"?s:0);for(t=v.createCallback(t,n,3),Dt(e,function(e,n,i){var s=o[++r]=a();s.m=t(e,n,i),s.n=r,s.o=e}),s=o.length,o.sort(i);s--;)e=o[s],o[s]=e.o,c(e);return o},v.tap=function(e,t){return t(e),e},v.throttle=function(e,t,n){var r=!0,i=!0;if(!Tt(e))throw new cn;return!1===n?r=!1:Nt(n)&&(r="leading"in n?n.leading:r,i="trailing"in n?n.trailing:i),J.leading=r,J.maxWait=t,J.trailing=i,Kt(e,t,J)},v.times=function(e,t,n){e=-1<(e=+e)?e:0;var r=-1,i=tn(e);for(t=tt(t,n,1);++r<e;)i[r]=t(r);return i},v.toArray=function(e){return e&&typeof e.length=="number"?zn.unindexedChars&&kt(e)?e.split(""):h(e):Lt(e)},v.transform=function(e,t,n,r){var i=Xn(e);if(null==n)if(i)n=[];else{var s=e&&e.constructor;n=et(s&&s.prototype)}return t&&(t=v.createCallback(t,r,4),(i?tr:sr)(e,function(e,r,i){return t(n,e,r,i)})),n},v.union=function(){return ht(at(arguments,!0,!0))},v.uniq=Xt,v.values=Lt,v.where=Mt,v.without=function(e){return ot(e,h(arguments,1))},v.wrap=function(e,t){return dt(t,16,[e])},v.zip=Vt,v.zipObject=$t,v.collect=Ht,v.drop=zt,v.each=Dt,v.eachRight=Pt,v.extend=nr,v.methods=St,v.object=$t,v.select=Mt,v.tail=zt,v.unique=Xt,v.unzip=Vt,Yt(v),v.clone=function(e,t,n,r){return typeof t!="boolean"&&null!=t&&(r=n,n=t,t=!1),Y(e,t,typeof n=="function"&&tt(n,r,1))},v.cloneDeep=function(e,t,n){return Y(e,!0,typeof t=="function"&&tt(t,n,1))},v.contains=At,v.escape=function(e){return null==e?"":ln(e).replace(er,mt)},v.every=Ot,v.find=_t,v.findIndex=function(e,t,n){var r=-1,i=e?e.length:0;for(t=v.createCallback(t,n,3);++r<i;)if(t(e[r],r,e))return r;return-1},v.findKey=function(e,t,n){var r;return t=v.createCallback(t,n,3),sr(e,function(e,n,i){return t(e,n,i)?(r=n,!1):void 0}),r},v.findLast=function(e,t,n){var r;return t=v.createCallback(t,n,3),Pt(e,function(e,n,i){return t(e,n,i)?(r=e,!1):void 0}),r},v.findLastIndex=function(e,t,n){var r=e?e.length:0;for(t=v.createCallback(t,n,3);r--;)if(t(e[r],r,e))return r;return-1},v.findLastKey=function(e,t,n){var r;return t=v.createCallback(t,n,3),Et(e,function(e,n,i){return t(e,n,i)?(r=n,!1):void 0}),r},v.has=function(e,t){return e?Tn.call(e,t):!1},v.identity=Gt,v.indexOf=Ut,v.isArguments=wt,v.isArray=Xn,v.isBoolean=function(e){return!0===e||!1===e||e&&typeof e=="object"&&gn.call(e)==I||!1},v.isDate=function(e){return e&&typeof e=="object"&&gn.call(e)==q||!1},v.isElement=function(e){return e&&1===e.nodeType||!1},v.isEmpty=function(e){var t=!0;if(!e)return t;var n=gn.call(e),r=e.length;return n==F||n==V||(zn.argsClass?n==j:wt(e))||n==W&&typeof r=="number"&&Tt(e.splice)?!r:(sr(e,function(){return t=!1}),t)},v.isEqual=function(e,t,n,r){return ft(e,t,typeof n=="function"&&tt(n,r,2))},v.isFinite=function(e){return Pn(e)&&!Hn(parseFloat(e))},v.isFunction=Tt,v.isNaN=function(e){return Ct(e)&&e!=+e},v.isNull=function(e){return null===e},v.isNumber=Ct,v.isObject=Nt,v.isPlainObject=or,v.isRegExp=function(e){return e&&G[typeof e]&&gn.call(e)==X||!1},v.isString=kt,v.isUndefined=function(e){return typeof e=="undefined"},v.lastIndexOf=function(e,t,n){var r=e?e.length:0;for(typeof n=="number"&&(r=(0>n?jn(0,r+n):Fn(n,r-1))+1);r--;)if(e[r]===t)return r;return-1},v.mixin=Yt,v.noConflict=function(){return n._=mn,this},v.noop=Zt,v.parseInt=cr,v.random=function(e,t,n){var r=null==e,i=null==t;return null==n&&(typeof e=="boolean"&&i?(n=e,e=1):i||typeof t!="boolean"||(n=t,i=!0)),r&&i&&(t=1),e=+e||0,i?(t=e,e=0):t=+t||0,n||e%1||t%1?(n=qn(),Fn(e+n*(t-e+parseFloat("1e-"+((n+"").length-1))),t)):ct(e,t)},v.reduce=jt,v.reduceRight=Ft,v.result=function(e,t){if(e){var n=e[t];return Tt(n)?e[t]():n}},v.runInContext=p,v.size=function(e){var t=e?e.length:0;return typeof t=="number"?t:$n(e).length},v.some=qt,v.sortedIndex=Wt,v.template=function(e,t,n){var r=v.templateSettings;e=ln(e||""),n=rr({},n,r);var i,s=rr({},n.imports,r.imports),r=$n(s),s=Lt(s),u=0,a=n.interpolate||_,f="__p+='",a=fn((n.escape||_).source+"|"+a.source+"|"+(a===O?C:_).source+"|"+(n.evaluate||_).source+"|$","g");e.replace(a,function(t,n,r,s,a,l){return r||(r=s),f+=e.slice(u,l).replace(P,o),n&&(f+="'+__e("+n+")+'"),a&&(i=!0,f+="';"+a+";\n__p+='"),r&&(f+="'+((__t=("+r+"))==null?'':__t)+'"),u=l+t.length,t}),f+="';",a=n=n.variable,a||(n="obj",f="with("+n+"){"+f+"}"),f=(i?f.replace(x,""):f).replace(T,"$1").replace(N,"$1;"),f="function("+n+"){"+(a?"":n+"||("+n+"={});")+"var __t,__p='',__e=_.escape"+(i?",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,'')}":";")+f+"return __p}";try{var l=sn(r,"return "+f).apply(d,s)}catch(c){throw c.source=f,c}return t?l(t):(l.source=f,l)},v.unescape=function(e){return null==e?"":ln(e).replace(Zn,bt)},v.uniqueId=function(e){var t=++g;return ln(null==e?"":e)+t},v.all=Ot,v.any=qt,v.detect=_t,v.findWhere=_t,v.foldl=jt,v.foldr=Ft,v.include=At,v.inject=jt,sr(v,function(e,t){v.prototype[t]||(v.prototype[t]=function(){var t=[this.__wrapped__],n=this.__chain__;return Cn.apply(t,arguments),t=e.apply(v,t),n?new m(t,n):t})}),v.first=Rt,v.last=function(e,t,n){var r=0,i=e?e.length:0;if(typeof t!="number"&&null!=t){var s=i;for(t=v.createCallback(t,n,3);s--&&t(e[s],s,e);)r++}else if(r=t,null==r||n)return e?e[i-1]:d;return h(e,jn(0,i-r))},v.sample=function(e,t,n){return e&&typeof e.length!="number"?e=Lt(e):zn.unindexedChars&&kt(e)&&(e=e.split("")),null==t||n?e?e[ct(0,e.length-1)]:d:(e=It(e),e.length=Fn(jn(0,t),e.length),e)},v.take=Rt,v.head=Rt,sr(v,function(e,t){var n="sample"!==t;v.prototype[t]||(v.prototype[t]=function(t,r){var i=this.__chain__,s=e(this.__wrapped__,t,r);return i||null!=t&&(!r||n&&typeof t=="function")?new m(s,i):s})}),v.VERSION="2.3.0",v.prototype.chain=function(){return this.__chain__=!0,this},v.prototype.toString=function(){return ln(this.__wrapped__)},v.prototype.value=en,v.prototype.valueOf=en,tr(["join","pop","shift"],function(e){var t=hn[e];v.prototype[e]=function(){var e=this.__chain__,n=t.apply(this.__wrapped__,arguments);return e?new m(n,e):n}}),tr(["push","reverse","sort","unshift"],function(e){var t=hn[e];v.prototype[e]=function(){return t.apply(this.__wrapped__,arguments),this}}),tr(["concat","slice","splice"],function(e){var t=hn[e];v.prototype[e]=function(){return new m(t.apply(this.__wrapped__,arguments),this.__chain__)}}),zn.spliceObjects||tr(["pop","shift","splice"],function(e){var t=hn[e],n="splice"==e;v.prototype[e]=function(){var e=this.__chain__,r=this.__wrapped__,i=t.apply(r,arguments);return 0===r.length&&delete r[0],e||n?new m(i,e):i}}),v}var d,v=[],m=[],g=0,y={},b=+(new Date)+"",w=75,E=40,S=" 	\f\n\r\u2028\u2029",x=/\b__p\+='';/g,T=/\b(__p\+=)''\+/g,N=/(__e\(.*?\)|\b__t\))\+'';/g,C=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,L=/\w*$/,A=/^\s*function[ \n\r\t]+\w/,O=/<%=([\s\S]+?)%>/g,M=RegExp("^["+S+"]*0+(?=.$)"),_=/($^)/,D=/\bthis\b/,P=/['\n\r\t\u2028\u2029\\]/g,H="Array Boolean Date Error Function Math Number Object RegExp String _ attachEvent clearTimeout isFinite isNaN parseInt setImmediate setTimeout".split(" "),B="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),j="[object Arguments]",F="[object Array]",I="[object Boolean]",q="[object Date]",R="[object Error]",U="[object Function]",z="[object Number]",W="[object Object]",X="[object RegExp]",V="[object String]",$={};$[U]=!1,$[j]=$[F]=$[I]=$[q]=$[z]=$[W]=$[X]=$[V]=!0;var J={leading:!1,maxWait:0,trailing:!1},K={configurable:!1,enumerable:!1,value:null,writable:!1},Q={a:"",b:null,c:"",d:"",e:"",v:null,g:"",h:null,support:null,i:"",j:!1},G={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,"undefined":!1},Y={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},Z=G[typeof window]&&window||this,et=G[typeof exports]&&exports&&!exports.nodeType&&exports,tt=G[typeof module]&&module&&!module.nodeType&&module,nt=tt&&tt.exports===et&&et,rt=G[typeof global]&&global;!rt||rt.global!==rt&&rt.window!==rt||(Z=rt);var it=p();typeof tadpoles.define=="function"&&typeof tadpoles.define.amd=="object"&&tadpoles.define.amd?(Z._=it,tadpoles.define("lodash",[],function(){return it})):et&&tt?nt?(tt.exports=it)._=it:et._=it:Z._=it}.call(this),tadpoles.define("lodash-noconflict",["lodash"],function(e){return e.noConflict()}),function(e,t){typeof module=="object"&&typeof module.exports=="object"?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}(typeof window!="undefined"?window:this,function(e,t){function g(e){var t=e.length,n=h.type(e);return n==="function"||h.isWindow(e)?!1:e.nodeType===1&&t?!0:n==="array"||t===0||typeof t=="number"&&t>0&&t-1 in e}function S(e,t,n){if(h.isFunction(t))return h.grep(e,function(e,r){return!!t.call(e,r,e)!==n});if(t.nodeType)return h.grep(e,function(e){return e===t!==n});if(typeof t=="string"){if(E.test(t))return h.filter(t,e,n);t=h.filter(t,e)}return h.grep(e,function(e){return h.inArray(e,t)>=0!==n})}function A(e,t){do e=e[t];while(e&&e.nodeType!==1);return e}function _(e){var t=M[e]={};return h.each(e.match(O)||[],function(e,n){t[n]=!0}),t}function P(){T.addEventListener?(T.removeEventListener("DOMContentLoaded",H,!1),e.removeEventListener("load",H,!1)):(T.detachEvent("onreadystatechange",H),e.detachEvent("onload",H))}function H(){if(T.addEventListener||event.type==="load"||T.readyState==="complete")P(),h.ready()}function q(e,t,n){if(n===undefined&&e.nodeType===1){var r="data-"+t.replace(I,"-$1").toLowerCase();n=e.getAttribute(r);if(typeof n=="string"){try{n=n==="true"?!0:n==="false"?!1:n==="null"?null:+n+""===n?+n:F.test(n)?h.parseJSON(n):n}catch(i){}h.data(e,t,n)}else n=undefined}return n}function R(e){var t;for(t in e){if(t==="data"&&h.isEmptyObject(e[t]))continue;if(t!=="toJSON")return!1}return!0}function U(e,t,r,i){if(!h.acceptData(e))return;var s,o,u=h.expando,a=e.nodeType,f=a?h.cache:e,l=a?e[u]:e[u]&&u;if((!l||!f[l]||!i&&!f[l].data)&&r===undefined&&typeof t=="string")return;l||(a?l=e[u]=n.pop()||h.guid++:l=u),f[l]||(f[l]=a?{}:{toJSON:h.noop});if(typeof t=="object"||typeof t=="function")i?f[l]=h.extend(f[l],t):f[l].data=h.extend(f[l].data,t);return o=f[l],i||(o.data||(o.data={}),o=o.data),r!==undefined&&(o[h.camelCase(t)]=r),typeof t=="string"?(s=o[t],s==null&&(s=o[h.camelCase(t)])):s=o,s}function z(e,t,n){if(!h.acceptData(e))return;var r,i,s=e.nodeType,o=s?h.cache:e,u=s?e[h.expando]:h.expando;if(!o[u])return;if(t){r=n?o[u]:o[u].data;if(r){h.isArray(t)?t=t.concat(h.map(t,h.camelCase)):t in r?t=[t]:(t=h.camelCase(t),t in r?t=[t]:t=t.split(" ")),i=t.length;while(i--)delete r[t[i]];if(n?!R(r):!h.isEmptyObject(r))return}}if(!n){delete o[u].data;if(!R(o[u]))return}s?h.cleanData([e],!0):l.deleteExpando||o!=o.window?delete o[u]:o[u]=null}function et(){return!0}function tt(){return!1}function nt(){try{return T.activeElement}catch(e){}}function rt(e){var t=it.split("|"),n=e.createDocumentFragment();if(n.createElement)while(t.length)n.createElement(t.pop());return n}function wt(e,t){var n,r,i=0,s=typeof e.getElementsByTagName!==B?e.getElementsByTagName(t||"*"):typeof e.querySelectorAll!==B?e.querySelectorAll(t||"*"):undefined;if(!s)for(s=[],n=e.childNodes||e;(r=n[i])!=null;i++)!t||h.nodeName(r,t)?s.push(r):h.merge(s,wt(r,t));return t===undefined||t&&h.nodeName(e,t)?h.merge([e],s):s}function Et(e){J.test(e.type)&&(e.defaultChecked=e.checked)}function St(e,t){return h.nodeName(e,"table")&&h.nodeName(t.nodeType!==11?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function xt(e){return e.type=(h.find.attr(e,"type")!==null)+"/"+e.type,e}function Tt(e){var t=vt.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function Nt(e,t){var n,r=0;for(;(n=e[r])!=null;r++)h._data(n,"globalEval",!t||h._data(t[r],"globalEval"))}function Ct(e,t){if(t.nodeType!==1||!h.hasData(e))return;var n,r,i,s=h._data(e),o=h._data(t,s),u=s.events;if(u){delete o.handle,o.events={};for(n in u)for(r=0,i=u[n].length;r<i;r++)h.event.add(t,n,u[n][r])}o.data&&(o.data=h.extend({},o.data))}function kt(e,t){var n,r,i;if(t.nodeType!==1)return;n=t.nodeName.toLowerCase();if(!l.noCloneEvent&&t[h.expando]){i=h._data(t);for(r in i.events)h.removeEvent(t,r,i.handle);t.removeAttribute(h.expando)}if(n==="script"&&t.text!==e.text)xt(t).text=e.text,Tt(t);else if(n==="object")t.parentNode&&(t.outerHTML=e.outerHTML),l.html5Clone&&e.innerHTML&&!h.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML);else if(n==="input"&&J.test(e.type))t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value);else if(n==="option")t.defaultSelected=t.selected=e.defaultSelected;else if(n==="input"||n==="textarea")t.defaultValue=e.defaultValue}function Ot(t,n){var r,i=h(n.createElement(t)).appendTo(n.body),s=e.getDefaultComputedStyle&&(r=e.getDefaultComputedStyle(i[0]))?r.display:h.css(i[0],"display");return i.detach(),s}function Mt(e){var t=T,n=At[e];if(!n){n=Ot(e,t);if(n==="none"||!n)Lt=(Lt||h("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement),t=(Lt[0].contentWindow||Lt[0].contentDocument).document,t.write(),t.close(),n=Ot(e,t),Lt.detach();At[e]=n}return n}function jt(e,t){return{get:function(){var n=e();if(n==null)return;if(n){delete this.get;return}return(this.get=t).apply(this,arguments)}}}function Vt(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=Xt.length;while(i--){t=Xt[i]+n;if(t in e)return t}return r}function $t(e,t){var n,r,i,s=[],o=0,u=e.length;for(;o<u;o++){r=e[o];if(!r.style)continue;s[o]=h._data(r,"olddisplay"),n=r.style.display,t?(!s[o]&&n==="none"&&(r.style.display=""),r.style.display===""&&V(r)&&(s[o]=h._data(r,"olddisplay",Mt(r.nodeName)))):(i=V(r),(n&&n!=="none"||!i)&&h._data(r,"olddisplay",i?n:h.css(r,"display")))}for(o=0;o<u;o++){r=e[o];if(!r.style)continue;if(!t||r.style.display==="none"||r.style.display==="")r.style.display=t?s[o]||"":"none"}return e}function Jt(e,t,n){var r=Rt.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function Kt(e,t,n,r,i){var s=n===(r?"border":"content")?4:t==="width"?1:0,o=0;for(;s<4;s+=2)n==="margin"&&(o+=h.css(e,n+X[s],!0,i)),r?(n==="content"&&(o-=h.css(e,"padding"+X[s],!0,i)),n!=="margin"&&(o-=h.css(e,"border"+X[s]+"Width",!0,i))):(o+=h.css(e,"padding"+X[s],!0,i),n!=="padding"&&(o+=h.css(e,"border"+X[s]+"Width",!0,i)));return o}function Qt(e,t,n){var r=!0,i=t==="width"?e.offsetWidth:e.offsetHeight,s=Pt(e),o=l.boxSizing&&h.css(e,"boxSizing",!1,s)==="border-box";if(i<=0||i==null){i=Ht(e,t,s);if(i<0||i==null)i=e.style[t];if(Dt.test(i))return i;r=o&&(l.boxSizingReliable()||i===e.style[t]),i=parseFloat(i)||0}return i+Kt(e,t,n||(o?"border":"content"),r,s)+"px"}function Gt(e,t,n,r,i){return new Gt.prototype.init(e,t,n,r,i)}function on(){return setTimeout(function(){Yt=undefined}),Yt=h.now()}function un(e,t){var n,r={height:e},i=0;t=t?1:0;for(;i<4;i+=2-t)n=X[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function an(e,t,n){var r,i=(sn[t]||[]).concat(sn["*"]),s=0,o=i.length;for(;s<o;s++)if(r=i[s].call(n,t,e))return r}function fn(e,t,n){var r,i,s,o,u,a,f,c,p=this,d={},v=e.style,m=e.nodeType&&V(e),g=h._data(e,"fxshow");n.queue||(u=h._queueHooks(e,"fx"),u.unqueued==null&&(u.unqueued=0,a=u.empty.fire,u.empty.fire=function(){u.unqueued||a()}),u.unqueued++,p.always(function(){p.always(function(){u.unqueued--,h.queue(e,"fx").length||u.empty.fire()})})),e.nodeType===1&&("height"in t||"width"in t)&&(n.overflow=[v.overflow,v.overflowX,v.overflowY],f=h.css(e,"display"),c=f==="none"?h._data(e,"olddisplay")||Mt(e.nodeName):f,c==="inline"&&h.css(e,"float")==="none"&&(!l.inlineBlockNeedsLayout||Mt(e.nodeName)==="inline"?v.display="inline-block":v.zoom=1)),n.overflow&&(v.overflow="hidden",l.shrinkWrapBlocks()||p.always(function(){v.overflow=n.overflow[0],v.overflowX=n.overflow[1],v.overflowY=n.overflow[2]}));for(r in t){i=t[r];if(en.exec(i)){delete t[r],s=s||i==="toggle";if(i===(m?"hide":"show")){if(i!=="show"||!g||g[r]===undefined)continue;m=!0}d[r]=g&&g[r]||h.style(e,r)}else f=undefined}if(!h.isEmptyObject(d)){g?"hidden"in g&&(m=g.hidden):g=h._data(e,"fxshow",{}),s&&(g.hidden=!m),m?h(e).show():p.done(function(){h(e).hide()}),p.done(function(){var t;h._removeData(e,"fxshow");for(t in d)h.style(e,t,d[t])});for(r in d)o=an(m?g[r]:0,r,p),r in g||(g[r]=o.start,m&&(o.end=o.start,o.start=r==="width"||r==="height"?1:0))}else(f==="none"?Mt(e.nodeName):f)==="inline"&&(v.display=f)}function ln(e,t){var n,r,i,s,o;for(n in e){r=h.camelCase(n),i=t[r],s=e[n],h.isArray(s)&&(i=s[1],s=e[n]=s[0]),n!==r&&(e[r]=s,delete e[n]),o=h.cssHooks[r];if(o&&"expand"in o){s=o.expand(s),delete e[r];for(n in s)n in e||(e[n]=s[n],t[n]=i)}else t[r]=i}}function cn(e,t,n){var r,i,s=0,o=rn.length,u=h.Deferred().always(function(){delete a.elem}),a=function(){if(i)return!1;var t=Yt||on(),n=Math.max(0,f.startTime+f.duration-t),r=n/f.duration||0,s=1-r,o=0,a=f.tweens.length;for(;o<a;o++)f.tweens[o].run(s);return u.notifyWith(e,[f,s,n]),s<1&&a?n:(u.resolveWith(e,[f]),!1)},f=u.promise({elem:e,props:h.extend({},t),opts:h.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:Yt||on(),duration:n.duration,tweens:[],createTween:function(t,n){var r=h.Tween(e,f.opts,t,n,f.opts.specialEasing[t]||f.opts.easing);return f.tweens.push(r),r},stop:function(t){var n=0,r=t?f.tweens.length:0;if(i)return this;i=!0;for(;n<r;n++)f.tweens[n].run(1);return t?u.resolveWith(e,[f,t]):u.rejectWith(e,[f,t]),this}}),l=f.props;ln(l,f.opts.specialEasing);for(;s<o;s++){r=rn[s].call(f,e,l,f.opts);if(r)return r}return h.map(l,an,f),h.isFunction(f.opts.start)&&f.opts.start.call(e,f),h.fx.timer(h.extend(a,{elem:e,anim:f,queue:f.opts.queue})),f.progress(f.opts.progress).done(f.opts.done,f.opts.complete).fail(f.opts.fail).always(f.opts.always)}function Fn(e){return function(t,n){typeof t!="string"&&(n=t,t="*");var r,i=0,s=t.toLowerCase().match(O)||[];if(h.isFunction(n))while(r=s[i++])r.charAt(0)==="+"?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function In(e,t,n,r){function o(u){var a;return i[u]=!0,h.each(e[u]||[],function(e,u){var f=u(t,n,r);if(typeof f=="string"&&!s&&!i[f])return t.dataTypes.unshift(f),o(f),!1;if(s)return!(a=f)}),a}var i={},s=e===Hn;return o(t.dataTypes[0])||!i["*"]&&o("*")}function qn(e,t){var n,r,i=h.ajaxSettings.flatOptions||{};for(r in t)t[r]!==undefined&&((i[r]?e:n||(n={}))[r]=t[r]);return n&&h.extend(!0,e,n),e}function Rn(e,t,n){var r,i,s,o,u=e.contents,a=e.dataTypes;while(a[0]==="*")a.shift(),i===undefined&&(i=e.mimeType||t.getResponseHeader("Content-Type"));if(i)for(o in u)if(u[o]&&u[o].test(i)){a.unshift(o);break}if(a[0]in n)s=a[0];else{for(o in n){if(!a[0]||e.converters[o+" "+a[0]]){s=o;break}r||(r=o)}s=s||r}if(s)return s!==a[0]&&a.unshift(s),n[s]}function Un(e,t,n,r){var i,s,o,u,a,f={},l=e.dataTypes.slice();if(l[1])for(o in e.converters)f[o.toLowerCase()]=e.converters[o];s=l.shift();while(s){e.responseFields[s]&&(n[e.responseFields[s]]=t),!a&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),a=s,s=l.shift();if(s)if(s==="*")s=a;else if(a!=="*"&&a!==s){o=f[a+" "+s]||f["* "+s];if(!o)for(i in f){u=i.split(" ");if(u[1]===s){o=f[a+" "+u[0]]||f["* "+u[0]];if(o){o===!0?o=f[i]:f[i]!==!0&&(s=u[0],l.unshift(u[1]));break}}}if(o!==!0)if(o&&e["throws"])t=o(t);else try{t=o(t)}catch(c){return{state:"parsererror",error:o?c:"No conversion from "+a+" to "+s}}}}return{state:"success",data:t}}function Jn(e,t,n,r){var i;if(h.isArray(t))h.each(t,function(t,i){n||Wn.test(e)?r(e,i):Jn(e+"["+(typeof i=="object"?t:"")+"]",i,n,r)});else if(!n&&h.type(t)==="object")for(i in t)Jn(e+"["+i+"]",t[i],n,r);else r(e,t)}function Yn(){try{return new e.XMLHttpRequest}catch(t){}}function Zn(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function ir(e){return h.isWindow(e)?e:e.nodeType===9?e.defaultView||e.parentWindow:!1}var n=[],r=n.slice,i=n.concat,s=n.push,o=n.indexOf,u={},a=u.toString,f=u.hasOwnProperty,l={},c="1.11.1",h=function(e,t){return new h.fn.init(e,t)},p=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,d=/^-ms-/,v=/-([\da-z])/gi,m=function(e,t){return t.toUpperCase()};h.fn=h.prototype={jquery:c,constructor:h,selector:"",length:0,toArray:function(){return r.call(this)},get:function(e){return e!=null?e<0?this[e+this.length]:this[e]:r.call(this)},pushStack:function(e){var t=h.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return h.each(this,e,t)},map:function(e){return this.pushStack(h.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(r.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:s,sort:n.sort,splice:n.splice},h.extend=h.fn.extend=function(){var e,t,n,r,i,s,o=arguments[0]||{},u=1,a=arguments.length,f=!1;typeof o=="boolean"&&(f=o,o=arguments[u]||{},u++),typeof o!="object"&&!h.isFunction(o)&&(o={}),u===a&&(o=this,u--);for(;u<a;u++)if((i=arguments[u])!=null)for(r in i){e=o[r],n=i[r];if(o===n)continue;f&&n&&(h.isPlainObject(n)||(t=h.isArray(n)))?(t?(t=!1,s=e&&h.isArray(e)?e:[]):s=e&&h.isPlainObject(e)?e:{},o[r]=h.extend(f,s,n)):n!==undefined&&(o[r]=n)}return o},h.extend({expando:"jQuery"+(c+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return h.type(e)==="function"},isArray:Array.isArray||function(e){return h.type(e)==="array"},isWindow:function(e){return e!=null&&e==e.window},isNumeric:function(e){return!h.isArray(e)&&e-parseFloat(e)>=0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},isPlainObject:function(e){var t;if(!e||h.type(e)!=="object"||e.nodeType||h.isWindow(e))return!1;try{if(e.constructor&&!f.call(e,"constructor")&&!f.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(n){return!1}if(l.ownLast)for(t in e)return f.call(e,t);for(t in e);return t===undefined||f.call(e,t)},type:function(e){return e==null?e+"":typeof e=="object"||typeof e=="function"?u[a.call(e)]||"object":typeof e},globalEval:function(t){t&&h.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(d,"ms-").replace(v,m)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,i=0,s=e.length,o=g(e);if(n)if(o)for(;i<s;i++){r=t.apply(e[i],n);if(r===!1)break}else for(i in e){r=t.apply(e[i],n);if(r===!1)break}else if(o)for(;i<s;i++){r=t.call(e[i],i,e[i]);if(r===!1)break}else for(i in e){r=t.call(e[i],i,e[i]);if(r===!1)break}return e},trim:function(e){return e==null?"":(e+"").replace(p,"")},makeArray:function(e,t){var n=t||[];return e!=null&&(g(Object(e))?h.merge(n,typeof e=="string"?[e]:e):s.call(n,e)),n},inArray:function(e,t,n){var r;if(t){if(o)return o.call(t,e,n);r=t.length,n=n?n<0?Math.max(0,r+n):n:0;for(;n<r;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,t){var n=+t.length,r=0,i=e.length;while(r<n)e[i++]=t[r++];if(n!==n)while(t[r]!==undefined)e[i++]=t[r++];return e.length=i,e},grep:function(e,t,n){var r,i=[],s=0,o=e.length,u=!n;for(;s<o;s++)r=!t(e[s],s),r!==u&&i.push(e[s]);return i},map:function(e,t,n){var r,s=0,o=e.length,u=g(e),a=[];if(u)for(;s<o;s++)r=t(e[s],s,n),r!=null&&a.push(r);else for(s in e)r=t(e[s],s,n),r!=null&&a.push(r);return i.apply([],a)},guid:1,proxy:function(e,t){var n,i,s;return typeof t=="string"&&(s=e[t],t=e,e=s),h.isFunction(e)?(n=r.call(arguments,2),i=function(){return e.apply(t||this,n.concat(r.call(arguments)))},i.guid=e.guid=e.guid||h.guid++,i):undefined},now:function(){return+(new Date)},support:l}),h.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){u["[object "+t+"]"]=t.toLowerCase()});var y=function(e){function st(e,t,r,i){var s,u,f,l,c,d,g,y,S,x;(t?t.ownerDocument||t:E)!==p&&h(t),t=t||p,r=r||[];if(!e||typeof e!="string")return r;if((l=t.nodeType)!==1&&l!==9)return[];if(v&&!i){if(s=Z.exec(e))if(f=s[1]){if(l===9){u=t.getElementById(f);if(!u||!u.parentNode)return r;if(u.id===f)return r.push(u),r}else if(t.ownerDocument&&(u=t.ownerDocument.getElementById(f))&&b(t,u)&&u.id===f)return r.push(u),r}else{if(s[2])return P.apply(r,t.getElementsByTagName(e)),r;if((f=s[3])&&n.getElementsByClassName&&t.getElementsByClassName)return P.apply(r,t.getElementsByClassName(f)),r}if(n.qsa&&(!m||!m.test(e))){y=g=w,S=t,x=l===9&&e;if(l===1&&t.nodeName.toLowerCase()!=="object"){d=o(e),(g=t.getAttribute("id"))?y=g.replace(tt,"\\$&"):t.setAttribute("id",y),y="[id='"+y+"'] ",c=d.length;while(c--)d[c]=y+mt(d[c]);S=et.test(e)&&dt(t.parentNode)||t,x=d.join(",")}if(x)try{return P.apply(r,S.querySelectorAll(x)),r}catch(T){}finally{g||t.removeAttribute("id")}}}return a(e.replace(z,"$1"),t,r,i)}function ot(){function t(n,i){return e.push(n+" ")>r.cacheLength&&delete t[e.shift()],t[n+" "]=i}var e=[];return t}function ut(e){return e[w]=!0,e}function at(e){var t=p.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function ft(e,t){var n=e.split("|"),i=e.length;while(i--)r.attrHandle[n[i]]=t}function lt(e,t){var n=t&&e,r=n&&e.nodeType===1&&t.nodeType===1&&(~t.sourceIndex||A)-(~e.sourceIndex||A);if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function ct(e){return function(t){var n=t.nodeName.toLowerCase();return n==="input"&&t.type===e}}function ht(e){return function(t){var n=t.nodeName.toLowerCase();return(n==="input"||n==="button")&&t.type===e}}function pt(e){return ut(function(t){return t=+t,ut(function(n,r){var i,s=e([],n.length,t),o=s.length;while(o--)n[i=s[o]]&&(n[i]=!(r[i]=n[i]))})})}function dt(e){return e&&typeof e.getElementsByTagName!==L&&e}function vt(){}function mt(e){var t=0,n=e.length,r="";for(;t<n;t++)r+=e[t].value;return r}function gt(e,t,n){var r=t.dir,i=n&&r==="parentNode",s=x++;return t.first?function(t,n,s){while(t=t[r])if(t.nodeType===1||i)return e(t,n,s)}:function(t,n,o){var u,a,f=[S,s];if(o){while(t=t[r])if(t.nodeType===1||i)if(e(t,n,o))return!0}else while(t=t[r])if(t.nodeType===1||i){a=t[w]||(t[w]={});if((u=a[r])&&u[0]===S&&u[1]===s)return f[2]=u[2];a[r]=f;if(f[2]=e(t,n,o))return!0}}}function yt(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function bt(e,t,n){var r=0,i=t.length;for(;r<i;r++)st(e,t[r],n);return n}function wt(e,t,n,r,i){var s,o=[],u=0,a=e.length,f=t!=null;for(;u<a;u++)if(s=e[u])if(!n||n(s,r,i))o.push(s),f&&t.push(u);return o}function Et(e,t,n,r,i,s){return r&&!r[w]&&(r=Et(r)),i&&!i[w]&&(i=Et(i,s)),ut(function(s,o,u,a){var f,l,c,h=[],p=[],d=o.length,v=s||bt(t||"*",u.nodeType?[u]:u,[]),m=e&&(s||!t)?wt(v,h,e,u,a):v,g=n?i||(s?e:d||r)?[]:o:m;n&&n(m,g,u,a);if(r){f=wt(g,p),r(f,[],u,a),l=f.length;while(l--)if(c=f[l])g[p[l]]=!(m[p[l]]=c)}if(s){if(i||e){if(i){f=[],l=g.length;while(l--)(c=g[l])&&f.push(m[l]=c);i(null,g=[],f,a)}l=g.length;while(l--)(c=g[l])&&(f=i?B.call(s,c):h[l])>-1&&(s[f]=!(o[f]=c))}}else g=wt(g===o?g.splice(d,g.length):g),i?i(null,o,g,a):P.apply(o,g)})}function St(e){var t,n,i,s=e.length,o=r.relative[e[0].type],u=o||r.relative[" "],a=o?1:0,l=gt(function(e){return e===t},u,!0),c=gt(function(e){return B.call(t,e)>-1},u,!0),h=[function(e,n,r){return!o&&(r||n!==f)||((t=n).nodeType?l(e,n,r):c(e,n,r))}];for(;a<s;a++)if(n=r.relative[e[a].type])h=[gt(yt(h),n)];else{n=r.filter[e[a].type].apply(null,e[a].matches);if(n[w]){i=++a;for(;i<s;i++)if(r.relative[e[i].type])break;return Et(a>1&&yt(h),a>1&&mt(e.slice(0,a-1).concat({value:e[a-2].type===" "?"*":""})).replace(z,"$1"),n,a<i&&St(e.slice(a,i)),i<s&&St(e=e.slice(i)),i<s&&mt(e))}h.push(n)}return yt(h)}function xt(e,t){var n=t.length>0,i=e.length>0,s=function(s,o,u,a,l){var c,h,d,v=0,m="0",g=s&&[],y=[],b=f,w=s||i&&r.find.TAG("*",l),E=S+=b==null?1:Math.random()||.1,x=w.length;l&&(f=o!==p&&o);for(;m!==x&&(c=w[m])!=null;m++){if(i&&c){h=0;while(d=e[h++])if(d(c,o,u)){a.push(c);break}l&&(S=E)}n&&((c=!d&&c)&&v--,s&&g.push(c))}v+=m;if(n&&m!==v){h=0;while(d=t[h++])d(g,y,o,u);if(s){if(v>0)while(m--)!g[m]&&!y[m]&&(y[m]=_.call(a));y=wt(y)}P.apply(a,y),l&&!s&&y.length>0&&v+t.length>1&&st.uniqueSort(a)}return l&&(S=E,f=b),g};return n?ut(s):s}var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w="sizzle"+ -(new Date),E=e.document,S=0,x=0,T=ot(),N=ot(),C=ot(),k=function(e,t){return e===t&&(c=!0),0},L=typeof undefined,A=1<<31,O={}.hasOwnProperty,M=[],_=M.pop,D=M.push,P=M.push,H=M.slice,B=M.indexOf||function(e){var t=0,n=this.length;for(;t<n;t++)if(this[t]===e)return t;return-1},j="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",F="[\\x20\\t\\r\\n\\f]",I="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",q=I.replace("w","w#"),R="\\["+F+"*("+I+")(?:"+F+"*([*^$|!~]?=)"+F+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+q+"))|)"+F+"*\\]",U=":("+I+")(?:\\(("+"('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|"+"((?:\\\\.|[^\\\\()[\\]]|"+R+")*)|"+".*"+")\\)|)",z=new RegExp("^"+F+"+|((?:^|[^\\\\])(?:\\\\.)*)"+F+"+$","g"),W=new RegExp("^"+F+"*,"+F+"*"),X=new RegExp("^"+F+"*([>+~]|"+F+")"+F+"*"),V=new RegExp("="+F+"*([^\\]'\"]*?)"+F+"*\\]","g"),$=new RegExp(U),J=new RegExp("^"+q+"$"),K={ID:new RegExp("^#("+I+")"),CLASS:new RegExp("^\\.("+I+")"),TAG:new RegExp("^("+I.replace("w","w*")+")"),ATTR:new RegExp("^"+R),PSEUDO:new RegExp("^"+U),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+F+"*(even|odd|(([+-]|)(\\d*)n|)"+F+"*(?:([+-]|)"+F+"*(\\d+)|))"+F+"*\\)|)","i"),bool:new RegExp("^(?:"+j+")$","i"),needsContext:new RegExp("^"+F+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+F+"*((?:-\\d)?\\d*)"+F+"*\\)|)(?=[^-]|$)","i")},Q=/^(?:input|select|textarea|button)$/i,G=/^h\d$/i,Y=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,et=/[+~]/,tt=/'|\\/g,nt=new RegExp("\\\\([\\da-f]{1,6}"+F+"?|("+F+")|.)","ig"),rt=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:r<0?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,r&1023|56320)};try{P.apply(M=H.call(E.childNodes),E.childNodes),M[E.childNodes.length].nodeType}catch(it){P={apply:M.length?function(e,t){D.apply(e,H.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}n=st.support={},s=st.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?t.nodeName!=="HTML":!1},h=st.setDocument=function(e){var t,i=e?e.ownerDocument||e:E,o=i.defaultView;if(i===p||i.nodeType!==9||!i.documentElement)return p;p=i,d=i.documentElement,v=!s(i),o&&o!==o.top&&(o.addEventListener?o.addEventListener("unload",function(){h()},!1):o.attachEvent&&o.attachEvent("onunload",function(){h()})),n.attributes=at(function(e){return e.className="i",!e.getAttribute("className")}),n.getElementsByTagName=at(function(e){return e.appendChild(i.createComment("")),!e.getElementsByTagName("*").length}),n.getElementsByClassName=Y.test(i.getElementsByClassName)&&at(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",e.getElementsByClassName("i").length===2}),n.getById=at(function(e){return d.appendChild(e).id=w,!i.getElementsByName||!i.getElementsByName(w).length}),n.getById?(r.find.ID=function(e,t){if(typeof t.getElementById!==L&&v){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},r.filter.ID=function(e){var t=e.replace(nt,rt);return function(e){return e.getAttribute("id")===t}}):(delete r.find.ID,r.filter.ID=function(e){var t=e.replace(nt,rt);return function(e){var n=typeof e.getAttributeNode!==L&&e.getAttributeNode("id");return n&&n.value===t}}),r.find.TAG=n.getElementsByTagName?function(e,t){if(typeof t.getElementsByTagName!==L)return t.getElementsByTagName(e)}:function(e,t){var n,r=[],i=0,s=t.getElementsByTagName(e);if(e==="*"){while(n=s[i++])n.nodeType===1&&r.push(n);return r}return s},r.find.CLASS=n.getElementsByClassName&&function(e,t){if(typeof t.getElementsByClassName!==L&&v)return t.getElementsByClassName(e)},g=[],m=[];if(n.qsa=Y.test(i.querySelectorAll))at(function(e){e.innerHTML="<select msallowclip=''><option selected=''></option></select>",e.querySelectorAll("[msallowclip^='']").length&&m.push("[*^$]="+F+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||m.push("\\["+F+"*(?:value|"+j+")"),e.querySelectorAll(":checked").length||m.push(":checked")}),at(function(e){var t=i.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&m.push("name"+F+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||m.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),m.push(",.*:")});return(n.matchesSelector=Y.test(y=d.matches||d.webkitMatchesSelector||d.mozMatchesSelector||d.oMatchesSelector||d.msMatchesSelector))&&at(function(e){n.disconnectedMatch=y.call(e,"div"),y.call(e,"[s!='']:x"),g.push("!=",U)}),m=m.length&&new RegExp(m.join("|")),g=g.length&&new RegExp(g.join("|")),t=Y.test(d.compareDocumentPosition),b=t||Y.test(d.contains)?function(e,t){var n=e.nodeType===9?e.documentElement:e,r=t&&t.parentNode;return e===r||!!r&&r.nodeType===1&&!!(n.contains?n.contains(r):e.compareDocumentPosition&&e.compareDocumentPosition(r)&16)}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},k=t?function(e,t){if(e===t)return c=!0,0;var r=!e.compareDocumentPosition-!t.compareDocumentPosition;return r?r:(r=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,r&1||!n.sortDetached&&t.compareDocumentPosition(e)===r?e===i||e.ownerDocument===E&&b(E,e)?-1:t===i||t.ownerDocument===E&&b(E,t)?1:l?B.call(l,e)-B.call(l,t):0:r&4?-1:1)}:function(e,t){if(e===t)return c=!0,0;var n,r=0,s=e.parentNode,o=t.parentNode,u=[e],a=[t];if(!s||!o)return e===i?-1:t===i?1:s?-1:o?1:l?B.call(l,e)-B.call(l,t):0;if(s===o)return lt(e,t);n=e;while(n=n.parentNode)u.unshift(n);n=t;while(n=n.parentNode)a.unshift(n);while(u[r]===a[r])r++;return r?lt(u[r],a[r]):u[r]===E?-1:a[r]===E?1:0},i},st.matches=function(e,t){return st(e,null,null,t)},st.matchesSelector=function(e,t){(e.ownerDocument||e)!==p&&h(e),t=t.replace(V,"='$1']");if(n.matchesSelector&&v&&(!g||!g.test(t))&&(!m||!m.test(t)))try{var r=y.call(e,t);if(r||n.disconnectedMatch||e.document&&e.document.nodeType!==11)return r}catch(i){}return st(t,p,null,[e]).length>0},st.contains=function(e,t){return(e.ownerDocument||e)!==p&&h(e),b(e,t)},st.attr=function(e,t){(e.ownerDocument||e)!==p&&h(e);var i=r.attrHandle[t.toLowerCase()],s=i&&O.call(r.attrHandle,t.toLowerCase())?i(e,t,!v):undefined;return s!==undefined?s:n.attributes||!v?e.getAttribute(t):(s=e.getAttributeNode(t))&&s.specified?s.value:null},st.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},st.uniqueSort=function(e){var t,r=[],i=0,s=0;c=!n.detectDuplicates,l=!n.sortStable&&e.slice(0),e.sort(k);if(c){while(t=e[s++])t===e[s]&&(i=r.push(s));while(i--)e.splice(r[i],1)}return l=null,e},i=st.getText=function(e){var t,n="",r=0,s=e.nodeType;if(!s)while(t=e[r++])n+=i(t);else if(s===1||s===9||s===11){if(typeof e.textContent=="string")return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=i(e)}else if(s===3||s===4)return e.nodeValue;return n},r=st.selectors={cacheLength:50,createPseudo:ut,match:K,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(nt,rt),e[3]=(e[3]||e[4]||e[5]||"").replace(nt,rt),e[2]==="~="&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),e[1].slice(0,3)==="nth"?(e[3]||st.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*(e[3]==="even"||e[3]==="odd")),e[5]=+(e[7]+e[8]||e[3]==="odd")):e[3]&&st.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return K.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&$.test(n)&&(t=o(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(nt,rt).toLowerCase();return e==="*"?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=T[e+" "];return t||(t=new RegExp("(^|"+F+")"+e+"("+F+"|$)"))&&T(e,function(e){return t.test(typeof e.className=="string"&&e.className||typeof e.getAttribute!==L&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=st.attr(r,e);return i==null?t==="!=":t?(i+="",t==="="?i===n:t==="!="?i!==n:t==="^="?n&&i.indexOf(n)===0:t==="*="?n&&i.indexOf(n)>-1:t==="$="?n&&i.slice(-n.length)===n:t==="~="?(" "+i+" ").indexOf(n)>-1:t==="|="?i===n||i.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r,i){var s=e.slice(0,3)!=="nth",o=e.slice(-4)!=="last",u=t==="of-type";return r===1&&i===0?function(e){return!!e.parentNode}:function(t,n,a){var f,l,c,h,p,d,v=s!==o?"nextSibling":"previousSibling",m=t.parentNode,g=u&&t.nodeName.toLowerCase(),y=!a&&!u;if(m){if(s){while(v){c=t;while(c=c[v])if(u?c.nodeName.toLowerCase()===g:c.nodeType===1)return!1;d=v=e==="only"&&!d&&"nextSibling"}return!0}d=[o?m.firstChild:m.lastChild];if(o&&y){l=m[w]||(m[w]={}),f=l[e]||[],p=f[0]===S&&f[1],h=f[0]===S&&f[2],c=p&&m.childNodes[p];while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if(c.nodeType===1&&++h&&c===t){l[e]=[S,p,h];break}}else if(y&&(f=(t[w]||(t[w]={}))[e])&&f[0]===S)h=f[1];else while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if((u?c.nodeName.toLowerCase()===g:c.nodeType===1)&&++h){y&&((c[w]||(c[w]={}))[e]=[S,h]);if(c===t)break}return h-=i,h===r||h%r===0&&h/r>=0}}},PSEUDO:function(e,t){var n,i=r.pseudos[e]||r.setFilters[e.toLowerCase()]||st.error("unsupported pseudo: "+e);return i[w]?i(t):i.length>1?(n=[e,e,"",t],r.setFilters.hasOwnProperty(e.toLowerCase())?ut(function(e,n){var r,s=i(e,t),o=s.length;while(o--)r=B.call(e,s[o]),e[r]=!(n[r]=s[o])}):function(e){return i(e,0,n)}):i}},pseudos:{not:ut(function(e){var t=[],n=[],r=u(e.replace(z,"$1"));return r[w]?ut(function(e,t,n,i){var s,o=r(e,null,i,[]),u=e.length;while(u--)if(s=o[u])e[u]=!(t[u]=s)}):function(e,i,s){return t[0]=e,r(t,null,s,n),!n.pop()}}),has:ut(function(e){return function(t){return st(e,t).length>0}}),contains:ut(function(e){return function(t){return(t.textContent||t.innerText||i(t)).indexOf(e)>-1}}),lang:ut(function(e){return J.test(e||"")||st.error("unsupported lang: "+e),e=e.replace(nt,rt).toLowerCase(),function(t){var n;do if(n=v?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||n.indexOf(e+"-")===0;while((t=t.parentNode)&&t.nodeType===1);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===d},focus:function(e){return e===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&!!e.checked||t==="option"&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!r.pseudos.empty(e)},header:function(e){return G.test(e.nodeName)},input:function(e){return Q.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&e.type==="button"||t==="button"},text:function(e){var t;return e.nodeName.toLowerCase()==="input"&&e.type==="text"&&((t=e.getAttribute("type"))==null||t.toLowerCase()==="text")},first:pt(function(){return[0]}),last:pt(function(e,t){return[t-1]}),eq:pt(function(e,t,n){return[n<0?n+t:n]}),even:pt(function(e,t){var n=0;for(;n<t;n+=2)e.push(n);return e}),odd:pt(function(e,t){var n=1;for(;n<t;n+=2)e.push(n);return e}),lt:pt(function(e,t,n){var r=n<0?n+t:n;for(;--r>=0;)e.push(r);return e}),gt:pt(function(e,t,n){var r=n<0?n+t:n;for(;++r<t;)e.push(r);return e})}},r.pseudos.nth=r.pseudos.eq;for(t in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})r.pseudos[t]=ct(t);for(t in{submit:!0,reset:!0})r.pseudos[t]=ht(t);return vt.prototype=r.filters=r.pseudos,r.setFilters=new vt,o=st.tokenize=function(e,t){var n,i,s,o,u,a,f,l=N[e+" "];if(l)return t?0:l.slice(0);u=e,a=[],f=r.preFilter;while(u){if(!n||(i=W.exec(u)))i&&(u=u.slice(i[0].length)||u),a.push(s=[]);n=!1;if(i=X.exec(u))n=i.shift(),s.push({value:n,type:i[0].replace(z," ")}),u=u.slice(n.length);for(o in r.filter)(i=K[o].exec(u))&&(!f[o]||(i=f[o](i)))&&(n=i.shift(),s.push({value:n,type:o,matches:i}),u=u.slice(n.length));if(!n)break}return t?u.length:u?st.error(e):N(e,a).slice(0)},u=st.compile=function(e,t){var n,r=[],i=[],s=C[e+" "];if(!s){t||(t=o(e)),n=t.length;while(n--)s=St(t[n]),s[w]?r.push(s):i.push(s);s=C(e,xt(i,r)),s.selector=e}return s},a=st.select=function(e,t,i,s){var a,f,l,c,h,p=typeof e=="function"&&e,d=!s&&o(e=p.selector||e);i=i||[];if(d.length===1){f=d[0]=d[0].slice(0);if(f.length>2&&(l=f[0]).type==="ID"&&n.getById&&t.nodeType===9&&v&&r.relative[f[1].type]){t=(r.find.ID(l.matches[0].replace(nt,rt),t)||[])[0];if(!t)return i;p&&(t=t.parentNode),e=e.slice(f.shift().value.length)}a=K.needsContext.test(e)?0:f.length;while(a--){l=f[a];if(r.relative[c=l.type])break;if(h=r.find[c])if(s=h(l.matches[0].replace(nt,rt),et.test(f[0].type)&&dt(t.parentNode)||t)){f.splice(a,1),e=s.length&&mt(f);if(!e)return P.apply(i,s),i;break}}}return(p||u(e,d))(s,t,!v,i,et.test(e)&&dt(t.parentNode)||t),i},n.sortStable=w.split("").sort(k).join("")===w,n.detectDuplicates=!!c,h(),n.sortDetached=at(function(e){return e.compareDocumentPosition(p.createElement("div"))&1}),at(function(e){return e.innerHTML="<a href='#'></a>",e.firstChild.getAttribute("href")==="#"})||ft("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,t.toLowerCase()==="type"?1:2)}),(!n.attributes||!at(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),e.firstChild.getAttribute("value")===""}))&&ft("value",function(e,t,n){if(!n&&e.nodeName.toLowerCase()==="input")return e.defaultValue}),at(function(e){return e.getAttribute("disabled")==null})||ft(j,function(e,t,n){var r;if(!n)return e[t]===!0?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null}),st}(e);h.find=y,h.expr=y.selectors,h.expr[":"]=h.expr.pseudos,h.unique=y.uniqueSort,h.text=y.getText,h.isXMLDoc=y.isXML,h.contains=y.contains;var b=h.expr.match.needsContext,w=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,E=/^.[^:#\[\.,]*$/;h.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),t.length===1&&r.nodeType===1?h.find.matchesSelector(r,e)?[r]:[]:h.find.matches(e,h.grep(t,function(e){return e.nodeType===1}))},h.fn.extend({find:function(e){var t,n=[],r=this,i=r.length;if(typeof e!="string")return this.pushStack(h(e).filter(function(){for(t=0;t<i;t++)if(h.contains(r[t],this))return!0}));for(t=0;t<i;t++)h.find(e,r[t],n);return n=this.pushStack(i>1?h.unique(n):n),n.selector=this.selector?this.selector+" "+e:e,n},filter:function(e){return this.pushStack(S(this,e||[],!1))},not:function(e){return this.pushStack(S(this,e||[],!0))},is:function(e){return!!S(this,typeof e=="string"&&b.test(e)?h(e):e||[],!1).length}});var x,T=e.document,N=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,C=h.fn.init=function(e,t){var n,r;if(!e)return this;if(typeof e=="string"){e.charAt(0)==="<"&&e.charAt(e.length-1)===">"&&e.length>=3?n=[null,e,null]:n=N.exec(e);if(n&&(n[1]||!t)){if(n[1]){t=t instanceof h?t[0]:t,h.merge(this,h.parseHTML(n[1],t&&t.nodeType?t.ownerDocument||t:T,!0));if(w.test(n[1])&&h.isPlainObject(t))for(n in t)h.isFunction(this[n])?this[n](t[n]):this.attr(n,t[n]);return this}r=T.getElementById(n[2]);if(r&&r.parentNode){if(r.id!==n[2])return x.find(e);this.length=1,this[0]=r}return this.context=T,this.selector=e,this}return!t||t.jquery?(t||x).find(e):this.constructor(t).find(e)}return e.nodeType?(this.context=this[0]=e,this.length=1,this):h.isFunction(e)?typeof x.ready!="undefined"?x.ready(e):e(h):(e.selector!==undefined&&(this.selector=e.selector,this.context=e.context),h.makeArray(e,this))};C.prototype=h.fn,x=h(T);var k=/^(?:parents|prev(?:Until|All))/,L={children:!0,contents:!0,next:!0,prev:!0};h.extend({dir:function(e,t,n){var r=[],i=e[t];while(i&&i.nodeType!==9&&(n===undefined||i.nodeType!==1||!h(i).is(n)))i.nodeType===1&&r.push(i),i=i[t];return r},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)e.nodeType===1&&e!==t&&n.push(e);return n}}),h.fn.extend({has:function(e){var t,n=h(e,this),r=n.length;return this.filter(function(){for(t=0;t<r;t++)if(h.contains(this,n[t]))return!0})},closest:function(e,t){var n,r=0,i=this.length,s=[],o=b.test(e)||typeof e!="string"?h(e,t||this.context):0;for(;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(o?o.index(n)>-1:n.nodeType===1&&h.find.matchesSelector(n,e))){s.push(n);break}return this.pushStack(s.length>1?h.unique(s):s)},index:function(e){return e?typeof e=="string"?h.inArray(this[0],h(e)):h.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(h.unique(h.merge(this.get(),h(e,t))))},addBack:function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}}),h.each({parent:function(e){var t=e.parentNode;return t&&t.nodeType!==11?t:null},parents:function(e){return h.dir(e,"parentNode")},parentsUntil:function(e,t,n){return h.dir(e,"parentNode",n)},next:function(e){return A(e,"nextSibling")},prev:function(e){return A(e,"previousSibling")},nextAll:function(e){return h.dir(e,"nextSibling")},prevAll:function(e){return h.dir(e,"previousSibling")},nextUntil:function(e,t,n){return h.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return h.dir(e,"previousSibling",n)},siblings:function(e){return h.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return h.sibling(e.firstChild)},contents:function(e){return h.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:h.merge([],e.childNodes)}},function(e,t){h.fn[e]=function(n,r){var i=h.map(this,t,n);return e.slice(-5)!=="Until"&&(r=n),r&&typeof r=="string"&&(i=h.filter(r,i)),this.length>1&&(L[e]||(i=h.unique(i)),k.test(e)&&(i=i.reverse())),this.pushStack(i)}});var O=/\S+/g,M={};h.Callbacks=function(e){e=typeof e=="string"?M[e]||_(e):h.extend({},e);var t,n,r,i,s,o,u=[],a=!e.once&&[],f=function(c){n=e.memory&&c,r=!0,s=o||0,o=0,i=u.length,t=!0;for(;u&&s<i;s++)if(u[s].apply(c[0],c[1])===!1&&e.stopOnFalse){n=!1;break}t=!1,u&&(a?a.length&&f(a.shift()):n?u=[]:l.disable())},l={add:function(){if(u){var r=u.length;(function s(t){h.each(t,function(t,n){var r=h.type(n);r==="function"?(!e.unique||!l.has(n))&&u.push(n):n&&n.length&&r!=="string"&&s(n)})})(arguments),t?i=u.length:n&&(o=r,f(n))}return this},remove:function(){return u&&h.each(arguments,function(e,n){var r;while((r=h.inArray(n,u,r))>-1)u.splice(r,1),t&&(r<=i&&i--,r<=s&&s--)}),this},has:function(e){return e?h.inArray(e,u)>-1:!!u&&!!u.length},empty:function(){return u=[],i=0,this},disable:function(){return u=a=n=undefined,this},disabled:function(){return!u},lock:function(){return a=undefined,n||l.disable(),this},locked:function(){return!a},fireWith:function(e,n){return u&&(!r||a)&&(n=n||[],n=[e,n.slice?n.slice():n],t?a.push(n):f(n)),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!r}};return l},h.extend({Deferred:function(e){var t=[["resolve","done",h.Callbacks("once memory"),"resolved"],["reject","fail",h.Callbacks("once memory"),"rejected"],["notify","progress",h.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return h.Deferred(function(n){h.each(t,function(t,s){var o=h.isFunction(e[t])&&e[t];i[s[1]](function(){var e=o&&o.apply(this,arguments);e&&h.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[s[0]+"With"](this===r?n.promise():this,o?[e]:arguments)})}),e=null}).promise()},promise:function(e){return e!=null?h.extend(e,r):r}},i={};return r.pipe=r.then,h.each(t,function(e,s){var o=s[2],u=s[3];r[s[1]]=o.add,u&&o.add(function(){n=u},t[e^1][2].disable,t[2][2].lock),i[s[0]]=function(){return i[s[0]+"With"](this===i?r:this,arguments),this},i[s[0]+"With"]=o.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=r.call(arguments),i=n.length,s=i!==1||e&&h.isFunction(e.promise)?i:0,o=s===1?e:h.Deferred(),u=function(e,t,n){return function(i){t[e]=this,n[e]=arguments.length>1?r.call(arguments):i,n===a?o.notifyWith(t,n):--s||o.resolveWith(t,n)}},a,f,l;if(i>1){a=new Array(i),f=new Array(i),l=new Array(i);for(;t<i;t++)n[t]&&h.isFunction(n[t].promise)?n[t].promise().done(u(t,l,n)).fail(o.reject).progress(u(t,f,a)):--s}return s||o.resolveWith(l,n),o.promise()}});var D;h.fn.ready=function(e){return h.ready.promise().done(e),this},h.extend({isReady:!1,readyWait:1,holdReady:function(e){e?h.readyWait++:h.ready(!0)},ready:function(e){if(e===!0?--h.readyWait:h.isReady)return;if(!T.body)return setTimeout(h.ready);h.isReady=!0;if(e!==!0&&--h.readyWait>0)return;D.resolveWith(T,[h]),h.fn.triggerHandler&&(h(T).triggerHandler("ready"),h(T).off("ready"))}}),h.ready.promise=function(t){if(!D){D=h.Deferred();if(T.readyState==="complete")setTimeout(h.ready);else if(T.addEventListener)T.addEventListener("DOMContentLoaded",H,!1),e.addEventListener("load",H,!1);else{T.attachEvent("onreadystatechange",H),e.attachEvent("onload",H);var n=!1;try{n=e.frameElement==null&&T.documentElement}catch(r){}n&&n.doScroll&&function i(){if(!h.isReady){try{n.doScroll("left")}catch(e){return setTimeout(i,50)}P(),h.ready()}}()}}return D.promise(t)};var B=typeof undefined,j;for(j in h(l))break;l.ownLast=j!=="0",l.inlineBlockNeedsLayout=!1,h(function(){var e,t,n,r;n=T.getElementsByTagName("body")[0];if(!n||!n.style)return;t=T.createElement("div"),r=T.createElement("div"),r.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",n.appendChild(r).appendChild(t),typeof t.style.zoom!==B&&(t.style.cssText="display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1",l.inlineBlockNeedsLayout=e=t.offsetWidth===3,e&&(n.style.zoom=1)),n.removeChild(r)}),function(){var e=T.createElement("div");if(l.deleteExpando==null){l.deleteExpando=!0;try{delete e.test}catch(t){l.deleteExpando=!1}}e=null}(),h.acceptData=function(e){var t=h.noData[(e.nodeName+" ").toLowerCase()],n=+e.nodeType||1;return n!==1&&n!==9?!1:!t||t!==!0&&e.getAttribute("classid")===t};var F=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,I=/([A-Z])/g;h.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){return e=e.nodeType?h.cache[e[h.expando]]:e[h.expando],!!e&&!R(e)},data:function(e,t,n){return U(e,t,n)},removeData:function(e,t){return z(e,t)},_data:function(e,t,n){return U(e,t,n,!0)},_removeData:function(e,t){return z(e,t,!0)}}),h.fn.extend({data:function(e,t){var n,r,i,s=this[0],o=s&&s.attributes;if(e===undefined){if(this.length){i=h.data(s);if(s.nodeType===1&&!h._data(s,"parsedAttrs")){n=o.length;while(n--)o[n]&&(r=o[n].name,r.indexOf("data-")===0&&(r=h.camelCase(r.slice(5)),q(s,r,i[r])));h._data(s,"parsedAttrs",!0)}}return i}return typeof e=="object"?this.each(function(){h.data(this,e)}):arguments.length>1?this.each(function(){h.data(this,e,t)}):s?q(s,e,h.data(s,e)):undefined},removeData:function(e){return this.each(function(){h.removeData(this,e)})}}),h.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=h._data(e,t),n&&(!r||h.isArray(n)?r=h._data(e,t,h.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=h.queue(e,t),r=n.length,i=n.shift(),s=h._queueHooks(e,t),o=function(){h.dequeue(e,t)};i==="inprogress"&&(i=n.shift(),r--),i&&(t==="fx"&&n.unshift("inprogress"),delete s.stop,i.call(e,o,s)),!r&&s&&s.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return h._data(e,n)||h._data(e,n,{empty:h.Callbacks("once memory").add(function(){h._removeData(e,t+"queue"),h._removeData(e,n)})})}}),h.fn.extend({queue:function(e,t){var n=2;return typeof e!="string"&&(t=e,e="fx",n--),arguments.length<n?h.queue(this[0],e):t===undefined?this:this.each(function(){var n=h.queue(this,e,t);h._queueHooks(this,e),e==="fx"&&n[0]!=="inprogress"&&h.dequeue(this,e)})},dequeue:function(e){return this.each(function(){h.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=h.Deferred(),s=this,o=this.length,u=function(){--r||i.resolveWith(s,[s])};typeof e!="string"&&(t=e,e=undefined),e=e||"fx";while(o--)n=h._data(s[o],e+"queueHooks"),n&&n.empty&&(r++,n.empty.add(u));return u(),i.promise(t)}});var W=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,X=["Top","Right","Bottom","Left"],V=function(e,t){return e=t||e,h.css(e,"display")==="none"||!h.contains(e.ownerDocument,e)},$=h.access=function(e,t,n,r,i,s,o){var u=0,a=e.length,f=n==null;if(h.type(n)==="object"){i=!0;for(u in n)h.access(e,t,u,n[u],!0,s,o)}else if(r!==undefined){i=!0,h.isFunction(r)||(o=!0),f&&(o?(t.call(e,r),t=null):(f=t,t=function(e,t,n){return f.call(h(e),n)}));if(t)for(;u<a;u++)t(e[u],n,o?r:r.call(e[u],u,t(e[u],n)))}return i?e:f?t.call(e):a?t(e[0],n):s},J=/^(?:checkbox|radio)$/i;(function(){var e=T.createElement("input"),t=T.createElement("div"),n=T.createDocumentFragment();t.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",l.leadingWhitespace=t.firstChild.nodeType===3,l.tbody=!t.getElementsByTagName("tbody").length,l.htmlSerialize=!!t.getElementsByTagName("link").length,l.html5Clone=T.createElement("nav").cloneNode(!0).outerHTML!=="<:nav></:nav>",e.type="checkbox",e.checked=!0,n.appendChild(e),l.appendChecked=e.checked,t.innerHTML="<textarea>x</textarea>",l.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue,n.appendChild(t),t.innerHTML="<input type='radio' checked='checked' name='t'/>",l.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,l.noCloneEvent=!0,t.attachEvent&&(t.attachEvent("onclick",function(){l.noCloneEvent=!1}),t.cloneNode(!0).click());if(l.deleteExpando==null){l.deleteExpando=!0;try{delete t.test}catch(r){l.deleteExpando=!1}}})(),function(){var t,n,r=T.createElement("div");for(t in{submit:!0,change:!0,focusin:!0})n="on"+t,(l[t+"Bubbles"]=n in e)||(r.setAttribute(n,"t"),l[t+"Bubbles"]=r.attributes[n].expando===!1);r=null}();var K=/^(?:input|select|textarea)$/i,Q=/^key/,G=/^(?:mouse|pointer|contextmenu)|click/,Y=/^(?:focusinfocus|focusoutblur)$/,Z=/^([^.]*)(?:\.(.+)|)$/;h.event={global:{},add:function(e,t,n,r,i){var s,o,u,a,f,l,c,p,d,v,m,g=h._data(e);if(!g)return;n.handler&&(a=n,n=a.handler,i=a.selector),n.guid||(n.guid=h.guid++),(o=g.events)||(o=g.events={}),(l=g.handle)||(l=g.handle=function(e){return typeof h===B||!!e&&h.event.triggered===e.type?undefined:h.event.dispatch.apply(l.elem,arguments)},l.elem=e),t=(t||"").match(O)||[""],u=t.length;while(u--){s=Z.exec(t[u])||[],d=m=s[1],v=(s[2]||"").split(".").sort();if(!d)continue;f=h.event.special[d]||{},d=(i?f.delegateType:f.bindType)||d,f=h.event.special[d]||{},c=h.extend({type:d,origType:m,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&h.expr.match.needsContext.test(i),namespace:v.join(".")},a);if(!(p=o[d])){p=o[d]=[],p.delegateCount=0;if(!f.setup||f.setup.call(e,r,v,l)===!1)e.addEventListener?e.addEventListener(d,l,!1):e.attachEvent&&e.attachEvent("on"+d,l)}f.add&&(f.add.call(e,c),c.handler.guid||(c.handler.guid=n.guid)),i?p.splice(p.delegateCount++,0,c):p.push(c),h.event.global[d]=!0}e=null},remove:function(e,t,n,r,i){var s,o,u,a,f,l,c,p,d,v,m,g=h.hasData(e)&&h._data(e);if(!g||!(l=g.events))return;t=(t||"").match(O)||[""],f=t.length;while(f--){u=Z.exec(t[f])||[],d=m=u[1],v=(u[2]||"").split(".").sort();if(!d){for(d in l)h.event.remove(e,d+t[f],n,r,!0);continue}c=h.event.special[d]||{},d=(r?c.delegateType:c.bindType)||d,p=l[d]||[],u=u[2]&&new RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=s=p.length;while(s--)o=p[s],(i||m===o.origType)&&(!n||n.guid===o.guid)&&(!u||u.test(o.namespace))&&(!r||r===o.selector||r==="**"&&o.selector)&&(p.splice(s,1),o.selector&&p.delegateCount--,c.remove&&c.remove.call(e,o));a&&!p.length&&((!c.teardown||c.teardown.call(e,v,g.handle)===!1)&&h.removeEvent(e,d,g.handle),delete l[d])}h.isEmptyObject(l)&&(delete g.handle,h._removeData(e,"events"))},trigger:function(t,n,r,i){var s,o,u,a,l,c,p,d=[r||T],v=f.call(t,"type")?t.type:t,m=f.call(t,"namespace")?t.namespace.split("."):[];u=c=r=r||T;if(r.nodeType===3||r.nodeType===8)return;if(Y.test(v+h.event.triggered))return;v.indexOf(".")>=0&&(m=v.split("."),v=m.shift(),m.sort()),o=v.indexOf(":")<0&&"on"+v,t=t[h.expando]?t:new h.Event(v,typeof t=="object"&&t),t.isTrigger=i?2:3,t.namespace=m.join("."),t.namespace_re=t.namespace?new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=undefined,t.target||(t.target=r),n=n==null?[t]:h.makeArray(n,[t]),l=h.event.special[v]||{};if(!i&&l.trigger&&l.trigger.apply(r,n)===!1)return;if(!i&&!l.noBubble&&!h.isWindow(r)){a=l.delegateType||v,Y.test(a+v)||(u=u.parentNode);for(;u;u=u.parentNode)d.push(u),c=u;c===(r.ownerDocument||T)&&d.push(c.defaultView||c.parentWindow||e)}p=0;while((u=d[p++])&&!t.isPropagationStopped())t.type=p>1?a:l.bindType||v,s=(h._data(u,"events")||{})[t.type]&&h._data(u,"handle"),s&&s.apply(u,n),s=o&&u[o],s&&s.apply&&h.acceptData(u)&&(t.result=s.apply(u,n),t.result===!1&&t.preventDefault());t.type=v;if(!i&&!t.isDefaultPrevented()&&(!l._default||l._default.apply(d.pop(),n)===!1)&&h.acceptData(r)&&o&&r[v]&&!h.isWindow(r)){c=r[o],c&&(r[o]=null),h.event.triggered=v;try{r[v]()}catch(g){}h.event.triggered=undefined,c&&(r[o]=c)}return t.result},dispatch:function(e){e=h.event.fix(e);var t,n,i,s,o,u=[],a=r.call(arguments),f=(h._data(this,"events")||{})[e.type]||[],l=h.event.special[e.type]||{};a[0]=e,e.delegateTarget=this;if(l.preDispatch&&l.preDispatch.call(this,e)===!1)return;u=h.event.handlers.call(this,e,f),t=0;while((s=u[t++])&&!e.isPropagationStopped()){e.currentTarget=s.elem,o=0;while((i=s.handlers[o++])&&!e.isImmediatePropagationStopped())if(!e.namespace_re||e.namespace_re.test(i.namespace))e.handleObj=i,e.data=i.data,n=((h.event.special[i.origType]||{}).handle||i.handler).apply(s.elem,a),n!==undefined&&(e.result=n)===!1&&(e.preventDefault(),e.stopPropagation())}return l.postDispatch&&l.postDispatch.call(this,e),e.result},handlers:function(e,t){var n,r,i,s,o=[],u=t.delegateCount,a=e.target;if(u&&a.nodeType&&(!e.button||e.type!=="click"))for(;a!=this;a=a.parentNode||this)if(a.nodeType===1&&(a.disabled!==!0||e.type!=="click")){i=[];for(s=0;s<u;s++)r=t[s],n=r.selector+" ",i[n]===undefined&&(i[n]=r.needsContext?h(n,this).index(a)>=0:h.find(n,this,null,[a]).length),i[n]&&i.push(r);i.length&&o.push({elem:a,handlers:i})}return u<t.length&&o.push({elem:this,handlers:t.slice(u)}),o},fix:function(e){if(e[h.expando])return e;var t,n,r,i=e.type,s=e,o=this.fixHooks[i];o||(this.fixHooks[i]=o=G.test(i)?this.mouseHooks:Q.test(i)?this.keyHooks:{}),r=o.props?this.props.concat(o.props):this.props,e=new h.Event(s),t=r.length;while(t--)n=r[t],e[n]=s[n];return e.target||(e.target=s.srcElement||T),e.target.nodeType===3&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,o.filter?o.filter(e,s):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return e.which==null&&(e.which=t.charCode!=null?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,r,i,s=t.button,o=t.fromElement;return e.pageX==null&&t.clientX!=null&&(r=e.target.ownerDocument||T,i=r.documentElement,n=r.body,e.pageX=t.clientX+(i&&i.scrollLeft||n&&n.scrollLeft||0)-(i&&i.clientLeft||n&&n.clientLeft||0),e.pageY=t.clientY+(i&&i.scrollTop||n&&n.scrollTop||0)-(i&&i.clientTop||n&&n.clientTop||0)),!e.relatedTarget&&o&&(e.relatedTarget=o===e.target?t.toElement:o),!e.which&&s!==undefined&&(e.which=s&1?1:s&2?3:s&4?2:0),e}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==nt()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){if(this===nt()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if(h.nodeName(this,"input")&&this.type==="checkbox"&&this.click)return this.click(),!1},_default:function(e){return h.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==undefined&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=h.extend(new h.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?h.event.trigger(i,null,t):h.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},h.removeEvent=T.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var r="on"+t;e.detachEvent&&(typeof e[r]===B&&(e[r]=null),e.detachEvent(r,n))},h.Event=function(e,t){if(!(this instanceof h.Event))return new h.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.defaultPrevented===undefined&&e.returnValue===!1?et:tt):this.type=e,t&&h.extend(this,t),this.timeStamp=e&&e.timeStamp||h.now(),this[h.expando]=!0},h.Event.prototype={isDefaultPrevented:tt,isPropagationStopped:tt,isImmediatePropagationStopped:tt,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=et;if(!e)return;e.preventDefault?e.preventDefault():e.returnValue=!1},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=et;if(!e)return;e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=et,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},h.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){h.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,s=e.handleObj;if(!i||i!==r&&!h.contains(r,i))e.type=s.origType,n=s.handler.apply(this,arguments),e.type=t;return n}}}),l.submitBubbles||(h.event.special.submit={setup:function(){if(h.nodeName(this,"form"))return!1;h.event.add(this,"click._submit keypress._submit",function(e){var t=e.target,n=h.nodeName(t,"input")||h.nodeName(t,"button")?t.form:undefined;n&&!h._data(n,"submitBubbles")&&(h.event.add(n,"submit._submit",function(e){e._submit_bubble=!0}),h._data(n,"submitBubbles",!0))})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&h.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){if(h.nodeName(this,"form"))return!1;h.event.remove(this,"._submit")}}),l.changeBubbles||(h.event.special.change={setup:function(){if(K.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio")h.event.add(this,"propertychange._change",function(e){e.originalEvent.propertyName==="checked"&&(this._just_changed=!0)}),h.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),h.event.simulate("change",this,e,!0)});return!1}h.event.add(this,"beforeactivate._change",function(e){var t=e.target;K.test(t.nodeName)&&!h._data(t,"changeBubbles")&&(h.event.add(t,"change._change",function(e){this.parentNode&&!e.isSimulated&&!e.isTrigger&&h.event.simulate("change",this.parentNode,e,!0)}),h._data(t,"changeBubbles",!0))})},handle:function(e){var t=e.target;if(this!==t||e.isSimulated||e.isTrigger||t.type!=="radio"&&t.type!=="checkbox")return e.handleObj.handler.apply(this,arguments)},teardown:function(){return h.event.remove(this,"._change"),!K.test(this.nodeName)}}),l.focusinBubbles||h.each({focus:"focusin",blur:"focusout"},function(e,t){var n=function(e){h.event.simulate(t,e.target,h.event.fix(e),!0)};h.event.special[t]={setup:function(){var r=this.ownerDocument||this,i=h._data(r,t);i||r.addEventListener(e,n,!0),h._data(r,t,(i||0)+1)},teardown:function(){var r=this.ownerDocument||this,i=h._data(r,t)-1;i?h._data(r,t,i):(r.removeEventListener(e,n,!0),h._removeData(r,t))}}}),h.fn.extend({on:function(e,t,n,r,i){var s,o;if(typeof e=="object"){typeof t!="string"&&(n=n||t,t=undefined);for(s in e)this.on(s,t,n,e[s],i);return this}n==null&&r==null?(r=t,n=t=undefined):r==null&&(typeof t=="string"?(r=n,n=undefined):(r=n,n=t,t=undefined));if(r===!1)r=tt;else if(!r)return this;return i===1&&(o=r,r=function(e){return h().off(e),o.apply(this,arguments)},r.guid=o.guid||(o.guid=h.guid++)),this.each(function(){h.event.add(this,e,r,n,t)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,h(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if(typeof e=="object"){for(i in e)this.off(i,t,e[i]);return this}if(t===!1||typeof t=="function")n=t,t=undefined;return n===!1&&(n=tt),this.each(function(){h.event.remove(this,e,n,t)})},trigger:function(e,t){return this.each(function(){h.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return h.event.trigger(e,t,n,!0)}});var it="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",st=/ jQuery\d+="(?:null|\d+)"/g,ot=new RegExp("<(?:"+it+")[\\s/>]","i"),ut=/^\s+/,at=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,ft=/<([\w:]+)/,lt=/<tbody/i,ct=/<|&#?\w+;/,ht=/<(?:script|style|link)/i,pt=/checked\s*(?:[^=]|=\s*.checked.)/i,dt=/^$|\/(?:java|ecma)script/i,vt=/^true\/(.*)/,mt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,gt={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:l.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},yt=rt(T),bt=yt.appendChild(T.createElement("div"));gt.optgroup=gt.option,gt.tbody=gt.tfoot=gt.colgroup=gt.caption=gt.thead,gt.th=gt.td,h.extend({clone:function(e,t,n){var r,i,s,o,u,a=h.contains(e.ownerDocument,e);l.html5Clone||h.isXMLDoc(e)||!ot.test("<"+e.nodeName+">")?s=e.cloneNode(!0):(bt.innerHTML=e.outerHTML,bt.removeChild(s=bt.firstChild));if((!l.noCloneEvent||!l.noCloneChecked)&&(e.nodeType===1||e.nodeType===11)&&!h.isXMLDoc(e)){r=wt(s),u=wt(e);for(o=0;(i=u[o])!=null;++o)r[o]&&kt(i,r[o])}if(t)if(n){u=u||wt(e),r=r||wt(s);for(o=0;(i=u[o])!=null;o++)Ct(i,r[o])}else Ct(e,s);return r=wt(s,"script"),r.length>0&&Nt(r,!a&&wt(e,"script")),r=u=i=null,s},buildFragment:function(e,t,n,r){var i,s,o,u,a,f,c,p=e.length,d=rt(t),v=[],m=0;for(;m<p;m++){s=e[m];if(s||s===0)if(h.type(s)==="object")h.merge(v,s.nodeType?[s]:s);else if(!ct.test(s))v.push(t.createTextNode(s));else{u=u||d.appendChild(t.createElement("div")),a=(ft.exec(s)||["",""])[1].toLowerCase(),c=gt[a]||gt._default,u.innerHTML=c[1]+s.replace(at,"<$1></$2>")+c[2],i=c[0];while(i--)u=u.lastChild;!l.leadingWhitespace&&ut.test(s)&&v.push(t.createTextNode(ut.exec(s)[0]));if(!l.tbody){s=a==="table"&&!lt.test(s)?u.firstChild:c[1]==="<table>"&&!lt.test(s)?u:0,i=s&&s.childNodes.length;while(i--)h.nodeName(f=s.childNodes[i],"tbody")&&!f.childNodes.length&&s.removeChild(f)}h.merge(v,u.childNodes),u.textContent="";while(u.firstChild)u.removeChild(u.firstChild);u=d.lastChild}}u&&d.removeChild(u),l.appendChecked||h.grep(wt(v,"input"),Et),m=0;while(s=v[m++]){if(r&&h.inArray(s,r)!==-1)continue;o=h.contains(s.ownerDocument,s),u=wt(d.appendChild(s),"script"),o&&Nt(u);if(n){i=0;while(s=u[i++])dt.test(s.type||"")&&n.push(s)}}return u=null,d},cleanData:function(e,t){var r,i,s,o,u=0,a=h.expando,f=h.cache,c=l.deleteExpando,p=h.event.special;for(;(r=e[u])!=null;u++)if(t||h.acceptData(r)){s=r[a],o=s&&f[s];if(o){if(o.events)for(i in o.events)p[i]?h.event.remove(r,i):h.removeEvent(r,i,o.handle);f[s]&&(delete f[s],c?delete r[a]:typeof r.removeAttribute!==B?r.removeAttribute(a):r[a]=null,n.push(s))}}}}),h.fn.extend({text:function(e){return $(this,function(e){return e===undefined?h.text(this):this.empty().append((this[0]&&this[0].ownerDocument||T).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var t=St(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var t=St(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){var n,r=e?h.filter(e,this):this,i=0;for(;(n=r[i])!=null;i++)!t&&n.nodeType===1&&h.cleanData(wt(n)),n.parentNode&&(t&&h.contains(n.ownerDocument,n)&&Nt(wt(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){var e,t=0;for(;(e=this[t])!=null;t++){e.nodeType===1&&h.cleanData(wt(e,!1));while(e.firstChild)e.removeChild(e.firstChild);e.options&&h.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=e==null?!1:e,t=t==null?e:t,this.map(function(){return h.clone(this,e,t)})},html:function(e){return $(this,function(e){var t=this[0]||{},n=0,r=this.length;if(e===undefined)return t.nodeType===1?t.innerHTML.replace(st,""):undefined;if(typeof e=="string"&&!ht.test(e)&&(l.htmlSerialize||!ot.test(e))&&(l.leadingWhitespace||!ut.test(e))&&!gt[(ft.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(at,"<$1></$2>");try{for(;n<r;n++)t=this[n]||{},t.nodeType===1&&(h.cleanData(wt(t,!1)),t.innerHTML=e);t=0}catch(i){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=arguments[0];return this.domManip(arguments,function(t){e=this.parentNode,h.cleanData(wt(this)),e&&e.replaceChild(t,this)}),e&&(e.length||e.nodeType)?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t){e=i.apply([],e);var n,r,s,o,u,a,f=0,c=this.length,p=this,d=c-1,v=e[0],m=h.isFunction(v);if(m||c>1&&typeof v=="string"&&!l.checkClone&&pt.test(v))return this.each(function(n){var r=p.eq(n);m&&(e[0]=v.call(this,n,r.html())),r.domManip(e,t)});if(c){a=h.buildFragment(e,this[0].ownerDocument,!1,this),n=a.firstChild,a.childNodes.length===1&&(a=n);if(n){o=h.map(wt(a,"script"),xt),s=o.length;for(;f<c;f++)r=a,f!==d&&(r=h.clone(r,!0,!0),s&&h.merge(o,wt(r,"script"))),t.call(this[f],r,f);if(s){u=o[o.length-1].ownerDocument,h.map(o,Tt);for(f=0;f<s;f++)r=o[f],dt.test(r.type||"")&&!h._data(r,"globalEval")&&h.contains(u,r)&&(r.src?h._evalUrl&&h._evalUrl(r.src):h.globalEval((r.text||r.textContent||r.innerHTML||"").replace(mt,"")))}a=n=null}}return this}}),h.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){h.fn[e]=function(e){var n,r=0,i=[],o=h(e),u=o.length-1;for(;r<=u;r++)n=r===u?this:this.clone(!0),h(o[r])[t](n),s.apply(i,n.get());return this.pushStack(i)}});var Lt,At={};(function(){var e;l.shrinkWrapBlocks=function(){if(e!=null)return e;e=!1;var t,n,r;n=T.getElementsByTagName("body")[0];if(!n||!n.style)return;return t=T.createElement("div"),r=T.createElement("div"),r.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",n.appendChild(r).appendChild(t),typeof t.style.zoom!==B&&(t.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:1px;width:1px;zoom:1",t.appendChild(T.createElement("div")).style.width="5px",e=t.offsetWidth!==3),n.removeChild(r),e}})();var _t=/^margin/,Dt=new RegExp("^("+W+")(?!px)[a-z%]+$","i"),Pt,Ht,Bt=/^(top|right|bottom|left)$/;e.getComputedStyle?(Pt=function(e){return e.ownerDocument.defaultView.getComputedStyle(e,null)},Ht=function(e,t,n){var r,i,s,o,u=e.style;return n=n||Pt(e),o=n?n.getPropertyValue(t)||n[t]:undefined,n&&(o===""&&!h.contains(e.ownerDocument,e)&&(o=h.style(e,t)),Dt.test(o)&&_t.test(t)&&(r=u.width,i=u.minWidth,s=u.maxWidth,u.minWidth=u.maxWidth=u.width=o,o=n.width,u.width=r,u.minWidth=i,u.maxWidth=s)),o===undefined?o:o+""}):T.documentElement.currentStyle&&(Pt=function(e){return e.currentStyle},Ht=function(e,t,n){var r,i,s,o,u=e.style;return n=n||Pt(e),o=n?n[t]:undefined,o==null&&u&&u[t]&&(o=u[t]),Dt.test(o)&&!Bt.test(t)&&(r=u.left,i=e.runtimeStyle,s=i&&i.left,s&&(i.left=e.currentStyle.left),u.left=t==="fontSize"?"1em":o,o=u.pixelLeft+"px",u.left=r,s&&(i.left=s)),o===undefined?o:o+""||"auto"}),function(){function a(){var t,n,r,a;n=T.getElementsByTagName("body")[0];if(!n||!n.style)return;t=T.createElement("div"),r=T.createElement("div"),r.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",n.appendChild(r).appendChild(t),t.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",i=s=!1,u=!0,e.getComputedStyle&&(i=(e.getComputedStyle(t,null)||{}).top!=="1%",s=(e.getComputedStyle(t,null)||{width:"4px"}).width==="4px",a=t.appendChild(T.createElement("div")),a.style.cssText=t.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",a.style.marginRight=a.style.width="0",t.style.width="1px",u=!parseFloat((e.getComputedStyle(a,null)||{}).marginRight)),t.innerHTML="<table><tr><td></td><td>t</td></tr></table>",a=t.getElementsByTagName("td"),a[0].style.cssText="margin:0;border:0;padding:0;display:none",o=a[0].offsetHeight===0,o&&(a[0].style.display="",a[1].style.display="none",o=a[0].offsetHeight===0),n.removeChild(r)}var t,n,r,i,s,o,u;t=T.createElement("div"),t.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",r=t.getElementsByTagName("a")[0],n=r&&r.style;if(!n)return;n.cssText="float:left;opacity:.5",l.opacity=n.opacity==="0.5",l.cssFloat=!!n.cssFloat,t.style.backgroundClip="content-box",t.cloneNode(!0).style.backgroundClip="",l.clearCloneStyle=t.style.backgroundClip==="content-box",l.boxSizing=n.boxSizing===""||n.MozBoxSizing===""||n.WebkitBoxSizing==="",h.extend(l,{reliableHiddenOffsets:function(){return o==null&&a(),o},boxSizingReliable:function(){return s==null&&a(),s},pixelPosition:function(){return i==null&&a(),i},reliableMarginRight:function(){return u==null&&a(),u}})}(),h.swap=function(e,t,n,r){var i,s,o={};for(s in t)o[s]=e.style[s],e.style[s]=t[s];i=n.apply(e,r||[]);for(s in t)e.style[s]=o[s];return i};var Ft=/alpha\([^)]*\)/i,It=/opacity\s*=\s*([^)]*)/,qt=/^(none|table(?!-c[ea]).+)/,Rt=new RegExp("^("+W+")(.*)$","i"),Ut=new RegExp("^([+-])=("+W+")","i"),zt={position:"absolute",visibility:"hidden",display:"block"},Wt={letterSpacing:"0",fontWeight:"400"},Xt=["Webkit","O","Moz","ms"];h.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Ht(e,"opacity");return n===""?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":l.cssFloat?"cssFloat":"styleFloat"},style:function(e,t,n,r){if(!e||e.nodeType===3||e.nodeType===8||!e.style)return;var i,s,o,u=h.camelCase(t),a=e.style;t=h.cssProps[u]||(h.cssProps[u]=Vt(a,u)),o=h.cssHooks[t]||h.cssHooks[u];if(n===undefined)return o&&"get"in o&&(i=o.get(e,!1,r))!==undefined?i:a[t];s=typeof n,s==="string"&&(i=Ut.exec(n))&&(n=(i[1]+1)*i[2]+parseFloat(h.css(e,t)),s="number");if(n==null||n!==n)return;s==="number"&&!h.cssNumber[u]&&(n+="px"),!l.clearCloneStyle&&n===""&&t.indexOf("background")===0&&(a[t]="inherit");if(!o||!("set"in o)||(n=o.set(e,n,r))!==undefined)try{a[t]=n}catch(f){}},css:function(e,t,n,r){var i,s,o,u=h.camelCase(t);return t=h.cssProps[u]||(h.cssProps[u]=Vt(e.style,u)),o=h.cssHooks[t]||h.cssHooks[u],o&&"get"in o&&(s=o.get(e,!0,n)),s===undefined&&(s=Ht(e,t,r)),s==="normal"&&t in Wt&&(s=Wt[t]),n===""||n?(i=parseFloat(s),n===!0||h.isNumeric(i)?i||0:s):s}}),h.each(["height","width"],function(e,t){h.cssHooks[t]={get:function(e,n,r){if(n)return qt.test(h.css(e,"display"))&&e.offsetWidth===0?h.swap(e,zt,function(){return Qt(e,t,r)}):Qt(e,t,r)},set:function(e,n,r){var i=r&&Pt(e);return Jt(e,n,r?Kt(e,t,r,l.boxSizing&&h.css(e,"boxSizing",!1,i)==="border-box",i):0)}}}),l.opacity||(h.cssHooks.opacity={get:function(e,t){return It.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,r=e.currentStyle,i=h.isNumeric(t)?"alpha(opacity="+t*100+")":"",s=r&&r.filter||n.filter||"";n.zoom=1;if((t>=1||t==="")&&h.trim(s.replace(Ft,""))===""&&n.removeAttribute){n.removeAttribute("filter");if(t===""||r&&!r.filter)return}n.filter=Ft.test(s)?s.replace(Ft,i):s+" "+i}}),h.cssHooks.marginRight=jt(l.reliableMarginRight,function(e,t){if(t)return h.swap(e,{display:"inline-block"},Ht,[e,"marginRight"])}),h.each({margin:"",padding:"",border:"Width"},function(e,t){h.cssHooks[e+t]={expand:function(n){var r=0,i={},s=typeof n=="string"?n.split(" "):[n];for(;r<4;r++)i[e+X[r]+t]=s[r]||s[r-2]||s[0];return i}},_t.test(e)||(h.cssHooks[e+t].set=Jt)}),h.fn.extend({css:function(e,t){return $(this,function(e,t,n){var r,i,s={},o=0;if(h.isArray(t)){r=Pt(e),i=t.length;for(;o<i;o++)s[t[o]]=h.css(e,t[o],!1,r);return s}return n!==undefined?h.style(e,t,n):h.css(e,t)},e,t,arguments.length>1)},show:function(){return $t(this,!0)},hide:function(){return $t(this)},toggle:function(e){return typeof e=="boolean"?e?this.show():this.hide():this.each(function(){V(this)?h(this).show():h(this).hide()})}}),h.Tween=Gt,Gt.prototype={constructor:Gt,init:function(e,t,n,r,i,s){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=s||(h.cssNumber[n]?"":"px")},cur:function(){var e=Gt.propHooks[this.prop];return e&&e.get?e.get(this):Gt.propHooks._default.get(this)},run:function(e){var t,n=Gt.propHooks[this.prop];return this.options.duration?this.pos=t=h.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Gt.propHooks._default.set(this),this}},Gt.prototype.init.prototype=Gt.prototype,Gt.propHooks={_default:{get:function(e){var t;return e.elem[e.prop]==null||!!e.elem.style&&e.elem.style[e.prop]!=null?(t=h.css(e.elem,e.prop,""),!t||t==="auto"?0:t):e.elem[e.prop]},set:function(e){h.fx.step[e.prop]?h.fx.step[e.prop](e):e.elem.style&&(e.elem.style[h.cssProps[e.prop]]!=null||h.cssHooks[e.prop])?h.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},Gt.propHooks.scrollTop=Gt.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},h.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},h.fx=Gt.prototype.init,h.fx.step={};var Yt,Zt,en=/^(?:toggle|show|hide)$/,tn=new RegExp("^(?:([+-])=|)("+W+")([a-z%]*)$","i"),nn=/queueHooks$/,rn=[fn],sn={"*":[function(e,t){var n=this.createTween(e,t),r=n.cur(),i=tn.exec(t),s=i&&i[3]||(h.cssNumber[e]?"":"px"),o=(h.cssNumber[e]||s!=="px"&&+r)&&tn.exec(h.css(n.elem,e)),u=1,a=20;if(o&&o[3]!==s){s=s||o[3],i=i||[],o=+r||1;do u=u||".5",o/=u,h.style(n.elem,e,o+s);while(u!==(u=n.cur()/r)&&u!==1&&--a)}return i&&(o=n.start=+o||+r||0,n.unit=s,n.end=i[1]?o+(i[1]+1)*i[2]:+i[2]),n}]};h.Animation=h.extend(cn,{tweener:function(e,t){h.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;r<i;r++)n=e[r],sn[n]=sn[n]||[],sn[n].unshift(t)},prefilter:function(e,t){t?rn.unshift(e):rn.push(e)}}),h.speed=function(e,t,n){var r=e&&typeof e=="object"?h.extend({},e):{complete:n||!n&&t||h.isFunction(e)&&e,duration:e,easing:n&&t||t&&!h.isFunction(t)&&t};r.duration=h.fx.off?0:typeof r.duration=="number"?r.duration:r.duration in h.fx.speeds?h.fx.speeds[r.duration]:h.fx.speeds._default;if(r.queue==null||r.queue===!0)r.queue="fx";return r.old=r.complete,r.complete=function(){h.isFunction(r.old)&&r.old.call(this),r.queue&&h.dequeue(this,r.queue)},r},h.fn.extend({fadeTo:function(e,t,n,r){return this.filter(V).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=h.isEmptyObject(e),s=h.speed(t,n,r),o=function(){var t=cn(this,h.extend({},e),s);(i||h._data(this,"finish"))&&t.stop(!0)};return o.finish=o,i||s.queue===!1?this.each(o):this.queue(s.queue,o)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return typeof e!="string"&&(n=t,t=e,e=undefined),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=e!=null&&e+"queueHooks",s=h.timers,o=h._data(this);if(i)o[i]&&o[i].stop&&r(o[i]);else for(i in o)o[i]&&o[i].stop&&nn.test(i)&&r(o[i]);for(i=s.length;i--;)s[i].elem===this&&(e==null||s[i].queue===e)&&(s[i].anim.stop(n),t=!1,s.splice(i,1));(t||!n)&&h.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=h._data(this),r=n[e+"queue"],i=n[e+"queueHooks"],s=h.timers,o=r?r.length:0;n.finish=!0,h.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0);for(t=s.length;t--;)s[t].elem===this&&s[t].queue===e&&(s[t].anim.stop(!0),s.splice(t,1));for(t=0;t<o;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),h.each(["toggle","show","hide"],function(e,t){var n=h.fn[t];h.fn[t]=function(e,r,i){return e==null||typeof e=="boolean"?n.apply(this,arguments):this.animate(un(t,!0),e,r,i)}}),h.each({slideDown:un("show"),slideUp:un("hide"),slideToggle:un("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){h.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),h.timers=[],h.fx.tick=function(){var e,t=h.timers,n=0;Yt=h.now();for(;n<t.length;n++)e=t[n],!e()&&t[n]===e&&t.splice(n--,1);t.length||h.fx.stop(),Yt=undefined},h.fx.timer=function(e){h.timers.push(e),e()?h.fx.start():h.timers.pop()},h.fx.interval=13,h.fx.start=function(){Zt||(Zt=setInterval(h.fx.tick,h.fx.interval))},h.fx.stop=function(){clearInterval(Zt),Zt=null},h.fx.speeds={slow:600,fast:200,_default:400},h.fn.delay=function(e,t){return e=h.fx?h.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},function(){var e,t,n,r,i;t=T.createElement("div"),t.setAttribute("className","t"),t.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",r=t.getElementsByTagName("a")[0],n=T.createElement("select"),i=n.appendChild(T.createElement("option")),e=t.getElementsByTagName("input")[0],r.style.cssText="top:1px",l.getSetAttribute=t.className!=="t",l.style=/top/.test(r.getAttribute("style")),l.hrefNormalized=r.getAttribute("href")==="/a",l.checkOn=!!e.value,l.optSelected=i.selected,l.enctype=!!T.createElement("form").enctype,n.disabled=!0,l.optDisabled=!i.disabled,e=T.createElement("input"),e.setAttribute("value",""),l.input=e.getAttribute("value")==="",e.value="t",e.setAttribute("type","radio"),l.radioValue=e.value==="t"}();var hn=/\r/g;h.fn.extend({val:function(e){var t,n,r,i=this[0];if(!arguments.length){if(i)return t=h.valHooks[i.type]||h.valHooks[i.nodeName.toLowerCase()],t&&"get"in t&&(n=t.get(i,"value"))!==undefined?n:(n=i.value,typeof n=="string"?n.replace(hn,""):n==null?"":n);return}return r=h.isFunction(e),this.each(function(n){var i;if(this.nodeType!==1)return;r?i=e.call(this,n,h(this).val()):i=e,i==null?i="":typeof i=="number"?i+="":h.isArray(i)&&(i=h.map(i,function(e){return e==null?"":e+""})),t=h.valHooks[this.type]||h.valHooks[this.nodeName.toLowerCase()];if(!t||!("set"in t)||t.set(this,i,"value")===undefined)this.value=i})}}),h.extend({valHooks:{option:{get:function(e){var t=h.find.attr(e,"value");return t!=null?t:h.trim(h.text(e))}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,s=e.type==="select-one"||i<0,o=s?null:[],u=s?i+1:r.length,a=i<0?u:s?i:0;for(;a<u;a++){n=r[a];if((n.selected||a===i)&&(l.optDisabled?!n.disabled:n.getAttribute("disabled")===null)&&(!n.parentNode.disabled||!h.nodeName(n.parentNode,"optgroup"))){t=h(n).val();if(s)return t;o.push(t)}}return o},set:function(e,t){var n,r,i=e.options,s=h.makeArray(t),o=i.length;while(o--){r=i[o];if(h.inArray(h.valHooks.option.get(r),s)>=0)try{r.selected=n=!0}catch(u){r.scrollHeight}else r.selected=!1}return n||(e.selectedIndex=-1),i}}}}),h.each(["radio","checkbox"],function(){h.valHooks[this]={set:function(e,t){if(h.isArray(t))return e.checked=h.inArray(h(e).val(),t)>=0}},l.checkOn||(h.valHooks[this].get=function(e){return e.getAttribute("value")===null?"on":e.value})});var pn,dn,vn=h.expr.attrHandle,mn=/^(?:checked|selected)$/i,gn=l.getSetAttribute,yn=l.input;h.fn.extend({attr:function(e,t){return $(this,h.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){h.removeAttr(this,e)})}}),h.extend({attr:function(e,t,n){var r,i,s=e.nodeType;if(!e||s===3||s===8||s===2)return;if(typeof e.getAttribute===B)return h.prop(e,t,n);if(s!==1||!h.isXMLDoc(e))t=t.toLowerCase(),r=h.attrHooks[t]||(h.expr.match.bool.test(t)?dn:pn);if(n===undefined)return r&&"get"in r&&(i=r.get(e,t))!==null?i:(i=h.find.attr(e,t),i==null?undefined:i);if(n!==null)return r&&"set"in r&&(i=r.set(e,n,t))!==undefined?i:(e.setAttribute(t,n+""),n);h.removeAttr(e,t)},removeAttr:function(e,t){var n,r,i=0,s=t&&t.match(O);if(s&&e.nodeType===1)while(n=s[i++])r=h.propFix[n]||n,h.expr.match.bool.test(n)?yn&&gn||!mn.test(n)?e[r]=!1:e[h.camelCase("default-"+n)]=e[r]=!1:h.attr(e,n,""),e.removeAttribute(gn?n:r)},attrHooks:{type:{set:function(e,t){if(!l.radioValue&&t==="radio"&&h.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}}}),dn={set:function(e,t,n){return t===!1?h.removeAttr(e,n):yn&&gn||!mn.test(n)?e.setAttribute(!gn&&h.propFix[n]||n,n):e[h.camelCase("default-"+n)]=e[n]=!0,n}},h.each(h.expr.match.bool.source.match(/\w+/g),function(e,t){var n=vn[t]||h.find.attr;vn[t]=yn&&gn||!mn.test(t)?function(e,t,r){var i,s;return r||(s=vn[t],vn[t]=i,i=n(e,t,r)!=null?t.toLowerCase():null,vn[t]=s),i}:function(e,t,n){if(!n)return e[h.camelCase("default-"+t)]?t.toLowerCase():null}});if(!yn||!gn)h.attrHooks.value={set:function(e,t,n){if(!h.nodeName(e,"input"))return pn&&pn.set(e,t,n);e.defaultValue=t}};gn||(pn={set:function(e,t,n){var r=e.getAttributeNode(n);r||e.setAttributeNode(r=e.ownerDocument.createAttribute(n)),r.value=t+="";if(n==="value"||t===e.getAttribute(n))return t}},vn.id=vn.name=vn.coords=function(e,t,n){var r;if(!n)return(r=e.getAttributeNode(t))&&r.value!==""?r.value:null},h.valHooks.button={get:function(e,t){var n=e.getAttributeNode(t);if(n&&n.specified)return n.value},set:pn.set},h.attrHooks.contenteditable={set:function(e,t,n){pn.set(e,t===""?!1:t,n)}},h.each(["width","height"],function(e,t){h.attrHooks[t]={set:function(e,n){if(n==="")return e.setAttribute(t,"auto"),n}}})),l.style||(h.attrHooks.style={get:function(e){return e.style.cssText||undefined},set:function(e,t){return e.style.cssText=t+""}});var bn=/^(?:input|select|textarea|button|object)$/i,wn=/^(?:a|area)$/i;h.fn.extend({prop:function(e,t){return $(this,h.prop,e,t,arguments.length>1)},removeProp:function(e){return e=h.propFix[e]||e,this.each(function(){try{this[e]=undefined,delete this[e]}catch(t){}})}}),h.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(e,t,n){var r,i,s,o=e.nodeType;if(!e||o===3||o===8||o===2)return;return s=o!==1||!h.isXMLDoc(e),s&&(t=h.propFix[t]||t,i=h.propHooks[t]),n!==undefined?i&&"set"in i&&(r=i.set(e,n,t))!==undefined?r:e[t]=n:i&&"get"in i&&(r=i.get(e,t))!==null?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=h.find.attr(e,"tabindex");return t?parseInt(t,10):bn.test(e.nodeName)||wn.test(e.nodeName)&&e.href?0:-1}}}}),l.hrefNormalized||h.each(["href","src"],function(e,t){h.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}}),l.optSelected||(h.propHooks.selected={get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}}),h.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){h.propFix[this.toLowerCase()]=this}),l.enctype||(h.propFix.enctype="encoding");var En=/[\t\r\n\f]/g;h.fn.extend({addClass:function(e){var t,n,r,i,s,o,u=0,a=this.length,f=typeof e=="string"&&e;if(h.isFunction(e))return this.each(function(t){h(this).addClass(e.call(this,t,this.className))});if(f){t=(e||"").match(O)||[];for(;u<a;u++){n=this[u],r=n.nodeType===1&&(n.className?(" "+n.className+" ").replace(En," "):" ");if(r){s=0;while(i=t[s++])r.indexOf(" "+i+" ")<0&&(r+=i+" ");o=h.trim(r),n.className!==o&&(n.className=o)}}}return this},removeClass:function(e){var t,n,r,i,s,o,u=0,a=this.length,f=arguments.length===0||typeof e=="string"&&e;if(h.isFunction(e))return this.each(function(t){h(this).removeClass(e.call(this,t,this.className))});if(f){t=(e||"").match(O)||[];for(;u<a;u++){n=this[u],r=n.nodeType===1&&(n.className?(" "+n.className+" ").replace(En," "):"");if(r){s=0;while(i=t[s++])while(r.indexOf(" "+i+" ")>=0)r=r.replace(" "+i+" "," ");o=e?h.trim(r):"",n.className!==o&&(n.className=o)}}}return this},toggleClass:function(e,t){var n=typeof e;return typeof t=="boolean"&&n==="string"?t?this.addClass(e):this.removeClass(e):h.isFunction(e)?this.each(function(n){h(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if(n==="string"){var t,r=0,i=h(this),s=e.match(O)||[];while(t=s[r++])i.hasClass(t)?i.removeClass(t):i.addClass(t)}else if(n===B||n==="boolean")this.className&&h._data(this,"__className__",this.className),this.className=this.className||e===!1?"":h._data(this,"__className__")||""})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;n<r;n++)if(this[n].nodeType===1&&(" "+this[n].className+" ").replace(En," ").indexOf(t)>=0)return!0;return!1}}),h.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){h.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),h.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return arguments.length===1?this.off(e,"**"):this.off(t,e||"**",n)}});var Sn=h.now(),xn=/\?/,Tn=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;h.parseJSON=function(t){if(e.JSON&&e.JSON.parse)return e.JSON.parse(t+"");var n,r=null,i=h.trim(t+"");return i&&!h.trim(i.replace(Tn,function(e,t,i,s){return n&&t&&(r=0),r===0?e:(n=i||t,r+=!s-!i,"")}))?Function("return "+i)():h.error("Invalid JSON: "+t)},h.parseXML=function(t){var n,r;if(!t||typeof t!="string")return null;try{e.DOMParser?(r=new DOMParser,n=r.parseFromString(t,"text/xml")):(n=new ActiveXObject("Microsoft.XMLDOM"),n.async="false",n.loadXML(t))}catch(i){n=undefined}return(!n||!n.documentElement||n.getElementsByTagName("parsererror").length)&&h.error("Invalid XML: "+t),n};var Nn,Cn,kn=/#.*$/,Ln=/([?&])_=[^&]*/,An=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,On=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Mn=/^(?:GET|HEAD)$/,_n=/^\/\//,Dn=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Pn={},Hn={},Bn="*/".concat("*");try{Cn=location.href}catch(jn){Cn=T.createElement("a"),Cn.href="",Cn=Cn.href}Nn=Dn.exec(Cn.toLowerCase())||[],h.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Cn,type:"GET",isLocal:On.test(Nn[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Bn,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":h.parseJSON,"text xml":h.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?qn(qn(e,h.ajaxSettings),t):qn(h.ajaxSettings,e)},ajaxPrefilter:Fn(Pn),ajaxTransport:Fn(Hn),ajax:function(e,t){function x(e,t,n,r){var f,g,y,w,S,x=t;if(b===2)return;b=2,o&&clearTimeout(o),a=undefined,s=r||"",E.readyState=e>0?4:0,f=e>=200&&e<300||e===304,n&&(w=Rn(l,E,n)),w=Un(l,w,E,f);if(f)l.ifModified&&(S=E.getResponseHeader("Last-Modified"),S&&(h.lastModified[i]=S),S=E.getResponseHeader("etag"),S&&(h.etag[i]=S)),e===204||l.type==="HEAD"?x="nocontent":e===304?x="notmodified":(x=w.state,g=w.data,y=w.error,f=!y);else{y=x;if(e||!x)x="error",e<0&&(e=0)}E.status=e,E.statusText=(t||x)+"",f?d.resolveWith(c,[g,x,E]):d.rejectWith(c,[E,x,y]),E.statusCode(m),m=undefined,u&&p.trigger(f?"ajaxSuccess":"ajaxError",[E,l,f?g:y]),v.fireWith(c,[E,x]),u&&(p.trigger("ajaxComplete",[E,l]),--h.active||h.event.trigger("ajaxStop"))}typeof e=="object"&&(t=e,e=undefined),t=t||{};var n,r,i,s,o,u,a,f,l=h.ajaxSetup({},t),c=l.context||l,p=l.context&&(c.nodeType||c.jquery)?h(c):h.event,d=h.Deferred(),v=h.Callbacks("once memory"),m=l.statusCode||{},g={},y={},b=0,w="canceled",E={readyState:0,getResponseHeader:function(e){var t;if(b===2){if(!f){f={};while(t=An.exec(s))f[t[1].toLowerCase()]=t[2]}t=f[e.toLowerCase()]}return t==null?null:t},getAllResponseHeaders:function(){return b===2?s:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return b||(e=y[n]=y[n]||e,g[e]=t),this},overrideMimeType:function(e){return b||(l.mimeType=e),this},statusCode:function(e){var t;if(e)if(b<2)for(t in e)m[t]=[m[t],e[t]];else E.always(e[E.status]);return this},abort:function(e){var t=e||w;return a&&a.abort(t),x(0,t),this}};d.promise(E).complete=v.add,E.success=E.done,E.error=E.fail,l.url=((e||l.url||Cn)+"").replace(kn,"").replace(_n,Nn[1]+"//"),l.type=t.method||t.type||l.method||l.type,l.dataTypes=h.trim(l.dataType||"*").toLowerCase().match(O)||[""],l.crossDomain==null&&(n=Dn.exec(l.url.toLowerCase()),l.crossDomain=!(!n||n[1]===Nn[1]&&n[2]===Nn[2]&&(n[3]||(n[1]==="http:"?"80":"443"))===(Nn[3]||(Nn[1]==="http:"?"80":"443")))),l.data&&l.processData&&typeof l.data!="string"&&(l.data=h.param(l.data,l.traditional)),In(Pn,l,t,E);if(b===2)return E;u=l.global,u&&h.active++===0&&h.event.trigger("ajaxStart"),l.type=l.type.toUpperCase(),l.hasContent=!Mn.test(l.type),i=l.url,l.hasContent||(l.data&&(i=l.url+=(xn.test(i)?"&":"?")+l.data,delete l.data),l.cache===!1&&(l.url=Ln.test(i)?i.replace(Ln,"$1_="+Sn++):i+(xn.test(i)?"&":"?")+"_="+Sn++)),l.ifModified&&(h.lastModified[i]&&E.setRequestHeader("If-Modified-Since",h.lastModified[i]),h.etag[i]&&E.setRequestHeader("If-None-Match",h.etag[i])),(l.data&&l.hasContent&&l.contentType!==!1||t.contentType)&&E.setRequestHeader("Content-Type",l.contentType),E.setRequestHeader("Accept",l.dataTypes[0]&&l.accepts[l.dataTypes[0]]?l.accepts[l.dataTypes[0]]+(l.dataTypes[0]!=="*"?", "+Bn+"; q=0.01":""):l.accepts["*"]);for(r in l.headers)E.setRequestHeader(r,l.headers[r]);if(!l.beforeSend||l.beforeSend.call(c,E,l)!==!1&&b!==2){w="abort";for(r in{success:1,error:1,complete:1})E[r](l[r]);a=In(Hn,l,t,E);if(!a)x(-1,"No Transport");else{E.readyState=1,u&&p.trigger("ajaxSend",[E,l]),l.async&&l.timeout>0&&(o=setTimeout(function(){E.abort("timeout")},l.timeout));try{b=1,a.send(g,x)}catch(S){if(!(b<2))throw S;x(-1,S)}}return E}return E.abort()},getJSON:function(e,t,n){return h.get(e,t,n,"json")},getScript:function(e,t){return h.get(e,undefined,t,"script")}}),h.each(["get","post"],function(e,t){h[t]=function(e,n,r,i){return h.isFunction(n)&&(i=i||r,r=n,n=undefined),h.ajax({url:e,type:t,dataType:i,data:n,success:r})}}),h.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){h.fn[t]=function(e){return this.on(t,e)}}),h._evalUrl=function(e){return h.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},h.fn.extend({wrapAll:function(e){if(h.isFunction(e))return this.each(function(t){h(this).wrapAll(e.call(this,t))});if(this[0]){var t=h(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstChild&&e.firstChild.nodeType===1)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return h.isFunction(e)?this.each(function(t){h(this).wrapInner(e.call(this,t))}):this.each(function(){var t=h(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=h.isFunction(e);return this.each(function(n){h(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){h.nodeName(this,"body")||h(this).replaceWith(this.childNodes)}).end()}}),h.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0||!l.reliableHiddenOffsets()&&(e.style&&e.style.display||h.css(e,"display"))==="none"},h.expr.filters.visible=function(e){return!h.expr.filters.hidden(e)};var zn=/%20/g,Wn=/\[\]$/,Xn=/\r?\n/g,Vn=/^(?:submit|button|image|reset|file)$/i,$n=/^(?:input|select|textarea|keygen)/i;h.param=function(e,t){var n,r=[],i=function(e,t){t=h.isFunction(t)?t():t==null?"":t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};t===undefined&&(t=h.ajaxSettings&&h.ajaxSettings.traditional);if(h.isArray(e)||e.jquery&&!h.isPlainObject(e))h.each(e,function(){i(this.name,this.value)});else for(n in e)Jn(n,e[n],t,i);return r.join("&").replace(zn,"+")},h.fn.extend({serialize:function(){return h.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=h.prop(this,"elements");return e?h.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!h(this).is(":disabled")&&$n.test(this.nodeName)&&!Vn.test(e)&&(this.checked||!J.test(e))}).map(function(e,t){var n=h(this).val();return n==null?null:h.isArray(n)?h.map(n,function(e){return{name:t.name,value:e.replace(Xn,"\r\n")}}):{name:t.name,value:n.replace(Xn,"\r\n")}}).get()}}),h.ajaxSettings.xhr=e.ActiveXObject!==undefined?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&Yn()||Zn()}:Yn;var Kn=0,Qn={},Gn=h.ajaxSettings.xhr();e.ActiveXObject&&h(e).on("unload",function(){for(var e in Qn)Qn[e](undefined,!0)}),l.cors=!!Gn&&"withCredentials"in Gn,Gn=l.ajax=!!Gn,Gn&&h.ajaxTransport(function(e){if(!e.crossDomain||l.cors){var t;return{send:function(n,r){var i,s=e.xhr(),o=++Kn;s.open(e.type,e.url,e.async,e.username,e.password);if(e.xhrFields)for(i in e.xhrFields)s[i]=e.xhrFields[i];e.mimeType&&s.overrideMimeType&&s.overrideMimeType(e.mimeType),!e.crossDomain&&!n["X-Requested-With"]&&(n["X-Requested-With"]="XMLHttpRequest");for(i in n)n[i]!==undefined&&s.setRequestHeader(i,n[i]+"");s.send(e.hasContent&&e.data||null),t=function(n,i){var u,a,f;if(t&&(i||s.readyState===4)){delete Qn[o],t=undefined,s.onreadystatechange=h.noop;if(i)s.readyState!==4&&s.abort();else{f={},u=s.status,typeof s.responseText=="string"&&(f.text=s.responseText);try{a=s.statusText}catch(l){a=""}!u&&e.isLocal&&!e.crossDomain?u=f.text?200:404:u===1223&&(u=204)}}f&&r(u,a,f,s.getAllResponseHeaders())},e.async?s.readyState===4?setTimeout(t):s.onreadystatechange=Qn[o]=t:t()},abort:function(){t&&t(undefined,!0)}}}}),h.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return h.globalEval(e),e}}}),h.ajaxPrefilter("script",function(e){e.cache===undefined&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),h.ajaxTransport("script",function(e){if(e.crossDomain){var t,n=T.head||h("head")[0]||T.documentElement;return{send:function(r,i){t=T.createElement("script"),t.async=!0,e.scriptCharset&&(t.charset=e.scriptCharset),t.src=e.url,t.onload=t.onreadystatechange=function(e,n){if(n||!t.readyState||/loaded|complete/.test(t.readyState))t.onload=t.onreadystatechange=null,t.parentNode&&t.parentNode.removeChild(t),t=null,n||i(200,"success")},n.insertBefore(t,n.firstChild)},abort:function(){t&&t.onload(undefined,!0)}}}});var er=[],tr=/(=)\?(?=&|$)|\?\?/;h.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=er.pop()||h.expando+"_"+Sn++;return this[e]=!0,e}}),h.ajaxPrefilter("json jsonp",function(t,n,r){var i,s,o,u=t.jsonp!==!1&&(tr.test(t.url)?"url":typeof t.data=="string"&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&tr.test(t.data)&&"data");if(u||t.dataTypes[0]==="jsonp")return i=t.jsonpCallback=h.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,u?t[u]=t[u].replace(tr,"$1"+i):t.jsonp!==!1&&(t.url+=(xn.test(t.url)?"&":"?")+t.jsonp+"="+i),t.converters["script json"]=function(){return o||h.error(i+" was not called"),o[0]},t.dataTypes[0]="json",s=e[i],e[i]=function(){o=arguments},r.always(function(){e[i]=s,t[i]&&(t.jsonpCallback=n.jsonpCallback,er.push(i)),o&&h.isFunction(s)&&s(o[0]),o=s=undefined}),"script"}),h.parseHTML=function(e,t,n){if(!e||typeof e!="string")return null;typeof t=="boolean"&&(n=t,t=!1),t=t||T;var r=w.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=h.buildFragment([e],t,i),i&&i.length&&h(i).remove(),h.merge([],r.childNodes))};var nr=h.fn.load;h.fn.load=function(e,t,n){if(typeof e!="string"&&nr)return nr.apply(this,arguments);var r,i,s,o=this,u=e.indexOf(" ");return u>=0&&(r=h.trim(e.slice(u,e.length)),e=e.slice(0,u)),h.isFunction(t)?(n=t,t=undefined):t&&typeof t=="object"&&(s="POST"),o.length>0&&h.ajax({url:e,type:s,dataType:"html",data:t}).done(function(e){i=arguments,o.html(r?h("<div>").append(h.parseHTML(e)).find(r):e)}).complete(n&&function(e,t){o.each(n,i||[e.responseText,t,e])}),this},h.expr.filters.animated=function(e){return h.grep(h.timers,function(t){return e===t.elem}).length};var rr=e.document.documentElement;h.offset={setOffset:function(e,t,n){var r,i,s,o,u,a,f,l=h.css(e,"position"),c=h(e),p={};l==="static"&&(e.style.position="relative"),u=c.offset(),s=h.css(e,"top"),a=h.css(e,"left"),f=(l==="absolute"||l==="fixed")&&h.inArray("auto",[s,a])>-1,f?(r=c.position(),o=r.top,i=r.left):(o=parseFloat(s)||0,i=parseFloat(a)||0),h.isFunction(t)&&(t=t.call(e,n,u)),t.top!=null&&(p.top=t.top-u.top+o),t.left!=null&&(p.left=t.left-u.left+i),"using"in t?t.using.call(e,p):c.css(p)}},h.fn.extend({offset:function(e){if(arguments.length)return e===undefined?this:this.each(function(t){h.offset.setOffset(this,e,t)});var t,n,r={top:0,left:0},i=this[0],s=i&&i.ownerDocument;if(!s)return;return t=s.documentElement,h.contains(t,i)?(typeof i.getBoundingClientRect!==B&&(r=i.getBoundingClientRect()),n=ir(s),{top:r.top+(n.pageYOffset||t.scrollTop)-(t.clientTop||0),left:r.left+(n.pageXOffset||t.scrollLeft)-(t.clientLeft||0)}):r},position:function(){if(!this[0])return;var e,t,n={top:0,left:0},r=this[0];return h.css(r,"position")==="fixed"?t=r.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),h.nodeName(e[0],"html")||(n=e.offset()),n.top+=h.css(e[0],"borderTopWidth",!0),n.left+=h.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-h.css(r,"marginTop",!0),left:t.left-n.left-h.css(r,"marginLeft",!0)}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||rr;while(e&&!h.nodeName(e,"html")&&h.css(e,"position")==="static")e=e.offsetParent;return e||rr})}}),h.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var n=/Y/.test(t);h.fn[e]=function(r){return $(this,function(e,r,i){var s=ir(e);if(i===undefined)return s?t in s?s[t]:s.document.documentElement[r]:e[r];s?s.scrollTo(n?h(s).scrollLeft():i,n?i:h(s).scrollTop()):e[r]=i},e,r,arguments.length,null)}}),h.each(["top","left"],function(e,t){h.cssHooks[t]=jt(l.pixelPosition,function(e,n){if(n)return n=Ht(e,t),Dt.test(n)?h(e).position()[t]+"px":n})}),h.each({Height:"height",Width:"width"},function(e,t){h.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,r){h.fn[r]=function(r,i){var s=arguments.length&&(n||typeof r!="boolean"),o=n||(r===!0||i===!0?"margin":"border");return $(this,function(t,n,r){var i;return h.isWindow(t)?t.document.documentElement["client"+e]:t.nodeType===9?(i=t.documentElement,Math.max(t.body["scroll"+e],i["scroll"+e],t.body["offset"+e],i["offset"+e],i["client"+e])):r===undefined?h.css(t,n,o):h.style(t,n,r,o)},t,s?r:undefined,s,null)}})}),h.fn.size=function(){return this.length},h.fn.andSelf=h.fn.addBack,typeof tadpoles.define=="function"&&tadpoles.define.amd&&tadpoles.define("jquery",[],function(){return h});var sr=e.jQuery,or=e.$;return h.noConflict=function(t){return e.$===h&&(e.$=or),t&&e.jQuery===h&&(e.jQuery=sr),h},typeof t===B&&(e.jQuery=e.$=h),h}),tadpoles.define("jquery-noconflict",["jquery"],function(e){return e.noConflict(!0)}),function(){var DEBUG=!1;(function(undefined){var window=this||(0,eval)("this"),document=window.document,navigator=window.navigator,jQueryInstance=window.jQuery,JSON=window.JSON;(function(e){typeof tadpoles.define=="function"&&tadpoles.define.amd?tadpoles.define("ko",["exports","require","jquery"],e):typeof exports=="object"&&typeof module=="object"?e(module.exports||exports):e(window.ko={})})(function(e,t,n){function s(e,t){var n=e===null||typeof e in i;return n?e===t:!1}function o(e,t){var n;return function(){n||(n=r.utils.setTimeout(function(){n=undefined,e()},t))}}function u(e,t){var n;return function(){clearTimeout(n),n=r.utils.setTimeout(e,t)}}function a(e){var t=this;return e&&r.utils.objectForEach(e,function(e,n){var i=r.extenders[e];typeof i=="function"&&(t=i(t,n)||t)}),t}function l(e,t){!t||t===f?this._limitChange(e):t==="beforeChange"?this._limitBeforeChange(e):this._origNotifySubscribers(e,t)}function g(e,t){t!==null&&t.dispose&&t.dispose()}function y(e,t){var n=this.computedObservable,r=n[m];r.isDisposed||(this.disposalCount&&this.disposalCandidates[t]?(n.addDependencyTracking(t,e,this.disposalCandidates[t]),this.disposalCandidates[t]=null,--this.disposalCount):r.dependencyTracking[t]||n.addDependencyTracking(t,e,r.isSleeping?{_target:e}:n.subscribeToDependency(e)))}function N(e){r.bindingHandlers[e]={init:function(t,n,i,s,o){var u=function(){var t={};return t[e]=n(),t};return r.bindingHandlers.event.init.call(this,t,u,i,s,o)}}}function L(e,t,n,i){r.bindingHandlers[e]={init:function(e,s,o,u,a){var f,l;return r.computed(function(){var o=r.utils.unwrapObservable(s()),u=!n!=!o,c=!l,h=c||t||u!==f;h&&(c&&r.computedContext.getDependenciesCount()&&(l=r.utils.cloneNodes(r.virtualElements.childNodes(e),!0)),u?(c||r.virtualElements.setDomNodeChildren(e,r.utils.cloneNodes(l)),r.applyBindingsToDescendants(i?i(a,o):a,e)):r.virtualElements.emptyNode(e),f=u)},null,{disposeWhenNodeIsRemoved:e}),{controlsDescendantBindings:!0}}},r.expressionRewriting.bindingRewriteValidators[e]=!1,r.virtualElements.allowedBindings[e]=!0}jQueryInstance=jQueryInstance||n;var r=typeof e!="undefined"?e:{};r.exportSymbol=function(e,t){var n=e.split("."),i=r;for(var s=0;s<n.length-1;s++)i=i[n[s]];i[n[n.length-1]]=t},r.exportProperty=function(e,t,n){e[t]=n},r.version="3.4.0",r.exportSymbol("version",r.version),r.options={deferUpdates:!1,useOnlyNativeEvents:!1},r.utils=function(){function e(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n,e[n])}function t(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function n(e,t){return e.__proto__=t,e}function p(e,t){if(r.utils.tagNameLower(e)!=="input"||!e.type)return!1;if(t.toLowerCase()!="click")return!1;var n=e.type;return n=="checkbox"||n=="radio"}function v(e,t,n){var i;t&&(typeof e.classList=="object"?(i=e.classList[n?"add":"remove"],r.utils.arrayForEach(t.match(d),function(t){i.call(e.classList,t)})):typeof e.className["baseVal"]=="string"?m(e.className,"baseVal",t,n):m(e,"className",t,n))}function m(e,t,n,i){var s=e[t].match(d)||[];r.utils.arrayForEach(n.match(d),function(e){r.utils.addOrRemoveItem(s,e,i)}),e[t]=s.join(" ")}var i={__proto__:[]}instanceof Array,s=!DEBUG&&typeof Symbol=="function",o={},u={},a=navigator&&/Firefox\/2/i.test(navigator.userAgent)?"KeyboardEvent":"UIEvents";o[a]=["keyup","keydown","keypress"],o.MouseEvents=["click","dblclick","mousedown","mouseup","mousemove","mouseover","mouseout","mouseenter","mouseleave"],e(o,function(e,t){if(t.length)for(var n=0,r=t.length;n<r;n++)u[t[n]]=e});var f={propertychange:!0},l=document&&function(){var e=3,t=document.createElement("div"),n=t.getElementsByTagName("i");while(t.innerHTML="<!--[if gt IE "+ ++e+"]><i></i><![endif]-->",n[0]);return e>4?e:undefined}(),c=l===6,h=l===7,d=/\S+/g;return{fieldsIncludedWithJsonPost:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],arrayForEach:function(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)},arrayIndexOf:function(e,t){if(typeof Array.prototype.indexOf=="function")return Array.prototype.indexOf.call(e,t);for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},arrayFirst:function(e,t,n){for(var r=0,i=e.length;r<i;r++)if(t.call(n,e[r],r))return e[r];return null},arrayRemoveItem:function(e,t){var n=r.utils.arrayIndexOf(e,t);n>0?e.splice(n,1):n===0&&e.shift()},arrayGetDistinctValues:function(e){e=e||[];var t=[];for(var n=0,i=e.length;n<i;n++)r.utils.arrayIndexOf(t,e[n])<0&&t.push(e[n]);return t},arrayMap:function(e,t){e=e||[];var n=[];for(var r=0,i=e.length;r<i;r++)n.push(t(e[r],r));return n},arrayFilter:function(e,t){e=e||[];var n=[];for(var r=0,i=e.length;r<i;r++)t(e[r],r)&&n.push(e[r]);return n},arrayPushAll:function(e,t){if(t instanceof Array)e.push.apply(e,t);else for(var n=0,r=t.length;n<r;n++)e.push(t[n]);return e},addOrRemoveItem:function(e,t,n){var i=r.utils.arrayIndexOf(r.utils.peekObservable(e),t);i<0?n&&e.push(t):n||e.splice(i,1)},canSetPrototype:i,extend:t,setPrototypeOf:n,setPrototypeOfOrExtend:i?n:t,objectForEach:e,objectMap:function(e,t){if(!e)return e;var n={};for(var r in e)e.hasOwnProperty(r)&&(n[r]=t(e[r],r,e));return n},emptyDomNode:function(e){while(e.firstChild)r.removeNode(e.firstChild)},moveCleanedNodesToContainerElement:function(e){var t=r.utils.makeArray(e),n=t[0]&&t[0].ownerDocument||document,i=n.createElement("div");for(var s=0,o=t.length;s<o;s++)i.appendChild(r.cleanNode(t[s]));return i},cloneNodes:function(e,t){for(var n=0,i=e.length,s=[];n<i;n++){var o=e[n].cloneNode(!0);s.push(t?r.cleanNode(o):o)}return s},setDomNodeChildren:function(e,t){r.utils.emptyDomNode(e);if(t)for(var n=0,i=t.length;n<i;n++)e.appendChild(t[n])},replaceDomNodes:function(e,t){var n=e.nodeType?[e]:e;if(n.length>0){var i=n[0],s=i.parentNode;for(var o=0,u=t.length;o<u;o++)s.insertBefore(t[o],i);for(var o=0,u=n.length;o<u;o++)r.removeNode(n[o])}},fixUpContinuousNodeArray:function(e,t){if(e.length){t=t.nodeType===8&&t.parentNode||t;while(e.length&&e[0].parentNode!==t)e.splice(0,1);while(e.length>1&&e[e.length-1].parentNode!==t)e.length--;if(e.length>1){var n=e[0],r=e[e.length-1];e.length=0;while(n!==r)e.push(n),n=n.nextSibling;e.push(r)}}return e},setOptionNodeSelectionState:function(e,t){l<7?e.setAttribute("selected",t):e.selected=t},stringTrim:function(e){return e===null||e===undefined?"":e.trim?e.trim():e.toString().replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},stringStartsWith:function(e,t){return e=e||"",t.length>e.length?!1:e.substring(0,t.length)===t},domNodeIsContainedBy:function(e,t){if(e===t)return!0;if(e.nodeType===11)return!1;if(t.contains)return t.contains(e.nodeType===3?e.parentNode:e);if(t.compareDocumentPosition)return(t.compareDocumentPosition(e)&16)==16;while(e&&e!=t)e=e.parentNode;return!!e},domNodeIsAttachedToDocument:function(e){return r.utils.domNodeIsContainedBy(e,e.ownerDocument.documentElement)},anyDomNodeIsAttachedToDocument:function(e){return!!r.utils.arrayFirst(e,r.utils.domNodeIsAttachedToDocument)},tagNameLower:function(e){return e&&e.tagName&&e.tagName.toLowerCase()},catchFunctionErrors:function(e){return r.onError?function(){try{return e.apply(this,arguments)}catch(t){throw r.onError&&r.onError(t),t}}:e},setTimeout:function(e,t){return setTimeout(r.utils.catchFunctionErrors(e),t)},deferError:function(e){setTimeout(function(){throw r.onError&&r.onError(e),e},0)},registerEventHandler:function(e,t,n){var i=r.utils.catchFunctionErrors(n),s=l&&f[t];if(!r.options.useOnlyNativeEvents&&!s&&jQueryInstance)jQueryInstance(e).bind(t,i);else if(!s&&typeof e.addEventListener=="function")e.addEventListener(t,i,!1);else{if(typeof e.attachEvent=="undefined")throw new Error("Browser doesn't support addEventListener or attachEvent");var o=function(t){i.call(e,t)},u="on"+t;e.attachEvent(u,o),r.utils.domNodeDisposal.addDisposeCallback(e,function(){e.detachEvent(u,o)})}},triggerEvent:function(e,t){if(!e||!e.nodeType)throw new Error("element must be a DOM node when calling triggerEvent");var n=p(e,t);if(!r.options.useOnlyNativeEvents&&jQueryInstance&&!n)jQueryInstance(e).trigger(t);else if(typeof document.createEvent=="function"){if(typeof e.dispatchEvent!="function")throw new Error("The supplied element doesn't support dispatchEvent");var i=u[t]||"HTMLEvents",s=document.createEvent(i);s.initEvent(t,!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,e),e.dispatchEvent(s)}else if(n&&e.click)e.click();else{if(typeof e.fireEvent=="undefined")throw new Error("Browser doesn't support triggering events");e.fireEvent("on"+t)}},unwrapObservable:function(e){return r.isObservable(e)?e():e},peekObservable:function(e){return r.isObservable(e)?e.peek():e},toggleDomNodeCssClass:v,setTextContent:function(e,t){var n=r.utils.unwrapObservable(t);if(n===null||n===undefined)n="";var i=r.virtualElements.firstChild(e);!i||i.nodeType!=3||r.virtualElements.nextSibling(i)?r.virtualElements.setDomNodeChildren(e,[e.ownerDocument.createTextNode(n)]):i.data=n,r.utils.forceRefresh(e)},setElementName:function(e,t){e.name=t;if(l<=7)try{e.mergeAttributes(document.createElement("<input name='"+e.name+"'/>"),!1)}catch(n){}},forceRefresh:function(e){if(l>=9){var t=e.nodeType==1?e:e.parentNode;t.style&&(t.style.zoom=t.style.zoom)}},ensureSelectElementIsRenderedCorrectly:function(e){if(l){var t=e.style.width;e.style.width=0,e.style.width=t}},range:function(e,t){e=r.utils.unwrapObservable(e),t=r.utils.unwrapObservable(t);var n=[];for(var i=e;i<=t;i++)n.push(i);return n},makeArray:function(e){var t=[];for(var n=0,r=e.length;n<r;n++)t.push(e[n]);return t},createSymbolOrString:function(e){return s?Symbol(e):e},isIe6:c,isIe7:h,ieVersion:l,getFormFields:function(e,t){var n=r.utils.makeArray(e.getElementsByTagName("input")).concat(r.utils.makeArray(e.getElementsByTagName("textarea"))),i=typeof t=="string"?function(e){return e.name===t}:function(e){return t.test(e.name)},s=[];for(var o=n.length-1;o>=0;o--)i(n[o])&&s.push(n[o]);return s},parseJson:function(e){if(typeof e=="string"){e=r.utils.stringTrim(e);if(e)return JSON&&JSON.parse?JSON.parse(e):(new Function("return "+e))()}return null},stringifyJson:function(e,t,n){if(!JSON||!JSON.stringify)throw new Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js");return JSON.stringify(r.utils.unwrapObservable(e),t,n)},postJson:function(t,n,i){i=i||{};var s=i.params||{},o=i.includeFields||this.fieldsIncludedWithJsonPost,u=t;if(typeof t=="object"&&r.utils.tagNameLower(t)==="form"){var a=t;u=a.action;for(var f=o.length-1;f>=0;f--){var l=r.utils.getFormFields(a,o[f]);for(var c=l.length-1;c>=0;c--)s[l[c].name]=l[c].value}}n=r.utils.unwrapObservable(n);var h=document.createElement("form");h.style.display="none",h.action=u,h.method="post";for(var p in n){var d=document.createElement("input");d.type="hidden",d.name=p,d.value=r.utils.stringifyJson(r.utils.unwrapObservable(n[p])),h.appendChild(d)}e(s,function(e,t){var n=document.createElement("input");n.type="hidden",n.name=e,n.value=t,h.appendChild(n)}),document.body.appendChild(h),i.submitter?i.submitter(h):h.submit(),setTimeout(function(){h.parentNode.removeChild(h)},0)}}}(),r.exportSymbol("utils",r.utils),r.exportSymbol("utils.arrayForEach",r.utils.arrayForEach),r.exportSymbol("utils.arrayFirst",r.utils.arrayFirst),r.exportSymbol("utils.arrayFilter",r.utils.arrayFilter),r.exportSymbol("utils.arrayGetDistinctValues",r.utils.arrayGetDistinctValues),r.exportSymbol("utils.arrayIndexOf",r.utils.arrayIndexOf),r.exportSymbol("utils.arrayMap",r.utils.arrayMap),r.exportSymbol("utils.arrayPushAll",r.utils.arrayPushAll),r.exportSymbol("utils.arrayRemoveItem",r.utils.arrayRemoveItem),r.exportSymbol("utils.extend",r.utils.extend),r.exportSymbol("utils.fieldsIncludedWithJsonPost",r.utils.fieldsIncludedWithJsonPost),r.exportSymbol("utils.getFormFields",r.utils.getFormFields),r.exportSymbol("utils.peekObservable",r.utils.peekObservable),r.exportSymbol("utils.postJson",r.utils.postJson),r.exportSymbol("utils.parseJson",r.utils.parseJson),r.exportSymbol("utils.registerEventHandler",r.utils.registerEventHandler),r.exportSymbol("utils.stringifyJson",r.utils.stringifyJson),r.exportSymbol("utils.range",r.utils.range),r.exportSymbol("utils.toggleDomNodeCssClass",r.utils.toggleDomNodeCssClass),r.exportSymbol("utils.triggerEvent",r.utils.triggerEvent),r.exportSymbol("utils.unwrapObservable",r.utils.unwrapObservable),r.exportSymbol("utils.objectForEach",r.utils.objectForEach),r.exportSymbol("utils.addOrRemoveItem",r.utils.addOrRemoveItem),r.exportSymbol("utils.setTextContent",r.utils.setTextContent),r.exportSymbol("unwrap",r.utils.unwrapObservable),Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if(arguments.length===1)return function(){return t.apply(e,arguments)};var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice(0);return r.push.apply(r,arguments),t.apply(e,r)}}),r.utils.domData=new function(){function r(r,i){var s=r[t],o=s&&s!=="null"&&n[s];if(!o){if(!i)return undefined;s=r[t]="ko"+e++,n[s]={}}return n[s]}var e=0,t="__ko__"+(new Date).getTime(),n={};return{get:function(e,t){var n=r(e,!1);return n===undefined?undefined:n[t]},set:function(e,t,n){if(n===undefined&&r(e,!1)===undefined)return;var i=r(e,!0);i[t]=n},clear:function(e){var r=e[t];return r?(delete n[r],e[t]=null,!0):!1},nextKey:function(){return e++ +t}}},r.exportSymbol("utils.domData",r.utils.domData),r.exportSymbol("utils.domData.clear",r.utils.domData.clear),r.utils.domNodeDisposal=new function(){function i(t,n){var i=r.utils.domData.get(t,e);return i===undefined&&n&&(i=[],r.utils.domData.set(t,e,i)),i}function s(t){r.utils.domData.set(t,e,undefined)}function o(e){var t=i(e,!1);if(t){t=t.slice(0);for(var s=0;s<t.length;s++)t[s](e)}r.utils.domData.clear(e),r.utils.domNodeDisposal.cleanExternalData(e),n[e.nodeType]&&u(e)}function u(e){var t,n=e.firstChild;while(t=n)n=t.nextSibling,t.nodeType===8&&o(t)}var e=r.utils.domData.nextKey(),t={1:!0,8:!0,9:!0},n={1:!0,9:!0};return{addDisposeCallback:function(e,t){if(typeof t!="function")throw new Error("Callback must be a function");i(e,!0).push(t)},removeDisposeCallback:function(e,t){var n=i(e,!1);n&&(r.utils.arrayRemoveItem(n,t),n.length==0&&s(e))},cleanNode:function(e){if(t[e.nodeType]){o(e);if(n[e.nodeType]){var i=[];r.utils.arrayPushAll(i,e.getElementsByTagName("*"));for(var s=0,u=i.length;s<u;s++)o(i[s])}}return e},removeNode:function(e){r.cleanNode(e),e.parentNode&&e.parentNode.removeChild(e)},cleanExternalData:function(e){jQueryInstance&&typeof jQueryInstance["cleanData"]=="function"&&jQueryInstance.cleanData([e])}}},r.cleanNode=r.utils.domNodeDisposal.cleanNode,r.removeNode=r.utils.domNodeDisposal.removeNode,r.exportSymbol("cleanNode",r.cleanNode),r.exportSymbol("removeNode",r.removeNode),r.exportSymbol("utils.domNodeDisposal",r.utils.domNodeDisposal),r.exportSymbol("utils.domNodeDisposal.addDisposeCallback",r.utils.domNodeDisposal.addDisposeCallback),r.exportSymbol("utils.domNodeDisposal.removeDisposeCallback",r.utils.domNodeDisposal.removeDisposeCallback),function(){function a(t){var n=t.match(/^<([a-z]+)[ >]/);return n&&o[n[1]]||e}function f(e,t){t||(t=document);var n=t.parentWindow||t.defaultView||window,i=r.utils.stringTrim(e).toLowerCase(),s=t.createElement("div"),o=a(i),f=o[0],l="ignored<div>"+o[1]+e+o[2]+"</div>";typeof n["innerShiv"]=="function"?s.appendChild(n.innerShiv(l)):(u&&t.appendChild(s),s.innerHTML=l,u&&s.parentNode.removeChild(s));while(f--)s=s.lastChild;return r.utils.makeArray(s.lastChild.childNodes)}function l(e,t){if(jQueryInstance.parseHTML)return jQueryInstance.parseHTML(e,t)||[];var n=jQueryInstance.clean([e],t);if(n&&n[0]){var r=n[0];while(r.parentNode&&r.parentNode.nodeType!==11)r=r.parentNode;r.parentNode&&r.parentNode.removeChild(r)}return n}var e=[0,"",""],t=[1,"<table>","</table>"],n=[2,"<table><tbody>","</tbody></table>"],i=[3,"<table><tbody><tr>","</tr></tbody></table>"],s=[1,"<select multiple='multiple'>","</select>"],o={thead:t,tbody:t,tfoot:t,tr:n,td:i,th:i,option:s,optgroup:s},u=r.utils.ieVersion<=8;r.utils.parseHtmlFragment=function(e,t){return jQueryInstance?l(e,t):f(e,t)},r.utils.setHtml=function(e,t){r.utils.emptyDomNode(e),t=r.utils.unwrapObservable(t);if(t!==null&&t!==undefined){typeof t!="string"&&(t=t.toString());if(jQueryInstance)jQueryInstance(e).html(t);else{var n=r.utils.parseHtmlFragment(t,e.ownerDocument);for(var i=0;i<n.length;i++)e.appendChild(n[i])}}}}(),r.exportSymbol("utils.parseHtmlFragment",r.utils.parseHtmlFragment),r.exportSymbol("utils.setHtml",r.utils.setHtml),r.memoization=function(){function t(){return((1+Math.random())*4294967296|0).toString(16).substring(1)}function n(){return t()+t()}function i(e,t){if(!e)return;if(e.nodeType==8){var n=r.memoization.parseMemoText(e.nodeValue);n!=null&&t.push({domNode:e,memoId:n})}else if(e.nodeType==1)for(var s=0,o=e.childNodes,u=o.length;s<u;s++)i(o[s],t)}var e={};return{memoize:function(t){if(typeof t!="function")throw new Error("You can only pass a function to ko.memoization.memoize()");var r=n();return e[r]=t,"<!--[ko_memo:"+r+"]-->"},unmemoize:function(t,n){var r=e[t];if(r===undefined)throw new Error("Couldn't find any memo with ID "+t+". Perhaps it's already been unmemoized.");try{return r.apply(null,n||[]),!0}finally{delete e[t]}},unmemoizeDomNodeAndDescendants:function(e,t){var n=[];i(e,n);for(var s=0,o=n.length;s<o;s++){var u=n[s].domNode,a=[u];t&&r.utils.arrayPushAll(a,t),r.memoization.unmemoize(n[s].memoId,a),u.nodeValue="",u.parentNode&&u.parentNode.removeChild(u)}},parseMemoText:function(e){var t=e.match(/^\[ko_memo\:(.*?)\]$/);return t?t[1]:null}}}(),r.exportSymbol("memoization",r.memoization),r.exportSymbol("memoization.memoize",r.memoization.memoize),r.exportSymbol("memoization.unmemoize",r.memoization.unmemoize),r.exportSymbol("memoization.parseMemoText",r.memoization.parseMemoText),r.exportSymbol("memoization.unmemoizeDomNodeAndDescendants",r.memoization.unmemoizeDomNodeAndDescendants),r.tasks=function(){function o(){if(n){var e=n,i=0;for(var o;s<n;)if(o=t[s++]){if(s>e){if(++i>=5e3){s=n,r.utils.deferError(Error("'Too much recursion' after processing "+i+" task groups."));break}e=n}try{o()}catch(u){r.utils.deferError(u)}}}}function u(){o(),s=n=t.length=0}function a(){r.tasks.scheduler(u)}var e,t=[],n=0,i=1,s=0;window.MutationObserver?e=function(e){var t=document.createElement("div");return(new MutationObserver(e)).observe(t,{attributes:!0}),function(){t.classList.toggle("foo")}}(u):document&&"onreadystatechange"in document.createElement("script")?e=function(e){var t=document.createElement("script");t.onreadystatechange=function(){t.onreadystatechange=null,document.documentElement.removeChild(t),t=null,e()},document.documentElement.appendChild(t)}:e=function(e){setTimeout(e,0)};var f={scheduler:e,schedule:function(e){return n||a(),t[n++]=e,i++},cancel:function(e){var r=e-(i-n);r>=s&&r<n&&(t[r]=null)},resetForTesting:function(){var e=n-s;return s=n=t.length=0,e},runEarly:o};return f}(),r.exportSymbol("tasks",r.tasks),r.exportSymbol("tasks.schedule",r.tasks.schedule),r.exportSymbol("tasks.runEarly",r.tasks.runEarly),r.extenders={throttle:function(e,t){e.throttleEvaluation=t;var n=null;return r.dependentObservable({read:e,write:function(i){clearTimeout(n),n=r.utils.setTimeout(function(){e(i)},t)}})},rateLimit:function(e,t){var n,r,i;typeof t=="number"?n=t:(n=t.timeout,r=t.method),e._deferUpdates=!1,i=r=="notifyWhenChangesStop"?u:o,e.limit(function(e){return i(e,n)})},deferred:function(e,t){if(t!==!0)throw new Error("The 'deferred' extender only accepts the value 'true', because it is not supported to turn deferral off once enabled.");e._deferUpdates||(e._deferUpdates=!0,e.limit(function(t){var n;return function(){r.tasks.cancel(n),n=r.tasks.schedule(t),e.notifySubscribers(undefined,"dirty")}}))},notify:function(e,t){e.equalityComparer=t=="always"?null:s}};var i={"undefined":1,"boolean":1,number:1,string:1};r.exportSymbol("extenders",r.extenders),r.subscription=function(e,t,n){this._target=e,this.callback=t,this.disposeCallback=n,this.isDisposed=!1,r.exportProperty(this,"dispose",this.dispose)},r.subscription.prototype.dispose=function(){this.isDisposed=!0,this.disposeCallback()},r.subscribable=function(){r.utils.setPrototypeOfOrExtend(this,c),c.init(this)};var f="change",c={init:function(e){e._subscriptions={},e._versionNumber=1},subscribe:function(e,t,n){var i=this;n=n||f;var s=t?e.bind(t):e,o=new r.subscription(i,s,function(){r.utils.arrayRemoveItem(i._subscriptions[n],o),i.afterSubscriptionRemove&&i.afterSubscriptionRemove(n)});return i.beforeSubscriptionAdd&&i.beforeSubscriptionAdd(n),i._subscriptions[n]||(i._subscriptions[n]=[]),i._subscriptions[n].push(o),o},notifySubscribers:function(e,t){t=t||f,t===f&&this.updateVersion();if(this.hasSubscriptionsForEvent(t))try{r.dependencyDetection.begin();for(var n=this._subscriptions[t].slice(0),i=0,s;s=n[i];++i)s.isDisposed||s.callback(e)}finally{r.dependencyDetection.end()}},getVersion:function(){return this._versionNumber},hasChanged:function(e){return this.getVersion()!==e},updateVersion:function(){++this._versionNumber},limit:function(e){var t=this,n=r.isObservable(t),i,s,o,u="beforeChange";t._origNotifySubscribers||(t._origNotifySubscribers=t.notifySubscribers,t.notifySubscribers=l);var a=e(function(){t._notificationIsPending=!1,n&&o===t&&(o=t()),i=!1,t.isDifferent(s,o)&&t._origNotifySubscribers(s=o)});t._limitChange=function(e){t._notificationIsPending=i=!0,o=e,a()},t._limitBeforeChange=function(e){i||(s=e,t._origNotifySubscribers(e,u))}},hasSubscriptionsForEvent:function(e){return this._subscriptions[e]&&this._subscriptions[e].length},getSubscriptionsCount:function(e){if(e)return this._subscriptions[e]&&this._subscriptions[e].length||0;var t=0;return r.utils.objectForEach(this._subscriptions,function(e,n){e!=="dirty"&&(t+=n.length)}),t},isDifferent:function(e,t){return!this.equalityComparer||!this.equalityComparer(e,t)},extend:a};r.exportProperty(c,"subscribe",c.subscribe),r.exportProperty(c,"extend",c.extend),r.exportProperty(c,"getSubscriptionsCount",c.getSubscriptionsCount),r.utils.canSetPrototype&&r.utils.setPrototypeOf(c,Function.prototype),r.subscribable.fn=c,r.isSubscribable=function(e){return e!=null&&typeof e.subscribe=="function"&&typeof e["notifySubscribers"]=="function"},r.exportSymbol("subscribable",r.subscribable),r.exportSymbol("isSubscribable",r.isSubscribable),r.computedContext=r.dependencyDetection=function(){function i(){return++n}function s(n){e.push(t),t=n}function o(){t=e.pop()}var e=[],t,n=0;return{begin:s,end:o,registerDependency:function(e){if(t){if(!r.isSubscribable(e))throw new Error("Only subscribable things can act as dependencies");t.callback.call(t.callbackTarget,e,e._id||(e._id=i()))}},ignore:function(e,t,n){try{return s(),e.apply(t,n||[])}finally{o()}},getDependenciesCount:function(){if(t)return t.computed.getDependenciesCount()},isInitial:function(){if(t)return t.isInitial}}}(),r.exportSymbol("computedContext",r.computedContext),r.exportSymbol("computedContext.getDependenciesCount",r.computedContext.getDependenciesCount),r.exportSymbol("computedContext.isInitial",r.computedContext.isInitial),r.exportSymbol("ignoreDependencies",r.ignoreDependencies=r.dependencyDetection.ignore);var h=r.utils.createSymbolOrString("_latestValue");r.observable=function(e){function t(){return arguments.length>0?(t.isDifferent(t[h],arguments[0])&&(t.valueWillMutate(),t[h]=arguments[0],t.valueHasMutated()),this):(r.dependencyDetection.registerDependency(t),t[h])}return t[h]=e,r.utils.canSetPrototype||r.utils.extend(t,r.subscribable.fn),r.subscribable.fn.init(t),r.utils.setPrototypeOfOrExtend(t,p),r.options.deferUpdates&&r.extenders.deferred(t,!0),t};var p={equalityComparer:s,peek:function(){return this[h]},valueHasMutated:function(){this.notifySubscribers(this[h])},valueWillMutate:function(){this.notifySubscribers(this[h],"beforeChange")}};r.utils.canSetPrototype&&r.utils.setPrototypeOf(p,r.subscribable.fn);var d=r.observable.protoProperty="__ko_proto__";p[d]=r.observable,r.hasPrototype=function(e,t){return e===null||e===undefined||e[d]===undefined?!1:e[d]===t?!0:r.hasPrototype(e[d],t)},r.isObservable=function(e){return r.hasPrototype(e,r.observable)},r.isWriteableObservable=function(e){return typeof e=="function"&&e[d]===r.observable?!0:typeof e=="function"&&e[d]===r.dependentObservable&&e.hasWriteFunction?!0:!1},r.exportSymbol("observable",r.observable),r.exportSymbol("isObservable",r.isObservable),r.exportSymbol("isWriteableObservable",r.isWriteableObservable),r.exportSymbol("isWritableObservable",r.isWriteableObservable),r.exportSymbol("observable.fn",p),r.exportProperty(p,"peek",p.peek),r.exportProperty(p,"valueHasMutated",p.valueHasMutated),r.exportProperty(p,"valueWillMutate",p.valueWillMutate),r.observableArray=function(e){e=e||[];if(typeof e=="object"&&"length"in e){var t=r.observable(e);return r.utils.setPrototypeOfOrExtend(t,r.observableArray.fn),t.extend({trackArrayChanges:!0})}throw new Error("The argument passed when initializing an observable array must be an array, or null, or undefined.")},r.observableArray.fn={remove:function(e){var t=this.peek(),n=[],i=typeof e=="function"&&!r.isObservable(e)?e:function(t){return t===e};for(var s=0;s<t.length;s++){var o=t[s];i(o)&&(n.length===0&&this.valueWillMutate(),n.push(o),t.splice(s,1),s--)}return n.length&&this.valueHasMutated(),n},removeAll:function(e){if(e===undefined){var t=this.peek(),n=t.slice(0);return this.valueWillMutate(),t.splice(0,t.length),this.valueHasMutated(),n}return e?this.remove(function(t){return r.utils.arrayIndexOf(e,t)>=0}):[]},destroy:function(e){var t=this.peek(),n=typeof e=="function"&&!r.isObservable(e)?e:function(t){return t===e};this.valueWillMutate();for(var i=t.length-1;i>=0;i--){var s=t[i];n(s)&&(t[i]._destroy=!0)}this.valueHasMutated()},destroyAll:function(e){return e===undefined?this.destroy(function(){return!0}):e?this.destroy(function(t){return r.utils.arrayIndexOf(e,t)>=0}):[]},indexOf:function(e){var t=this();return r.utils.arrayIndexOf(t,e)},replace:function(e,t){var n=this.indexOf(e);n>=0&&(this.valueWillMutate(),this.peek()[n]=t,this.valueHasMutated())}},r.utils.canSetPrototype&&r.utils.setPrototypeOf(r.observableArray.fn,r.observable.fn),r.utils.arrayForEach(["pop","push","reverse","shift","sort","splice","unshift"],function(e){r.observableArray.fn[e]=function(){var t=this.peek();this.valueWillMutate(),this.cacheDiffForKnownOperation(t,e,arguments);var n=t[e].apply(t,arguments);return this.valueHasMutated(),n===t?this:n}}),r.utils.arrayForEach(["slice"],function(e){r.observableArray.fn[e]=function(){var t=this();return t[e].apply(t,arguments)}}),r.exportSymbol("observableArray",r.observableArray);var v="arrayChange";r.extenders.trackArrayChanges=function(e,t){function l(){if(n)return;n=!0;var t=e.notifySubscribers;e.notifySubscribers=function(e,n){return(!n||n===f)&&++o,t.apply(this,arguments)};var r=[].concat(e.peek()||[]);i=null,s=e.subscribe(function(t){t=[].concat(t||[]);if(e.hasSubscriptionsForEvent(v))var n=c(r,t);r=t,i=null,o=0,n&&n.length&&e.notifySubscribers(n,v)})}function c(t,n){if(!i||o>1)i=r.utils.compareArrays(t,n,e.compareArrayOptions);return i}e.compareArrayOptions={},t&&typeof t=="object"&&r.utils.extend(e.compareArrayOptions,t),e.compareArrayOptions.sparse=!0;if(e.cacheDiffForKnownOperation)return;var n=!1,i=null,s,o=0,u=e.beforeSubscriptionAdd,a=e.afterSubscriptionRemove;e.beforeSubscriptionAdd=function(t){u&&u.call(e,t),t===v&&l()},e.afterSubscriptionRemove=function(t){a&&a.call(e,t),t===v&&!e.hasSubscriptionsForEvent(v)&&(s.dispose(),n=!1)},e.cacheDiffForKnownOperation=function(e,t,s){function c(e,t,n){return u[u.length]={status:e,value:t,index:n}}if(!n||o)return;var u=[],a=e.length,f=s.length,l=0;switch(t){case"push":l=a;case"unshift":for(var h=0;h<f;h++)c("added",s[h],l+h);break;case"pop":l=a-1;case"shift":a&&c("deleted",e[l],l);break;case"splice":var p=Math.min(Math.max(0,s[0]<0?a+s[0]:s[0]),a),d=f===1?a:Math.min(p+(s[1]||0),a),v=p+f-2,m=Math.max(d,v),g=[],y=[];for(var h=p,b=2;h<m;++h,++b)h<d&&y.push(c("deleted",e[h],h)),h<v&&g.push(c("added",s[b],h));r.utils.findMovesInArrayComparison(y,g);break;default:return}i=u}};var m=r.utils.createSymbolOrString("_state");r.computed=r.dependentObservable=function(e,t,n){function o(){if(arguments.length>0){if(typeof i!="function")throw new Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.");return i.apply(s.evaluatorFunctionTarget,arguments),this}return r.dependencyDetection.registerDependency(o),(s.isStale||s.isSleeping&&o.haveDependenciesChanged())&&o.evaluateImmediate(),s.latestValue}typeof e=="object"?n=e:(n=n||{},e&&(n.read=e));if(typeof n["read"]!="function")throw Error("Pass a function that returns the value of the ko.computed");var i=n.write,s={latestValue:undefined,isStale:!0,isBeingEvaluated:!1,suppressDisposalUntilDisposeWhenReturnsFalse:!1,isDisposed:!1,pure:!1,isSleeping:!1,readFunction:n.read,evaluatorFunctionTarget:t||n.owner,disposeWhenNodeIsRemoved:n.disposeWhenNodeIsRemoved||n.disposeWhenNodeIsRemoved||null,disposeWhen:n.disposeWhen||n.disposeWhen,domNodeDisposalCallback:null,dependencyTracking:{},dependenciesCount:0,evaluationTimeoutInstance:null};return o[m]=s,o.hasWriteFunction=typeof i=="function",r.utils.canSetPrototype||r.utils.extend(o,r.subscribable.fn),r.subscribable.fn.init(o),r.utils.setPrototypeOfOrExtend(o,b),n.pure?(s.pure=!0,s.isSleeping=!0,r.utils.extend(o,w)):n.deferEvaluation&&r.utils.extend(o,E),r.options.deferUpdates&&r.extenders.deferred(o,!0),DEBUG&&(o._options=n),s.disposeWhenNodeIsRemoved&&(s.suppressDisposalUntilDisposeWhenReturnsFalse=!0,s.disposeWhenNodeIsRemoved.nodeType||(s.disposeWhenNodeIsRemoved=null)),!s.isSleeping&&!n.deferEvaluation&&o.evaluateImmediate(),s.disposeWhenNodeIsRemoved&&o.isActive()&&r.utils.domNodeDisposal.addDisposeCallback(s.disposeWhenNodeIsRemoved,s.domNodeDisposalCallback=function(){o.dispose()}),o};var b={equalityComparer:s,getDependenciesCount:function(){return this[m].dependenciesCount},addDependencyTracking:function(e,t,n){if(this[m].pure&&t===this)throw Error("A 'pure' computed must not be called recursively");this[m].dependencyTracking[e]=n,n._order=this[m].dependenciesCount++,n._version=t.getVersion()},haveDependenciesChanged:function(){var e,t,n=this[m].dependencyTracking;for(e in n)if(n.hasOwnProperty(e)){t=n[e];if(t._target.hasChanged(t._version))return!0}},markDirty:function(){this._evalDelayed&&!this[m].isBeingEvaluated&&this._evalDelayed()},isActive:function(){return this[m].isStale||this[m].dependenciesCount>0},respondToChange:function(){this._notificationIsPending||this.evaluatePossiblyAsync()},subscribeToDependency:function(e){if(e._deferUpdates&&!this[m].disposeWhenNodeIsRemoved){var t=e.subscribe(this.markDirty,this,"dirty"),n=e.subscribe(this.respondToChange,this);return{_target:e,dispose:function(){t.dispose(),n.dispose()}}}return e.subscribe(this.evaluatePossiblyAsync,this)},evaluatePossiblyAsync:function(){var e=this,t=e.throttleEvaluation;t&&t>=0?(clearTimeout(this[m].evaluationTimeoutInstance),this[m].evaluationTimeoutInstance=r.utils.setTimeout(function(){e.evaluateImmediate(!0)},t)):e._evalDelayed?e._evalDelayed():e.evaluateImmediate(!0)},evaluateImmediate:function(e){var t=this,n=t[m],i=n.disposeWhen;if(n.isBeingEvaluated)return;if(n.isDisposed)return;if(n.disposeWhenNodeIsRemoved&&!r.utils.domNodeIsAttachedToDocument(n.disposeWhenNodeIsRemoved)||i&&i()){if(!n.suppressDisposalUntilDisposeWhenReturnsFalse){t.dispose();return}}else n.suppressDisposalUntilDisposeWhenReturnsFalse=!1;n.isBeingEvaluated=!0;try{this.evaluateImmediate_CallReadWithDependencyDetection(e)}finally{n.isBeingEvaluated=!1}n.dependenciesCount||t.dispose()},evaluateImmediate_CallReadWithDependencyDetection:function(e){var t=this,n=t[m],i=n.pure?undefined:!n.dependenciesCount,s={computedObservable:t,disposalCandidates:n.dependencyTracking,disposalCount:n.dependenciesCount};r.dependencyDetection.begin({callbackTarget:s,callback:y,computed:t,isInitial:i}),n.dependencyTracking={},n.dependenciesCount=0;var o=this.evaluateImmediate_CallReadThenEndDependencyDetection(n,s);t.isDifferent(n.latestValue,o)&&(n.isSleeping||t.notifySubscribers(n.latestValue,"beforeChange"),n.latestValue=o,n.isSleeping?t.updateVersion():e&&t.notifySubscribers(n.latestValue)),i&&t.notifySubscribers(n.latestValue,"awake")},evaluateImmediate_CallReadThenEndDependencyDetection:function(e,t){try{var n=e.readFunction;return e.evaluatorFunctionTarget?n.call(e.evaluatorFunctionTarget):n()}finally{r.dependencyDetection.end(),t.disposalCount&&!e.isSleeping&&r.utils.objectForEach(t.disposalCandidates,g),e.isStale=!1}},peek:function(){var e=this[m];return(e.isStale&&!e.dependenciesCount||e.isSleeping&&this.haveDependenciesChanged())&&this.evaluateImmediate(),e.latestValue},limit:function(e){r.subscribable.fn.limit.call(this,e),this._evalDelayed=function(){this._limitBeforeChange(this[m].latestValue),this[m].isStale=!0,this._limitChange(this)}},dispose:function(){var e=this[m];!e.isSleeping&&e.dependencyTracking&&r.utils.objectForEach(e.dependencyTracking,function(e,t){t.dispose&&t.dispose()}),e.disposeWhenNodeIsRemoved&&e.domNodeDisposalCallback&&r.utils.domNodeDisposal.removeDisposeCallback(e.disposeWhenNodeIsRemoved,e.domNodeDisposalCallback),e.dependencyTracking=null,e.dependenciesCount=0,e.isDisposed=!0,e.isStale=!1,e.isSleeping=!1,e.disposeWhenNodeIsRemoved=null}},w={beforeSubscriptionAdd:function(e){var t=this,n=t[m];if(!n.isDisposed&&n.isSleeping&&e=="change"){n.isSleeping=!1;if(n.isStale||t.haveDependenciesChanged())n.dependencyTracking=null,n.dependenciesCount=0,n.isStale=!0,t.evaluateImmediate();else{var i=[];r.utils.objectForEach(n.dependencyTracking,function(e,t){i[t._order]=e}),r.utils.arrayForEach(i,function(e,r){var i=n.dependencyTracking[e],s=t.subscribeToDependency(i._target);s._order=r,s._version=i._version,n.dependencyTracking[e]=s})}n.isDisposed||t.notifySubscribers(n.latestValue,"awake")}},afterSubscriptionRemove:function(e){var t=this[m];!t.isDisposed&&e=="change"&&!this.hasSubscriptionsForEvent("change")&&(r.utils.objectForEach(t.dependencyTracking,function(e,n){n.dispose&&(t.dependencyTracking[e]={_target:n._target,_order:n._order,_version:n._version},n.dispose())}),t.isSleeping=!0,this.notifySubscribers(undefined,"asleep"))},getVersion:function(){var e=this[m];return e.isSleeping&&(e.isStale||this.haveDependenciesChanged())&&this.evaluateImmediate(),r.subscribable.fn.getVersion.call(this)}},E={beforeSubscriptionAdd:function(e){(e=="change"||e=="beforeChange")&&this.peek()}};r.utils.canSetPrototype&&r.utils.setPrototypeOf(b,r.subscribable.fn);var S=r.observable.protoProperty;r.computed[S]=r.observable,b[S]=r.computed,r.isComputed=function(e){return r.hasPrototype(e,r.computed)},r.isPureComputed=function(e){return r.hasPrototype(e,r.computed)&&e[m]&&e[m].pure},r.exportSymbol("computed",r.computed),r.exportSymbol("dependentObservable",r.computed),r.exportSymbol("isComputed",r.isComputed),r.exportSymbol("isPureComputed",r.isPureComputed),r.exportSymbol("computed.fn",b),r.exportProperty(b,"peek",b.peek),r.exportProperty(b,"dispose",b.dispose),r.exportProperty(b,"isActive",b.isActive),r.exportProperty(b,"getDependenciesCount",b.getDependenciesCount),r.pureComputed=function(e,t){return typeof e=="function"?r.computed(e,t,{pure:!0}):(e=r.utils.extend({},e),e.pure=!0,r.computed(e,t))},r.exportSymbol("pureComputed",r.pureComputed),function(){function t(e,r,s){s=s||new i,e=r(e);var o=typeof e=="object"&&e!==null&&e!==undefined&&!(e instanceof RegExp)&&!(e instanceof Date)&&!(e instanceof String)&&!(e instanceof Number)&&!(e instanceof Boolean);if(!o)return e;var u=e instanceof Array?[]:{};return s.save(e,u),n(e,function(n){var i=r(e[n]);switch(typeof i){case"boolean":case"number":case"string":case"function":u[n]=i;break;case"object":case"undefined":var o=s.get(i);u[n]=o!==undefined?o:t(i,r,s)}}),u}function n(e,t){if(e instanceof Array){for(var n=0;n<e.length;n++)t(n);typeof e["toJSON"]=="function"&&t("toJSON")}else for(var r in e)t(r)}function i(){this.keys=[],this.values=[]}var e=10;r.toJS=function(n){if(arguments.length==0)throw new Error("When calling ko.toJS, pass the object you want to convert.");return t(n,function(t){for(var n=0;r.isObservable(t)&&n<e;n++)t=t();return t})},r.toJSON=function(e,t,n){var i=r.toJS(e);return r.utils.stringifyJson(i,t,n)},i.prototype={constructor:i,save:function(e,t){var n=r.utils.arrayIndexOf(this.keys,e);n>=0?this.values[n]=t:(this.keys.push(e),this.values.push(t))},get:function(e){var t=r.utils.arrayIndexOf(this.keys,e);return t>=0?this.values[t]:undefined}}}(),r.exportSymbol("toJS",r.toJS),r.exportSymbol("toJSON",r.toJSON),function(){var e="__ko__hasDomDataOptionValue__";r.selectExtensions={readValue:function(t){switch(r.utils.tagNameLower(t)){case"option":if(t[e]===!0)return r.utils.domData.get(t,r.bindingHandlers.options.optionValueDomDataKey);return r.utils.ieVersion<=7?t.getAttributeNode("value")&&t.getAttributeNode("value").specified?t.value:t.text:t.value;case"select":return t.selectedIndex>=0?r.selectExtensions.readValue(t.options[t.selectedIndex]):undefined;default:return t.value}},writeValue:function(t,n,i){switch(r.utils.tagNameLower(t)){case"option":switch(typeof n){case"string":r.utils.domData.set(t,r.bindingHandlers.options.optionValueDomDataKey,undefined),e in t&&delete t[e],t.value=n;break;default:r.utils.domData.set(t,r.bindingHandlers.options.optionValueDomDataKey,n),t[e]=!0,t.value=typeof n=="number"?n:""}break;case"select":if(n===""||n===null)n=undefined;var s=-1;for(var o=0,u=t.options.length,a;o<u;++o){a=r.selectExtensions.readValue(t.options[o]);if(a==n||a==""&&n===undefined){s=o;break}}if(i||s>=0||n===undefined&&t.size>1)t.selectedIndex=s;break;default:if(n===null||n===undefined)n="";t.value=n}}}}(),r.exportSymbol("selectExtensions",r.selectExtensions),r.exportSymbol("selectExtensions.readValue",r.selectExtensions.readValue),r.exportSymbol("selectExtensions.writeValue",r.selectExtensions.writeValue),r.expressionRewriting=function(){function n(n){if(r.utils.arrayIndexOf(e,n)>=0)return!1;var i=n.match(t);return i===null?!1:i[1]?"Object("+i[1]+")"+i[2]:n}function p(e){var t=r.utils.stringTrim(e);t.charCodeAt(0)===123&&(t=t.slice(1,-1));var n=[],i=t.match(l),s,o=[],u=0;if(i){i.push(",");for(var a=0,f;f=i[a];++a){var p=f.charCodeAt(0);if(p===44){if(u<=0){n.push(s&&o.length?{key:s,value:o.join("")}:{unknown:s||o.join("")}),s=u=0,o=[];continue}}else if(p===58){if(!u&&!s&&o.length===1){s=o.pop();continue}}else if(p===47&&a&&f.length>1){var d=i[a-1].match(c);d&&!h[d[0]]&&(t=t.substr(t.indexOf(f)+1),i=t.match(l),i.push(","),a=-1,f="/")}else p===40||p===123||p===91?++u:p===41||p===125||p===93?--u:!s&&!o.length&&(p===34||p===39)&&(f=f.slice(1,-1));o.push(f)}}return n}function v(e,t){function i(e,t){function l(n){return n&&n.preprocess?t=n.preprocess(t,e,i):!0}var f;if(!a){if(!l(r.getBindingHandler(e)))return;d[e]&&(f=n(t))&&o.push("'"+e+"':function(_z){"+f+"=_z}")}u&&(t="function(){return "+t+" }"),s.push("'"+e+"':"+t)}t=t||{};var s=[],o=[],u=t.valueAccessors,a=t.bindingParams,f=typeof e=="string"?p(e):e;return r.utils.arrayForEach(f,function(e){i(e.key||e.unknown,e.value)}),o.length&&i("_ko_property_writers","{"+o.join(",")+" }"),s.join(",")}var e=["true","false","null","undefined"],t=/^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i,i='"(?:[^"\\\\]|\\\\.)*"',s="'(?:[^'\\\\]|\\\\.)*'",o="/(?:[^/\\\\]|\\\\.)*/w*",u=",\"'{}()/:[\\]",a="[^\\s:,/][^"+u+"]*[^\\s"+u+"]",f="[^\\s]",l=RegExp(i+"|"+s+"|"+o+"|"+a+"|"+f,"g"),c=/[\])"'A-Za-z0-9_$]+$/,h={"in":1,"return":1,"typeof":1},d={};return{bindingRewriteValidators:[],twoWayBindings:d,parseObjectLiteral:p,preProcessBindings:v,keyValueArrayContainsKey:function(e,t){for(var n=0;n<e.length;n++)if(e[n]["key"]==t)return!0;return!1},writeValueToProperty:function(e,t,n,i,s){if(!e||!r.isObservable(e)){var o=t.get("_ko_property_writers");o&&o[n]&&o[n](i)}else r.isWriteableObservable(e)&&(!s||e.peek()!==i)&&e(i)}}}(),r.exportSymbol("expressionRewriting",r.expressionRewriting),r.exportSymbol("expressionRewriting.bindingRewriteValidators",r.expressionRewriting.bindingRewriteValidators),r.exportSymbol("expressionRewriting.parseObjectLiteral",r.expressionRewriting.parseObjectLiteral),r.exportSymbol("expressionRewriting.preProcessBindings",r.expressionRewriting.preProcessBindings),r.exportSymbol("expressionRewriting._twoWayBindings",r.expressionRewriting.twoWayBindings),r.exportSymbol("jsonExpressionRewriting",r.expressionRewriting),r.exportSymbol("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",r.expressionRewriting.preProcessBindings),function(){function s(n){return n.nodeType==8&&t.test(e?n.text:n.nodeValue)}function o(t){return t.nodeType==8&&n.test(e?t.text:t.nodeValue)}function u(e,t){var n=e,r=1,i=[];while(n=n.nextSibling){if(o(n)){r--;if(r===0)return i}i.push(n),s(n)&&r++}if(!t)throw new Error("Cannot find closing comment tag to match: "+e.nodeValue);return null}function a(e,t){var n=u(e,t);return n?n.length>0?n[n.length-1].nextSibling:e.nextSibling:null}function f(e){var t=e.firstChild,n=null;if(t)do if(n)n.push(t);else if(s(t)){var r=a(t,!0);r?t=r:n=[t]}else o(t)&&(n=[t]);while(t=t.nextSibling);return n}var e=document&&document.createComment("test").text==="<!--test-->",t=e?/^<!--\s*ko(?:\s+([\s\S]+))?\s*-->$/:/^\s*ko(?:\s+([\s\S]+))?\s*$/,n=e?/^<!--\s*\/ko\s*-->$/:/^\s*\/ko\s*$/,i={ul:!0,ol:!0};r.virtualElements={allowedBindings:{},childNodes:function(e){return s(e)?u(e):e.childNodes},emptyNode:function(e){if(!s(e))r.utils.emptyDomNode(e);else{var t=r.virtualElements.childNodes(e);for(var n=0,i=t.length;n<i;n++)r.removeNode(t[n])}},setDomNodeChildren:function(e,t){if(!s(e))r.utils.setDomNodeChildren(e,t);else{r.virtualElements.emptyNode(e);var n=e.nextSibling;for(var i=0,o=t.length;i<o;i++)n.parentNode.insertBefore(t[i],n)}},prepend:function(e,t){s(e)?e.parentNode.insertBefore(t,e.nextSibling):e.firstChild?e.insertBefore(t,e.firstChild):e.appendChild(t)},insertAfter:function(e,t,n){n?s(e)?e.parentNode.insertBefore(t,n.nextSibling):n.nextSibling?e.insertBefore(t,n.nextSibling):e.appendChild(t):r.virtualElements.prepend(e,t)},firstChild:function(e){return s(e)?!e.nextSibling||o(e.nextSibling)?null:e.nextSibling:e.firstChild},nextSibling:function(e){return s(e)&&(e=a(e)),e.nextSibling&&o(e.nextSibling)?null:e.nextSibling},hasBindingValue:s,virtualNodeBindingValue:function(n){var r=(e?n.text:n.nodeValue).match(t);return r?r[1]:null},normaliseVirtualElementDomStructure:function(e){if(!i[r.utils.tagNameLower(e)])return;var t=e.firstChild;if(t)do if(t.nodeType===1){var n=f(t);if(n){var s=t.nextSibling;for(var o=0;o<n.length;o++)s?e.insertBefore(n[o],s):e.appendChild(n[o])}}while(t=t.nextSibling)}}}(),r.exportSymbol("virtualElements",r.virtualElements),r.exportSymbol("virtualElements.allowedBindings",r.virtualElements.allowedBindings),r.exportSymbol("virtualElements.emptyNode",r.virtualElements.emptyNode),r.exportSymbol("virtualElements.insertAfter",r.virtualElements.insertAfter),r.exportSymbol("virtualElements.prepend",r.virtualElements.prepend),r.exportSymbol("virtualElements.setDomNodeChildren",r.virtualElements.setDomNodeChildren),function(){function t(e,t,r){var i=e+(r&&r.valueAccessors||"");return t[i]||(t[i]=n(e,r))}function n(e,t){var n=r.expressionRewriting.preProcessBindings(e,t),i="with($context){with($data||{}){return{"+n+"}}}";return new Function("$context","$element",i)}var e="data-bind";r.bindingProvider=function(){this.bindingCache={}},r.utils.extend(r.bindingProvider.prototype,{nodeHasBindings:function(t){switch(t.nodeType){case 1:return t.getAttribute(e)!=null||r.components.getComponentNameForNode(t);case 8:return r.virtualElements.hasBindingValue(t);default:return!1}},getBindings:function(e,t){var n=this.getBindingsString(e,t),i=n?this.parseBindingsString(n,t,e):null;return r.components.addBindingsForCustomElement(i,e,t,!1)},getBindingAccessors:function(e,t){var n=this.getBindingsString(e,t),i=n?this.parseBindingsString(n,t,e,{valueAccessors:!0}):null;return r.components.addBindingsForCustomElement(i,e,t,!0)},getBindingsString:function(t,n){switch(t.nodeType){case 1:return t.getAttribute(e);case 8:return r.virtualElements.virtualNodeBindingValue(t);default:return null}},parseBindingsString:function(e,n,r,i){try{var s=t(e,this.bindingCache,i);return s(n,r)}catch(o){throw o.message="Unable to parse bindings.\nBindings value: "+e+"\nMessage: "+o.message,o}}}),r.bindingProvider.instance=new r.bindingProvider}(),r.exportSymbol("bindingProvider",r.bindingProvider),function(){function t(e){return function(){return e}}function n(e){return e()}function i(e){return r.utils.objectMap(r.dependencyDetection.ignore(e),function(t,n){return function(){return e()[n]}})}function s(e,n,s){return typeof e=="function"?i(e.bind(null,n,s)):r.utils.objectMap(e,t)}function o(e,t){return i(this.getBindings.bind(this,e,t))}function u(e){var t=r.virtualElements.allowedBindings[e];if(!t)throw new Error("The binding '"+e+"' cannot be used with virtual elements")}function a(e,t,n){var i,s=r.virtualElements.firstChild(t),o=r.bindingProvider.instance,u=o.preprocessNode;if(u){while(i=s)s=r.virtualElements.nextSibling(i),u.call(o,i);s=r.virtualElements.firstChild(t)}while(i=s)s=r.virtualElements.nextSibling(i),f(e,i,n)}function f(t,n,i){var s=!0,o=n.nodeType===1;o&&r.virtualElements.normaliseVirtualElementDomStructure(n);var u=o&&i||r.bindingProvider.instance.nodeHasBindings(n);u&&(s=h(n,null,t,i).shouldBindDescendants),s&&!e[r.utils.tagNameLower(n)]&&a(t,n,!o)}function c(e){var t=[],n={},i=[];return r.utils.objectForEach(e,function s(o){if(!n[o]){var u=r.getBindingHandler(o);u&&(u.after&&(i.push(o),r.utils.arrayForEach(u.after,function(t){if(e[t]){if(r.utils.arrayIndexOf(i,t)!==-1)throw Error("Cannot combine the following bindings, because they have a cyclic dependency: "+i.join(", "));s(t)}}),i.length--),t.push({key:o,handler:u})),n[o]=!0}}),t}function h(e,t,i,s){var a=r.utils.domData.get(e,l);if(!t){if(a)throw Error("You cannot apply bindings multiple times to the same element.");r.utils.domData.set(e,l,!0)}!a&&s&&r.storedBindingContextForNode(e,i);var f;if(t&&typeof t!="function")f=t;else{var h=r.bindingProvider.instance,p=h.getBindingAccessors||o,d=r.dependentObservable(function(){return f=t?t(i,e):p.call(h,e,i),f&&i._subscribable&&i._subscribable(),f},null,{disposeWhenNodeIsRemoved:e});if(!f||!d.isActive())d=null}var v;if(f){var m=d?function(e){return function(){return n(d()[e])}}:function(e){return f[e]};function g(){return r.utils.objectMap(d?d():f,n)}g.get=function(e){return f[e]&&n(m(e))},g.has=function(e){return e in f};var y=c(f);r.utils.arrayForEach(y,function(t){var n=t.handler.init,s=t.handler.update,o=t.key;e.nodeType===8&&u(o);try{typeof n=="function"&&r.dependencyDetection.ignore(function(){var t=n(e,m(o),g,i.$data,i);if(t&&t.controlsDescendantBindings){if(v!==undefined)throw new Error("Multiple bindings ("+v+" and "+o+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.");v=o}}),typeof s=="function"&&r.dependentObservable(function(){s(e,m(o),g,i.$data,i)},null,{disposeWhenNodeIsRemoved:e})}catch(a){throw a.message='Unable to process binding "'+o+": "+f[o]+'"\nMessage: '+a.message,a}})}return{shouldBindDescendants:v===undefined}}function d(e){return e&&e instanceof r.bindingContext?e:new r.bindingContext(e)}r.bindingHandlers={};var e={script:!0,textarea:!0,template:!0};r.getBindingHandler=function(e){return r.bindingHandlers[e]},r.bindingContext=function(e,t,n,i){function s(){var s=a?e():e,o=r.utils.unwrapObservable(s);return t?(t._subscribable&&t._subscribable(),r.utils.extend(u,t),l&&(u._subscribable=l)):(u.$parents=[],u.$root=o,u.ko=r),u.$rawData=s,u.$data=o,n&&(u[n]=o),i&&i(u,t,o),u.$data}function o(){return f&&!r.utils.anyDomNodeIsAttachedToDocument(f)}var u=this,a=typeof e=="function"&&!r.isObservable(e),f,l=r.dependentObservable(s,null,{disposeWhen:o,disposeWhenNodeIsRemoved:!0});l.isActive()&&(u._subscribable=l,l.equalityComparer=null,f=[],l._addNode=function(e){f.push(e),r.utils.domNodeDisposal.addDisposeCallback(e,function(e){r.utils.arrayRemoveItem(f,e),f.length||(l.dispose(),u._subscribable=l=undefined)})})},r.bindingContext.prototype.createChildContext=function(e,t,n){return new r.bindingContext(e,this,t,function(e,t){e.$parentContext=t,e.$parent=t.$data,e.$parents=(t.$parents||[]).slice(0),e.$parents.unshift(e.$parent),n&&n(e)})},r.bindingContext.prototype.extend=function(e){return new r.bindingContext(this._subscribable||this.$data,this,null,function(t,n){t.$rawData=n.$rawData,r.utils.extend(t,typeof e=="function"?e():e)})};var l=r.utils.domData.nextKey(),p=r.utils.domData.nextKey();r.storedBindingContextForNode=function(e,t){if(arguments.length!=2)return r.utils.domData.get(e,p);r.utils.domData.set(e,p,t),t._subscribable&&t._subscribable._addNode(e)},r.applyBindingAccessorsToNode=function(e,t,n){return e.nodeType===1&&r.virtualElements.normaliseVirtualElementDomStructure(e),h(e,t,d(n),!0)},r.applyBindingsToNode=function(e,t,n){var i=d(n);return r.applyBindingAccessorsToNode(e,s(t,i,e),i)},r.applyBindingsToDescendants=function(e,t){(t.nodeType===1||t.nodeType===8)&&a(d(e),t,!0)},r.applyBindings=function(e,t){!jQueryInstance&&window.jQuery&&(jQueryInstance=window.jQuery);if(t&&t.nodeType!==1&&t.nodeType!==8)throw new Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node");t=t||window.document.body,f(d(e),t,!0)},r.contextFor=function(e){switch(e.nodeType){case 1:case 8:var t=r.storedBindingContextForNode(e);if(t)return t;if(e.parentNode)return r.contextFor(e.parentNode)}return undefined},r.dataFor=function(e){var t=r.contextFor(e);return t?t.$data:undefined},r.exportSymbol("bindingHandlers",r.bindingHandlers),r.exportSymbol("applyBindings",r.applyBindings),r.exportSymbol("applyBindingsToDescendants",r.applyBindingsToDescendants),r.exportSymbol("applyBindingAccessorsToNode",r.applyBindingAccessorsToNode),r.exportSymbol("applyBindingsToNode",r.applyBindingsToNode),r.exportSymbol("contextFor",r.contextFor),r.exportSymbol("dataFor",r.dataFor)}(),function(e){function i(t,n){return t.hasOwnProperty(n)?t[n]:e}function s(e,s){var u=i(t,e),a;u?u.subscribe(s):(u=t[e]=new r.subscribable,u.subscribe(s),o(e,function(i,s){var o=!!s&&!!s.synchronous;n[e]={definition:i,isSynchronousComponent:o},delete t[e],a||o?u.notifySubscribers(i):r.tasks.schedule(function(){u.notifySubscribers(i)})}),a=!0)}function o(e,t){u("getConfig",[e],function(n){n?u("loadComponent",[e,n],function(e){t(e,n)}):t(null,null)})}function u(t,n,i,s){s||(s=r.components.loaders.slice(0));var o=s.shift();if(o){var a=o[t];if(a){var f=!1,l=a.apply(o,n.concat(function(e){f?i(null):e!==null?i(e):u(t,n,i,s)}));if(l!==e){f=!0;if(!o.suppressLoaderExceptions)throw new Error("Component loaders must supply values by invoking the callback, not by returning values synchronously.")}}else u(t,n,i,s)}else i(null)}var t={},n={};r.components={get:function(e,t){var o=i(n,e);o?o.isSynchronousComponent?r.dependencyDetection.ignore(function(){t(o.definition)}):r.tasks.schedule(function(){t(o.definition)}):s(e,t)},clearCachedDefinition:function(e){delete n[e]},_getFirstResultFromLoaders:u},r.components.loaders=[],r.exportSymbol("components",r.components),r.exportSymbol("components.get",r.components.get),r.exportSymbol("components.clearCachedDefinition",r.components.clearCachedDefinition)}(),function(e){function s(e,t,n,s){var o={},u=2,a=function(){--u===0&&s(o)},f=n.template,l=n.viewModel;f?c(t,f,function(t){r.components._getFirstResultFromLoaders("loadTemplate",[e,t],function(e){o.template=e,a()})}):a(),l?c(t,l,function(t){r.components._getFirstResultFromLoaders("loadViewModel",[e,t],function(e){o[i]=e,a()})}):a()}function o(e,t,n){if(typeof t=="string")n(r.utils.parseHtmlFragment(t));else if(t instanceof Array)n(t);else if(l(t))n(r.utils.makeArray(t.childNodes));else if(t.element){var i=t.element;if(f(i))n(a(i));else if(typeof i=="string"){var s=document.getElementById(i);s?n(a(s)):e("Cannot find element with ID "+i)}else e("Unknown element type: "+i)}else e("Unknown template value: "+t)}function u(e,t,n){if(typeof t=="function")n(function(e){return new t(e)});else if(typeof t[i]=="function")n(t[i]);else if("instance"in t){var r=t.instance;n(function(e,t){return r})}else"viewModel"in t?u(e,t.viewModel,n):e("Unknown viewModel value: "+t)}function a(e){switch(r.utils.tagNameLower(e)){case"script":return r.utils.parseHtmlFragment(e.text);case"textarea":return r.utils.parseHtmlFragment(e.value);case"template":if(l(e.content))return r.utils.cloneNodes(e.content.childNodes)}return r.utils.cloneNodes(e.childNodes)}function f(e){return window.HTMLElement?e instanceof HTMLElement:e&&e.tagName&&e.nodeType===1}function l(e){return window.DocumentFragment?e instanceof DocumentFragment:e&&e.nodeType===11}function c(e,n,r){typeof n["require"]=="string"?t||window.require?(t||window.require)([n.require],r):e("Uses require, but no AMD loader is present"):r(n)}function h(e){return function(t){throw new Error("Component '"+e+"': "+t)}}var n={};r.components.register=function(e,t){if(!t)throw new Error("Invalid configuration for "+e);if(r.components.isRegistered(e))throw new Error("Component "+e+" is already registered");n[e]=t},r.components.isRegistered=function(e){return n.hasOwnProperty(e)},r.components.unregister=function(e){delete n[e],r.components.clearCachedDefinition(e)},r.components.defaultLoader={getConfig:function(e,t){var r=n.hasOwnProperty(e)?n[e]:null;t(r)},loadComponent:function(e,t,n){var r=h(e);c(r,t,function(t){s(e,r,t,n)})},loadTemplate:function(e,t,n){o(h(e),t,n)},loadViewModel:function(e,t,n){u(h(e),t,n)}};var i="createViewModel";r.exportSymbol("components.register",r.components.register),r.exportSymbol("components.isRegistered",r.components.isRegistered),r.exportSymbol("components.unregister",r.components.unregister),r.exportSymbol("components.defaultLoader",r.components.defaultLoader),r.components.loaders.push(r.components.defaultLoader),r.components._allRegisteredComponents=n}(),function(e){function n(e,n){var i=e.getAttribute("params");if(i){var s=t.parseBindingsString(i,n,e,{valueAccessors:!0,bindingParams:!0}),o=r.utils.objectMap(s,function(t,n){return r.computed(t,null,{disposeWhenNodeIsRemoved:e})}),u=r.utils.objectMap(o,function(t,n){var i=t.peek();return t.isActive()?r.computed({read:function(){return r.utils.unwrapObservable(t())},write:r.isWriteableObservable(i)&&function(e){t()(e)},disposeWhenNodeIsRemoved:e}):i});return u.hasOwnProperty("$raw")||(u.$raw=o),u}return{$raw:{}}}r.components.getComponentNameForNode=function(e){var t=r.utils.tagNameLower(e);if(r.components.isRegistered(t))if(t.indexOf("-")!=-1||""+e=="[object HTMLUnknownElement]"||r.utils.ieVersion<=8&&e.tagName===t)return t},r.components.addBindingsForCustomElement=function(e,t,i,s){if(t.nodeType===1){var o=r.components.getComponentNameForNode(t);if(o){e=e||{};if(e.component)throw new Error('Cannot use the "component" binding on a custom element matching a component');var u={name:o,params:n(t,i)};e.component=s?function(){return u}:u}}return e};var t=new r.bindingProvider;r.utils.ieVersion<9&&(r.components.register=function(e){return function(t){return document.createElement(t),e.apply(this,arguments)}}(r.components.register),document.createDocumentFragment=function(e){return function(){var t=e(),n=r.components._allRegisteredComponents;for(var i in n)n.hasOwnProperty(i)&&t.createElement(i);return t}}(document.createDocumentFragment))}(),function(e){function n(e,t,n){var i=t.template;if(!i)throw new Error("Component '"+e+"' has no template");var s=r.utils.cloneNodes(i);r.virtualElements.setDomNodeChildren(n,s)}function i(e,t,n,r){var i=e.createViewModel;return i?i.call(e,r,{element:t,templateNodes:n}):r}var t=0;r.bindingHandlers.component={init:function(s,o,u,a,f){var l,c,h=function(){var e=l&&l.dispose;typeof e=="function"&&e.call(l),l=null,c=null},p=r.utils.makeArray(r.virtualElements.childNodes(s));return r.utils.domNodeDisposal.addDisposeCallback(s,h),r.computed(function(){var u=r.utils.unwrapObservable(o()),a,d;typeof u=="string"?a=u:(a=r.utils.unwrapObservable(u.name),d=r.utils.unwrapObservable(u.params));if(!a)throw new Error("No component name specified");var v=c=++t;r.components.get(a,function(t){if(c!==v)return;h();if(!t)throw new Error("Unknown component '"+a+"'");n(a,t,s);var o=i(t,s,p,d),u=f.createChildContext(o,e,function(e){e.$component=o,e.$componentTemplateNodes=p});l=o,r.applyBindingsToDescendants(u,s)})},null,{disposeWhenNodeIsRemoved:s}),{controlsDescendantBindings:!0}}},r.virtualElements.allowedBindings.component=!0}();var x={"class":"className","for":"htmlFor"};r.bindingHandlers.attr={update:function(e,t,n){var i=r.utils.unwrapObservable(t())||{};r.utils.objectForEach(i,function(t,n){n=r.utils.unwrapObservable(n);var i=n===!1||n===null||n===undefined;i&&e.removeAttribute(t),r.utils.ieVersion<=8&&t in x?(t=x[t],i?e.removeAttribute(t):e[t]=n):i||e.setAttribute(t,n.toString()),t==="name"&&r.utils.setElementName(e,i?"":n.toString())})}},function(){r.bindingHandlers.checked={after:["value","attr"],init:function(e,t,n){function s(){var s=e.checked,o=p?i():s;if(r.computedContext.isInitial())return;if(a&&!s)return;var u=r.dependencyDetection.ignore(t);if(l){var f=c?u.peek():u;h!==o?(s&&(r.utils.addOrRemoveItem(f,o,!0),r.utils.addOrRemoveItem(f,h,!1)),h=o):r.utils.addOrRemoveItem(f,o,s),c&&r.isWriteableObservable(u)&&u(f)}else r.expressionRewriting.writeValueToProperty(u,n,"checked",o,!0)}function o(){var n=r.utils.unwrapObservable(t());l?e.checked=r.utils.arrayIndexOf(n,i())>=0:u?e.checked=n:e.checked=i()===n}var i=r.pureComputed(function(){return n.has("checkedValue")?r.utils.unwrapObservable(n.get("checkedValue")):n.has("value")?r.utils.unwrapObservable(n.get("value")):e.value}),u=e.type=="checkbox",a=e.type=="radio";if(!u&&!a)return;var f=t(),l=u&&r.utils.unwrapObservable(f)instanceof Array,c=!(l&&f.push&&f.splice),h=l?i():undefined,p=a||l;a&&!e.name&&r.bindingHandlers.uniqueName.init(e,function(){return!0}),r.computed(s,null,{disposeWhenNodeIsRemoved:e}),r.utils.registerEventHandler(e,"click",s),r.computed(o,null,{disposeWhenNodeIsRemoved:e}),f=undefined}},r.expressionRewriting.twoWayBindings.checked=!0,r.bindingHandlers.checkedValue={update:function(e,t){e.value=r.utils.unwrapObservable(t())}}}();var T="__ko__cssValue";r.bindingHandlers.css={update:function(e,t){var n=r.utils.unwrapObservable(t());n!==null&&typeof n=="object"?r.utils.objectForEach(n,function(t,n){n=r.utils.unwrapObservable(n),r.utils.toggleDomNodeCssClass(e,t,n)}):(n=r.utils.stringTrim(String(n||"")),r.utils.toggleDomNodeCssClass(e,e[T],!1),e[T]=n,r.utils.toggleDomNodeCssClass(e,n,!0))}},r.bindingHandlers.enable={update:function(e,t){var n=r.utils.unwrapObservable(t());n&&e.disabled?e.removeAttribute("disabled"):!n&&!e.disabled&&(e.disabled=!0)}},r.bindingHandlers.disable={update:function(e,t){r.bindingHandlers.enable.update(e,function(){return!r.utils.unwrapObservable(t())})}},r.bindingHandlers.event={init:function(e,t,n,i,s){var o=t()||{};r.utils.objectForEach(o,function(o){typeof o=="string"&&r.utils.registerEventHandler(e,o,function(e){var u,a=t()[o];if(!a)return;try{var f=r.utils.makeArray(arguments);i=s.$data,f.unshift(i),u=a.apply(i,f)}finally{u!==!0&&(e.preventDefault?e.preventDefault():e.returnValue=!1)}var l=n.get(o+"Bubble")!==!1;l||(e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation())})})}},r.bindingHandlers.foreach={makeTemplateValueAccessor:function(e){return function(){var t=e(),n=r.utils.peekObservable(t);return!n||typeof n.length=="number"?{foreach:t,templateEngine:r.nativeTemplateEngine.instance}:(r.utils.unwrapObservable(t),{foreach:n.data,as:n.as,includeDestroyed:n.includeDestroyed,afterAdd:n.afterAdd,beforeRemove:n.beforeRemove,afterRender:n.afterRender,beforeMove:n.beforeMove,afterMove:n.afterMove,templateEngine:r.nativeTemplateEngine.instance})}},init:function(e,t,n,i,s){return r.bindingHandlers.template.init(e,r.bindingHandlers.foreach.makeTemplateValueAccessor(t))},update:function(e,t,n,i,s){return r.bindingHandlers.template.update(e,r.bindingHandlers.foreach.makeTemplateValueAccessor(t),n,i,s)}},r.expressionRewriting.bindingRewriteValidators.foreach=!1,r.virtualElements.allowedBindings.foreach=!0;var C="__ko_hasfocusUpdating",k="__ko_hasfocusLastValue";r.bindingHandlers.hasfocus={init:function(e,t,n){var i=function(i){e[C]=!0;var s=e.ownerDocument;if("activeElement"in s){var o;try{o=s.activeElement}catch(u){o=s.body}i=o===e}var a=t();r.expressionRewriting.writeValueToProperty(a,n,"hasfocus",i,!0),e[k]=i,e[C]=!1},s=i.bind(null,!0),o=i.bind(null,!1);r.utils.registerEventHandler(e,"focus",s),r.utils.registerEventHandler(e,"focusin",s),r.utils.registerEventHandler(e,"blur",o),r.utils.registerEventHandler(e,"focusout",o)},update:function(e,t){var n=!!r.utils.unwrapObservable(t());!e[C]&&e[k]!==n&&(n?e.focus():e.blur(),!n&&e[k]&&e.ownerDocument.body.focus(),r.dependencyDetection.ignore(r.utils.triggerEvent,null,[e,n?"focusin":"focusout"]))}},r.expressionRewriting.twoWayBindings.hasfocus=!0,r.bindingHandlers.hasFocus=r.bindingHandlers.hasfocus,r.expressionRewriting.twoWayBindings.hasFocus=!0,r.bindingHandlers.html={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t){r.utils.setHtml(e,t())}},L("if"),L("ifnot",!1,!0),L("with",!0,!1,function(e,t){return e.createChildContext(t)});var A={};r.bindingHandlers.options={init:function(e){if(r.utils.tagNameLower(e)!=="select")throw new Error("options binding applies only to SELECT elements");while(e.length>0)e.remove(0);return{controlsDescendantBindings:!0}},update:function(e,t,n){function i(){return r.utils.arrayFilter(e.options,function(e){return e.selected})}function v(e,t,n){var r=typeof t;return r=="function"?t(e):r=="string"?e[t]:n}function g(t,i,s){s.length&&(d=!f&&s[0].selected?[r.selectExtensions.readValue(s[0])]:[],m=!0);var o=e.ownerDocument.createElement("option");if(t===A)r.utils.setTextContent(o,n.get("optionsCaption")),r.selectExtensions.writeValue(o,undefined);else{var u=v(t,n.get("optionsValue"),t);r.selectExtensions.writeValue(o,r.utils.unwrapObservable(u));var a=v(t,n.get("optionsText"),u);r.utils.setTextContent(o,a)}return[o]}function y(t,i){if(m&&f)r.selectExtensions.writeValue(e,r.utils.unwrapObservable(n.get("value")),!0);else if(d.length){var s=r.utils.arrayIndexOf(d,r.selectExtensions.readValue(i[0]))>=0;r.utils.setOptionNodeSelectionState(i[0],s),m&&!s&&r.dependencyDetection.ignore(r.utils.triggerEvent,null,[e,"change"])}}var s=e.length==0,o=e.multiple,u=!s&&o?e.scrollTop:null,a=r.utils.unwrapObservable(t()),f=n.get("valueAllowUnset")&&n.has("value"),l=n.get("optionsIncludeDestroyed"),c={},h,p,d=[];f||(o?d=r.utils.arrayMap(i(),r.selectExtensions.readValue):e.selectedIndex>=0&&d.push(r.selectExtensions.readValue(e.options[e.selectedIndex]))),a&&(typeof a.length=="undefined"&&(a=[a]),p=r.utils.arrayFilter(a,function(e){return l||e===undefined||e===null||!r.utils.unwrapObservable(e._destroy)}),n.has("optionsCaption")&&(h=r.utils.unwrapObservable(n.get("optionsCaption")),h!==null&&h!==undefined&&p.unshift(A)));var m=!1;c.beforeRemove=function(t){e.removeChild(t)};var b=y;n.has("optionsAfterRender")&&typeof n.get("optionsAfterRender")=="function"&&(b=function(e,t){y(e,t),r.dependencyDetection.ignore(n.get("optionsAfterRender"),null,[t[0],e!==A?e:undefined])}),r.utils.setDomNodeChildrenFromArrayMapping(e,p,g,c,b),r.dependencyDetection.ignore(function(){if(f)r.selectExtensions.writeValue(e,r.utils.unwrapObservable(n.get("value")),!0);else{var t;o?t=d.length&&i().length<d.length:t=d.length&&e.selectedIndex>=0?r.selectExtensions.readValue(e.options[e.selectedIndex])!==d[0]:d.length||e.selectedIndex>=0,t&&r.utils.triggerEvent(e,"change")}}),r.utils.ensureSelectElementIsRenderedCorrectly(e),u&&Math.abs(u-e.scrollTop)>20&&(e.scrollTop=u)}},r.bindingHandlers.options.optionValueDomDataKey=r.utils.domData.nextKey(),r.bindingHandlers.selectedOptions={after:["options","foreach"],init:function(e,t,n){r.utils.registerEventHandler(e,"change",function(){var i=t(),s=[];r.utils.arrayForEach(e.getElementsByTagName("option"),function(e){e.selected&&s.push(r.selectExtensions.readValue(e))}),r.expressionRewriting.writeValueToProperty(i,n,"selectedOptions",s)})},update:function(e,t){if(r.utils.tagNameLower(e)!="select")throw new Error("values binding applies only to SELECT elements");var n=r.utils.unwrapObservable(t()),i=e.scrollTop;n&&typeof n.length=="number"&&r.utils.arrayForEach(e.getElementsByTagName("option"),function(e){var t=r.utils.arrayIndexOf(n,r.selectExtensions.readValue(e))>=0;e.selected!=t&&r.utils.setOptionNodeSelectionState(e,t)}),e.scrollTop=i}},r.expressionRewriting.twoWayBindings.selectedOptions=!0,r.bindingHandlers.style={update:function(e,t){var n=r.utils.unwrapObservable(t()||{});r.utils.objectForEach(n,function(t,n){n=r.utils.unwrapObservable(n);if(n===null||n===undefined||n===!1)n="";e.style[t]=n})}},r.bindingHandlers.submit={init:function(e,t,n,i,s){if(typeof t()!="function")throw new Error("The value for a submit binding must be a function");r.utils.registerEventHandler(e,"submit",function(n){var r,i=t();try{r=i.call(s.$data,e)}finally{r!==!0&&(n.preventDefault?n.preventDefault():n.returnValue=!1)}})}},r.bindingHandlers.text={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t){r.utils.setTextContent(e,t())}},r.virtualElements.allowedBindings.text=!0,function(){if(window&&window.navigator)var e=function(e){if(e)return parseFloat(e[1])},t=window.opera&&window.opera.version&&parseInt(window.opera.version()),n=window.navigator.userAgent,i=e(n.match(/^(?:(?!chrome).)*version\/([^ ]*) safari/i)),s=e(n.match(/Firefox\/([^ ]*)/));if(r.utils.ieVersion<10)var o=r.utils.domData.nextKey(),u=r.utils.domData.nextKey(),a=function(e){var t=this.activeElement,n=t&&r.utils.domData.get(t,u);n&&n(e)},f=function(e,t){var n=e.ownerDocument;r.utils.domData.get(n,o)||(r.utils.domData.set(n,o,!0),r.utils.registerEventHandler(n,"selectionchange",a)),r.utils.domData.set(e,u,t)};r.bindingHandlers.textInput={init:function(e,n,o){var u=e.value,a,l,c=function(t){clearTimeout(a),l=a=undefined;var i=e.value;u!==i&&(DEBUG&&t&&(e._ko_textInputProcessedEvent=t.type),u=i,r.expressionRewriting.writeValueToProperty(n(),o,"textInput",i))},h=function(t){if(!a){l=e.value;var n=DEBUG?c.bind(e,{type:t.type}):c;a=r.utils.setTimeout(n,4)}},p=r.utils.ieVersion==9?h:c,d=function(){var t=r.utils.unwrapObservable(n());if(t===null||t===undefined)t="";if(l!==undefined&&t===l){r.utils.setTimeout(d,4);return}e.value!==t&&(u=t,e.value=t)},v=function(t,n){r.utils.registerEventHandler(e,t,n)};DEBUG&&r.bindingHandlers.textInput._forceUpdateOn?r.utils.arrayForEach(r.bindingHandlers.textInput._forceUpdateOn,function(e){e.slice(0,5)=="after"?v(e.slice(5),h):v(e,c)}):r.utils.ieVersion<10?(v("propertychange",function(e){e.propertyName==="value"&&p(e)}),r.utils.ieVersion==8&&(v("keyup",c),v("keydown",c)),r.utils.ieVersion>=8&&(f(e,p),v("dragend",h))):(v("input",c),i<5&&r.utils.tagNameLower(e)==="textarea"?(v("keydown",h),v("paste",h),v("cut",h)):t<11?v("keydown",h):s<4&&(v("DOMAutoComplete",c),v("dragdrop",c),v("drop",c))),v("change",c),r.computed(d,null,{disposeWhenNodeIsRemoved:e})}},r.expressionRewriting.twoWayBindings.textInput=!0,r.bindingHandlers.textinput={preprocess:function(e,t,n){n("textInput",e)}}}(),r.bindingHandlers.uniqueName={init:function(e,t){if(t()){var n="ko_unique_"+ ++r.bindingHandlers.uniqueName.currentIndex;r.utils.setElementName(e,n)}}},r.bindingHandlers.uniqueName.currentIndex=0,r.bindingHandlers.value={after:["options","foreach"],init:function(e,t,n){if(e.tagName.toLowerCase()=="input"&&(e.type=="checkbox"||e.type=="radio")){r.applyBindingAccessorsToNode(e,{checkedValue:t});return}var i=["change"],s=n.get("valueUpdate"),o=!1,u=null;s&&(typeof s=="string"&&(s=[s]),r.utils.arrayPushAll(i,s),i=r.utils.arrayGetDistinctValues(i));var a=function(){u=null,o=!1;var i=t(),s=r.selectExtensions.readValue(e);r.expressionRewriting.writeValueToProperty(i,n,"value",s)},f=r.utils.ieVersion&&e.tagName.toLowerCase()=="input"&&e.type=="text"&&e.autocomplete!="off"&&(!e.form||e.form.autocomplete!="off");f&&r.utils.arrayIndexOf(i,"propertychange")==-1&&(r.utils.registerEventHandler(e,"propertychange",function(){o=!0}),r.utils.registerEventHandler(e,"focus",function(){o=!1}),r.utils.registerEventHandler(e,"blur",function(){o&&a()})),r.utils.arrayForEach(i,function(t){var n=a;r.utils.stringStartsWith(t,"after")&&(n=function(){u=r.selectExtensions.readValue(e),r.utils.setTimeout(a,0)},t=t.substring("after".length)),r.utils.registerEventHandler(e,t,n)});var l=function(){var i=r.utils.unwrapObservable(t()),s=r.selectExtensions.readValue(e);if(u!==null&&i===u){r.utils.setTimeout(l,0);return}var o=i!==s;if(o)if(r.utils.tagNameLower(e)==="select"){var a=n.get("valueAllowUnset"),f=function(){r.selectExtensions.writeValue(e,i,a)};f(),!a&&i!==r.selectExtensions.readValue(e)?r.dependencyDetection.ignore(r.utils.triggerEvent,null,[e,"change"]):r.utils.setTimeout(f,0)}else r.selectExtensions.writeValue(e,i)};r.computed(l,null,{disposeWhenNodeIsRemoved:e})},update:function(){}},r.expressionRewriting.twoWayBindings.value=!0,r.bindingHandlers.visible={update:function(e,t){var n=r.utils.unwrapObservable(t()),i=e.style.display!="none";n&&!i?e.style.display="":!n&&i&&(e.style.display="none")}},N("click"),r.templateEngine=function(){},r.templateEngine.prototype.renderTemplateSource=function(e,t,n,r){throw new Error("Override renderTemplateSource")},r.templateEngine.prototype.createJavaScriptEvaluatorBlock=function(e){throw new Error("Override createJavaScriptEvaluatorBlock")},r.templateEngine.prototype.makeTemplateSource=function(e,t){if(typeof e=="string"){t=t||document;var n=t.getElementById(e);if(!n)throw new Error("Cannot find template with ID "+e);return new r.templateSources.domElement(n)}if(e.nodeType==1||e.nodeType==8)return new r.templateSources.anonymousTemplate(e);throw new Error("Unknown template type: "+e)},r.templateEngine.prototype.renderTemplate=function(e,t,n,r){var i=this.makeTemplateSource(e,r);return this.renderTemplateSource(i,t,n,r)},r.templateEngine.prototype.isTemplateRewritten=function(e,t){return this.allowTemplateRewriting===!1?!0:this.makeTemplateSource(e,t).data("isRewritten")},r.templateEngine.prototype.rewriteTemplate=function(e,t,n){var r=this.makeTemplateSource(e,n),i=t(r.text());r.text(i),r.data("isRewritten",!0)},r.exportSymbol("templateEngine",r.templateEngine),r.templateRewriting=function(){function n(e){var t=r.expressionRewriting.bindingRewriteValidators;for(var n=0;n<e.length;n++){var i=e[n].key;if(t.hasOwnProperty(i)){var s=t[i];if(typeof s=="function"){var o=s(e[n].value);if(o)throw new Error(o)}else if(!s)throw new Error("This template engine does not support the '"+i+"' binding within its templates")}}}function i(e,t,i,s){var o=r.expressionRewriting.parseObjectLiteral(e);n(o);var u=r.expressionRewriting.preProcessBindings(o,{valueAccessors:!0}),a="ko.__tr_ambtns(function($context,$element){return(function(){return{ "+u+" } })()},'"+i.toLowerCase()+"')";return s.createJavaScriptEvaluatorBlock(a)+t}var e=/(<([a-z]+\d*)(?:\s+(?!data-bind\s*=\s*)[a-z0-9\-]+(?:=(?:\"[^\"]*\"|\'[^\']*\'|[^>]*))?)*\s+)data-bind\s*=\s*(["'])([\s\S]*?)\3/gi,t=/<!--\s*ko\b\s*([\s\S]*?)\s*-->/g;return{ensureTemplateIsRewritten:function(e,t,n){t.isTemplateRewritten(e,n)||t.rewriteTemplate(e,function(e){return r.templateRewriting.memoizeBindingAttributeSyntax(e,t)},n)},memoizeBindingAttributeSyntax:function(n,r){return n.replace(e,function(){return i(arguments[4],arguments[1],arguments[2],r)}).replace(t,function(){return i(arguments[1],"<!-- ko -->","#comment",r)})},applyMemoizedBindingsToNextSibling:function(e,t){return r.memoization.memoize(function(n,i){var s=n.nextSibling;s&&s.nodeName.toLowerCase()===t&&r.applyBindingAccessorsToNode(s,e,i)})}}}(),r.exportSymbol("__tr_ambtns",r.templateRewriting.applyMemoizedBindingsToNextSibling),function(){function u(e){return r.utils.domData.get(e,o)||{}}function a(e,t){r.utils.domData.set(e,o,t)}r.templateSources={};var e=1,t=2,n=3,i=4;r.templateSources.domElement=function(s){this.domElement=s;if(s){var o=r.utils.tagNameLower(s);this.templateType=o==="script"?e:o==="textarea"?t:o=="template"&&s.content&&s.content.nodeType===11?n:i}},r.templateSources.domElement.prototype.text=function(){var n=this.templateType===e?"text":this.templateType===t?"value":"innerHTML";if(arguments.length==0)return this.domElement[n];var i=arguments[0];n==="innerHTML"?r.utils.setHtml(this.domElement,i):this.domElement[n]=i};var s=r.utils.domData.nextKey()+"_";r.templateSources.domElement.prototype.data=function(e){if(arguments.length===1)return r.utils.domData.get(this.domElement,s+e);r.utils.domData.set(this.domElement,s+e,arguments[1])};var o=r.utils.domData.nextKey();r.templateSources.domElement.prototype.nodes=function(){var e=this.domElement;if(arguments.length==0){var t=u(e),r=t.containerData;return r||(this.templateType===n?e.content:this.templateType===i?e:undefined)}var s=arguments[0];a(e,{containerData:s})},r.templateSources.anonymousTemplate=function(e){this.domElement=e},r.templateSources.anonymousTemplate.prototype=new r.templateSources.domElement,r.templateSources.anonymousTemplate.prototype.constructor=r.templateSources.anonymousTemplate,r.templateSources.anonymousTemplate.prototype.text=function(){if(arguments.length==0){var e=u(this.domElement);return e.textData===undefined&&e.containerData&&(e.textData=e.containerData.innerHTML),e.textData}var t=arguments[0];a(this.domElement,{textData:t})},r.exportSymbol("templateSources",r.templateSources),r.exportSymbol("templateSources.domElement",r.templateSources.domElement),r.exportSymbol("templateSources.anonymousTemplate",r.templateSources.anonymousTemplate)}(),function(){function t(e,t,n){var i,s=e,o=r.virtualElements.nextSibling(t);while(s&&(i=s)!==o)s=r.virtualElements.nextSibling(i),n(i,s)}function n(e,n){if(e.length){var i=e[0],s=e[e.length-1],o=i.parentNode,u=r.bindingProvider.instance,a=u.preprocessNode;if(a){t(i,s,function(e,t){var n=e.previousSibling,r=a.call(u,e);r&&(e===i&&(i=r[0]||t),e===s&&(s=r[r.length-1]||n))}),e.length=0;if(!i)return;i===s?e.push(i):(e.push(i,s),r.utils.fixUpContinuousNodeArray(e,o))}t(i,s,function(e){(e.nodeType===1||e.nodeType===8)&&r.applyBindings(n,e)}),t(i,s,function(e){(e.nodeType===1||e.nodeType===8)&&r.memoization.unmemoizeDomNodeAndDescendants(e,[n])}),r.utils.fixUpContinuousNodeArray(e,o)}}function i(e){return e.nodeType?e:e.length>0?e[0]:null}function s(t,s,o,u,a){a=a||{};var f=t&&i(t),l=(f||o||{}).ownerDocument,c=a.templateEngine||e;r.templateRewriting.ensureTemplateIsRewritten(o,c,l);var h=c.renderTemplate(o,u,a,l);if(typeof h.length!="number"||h.length>0&&typeof h[0].nodeType!="number")throw new Error("Template engine must return an array of DOM nodes");var p=!1;switch(s){case"replaceChildren":r.virtualElements.setDomNodeChildren(t,h),p=!0;break;case"replaceNode":r.utils.replaceDomNodes(t,h),p=!0;break;case"ignoreTargetNode":break;default:throw new Error("Unknown renderMode: "+s)}return p&&(n(h,u),a.afterRender&&r.dependencyDetection.ignore(a.afterRender,null,[h,u.$data])),h}function o(e,t,n){return r.isObservable(e)?e():typeof e=="function"?e(t,n):e}function a(e,t){var n=r.utils.domData.get(e,u);n&&typeof n.dispose=="function"&&n.dispose(),r.utils.domData.set(e,u,t&&t.isActive()?t:undefined)}var e;r.setTemplateEngine=function(t){if(!(t==undefined||t instanceof r.templateEngine))throw new Error("templateEngine must inherit from ko.templateEngine");e=t},r.renderTemplate=function(t,n,u,a,f){u=u||{};if((u["templateEngine"]||e)==undefined)throw new Error("Set a template engine before calling renderTemplate");f=f||"replaceChildren";if(a){var l=i(a),c=function(){return!l||!r.utils.domNodeIsAttachedToDocument(l)},h=l&&f=="replaceNode"?l.parentNode:l;return r.dependentObservable(function(){var e=n&&n instanceof r.bindingContext?n:new r.bindingContext(r.utils.unwrapObservable(n)),c=o(t,e.$data,e),h=s(a,f,c,e,u);f=="replaceNode"&&(a=h,l=i(a))},null,{disposeWhen:c,disposeWhenNodeIsRemoved:h})}return r.memoization.memoize(function(e){r.renderTemplate(t,n,u,e,"replaceNode")})},r.renderTemplateForEach=function(e,t,i,u,a){var f,l=function(t,n){f=a.createChildContext(t,i.as,function(e){e.$index=n});var r=o(e,t,f);return s(null,"ignoreTargetNode",r,f,i)},c=function(e,t,r){n(t,f),i.afterRender&&i.afterRender(t,e),f=null};return r.dependentObservable(function(){var e=r.utils.unwrapObservable(t)||[];typeof e.length=="undefined"&&(e=[e]);var n=r.utils.arrayFilter(e,function(e){return i.includeDestroyed||e===undefined||e===null||!r.utils.unwrapObservable(e._destroy)});r.dependencyDetection.ignore(r.utils.setDomNodeChildrenFromArrayMapping,null,[u,n,l,i,c])},null,{disposeWhenNodeIsRemoved:u})};var u=r.utils.domData.nextKey();r.bindingHandlers.template={init:function(e,t){var n=r.utils.unwrapObservable(t());if(typeof n=="string"||n.name)r.virtualElements.emptyNode(e);else if("nodes"in n){var i=n.nodes||[];if(r.isObservable(i))throw new Error('The "nodes" option must be a plain, non-observable array.');var s=r.utils.moveCleanedNodesToContainerElement(i);(new r.templateSources.anonymousTemplate(e)).nodes(s)}else{var o=r.virtualElements.childNodes(e),s=r.utils.moveCleanedNodesToContainerElement(o);(new r.templateSources.anonymousTemplate(e)).nodes(s)}return{controlsDescendantBindings:!0}},update:function(e,t,n,i,s){var o=t(),u,f=r.utils.unwrapObservable(o),l=!0,c=null,h;typeof f=="string"?(h=o,f={}):(h=f.name,"if"in f&&(l=r.utils.unwrapObservable(f["if"])),l&&"ifnot"in f&&(l=!r.utils.unwrapObservable(f.ifnot)),u=r.utils.unwrapObservable(f.data));if("foreach"in f){var p=l&&f.foreach||[];c=r.renderTemplateForEach(h||e,p,f,e,s)}else if(!l)r.virtualElements.emptyNode(e);else{var d="data"in f?s.createChildContext(u,f.as):s;c=r.renderTemplate(h||e,d,f,e)}a(e,c)}},r.expressionRewriting.bindingRewriteValidators.template=function(e){var t=r.expressionRewriting.parseObjectLiteral(e);return t.length==1&&t[0].unknown?null:r.expressionRewriting.keyValueArrayContainsKey(t,"name")?null:"This template engine does not support anonymous templates nested within its templates"},r.virtualElements.allowedBindings.template=!0}(),r.exportSymbol("setTemplateEngine",r.setTemplateEngine),r.exportSymbol("renderTemplate",r.renderTemplate),r.utils.findMovesInArrayComparison=function(e,t,n){if(e.length&&t.length){var r,i,s,o,u;for(r=i=0;(!n||r<n)&&(o=e[i]);++i){for(s=0;u=t[s];++s)if(o.value===u.value){o.moved=u.index,u.moved=o.index,t.splice(s,1),r=s=0;break}r+=s}}},r.utils.compareArrays=function(){function n(n,r,s){return s=typeof s=="boolean"?{dontLimitMoves:s}:s||{},n=n||[],r=r||[],n.length<r.length?i(n,r,e,t,s):i(r,n,t,e,s)}function i(e,t,n,i,s){var o=Math.min,u=Math.max,a=[],f,l=e.length,c,h=t.length,p=h-l||1,d=l+h+1,v,m,g,y;for(f=0;f<=l;f++){m=v,a.push(v=[]),g=o(h,f+p),y=u(0,f-1);for(c=y;c<=g;c++)if(!c)v[c]=f+1;else if(!f)v[c]=c+1;else if(e[f-1]===t[c-1])v[c]=m[c-1];else{var b=m[c]||d,w=v[c-1]||d;v[c]=o(b,w)+1}}var E=[],S,x=[],T=[];for(f=l,c=h;f||c;)S=a[f][c]-1,c&&S===a[f][c-1]?x.push(E[E.length]={status:n,value:t[--c],index:c}):f&&S===a[f-1][c]?T.push(E[E.length]={status:i,value:e[--f],index:f}):(--c,--f,s.sparse||E.push({status:"retained",value:t[c]}));return r.utils.findMovesInArrayComparison(T,x,!s.dontLimitMoves&&l*10),E.reverse()}var e="added",t="deleted";return n}(),r.exportSymbol("utils.compareArrays",r.utils.compareArrays),function(){function e(e,t,n,i,s){var o=[],u=r.dependentObservable(function(){var u=t(n,s,r.utils.fixUpContinuousNodeArray(o,e))||[];o.length>0&&(r.utils.replaceDomNodes(o,u),i&&r.dependencyDetection.ignore(i,null,[n,u,s])),o.length=0,r.utils.arrayPushAll(o,u)},null,{disposeWhenNodeIsRemoved:e,disposeWhen:function(){return!r.utils.anyDomNodeIsAttachedToDocument(o)}});return{mappedNodes:o,dependentObservable:u.isActive()?u:undefined}}var t=r.utils.domData.nextKey(),n=r.utils.domData.nextKey();r.utils.setDomNodeChildrenFromArrayMapping=function(i,s,o,u,a){function S(e,t){E=l[t],v!==t&&(b[e]=E),E.indexObservable(v++),r.utils.fixUpContinuousNodeArray(E.mappedNodes,i),p.push(E),g.push(E)}function x(e,t){if(e)for(var n=0,i=t.length;n<i;n++)t[n]&&r.utils.arrayForEach(t[n].mappedNodes,function(r){e(r,n,t[n].arrayEntry)})}s=s||[],u=u||{};var f=r.utils.domData.get(i,t)===undefined,l=r.utils.domData.get(i,t)||[],c=r.utils.arrayMap(l,function(e){return e.arrayEntry}),h=r.utils.compareArrays(c,s,u.dontLimitMoves),p=[],d=0,v=0,m=[],g=[],y=[],b=[],w=[],E;for(var T=0,N,C;N=h[T];T++){C=N.moved;switch(N.status){case"deleted":C===undefined&&(E=l[d],E.dependentObservable&&(E.dependentObservable.dispose(),E.dependentObservable=undefined),r.utils.fixUpContinuousNodeArray(E.mappedNodes,i).length&&(u.beforeRemove&&(p.push(E),g.push(E),E.arrayEntry===n?E=null:y[T]=E),E&&m.push.apply(m,E.mappedNodes))),d++;break;case"retained":S(T,d++);break;case"added":C!==undefined?S(T,C):(E={arrayEntry:N.value,indexObservable:r.observable(v++)},p.push(E),g.push(E),f||(w[T]=E))}}r.utils.domData.set(i,t,p),x(u.beforeMove,b),r.utils.arrayForEach(m,u.beforeRemove?r.cleanNode:r.removeNode);for(var T=0,k=r.virtualElements.firstChild(i),L,A;E=g[T];T++){E.mappedNodes||r.utils.extend(E,e(i,o,E.arrayEntry,a,E.indexObservable));for(var O=0;A=E.mappedNodes[O];k=A.nextSibling,L=A,O++)A!==k&&r.virtualElements.insertAfter(i,A,L);!E.initialized&&a&&(a(E.arrayEntry,E.mappedNodes,E.indexObservable),E.initialized=!0)}x(u.beforeRemove,y);for(T=0;T<y.length;++T)y[T]&&(y[T].arrayEntry=n);x(u.afterMove,b),x(u.afterAdd,w)}}(),r.exportSymbol("utils.setDomNodeChildrenFromArrayMapping",r.utils.setDomNodeChildrenFromArrayMapping),r.nativeTemplateEngine=function(){this.allowTemplateRewriting=!1},r.nativeTemplateEngine.prototype=new r.templateEngine,r.nativeTemplateEngine.prototype.constructor=r.nativeTemplateEngine,r.nativeTemplateEngine.prototype.renderTemplateSource=function(e,t,n,i){var s=!(r.utils.ieVersion<9),o=s?e.nodes:null,u=o?e.nodes():null;if(u)return r.utils.makeArray(u.cloneNode(!0).childNodes);var a=e.text();return r.utils.parseHtmlFragment(a,i)},r.nativeTemplateEngine.instance=new r.nativeTemplateEngine,r.setTemplateEngine(r.nativeTemplateEngine.instance),r.exportSymbol("nativeTemplateEngine",r.nativeTemplateEngine),function(){r.jqueryTmplTemplateEngine=function(){function t(){if(e<2)throw new Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later.")}function n(e,t,n){return jQueryInstance.tmpl(e,t,n)}var e=this.jQueryTmplVersion=function(){if(!jQueryInstance||!jQueryInstance.tmpl)return 0;try{if(jQueryInstance.tmpl.tag.tmpl.open.toString().indexOf("__")>=0)return 2}catch(e){}return 1}();this.renderTemplateSource=function(e,r,i,s){s=s||document,i=i||{},t();var o=e.data("precompiled");if(!o){var u=e.text()||"";u="{{ko_with $item.koBindingContext}}"+u+"{{/ko_with}}",o=jQueryInstance.template(null,u),e.data("precompiled",o)}var a=[r.$data],f=jQueryInstance.extend({koBindingContext:r},i.templateOptions),l=n(o,a,f);return l.appendTo(s.createElement("div")),jQueryInstance.fragments={},l},this.createJavaScriptEvaluatorBlock=function(e){return"{{ko_code ((function() { return "+e+" })()) }}"},this.addTemplate=function(e,t){document.write("<script type='text/html' id='"+e+"'>"+t+"<"+"/script>")},e>0&&(jQueryInstance.tmpl.tag.ko_code={open:"__.push($1 || '');"},jQueryInstance.tmpl.tag.ko_with={open:"with($1) {",close:"} "})},r.jqueryTmplTemplateEngine.prototype=new r.templateEngine,r.jqueryTmplTemplateEngine.prototype.constructor=r.jqueryTmplTemplateEngine;var e=new r.jqueryTmplTemplateEngine;e.jQueryTmplVersion>0&&r.setTemplateEngine(e),r.exportSymbol("jqueryTmplTemplateEngine",r.jqueryTmplTemplateEngine)}()})})()}(),!tadpoles.define("selfish",["require","exports","module","lodash","compat"],function(e,t){var n=e("lodash"),r=e("compat");t.Base=Object.create(Object.prototype,{create:{value:function(){var t=Object.create(this);return n.bindAll(t),t.initialize.apply(t,arguments),t}},initialize:{value:function(){}},merge:{value:function(){var t={},n=this;return Array.prototype.forEach.call(arguments,function(e){Object.getOwnPropertyNames(e).forEach(function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)})}),Object.defineProperties(this,t),this}},extend:{value:function(){return this.merge.apply(Object.create(this),arguments)}}})}),tadpoles.define("services/config",["require","selfish"],function(e){var t=e("selfish"),n=t.Base.extend({className:"Config",initialize:function(e){var t=this,n=window.tadpoles;t.CB=n.CB,t.baseUrl=n.baseUrl||"",t.isDemo=n.isDemo,t.isWidget=n.isWidget,t.params=n.appParams||{},t.appName=n.appName,t.channel={},t.env=t.params.env,t.user=t.params.user,t.person=t.params.person,t.employees=t.params.employees,t.product=t.params.product,t.locations=t.params.locations,t.groups=t.params.groups,t.account=t.params.account||{},t.labels=t.params.labels,t.location=t.params.location,t.atFacility=t.params.at_facility;try{t.locations&&t.locations.length===1&&(t.location=t.locations[0])}catch(r){}t.isProviderApp=t.appName==="provider",t.isParentApp=t.appName==="parent"},getParam:function(e){return this.params[e]}});return n.create()}),tadpoles.define("services/analytics",["require","services/config"],function(e){var t=e("services/config");if(!t.isWidget)try{(function(){var e=e||[];e.push(["_setAccount","UA-19847545-1"]),e.push(["_trackPageview"]),function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()})()}catch(n){}return{trackEvent:function(e,n,r){if(!t.isWidget)try{_gaq.push(["_trackEvent",e,n])}catch(i){}}}}),function(){function e(){}function t(e,t){for(var n=e.length;n--;)if(e[n].listener===t)return n;return-1}function n(e){return function(){return this[e].apply(this,arguments)}}var r=e.prototype,i=this,s=i.EventEmitter;r.getListeners=function(e){var t,n,r=this._getEvents();if(e instanceof RegExp){t={};for(n in r)r.hasOwnProperty(n)&&e.test(n)&&(t[n]=r[n])}else t=r[e]||(r[e]=[]);return t},r.flattenListeners=function(e){var t,n=[];for(t=0;t<e.length;t+=1)n.push(e[t].listener);return n},r.getListenersAsObject=function(e){var t,n=this.getListeners(e);return n instanceof Array&&(t={},t[e]=n),t||n},r.addListener=function(e,n){var r,i=this.getListenersAsObject(e),s="object"==typeof n;for(r in i)i.hasOwnProperty(r)&&-1===t(i[r],n)&&i[r].push(s?n:{listener:n,once:!1});return this},r.on=n("addListener"),r.addOnceListener=function(e,t){return this.addListener(e,{listener:t,once:!0})},r.once=n("addOnceListener"),r.defineEvent=function(e){return this.getListeners(e),this},r.defineEvents=function(e){for(var t=0;t<e.length;t+=1)this.defineEvent(e[t]);return this},r.removeListener=function(e,n){var r,i,s=this.getListenersAsObject(e);for(i in s)s.hasOwnProperty(i)&&(r=t(s[i],n),-1!==r&&s[i].splice(r,1));return this},r.off=n("removeListener"),r.addListeners=function(e,t){return this.manipulateListeners(!1,e,t)},r.removeListeners=function(e,t){return this.manipulateListeners(!0,e,t)},r.manipulateListeners=function(e,t,n){var r,i,s=e?this.removeListener:this.addListener,o=e?this.removeListeners:this.addListeners;if("object"!=typeof t||t instanceof RegExp)for(r=n.length;r--;)s.call(this,t,n[r]);else for(r in t)t.hasOwnProperty(r)&&(i=t[r])&&("function"==typeof i?s.call(this,r,i):o.call(this,r,i));return this},r.removeEvent=function(e){var t,n=typeof e,r=this._getEvents();if("string"===n)delete r[e];else if(e instanceof RegExp)for(t in r)r.hasOwnProperty(t)&&e.test(t)&&delete r[t];else delete this._events;return this},r.removeAllListeners=n("removeEvent"),r.emitEvent=function(e,t){var n,r,i,s,o=this.getListenersAsObject(e);for(i in o)if(o.hasOwnProperty(i))for(r=o[i].length;r--;)n=o[i][r],n.once===!0&&this.removeListener(e,n.listener),s=n.listener.apply(this,t||[]),s===this._getOnceReturnValue()&&this.removeListener(e,n.listener);return this},r.trigger=n("emitEvent"),r.emit=function(e){var t=Array.prototype.slice.call(arguments,1);return this.emitEvent(e,t)},r.setOnceReturnValue=function(e){return this._onceReturnValue=e,this},r._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},r._getEvents=function(){return this._events||(this._events={})},e.noConflict=function(){return i.EventEmitter=s,e},"function"==typeof tadpoles.define&&tadpoles.define.amd?tadpoles.define("EventEmitter",[],function(){return e}):"object"==typeof module&&module.exports?module.exports=e:this.EventEmitter=e}.call(this),tadpoles.define("emit",["require","EventEmitter"],function(e){var t=e("EventEmitter");return new t}),window.Modernizr=function(e,t,n){function r(e){g.cssText=e}function i(e,t){return r(prefixes.join(e+";")+(t||""))}function s(e,t){return typeof e===t}function o(e,t){return!!~(""+e).indexOf(t)}function u(e,t){for(var r in e)if(g[e[r]]!==n)return t=="pfx"?e[r]:!0;return!1}function a(e,t,r){for(var i in e){var o=t[e[i]];if(o!==n)return r===!1?e[i]:s(o,"function")?o.bind(r||t):o}return!1}function f(e,t,n){var r=e.charAt(0).toUpperCase()+e.substr(1),i=(e+" "+E.join(r+" ")+r).split(" ");return s(t,"string")||s(t,"undefined")?u(i,t):(i=(e+" "+S.join(r+" ")+r).split(" "),a(i,t,n))}function l(){h.input=function(n){for(var r=0,i=n.length;r<i;r++)N[n[r]]=n[r]in y;return N.list&&(N.list=!!t.createElement("datalist")&&!!e.HTMLDataListElement),N}("autocomplete autofocus list placeholder max min multiple pattern required step".split(" "))}var c="2.5.3",h={},p=!0,d=t.documentElement,v="modernizr",m=t.createElement(v),g=m.style,y=t.createElement("input"),b={}.toString,w="Webkit Moz O ms",E=w.split(" "),S=w.toLowerCase().split(" "),x={},T={},N={},C=[],k=C.slice,L,A={}.hasOwnProperty,O;!s(A,"undefined")&&!s(A.call,"undefined")?O=function(e,t){return A.call(e,t)}:O=function(e,t){return t in e&&s(e.constructor.prototype[t],"undefined")},Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if(typeof t!="function")throw new TypeError;var n=k.call(arguments,1),r=function(){if(this instanceof r){var i=function(){};i.prototype=t.prototype;var s=new i,o=t.apply(s,n.concat(k.call(arguments)));return Object(o)===o?o:s}return t.apply(e,n.concat(k.call(arguments)))};return r}),x.borderradius=function(){return f("borderRadius")};for(var M in x)O(x,M)&&(L=M.toLowerCase(),h[L]=x[M](),C.push((h[L]?"":"no-")+L));return h.input||l(),h.addTest=function(e,t){if(typeof e=="object")for(var r in e)O(e,r)&&h.addTest(r,e[r]);else{e=e.toLowerCase();if(h[e]!==n)return h;t=typeof t=="function"?t():t,d.className+=" "+(t?"":"no-")+e,h[e]=t}return h},r(""),m=y=null,function(e,t){function n(e,t){var n=e.createElement("p"),r=e.getElementsByTagName("head")[0]||e.documentElement;return n.innerHTML="x<style>"+t+"</style>",r.insertBefore(n.lastChild,r.firstChild)}function r(){var e=l.elements;return typeof e=="string"?e.split(" "):e}function i(e){var t={},n=e.createElement,i=e.createDocumentFragment,s=i();e.createElement=function(e){var r=(t[e]||(t[e]=n(e))).cloneNode();return l.shivMethods&&r.canHaveChildren&&!u.test(e)?s.appendChild(r):r},e.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+r().join().replace(/\w+/g,function(e){return t[e]=n(e),s.createElement(e),'c("'+e+'")'})+");return n}")(l,s)}function s(e){var t;return e.documentShived?e:(l.shivCSS&&!a&&(t=!!n(e,"article,aside,details,figcaption,figure,footer,header,hgroup,nav,section{display:block}audio{display:none}canvas,video{display:inline-block;*display:inline;*zoom:1}[hidden]{display:none}audio[controls]{display:inline-block;*display:inline;*zoom:1}mark{background:#FF0;color:#000}")),f||(t=!i(e)),t&&(e.documentShived=t),e)}var o=e.html5||{},u=/^<|^(?:button|form|map|select|textarea)$/i,a,f;(function(){var e=t.createElement("a");e.innerHTML="<xyz></xyz>",a="hidden"in e,f=e.childNodes.length==1||function(){try{t.createElement("a")}catch(e){return!0}var n=t.createDocumentFragment();return typeof n.cloneNode=="undefined"||typeof n.createDocumentFragment=="undefined"||typeof n.createElement=="undefined"}()})();var l={elements:o.elements||"abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video",shivCSS:o.shivCSS!==!1,shivMethods:o.shivMethods!==!1,type:"default",shivDocument:s};e.html5=l,s(t)}(this,t),h._version=c,h._domPrefixes=S,h._cssomPrefixes=E,h.testProp=function(e){return u([e])},h.testAllProps=f,d.className=d.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(p?" js "+C.join(" "):""),h}(this,this.document),function(e,t,n){function r(e){return d.call(e)=="[object Function]"}function i(e){return typeof e=="string"}function s(){}function o(e){return!e||e=="loaded"||e=="complete"||e=="uninitialized"}function u(){var e=v.shift();m=1,e?e.t?h(function(){(e.t=="c"?k.injectCss:k.injectJs)(e.s,0,e.a,e.x,e.e,1)},0):(e(),u()):m=0}function a(e,n,r,i,s,a,f){function l(t){if(!d&&o(c.readyState)&&(w.r=d=1,!m&&u(),c.onload=c.onreadystatechange=null,t)){e!="img"&&h(function(){b.removeChild(c)},50);for(var r in T[n])T[n].hasOwnProperty(r)&&T[n][r].onload()}}var f=f||k.errorTimeout,c={},d=0,g=0,w={t:r,s:n,e:s,a:a,x:f};T[n]===1&&(g=1,T[n]=[],c=t.createElement(e)),e=="object"?c.data=n:(c.src=n,c.type=e),c.width=c.height="0",c.onerror=c.onload=c.onreadystatechange=function(){l.call(this,g)},v.splice(i,0,w),e!="img"&&(g||T[n]===2?(b.insertBefore(c,y?null:p),h(l,f)):T[n].push(c))}function f(e,t,n,r,s){return m=0,t=t||"j",i(e)?a(t=="c"?E:w,e,t,this.i++,n,r,s):(v.splice(this.i++,0,e),v.length==1&&u()),this}function l(){var e=k;return e.loader={load:f,i:0},e}var c=t.documentElement,h=e.setTimeout,p=t.getElementsByTagName("script")[0],d={}.toString,v=[],m=0,g="MozAppearance"in c.style,y=g&&!!t.createRange().compareNode,b=y?c:p.parentNode,c=e.opera&&d.call(e.opera)=="[object Opera]",c=!!t.attachEvent&&!c,w=g?"object":c?"script":"img",E=c?"script":w,S=Array.isArray||function(e){return d.call(e)=="[object Array]"},x=[],T={},N={timeout:function(e,t){return t.length&&(e.timeout=t[0]),e}},C,k;k=function(e){function t(e){var e=e.split("!"),t=x.length,n=e.pop(),r=e.length,n={url:n,origUrl:n,prefixes:e},i,s,o;for(s=0;s<r;s++)o=e[s].split("="),(i=N[o.shift()])&&(n=i(n,o));for(s=0;s<t;s++)n=x[s](n);return n}function o(e,i,s,o,a){var f=t(e),c=f.autoCallback;f.url.split(".").pop().split("?").shift(),f.bypass||(i&&(i=r(i)?i:i[e]||i[o]||i[e.split("/").pop().split("?")[0]]||u),f.instead?f.instead(e,i,s,o,a):(T[f.url]?f.noexec=!0:T[f.url]=1,s.load(f.url,f.forceCSS||!f.forceJS&&"css"==f.url.split(".").pop().split("?").shift()?"c":n,f.noexec,f.attrs,f.timeout),(r(i)||r(c))&&s.load(function(){l(),i&&i(f.origUrl,a,o),c&&c(f.origUrl,a,o),T[f.url]=2})))}function a(e,t){function n(e,n){if(e){if(i(e))n||(f=function(){var e=[].slice.call(arguments);l.apply(this,e),c()}),o(e,f,t,0,u);else if(Object(e)===e)for(p in h=function(){var t=0,n;for(n in e)e.hasOwnProperty(n)&&t++;return t}(),e)e.hasOwnProperty(p)&&(!n&&!--h&&(r(f)?f=function(){var e=[].slice.call(arguments);l.apply(this,e),c()}:f[p]=function(e){return function(){var t=[].slice.call(arguments);e&&e.apply(this,t),c()}}(l[p])),o(e[p],f,t,p,u))}else!n&&c()}var u=!!e.test,a=e.load||e.both,f=e.callback||s,l=f,c=e.complete||s,h,p;n(u?e.yep:e.nope,!!a),a&&n(a)}var f,c,h=this.yepnope.loader;if(i(e))o(e,0,h,0);else if(S(e))for(f=0;f<e.length;f++)c=e[f],i(c)?o(c,0,h,0):S(c)?k(c):Object(c)===c&&a(c,h);else Object(e)===e&&a(e,h)},k.addPrefix=function(e,t){N[e]=t},k.addFilter=function(e){x.push(e)},k.errorTimeout=1e4,t.readyState==null&&t.addEventListener&&(t.readyState="loading",t.addEventListener("DOMContentLoaded",C=function(){t.removeEventListener("DOMContentLoaded",C,0),t.readyState="complete"},0)),e.yepnope=l(),e.yepnope.executeStack=u,e.yepnope.injectJs=function(e,n,r,i,a,f){var l=t.createElement("script"),c,d,i=i||k.errorTimeout;l.src=e;for(d in r)l.setAttribute(d,r[d]);n=f?u:n||s,l.onreadystatechange=l.onload=function(){!c&&o(l.readyState)&&(c=1,n(),l.onload=l.onreadystatechange=null)},h(function(){c||(c=1,n(1))},i),a?l.onload():p.parentNode.insertBefore(l,p)},e.yepnope.injectCss=function(e,n,r,i,o,a){var i=t.createElement("link"),f,n=a?u:n||s;i.href=e,i.rel="stylesheet",i.type="text/css";for(f in r)i.setAttribute(f,r[f]);o||(p.parentNode.insertBefore(i,p),h(n,0))}}(this,document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))},tadpoles.define("modernizr",function(){}),tadpoles.define("services/cssLoader",["require","selfish","services/config","jquery"],function(e){var t=e("selfish"),n=e("services/config"),r=e("jquery"),i=t.Base.extend({className:"CSSLoader",initialize:function(e){var t=this},loadCSS:function(e){var t=e.indexOf("/");t===0&&e.length>1&&(t=e.indexOf("/",1));var i=e.startsWith("http")?e:n.baseUrl+(e.substring(0,t+1)+n.CB+e.substring(t+1)),s=r("<link rel='stylesheet' type='text/css' href='"+i+"'>");r("head").append(s)}});return i.create()}),tadpoles.define("utilities",["require","jquery","lodash","services/config","emit","modernizr","ko","services/cssLoader"],function(e){var t=e("jquery"),n=e("lodash"),r=e("services/config"),i=e("emit"),s=e("modernizr"),o=e("ko"),u=e("services/cssLoader"),a=t(window).width()<=768,f={childSelection:null,isNull:function(e){return e===null||typeof e=="undefined"},isEmail:function(e){var n=/^(([a-zA-Z0-9_\-\.]+)@([a-zA-Z0-9_\-\.]+)\.([a-zA-Z]{2,5}){1,25})$/;return e!=null&&n.test(t.trim(e))},isParent:function(){return r.isParentApp},convertPlatformDateStringToDate:function(e){var t=null;return f.isNull(e)||(t=new Date,t.setISO8601(e)),t},dateFormatter:function(e){var t=null;return f.isNull(e)||(t=e.f("MMM d, yyyy")),t},valueOrNbsp:function(e){return f.isNull(e)?"&nbsp;":e},countSchedules:function(e){var t={monday:0,tuesday:0,wednesday:0,thursday:0,friday:0,saturday:0,sunday:0,mondayA:0,tuesdayA:0,wednesdayA:0,thursdayA:0,fridayA:0,saturdayA:0,sundayA:0,mondayP:0,tuesdayP:0,wednesdayP:0,thursdayP:0,fridayP:0,saturdayP:0,sundayP:0,mondayBA:0,tuesdayBA:0,wednesdayBA:0,thursdayBA:0,fridayBA:0,saturdayBA:0,sundayBA:0,mondayF:0,tuesdayF:0,wednesdayF:0,thursdayF:0,fridayF:0,saturdayF:0,sundayF:0},r=n.reduce(e,function(e,t){var n=t.schedule();if(n){e.monday+=n.monday()?1:0,e.tuesday+=n.tuesday()?1:0,e.wednesday+=n.wednesday()?1:0,e.thursday+=n.thursday()?1:0,e.friday+=n.friday()?1:0,e.saturday+=n.saturday()?1:0,e.sunday+=n.sunday()?1:0,n.enrollment()==="Morning"&&(e.mondayA+=n.monday()?1:0,e.tuesdayA+=n.tuesday()?1:0,e.wednesdayA+=n.wednesday()?1:0,e.thursdayA+=n.thursday()?1:0,e.fridayA+=n.friday()?1:0,e.saturdayA+=n.saturday()?1:0,e.sundayA+=n.sunday()?1:0),n.enrollment()==="Afternoon"&&(e.mondayP+=n.monday()?1:0,e.tuesdayP+=n.tuesday()?1:0,e.wednesdayP+=n.wednesday()?1:0,e.thursdayP+=n.thursday()?1:0,e.fridayP+=n.friday()?1:0,e.saturdayP+=n.saturday()?1:0,e.sundayP+=n.sunday()?1:0),n.enrollment()==="Before/After School"&&(e.mondayBA+=n.monday()?1:0,e.tuesdayBA+=n.tuesday()?1:0,e.wednesdayBA+=n.wednesday()?1:0,e.thursdayBA+=n.thursday()?1:0,e.fridayBA+=n.friday()?1:0,e.saturdayBA+=n.saturday()?1:0,e.sundayBA+=n.sunday()?1:0);if(n.enrollment()==="Day"||f.isNull(n.enrollment()))e.mondayF+=n.monday()?1:0,e.tuesdayF+=n.tuesday()?1:0,e.wednesdayF+=n.wednesday()?1:0,e.thursdayF+=n.thursday()?1:0,e.fridayF+=n.friday()?1:0,e.saturdayF+=n.saturday()?1:0,e.sundayF+=n.sunday()?1:0}return e},t);return r},prepareModernizer:function(){Modernizr.load({test:Modernizr.input.placeholder,nope:"/javascript/"+r.CB+"polyfill/placeholders.min.js",complete:function(){Modernizr.input.placeholder||Placeholders.init(!0)}})},generateFancyDefaults:function(){var e=this;return{padding:0,preload:0,arrows:!1,scrolling:"no",prevEffect:"fade",nextEffect:"fade",nextSpeed:"slow",prevSpeed:"slow",closeBtn:!1,helpers:{title:{type:"outside"},buttons:{}},afterLoad:function(e,t){t&&t.type==="inline"&&t.content.empty()},beforeShow:function(){t(".fancybox-overlay").css({zIndex:t(".modal-scrollable").length>0?1061:1e3})},afterShow:function(){t(".fancybox-inner").css({zIndex:t(".modal-scrollable").length>0?1062:1001}),t(".fancybox-title").css({zIndex:t(".modal-scrollable").length>0?1061:1001});var n=t('<div class="photo-print">'),r=o.dataFor(this.element.get(0));if(this.type==="image"){if(e.isParent()){r.canShare&&!r.canShare()?t('<div style="position:absolute;top:0;left:0;right:0;bottom:0;height:100%;width:100%" oncontextmenu="return false;">&nbsp;</div>').appendTo(this.inner):r.canShare&&(t('<img src="/images/2/sharetray_with_download.png" alt="share via facebook/email or download" usemap="#sharetray-map" width="150" height="40"/><map name="sharetray-map" id="sharetray-map"><area shape="rect" coords="0,0,44,40" href="#" alt="share via facebook" data-bind="click: shareToFacebook"><area shape="rect" coords="45,0,100,40" href="#" alt="share via email" data-bind="click: shareViaEmail"><area shape="rect" coords="101,0,150,40" href="#" alt="download" data-bind="click: download"></map></div>').appendTo(n),n.appendTo(this.inner),o.applyBindings(r,n.get(0)));return}t('<div id="viewPrintButton" class="btn btn-inverse btn-mini btn-action">print</div>').appendTo(n).click(function(){t(".photo-print").hide(),t(".fancybox-inner").jqprint(),t(".photo-print").show()}),r.inOutbox&&r.inOutbox()&&t('<div id="viewApproveButton" class="btn btn-warning btn-mini btn-action" data-bind="click: approve">approve</div></div>').appendTo(n),n.appendTo(this.inner)}else if(this.type==="inline"){var s=t(".fancybox-inner > div"),u=t('<video id="vid" class="video-js vjs-default-skin vjs-big-play-centered" controls autoplay preload="auto" width="'+s.width()+'" height="'+s.height()+'"><source src="'+s.attr("rel")+'" type="video/mp4"/></video>');this.content.append(u),videojs(u.get(0),{},function(){}),r.inOutbox&&r.inOutbox()&&(t('<div id="viewApproveButton" class="btn btn-warning btn-mini btn-action" data-bind="click: approve">approve</div></div>').appendTo(n),n.attr("style","top: 10px; bottom:auto; right: 6px; "),n.appendTo(this.inner))}o.applyBindings(r,n.get(0)),i.once("new-event",function(e){r.key===e.key&&t.fancybox.close()})},beforeClose:function(){this.type==="inline"&&this.content.empty()}}},prepareFancyBox:function(){var e=this;r.isWidget&&(u.loadCSS("/stylesheets/jquery.fancybox.css?v=2.1.5.0"),u.loadCSS("/stylesheets/jquery.fancybox-buttons.css?v=1.0.5")),t(function(){t(".fancybox").fancybox(e.generateFancyDefaults())})},lazyLoadModule:function(t,n){if(!t){var r=e;t=r(n)}return t},afterEvents:function(e,t){function s(e){r=n.without(r,e),r.length===0&&t()}var r=e.slice(0);n.each(e,function(e){i.once(e,function(t){s(e)})})},makeSingleton:function(e,t){var n=null;return{getInstance:function(r){return n||(n=e.create(t||r)),n}}},transpose:function(e){var t=[],r=n.max(e,function(e){return e.length}).length;return n.each(n.range(r),function(r){t.push(n.pluck(e,r))}),t},sortBySortValue:function(e,r,i){function s(e,t){return n.isFunction(t)?t(e):e[t]}var o=n(e).groupBy(function(e){var i=s(e,r);return n.isNull(i)||n.isUndefined(i)||t.trim(i)==""?"nosort":isNaN(i)?"charsort":"numsort"}).value(),u=n(o.numsort).sortBy(function(e){return parseInt(s(e,r))}).value(),a=n(o.charsort).sortBy("sort").value(),f=n(o.nosort).sortBy(function(e){var t=s(e,i);return t?t.toLowerCase():""}).value();return n(u).concat(a).concat(f).value()},parseDate:function(e){var t=e.match(/(\d+)/g);return new Date(t[0],t[1]-1,t[2])},inIframe:function(){try{return window.self!==window.top}catch(e){return!0}},getURLParameter:function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)"),n=t.exec(location.search);return n===null?null:decodeURIComponent(n[1].replace(/\+/g," "))},isSmallScreen:a};return f}),tadpoles.define("services/unitTests",["require","selfish","services/config","utilities"],function(e){var t=e("selfish"),n=e("services/config"),r=e("utilities"),i=document.location.origin+"/app/"+n.CB+"lib/js/",s=i+"chai.js",o=i+"mocha.js",u=i+"WebConsole.js",a=t.Base.extend({className:"UnitTests",initialize:function(){var e=this;e.suite=r.getURLParameter("tpsuite")},setup:function(t){var r=this;t.afterRender=this.suite?function(){e([s,u,o],function(e,t){typeof initMochaPhantomJS=="function"&&(initMochaPhantomJS(),window.initMochaPhantomJS=function(){});var i=window.mocha;i.setup({ui:"tdd",reporter:t}),tadpoles.require(["chai",document.location.origin+"/app/"+n.CB+"test/suites/"+r.suite+".js"],function(e){window.chai=e,i.run()})})}:function(){}}});return a.create({})}),function(){function b(){if(!t){var e=(g?g:"")+".resize-triggers { "+(y?y:"")+"visibility: hidden; opacity: 0; } "+'.resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e)),n.appendChild(r),t=!0}}var e=document.attachEvent,t=!1;if(!e){var n=function(){var e=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(e){return window.setTimeout(e,20)};return function(t){return e(t)}}(),r=function(){var e=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.clearTimeout;return function(t){return e(t)}}();function i(e){var t=e.__resizeTriggers__,n=t.firstElementChild,r=t.lastElementChild,i=n.firstElementChild;r.scrollLeft=r.scrollWidth,r.scrollTop=r.scrollHeight,i.style.width=n.offsetWidth+1+"px",i.style.height=n.offsetHeight+1+"px",n.scrollLeft=n.scrollWidth,n.scrollTop=n.scrollHeight}function s(e){return e.offsetWidth!=e.__resizeLast__.width||e.offsetHeight!=e.__resizeLast__.height}function o(e){var t=this;i(this),this.__resizeRAF__&&r(this.__resizeRAF__),this.__resizeRAF__=n(function(){s(t)&&(t.__resizeLast__.width=t.offsetWidth,t.__resizeLast__.height=t.offsetHeight,t.__resizeListeners__.forEach(function(n){n.call(t,e)}))})}var u=!1,a="animation",f="",l="animationstart",c="Webkit Moz O ms".split(" "),h="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),p="",d=document.createElement("fakeelement");d.style.animationName!==undefined&&(u=!0);if(u===!1)for(var v=0;v<c.length;v++)if(d.style[c[v]+"AnimationName"]!==undefined){p=c[v],a=p+"Animation",f="-"+p.toLowerCase()+"-",l=h[v],u=!0;break}var m="resizeanim",g="@"+f+"keyframes "+m+" { from { opacity: 0; } to { opacity: 0; } } ",y=f+"animation: 1ms "+m+"; "}window.addResizeListener=function(t,n){e?t.attachEvent("onresize",n):(t.__resizeTriggers__||(getComputedStyle(t).position=="static"&&(t.style.position="relative"),b(),t.__resizeLast__={},t.__resizeListeners__=[],(t.__resizeTriggers__=document.createElement("div")).className="resize-triggers",t.__resizeTriggers__.innerHTML='<div class="expand-trigger"><div></div></div><div class="contract-trigger"></div>',t.appendChild(t.__resizeTriggers__),i(t),t.addEventListener("scroll",o,!0),l&&t.__resizeTriggers__.addEventListener(l,function(e){e.animationName==m&&i(t)})),t.__resizeListeners__.push(n))},window.removeResizeListener=function(t,n){e?t.detachEvent("onresize",n):(t.__resizeListeners__.splice(t.__resizeListeners__.indexOf(n),1),t.__resizeListeners__.length||(t.removeEventListener("scroll",o),t.__resizeTriggers__=!t.removeChild(t.__resizeTriggers__)))}}(),tadpoles.define("lib/js/detect-element-resize",function(){}),tadpoles.define("components/modal",["require","jquery","utilities","lib/js/detect-element-resize"],function(e){function c(){var e=n.height(),t=n.width(),r=n.height()/2,i=n.width()/2,s=!1,u=!1;a.forEach(function(n){var o=!1,a=!1;n.css({left:i-n.width()/2+"px",top:r-n.height()/2+"px"}),n.height()>e&&(a=!0,u=!0),n.width()>t&&(o=!0,s=!0),o?n.addClass("overflowing-x"):n.removeClass("overflowing-x").removeClass("overflowing-both"),a?n.addClass("overflowing-y"):n.removeClass("overflowing-y").removeClass("overflowing-both"),o&&a&&n.addClass("overflowing-both")}),s&&o.css("overflow-x","auto"),u&&o.css("overflow-y","auto"),!s&&!u&&o.css("overflow","hidden")}var t=e("jquery"),n=t(window),r=t(document.body),i=t("html"),s=t('<div class="modal-screen hidden"></div>'),o=t('<div class="tadpoles modal-overflow-wrapper"></div>').hide(),u=e("utilities"),a=[],f=[];e("lib/js/detect-element-resize");var l=2;return r.append(o.append(s)),function(e,r){var h=t(e);return typeof r.width!="undefined"&&r.width!==null&&h.css("width",r.width),typeof r.height!="undefined"&&r.height!==null&&h.css("height",r.height),typeof r.maxHeight!="undefined"&&r.maxHeight!==null&&h.css("max-height",r.maxHeight),o.append(h),{open:function(){a.length===0&&(o.show(),i.addClass("modal-showing"),s.removeClass("hidden"),s.addClass("show"),u.isSmallScreen||n.on("resize",c)),a.push(h);var e=l+a.length;s.css("z-index",e),u.isSmallScreen&&(f.push({left:n.scrollLeft(),top:n.scrollTop()}),setTimeout(function(){window.scrollTo(0,0)},300));if(!u.isSmallScreen){var r=t(".modal-body",h);r.length&&window.addResizeListener(r[0],c),setTimeout(function(){c(),h.addClass("modal-open").css("z-index",e),r.length||(r=t(".modal-body",h),r.length?window.addResizeListener(r[0],c):setTimeout(function(){c(),r=t(".modal-body",h),r.length&&window.addResizeListener(r[0],c)},100))},50)}else h.addClass("modal-open").css("z-index",e);return this},close:function(){if(a.length===0)return;if(u.isSmallScreen){var e=f.pop();window.scrollTo(e.left,e.top)}else try{window.removeResizeListener(t(".modal-body",h)[0],c)}catch(r){}return a.length===1?(o.hide(),i.removeClass("modal-showing"),s.removeClass("show"),s.addClass("hidden"),u.isSmallScreen||n.off("resize",c)):s.css("z-index",Number(s.css("z-index"))-1),h.removeClass("modal-open").css("z-index",null),a.pop(),this}}}}),tadpoles.define("services/modal",["require","ko","selfish","components/modal"],function(e){var t=e("ko"),n=e("selfish"),r=e("components/modal"),i=t.observableArray([]),s=n.Base.extend({className:"Modal",initialize:function(e){this.model=t.observable(typeof e.model!="undefined"?e.model:this),this.id=e.template.replace(/\//g,"-")+"-"+Math.floor(Math.random()*1e5+1),this.template=e.template,this.width=t.observable(e.width||"560px"),this.height=t.observable(e.height?e.height:null),this.maxHeight=t.observable(e.maxHeight?e.maxHeight:null),this.clearModelOnClose=e.clearModelOnClose,this.isOpen=t.observable(!1),i.push(this)},open:function(e){e&&this.setModel(e);if(this.isOpen())return;this.modal?this.modal.open():this.modal=r("#"+this.id,{width:this.width(),maxHeight:this.maxHeight(),height:this.height()}).open(),this.isOpen(!0)},close:function(){this.clearModelOnClose&&this.model(null),this.modal&&this.modal.close(),this.isOpen(!1)},setModel:function(e){this.model(e)},getModel:function(){return this.model()}});return s.modals=i,s}),tadpoles.define("services/app",["require","ko","selfish","services/modal","services/config"],function(e){var t=e("ko"),n=e("selfish"),r=e("services/modal"),i=e("services/config"),s=n.Base.extend({initialize:function(e){e=e||{};var t=this;t.modals=r.modals,t.config=i}});return s}),function(e){typeof tadpoles.define=="function"&&tadpoles.define.amd?tadpoles.define("jqueryui",["jquery"],e):e(jQuery)}(function(e){function t(t,r){var i,s,o,u=t.nodeName.toLowerCase();return"area"===u?(i=t.parentNode,s=i.name,!t.href||!s||i.nodeName.toLowerCase()!=="map"?!1:(o=e("img[usemap=#"+s+"]")[0],!!o&&n(o))):(/input|select|textarea|button|object/.test(u)?!t.disabled:"a"===u?t.href||r:r)&&n(t)}function n(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return e.css(this,"visibility")==="hidden"}).length}function d(e){var t,n;while(e.length&&e[0]!==document){t=e.css("position");if(t==="absolute"||t==="relative"||t==="fixed"){n=parseInt(e.css("zIndex"),10);if(!isNaN(n)&&n!==0)return n}e=e.parent()}return 0}function v(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},e.extend(this._defaults,this.regional[""]),this.regional.en=e.extend(!0,{},this.regional[""]),this.regional["en-US"]=e.extend(!0,{},this.regional.en),this.dpDiv=m(e("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function m(t){var n="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return t.delegate(n,"mouseout",function(){e(this).removeClass("ui-state-hover"),this.className.indexOf("ui-datepicker-prev")!==-1&&e(this).removeClass("ui-datepicker-prev-hover"),this.className.indexOf("ui-datepicker-next")!==-1&&e(this).removeClass("ui-datepicker-next-hover")}).delegate(n,"mouseover",function(){e.datepicker._isDisabledDatepicker(p.inline?t.parent()[0]:p.input[0])||(e(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),e(this).addClass("ui-state-hover"),this.className.indexOf("ui-datepicker-prev")!==-1&&e(this).addClass("ui-datepicker-prev-hover"),this.className.indexOf("ui-datepicker-next")!==-1&&e(this).addClass("ui-datepicker-next-hover"))})}function g(t,n){e.extend(t,n);for(var r in n)n[r]==null&&(t[r]=n[r]);return t}e.ui=e.ui||{},e.extend(e.ui,{version:"1.11.0",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({scrollParent:function(){var t=this.css("position"),n=t==="absolute",r=this.parents().filter(function(){var t=e(this);return n&&t.css("position")==="static"?!1:/(auto|scroll)/.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))}).eq(0);return t==="fixed"||!r.length?e(this[0].ownerDocument||document):r},uniqueId:function(){var e=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(n){return!!e.data(n,t)}}):function(t,n,r){return!!e.data(t,r[3])},focusable:function(n){return t(n,!isNaN(e.attr(n,"tabindex")))},tabbable:function(n){var r=e.attr(n,"tabindex"),i=isNaN(r);return(i||r>=0)&&t(n,!i)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(t,n){function o(t,n,i,s){return e.each(r,function(){n-=parseFloat(e.css(t,"padding"+this))||0,i&&(n-=parseFloat(e.css(t,"border"+this+"Width"))||0),s&&(n-=parseFloat(e.css(t,"margin"+this))||0)}),n}var r=n==="Width"?["Left","Right"]:["Top","Bottom"],i=n.toLowerCase(),s={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+n]=function(t){return t===undefined?s["inner"+n].call(this):this.each(function(){e(this).css(i,o(this,t)+"px")})},e.fn["outer"+n]=function(t,r){return typeof t!="number"?s["outer"+n].call(this,t):this.each(function(){e(this).css(i,o(this,t,!0,r)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(n){return arguments.length?t.call(this,e.camelCase(n)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.fn.extend({focus:function(t){return function(n,r){return typeof n=="number"?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),r&&r.call(t)},n)}):t.apply(this,arguments)}}(e.fn.focus),disableSelection:function(){var e="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(e+".ui-disableSelection",function(e){e.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(t){if(t!==undefined)return this.css("zIndex",t);if(this.length){var n=e(this[0]),r,i;while(n.length&&n[0]!==document){r=n.css("position");if(r==="absolute"||r==="relative"||r==="fixed"){i=parseInt(n.css("zIndex"),10);if(!isNaN(i)&&i!==0)return i}n=n.parent()}}return 0}}),e.ui.plugin={add:function(t,n,r){var i,s=e.ui[t].prototype;for(i in r)s.plugins[i]=s.plugins[i]||[],s.plugins[i].push([n,r[i]])},call:function(e,t,n,r){var i,s=e.plugins[t];if(!s)return;if(!r&&(!e.element[0].parentNode||e.element[0].parentNode.nodeType===11))return;for(i=0;i<s.length;i++)e.options[s[i][0]]&&s[i][1].apply(e.element,n)}};var r=0,i=Array.prototype.slice;e.cleanData=function(t){return function(n){for(var r=0,i;(i=n[r])!=null;r++)try{e(i).triggerHandler("remove")}catch(s){}t(n)}}(e.cleanData),e.widget=function(t,n,r){var i,s,o,u,a={},f=t.split(".")[0];return t=t.split(".")[1],i=f+"-"+t,r||(r=n,n=e.Widget),e.expr[":"][i.toLowerCase()]=function(t){return!!e.data(t,i)},e[f]=e[f]||{},s=e[f][t],o=e[f][t]=function(e,t){if(!this._createWidget)return new o(e,t);arguments.length&&this._createWidget(e,t)},e.extend(o,s,{version:r.version,_proto:e.extend({},r),_childConstructors:[]}),u=new n,u.options=e.widget.extend({},u.options),e.each(r,function(t,r){if(!e.isFunction(r)){a[t]=r;return}a[t]=function(){var e=function(){return n.prototype[t].apply(this,arguments)},i=function(e){return n.prototype[t].apply(this,e)};return function(){var t=this._super,n=this._superApply,s;return this._super=e,this._superApply=i,s=r.apply(this,arguments),this._super=t,this._superApply=n,s}}()}),o.prototype=e.widget.extend(u,{widgetEventPrefix:s?u.widgetEventPrefix||t:t},a,{constructor:o,namespace:f,widgetName:t,widgetFullName:i}),s?(e.each(s._childConstructors,function(t,n){var r=n.prototype;e.widget(r.namespace+"."+r.widgetName,o,n._proto)}),delete s._childConstructors):n._childConstructors.push(o),e.widget.bridge(t,o),o},e.widget.extend=function(t){var n=i.call(arguments,1),r=0,s=n.length,o,u;for(;r<s;r++)for(o in n[r])u=n[r][o],n[r].hasOwnProperty(o)&&u!==undefined&&(e.isPlainObject(u)?t[o]=e.isPlainObject(t[o])?e.widget.extend({},t[o],u):e.widget.extend({},u):t[o]=u);return t},e.widget.bridge=function(t,n){var r=n.prototype.widgetFullName||t;e.fn[t]=function(s){var o=typeof s=="string",u=i.call(arguments,1),a=this;return s=!o&&u.length?e.widget.extend.apply(null,[s].concat(u)):s,o?this.each(function(){var n,i=e.data(this,r);if(s==="instance")return a=i,!1;if(!i)return e.error("cannot call methods on "+t+" prior to initialization; "+"attempted to call method '"+s+"'");if(!e.isFunction(i[s])||s.charAt(0)==="_")return e.error("no such method '"+s+"' for "+t+" widget instance");n=i[s].apply(i,u);if(n!==i&&n!==undefined)return a=n&&n.jquery?a.pushStack(n.get()):n,!1}):this.each(function(){var t=e.data(this,r);t?(t.option(s||{}),t._init&&t._init()):e.data(this,r,new n(s,this))}),a}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,n){n=e(n||this.defaultElement||this)[0],this.element=e(n),this.uuid=r++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),n!==this&&(e.data(n,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===n&&this.destroy()}}),this.document=e(n.style?n.ownerDocument:n.document||n),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(t,n){var r=t,i,s,o;if(arguments.length===0)return e.widget.extend({},this.options);if(typeof t=="string"){r={},i=t.split("."),t=i.shift();if(i.length){s=r[t]=e.widget.extend({},this.options[t]);for(o=0;o<i.length-1;o++)s[i[o]]=s[i[o]]||{},s=s[i[o]];t=i.pop();if(arguments.length===1)return s[t]===undefined?null:s[t];s[t]=n}else{if(arguments.length===1)return this.options[t]===undefined?null:this.options[t];r[t]=n}}return this._setOptions(r),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,e==="disabled"&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!t),t&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(t,n,r){var i,s=this;typeof t!="boolean"&&(r=n,n=t,t=!1),r?(n=i=e(n),this.bindings=this.bindings.add(n)):(r=n,n=this.element,i=this.widget()),e.each(r,function(r,o){function u(){if(!t&&(s.options.disabled===!0||e(this).hasClass("ui-state-disabled")))return;return(typeof o=="string"?s[o]:o).apply(s,arguments)}typeof o!="string"&&(u.guid=o.guid=o.guid||u.guid||e.guid++);var a=r.match(/^([\w:-]*)\s*(.*)$/),f=a[1]+s.eventNamespace,l=a[2];l?i.delegate(l,f,u):n.bind(f,u)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function n(){return(typeof e=="string"?r[e]:e).apply(r,arguments)}var r=this;return setTimeout(n,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,n,r){var i,s,o=this.options[t];r=r||{},n=e.Event(n),n.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),n.target=this.element[0],s=n.originalEvent;if(s)for(i in s)i in n||(n[i]=s[i]);return this.element.trigger(n,r),!(e.isFunction(o)&&o.apply(this.element[0],[n].concat(r))===!1||n.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,n){e.Widget.prototype["_"+t]=function(r,i,s){typeof i=="string"&&(i={effect:i});var o,u=i?i===!0||typeof i=="number"?n:i.effect||n:t;i=i||{},typeof i=="number"&&(i={duration:i}),o=!e.isEmptyObject(i),i.complete=s,i.delay&&r.delay(i.delay),o&&e.effects&&e.effects.effect[u]?r[t](i):u!==t&&r[u]?r[u](i.duration,i.easing,s):r.queue(function(n){e(this)[t](),s&&s.call(r[0]),n()})}});var s=e.widget,o=!1;e(document).mouseup(function(){o=!1});var u=e.widget("ui.mouse",{version:"1.11.0",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(n){if(!0===e.data(n.target,t.widgetName+".preventClickEvent"))return e.removeData(n.target,t.widgetName+".preventClickEvent"),n.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){if(o)return;this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var n=this,r=t.which===1,i=typeof this.options.cancel=="string"&&t.target.nodeName?e(t.target).closest(this.options.cancel).length:!1;if(!r||i||!this._mouseCapture(t))return!0;this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){n.mouseDelayMet=!0},this.options.delay));if(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)){this._mouseStarted=this._mouseStart(t)!==!1;if(!this._mouseStarted)return t.preventDefault(),!0}return!0===e.data(t.target,this.widgetName+".preventClickEvent")&&e.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return n._mouseMove(e)},this._mouseUpDelegate=function(e){return n._mouseUp(e)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),o=!0,!0},_mouseMove:function(t){return e.ui.ie&&(!document.documentMode||document.documentMode<9)&&!t.button?this._mouseUp(t):t.which?this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted):this._mouseUp(t)},_mouseUp:function(t){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),o=!1,!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}});(function(){function h(e,t,n){return[parseFloat(e[0])*(l.test(e[0])?t/100:1),parseFloat(e[1])*(l.test(e[1])?n/100:1)]}function p(t,n){return parseInt(e.css(t,n),10)||0}function d(t){var n=t[0];return n.nodeType===9?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:e.isWindow(n)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:n.preventDefault?{width:0,height:0,offset:{top:n.pageY,left:n.pageX}}:{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()}}e.ui=e.ui||{};var t,n,r=Math.max,i=Math.abs,s=Math.round,o=/left|center|right/,u=/top|center|bottom/,a=/[\+\-]\d+(\.[\d]+)?%?/,f=/^\w+/,l=/%$/,c=e.fn.position;e.position={scrollbarWidth:function(){if(t!==undefined)return t;var n,r,i=e("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),s=i.children()[0];return e("body").append(i),n=s.offsetWidth,i.css("overflow","scroll"),r=s.offsetWidth,n===r&&(r=i[0].clientWidth),i.remove(),t=n-r},getScrollInfo:function(t){var n=t.isWindow||t.isDocument?"":t.element.css("overflow-x"),r=t.isWindow||t.isDocument?"":t.element.css("overflow-y"),i=n==="scroll"||n==="auto"&&t.width<t.element[0].scrollWidth,s=r==="scroll"||r==="auto"&&t.height<t.element[0].scrollHeight;return{width:s?e.position.scrollbarWidth():0,height:i?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var n=e(t||window),r=e.isWindow(n[0]),i=!!n[0]&&n[0].nodeType===9;return{element:n,isWindow:r,isDocument:i,offset:n.offset()||{left:0,top:0},scrollLeft:n.scrollLeft(),scrollTop:n.scrollTop(),width:r?n.width():n.outerWidth(),height:r?n.height():n.outerHeight()}}},e.fn.position=function(t){if(!t||!t.of)return c.apply(this,arguments);t=e.extend({},t);var l,v,m,g,y,b,w=e(t.of),E=e.position.getWithinInfo(t.within),S=e.position.getScrollInfo(E),x=(t.collision||"flip").split(" "),T={};return b=d(w),w[0].preventDefault&&(t.at="left top"),v=b.width,m=b.height,g=b.offset,y=e.extend({},g),e.each(["my","at"],function(){var e=(t[this]||"").split(" "),n,r;e.length===1&&(e=o.test(e[0])?e.concat(["center"]):u.test(e[0])?["center"].concat(e):["center","center"]),e[0]=o.test(e[0])?e[0]:"center",e[1]=u.test(e[1])?e[1]:"center",n=a.exec(e[0]),r=a.exec(e[1]),T[this]=[n?n[0]:0,r?r[0]:0],t[this]=[f.exec(e[0])[0],f.exec(e[1])[0]]}),x.length===1&&(x[1]=x[0]),t.at[0]==="right"?y.left+=v:t.at[0]==="center"&&(y.left+=v/2),t.at[1]==="bottom"?y.top+=m:t.at[1]==="center"&&(y.top+=m/2),l=h(T.at,v,m),y.left+=l[0],y.top+=l[1],this.each(function(){var o,u,a=e(this),f=a.outerWidth(),c=a.outerHeight(),d=p(this,"marginLeft"),b=p(this,"marginTop"),N=f+d+p(this,"marginRight")+S.width,C=c+b+p(this,"marginBottom")+S.height,k=e.extend({},y),L=h(T.my,a.outerWidth(),a.outerHeight());t.my[0]==="right"?k.left-=f:t.my[0]==="center"&&(k.left-=f/2),t.my[1]==="bottom"?k.top-=c:t.my[1]==="center"&&(k.top-=c/2),k.left+=L[0],k.top+=L[1],n||(k.left=s(k.left),k.top=s(k.top)),o={marginLeft:d,marginTop:b},e.each(["left","top"],function(n,r){e.ui.position[x[n]]&&e.ui.position[x[n]][r](k,{targetWidth:v,targetHeight:m,elemWidth:f,elemHeight:c,collisionPosition:o,collisionWidth:N,collisionHeight:C,offset:[l[0]+L[0],l[1]+L[1]],my:t.my,at:t.at,within:E,elem:a})}),t.using&&(u=function(e){var n=g.left-k.left,s=n+v-f,o=g.top-k.top,u=o+m-c,l={target:{element:w,left:g.left,top:g.top,width:v,height:m},element:{element:a,left:k.left,top:k.top,width:f,height:c},horizontal:s<0?"left":n>0?"right":"center",vertical:u<0?"top":o>0?"bottom":"middle"};v<f&&i(n+s)<v&&(l.horizontal="center"),m<c&&i(o+u)<m&&(l.vertical="middle"),r(i(n),i(s))>r(i(o),i(u))?l.important="horizontal":l.important="vertical",t.using.call(this,e,l)}),a.offset(e.extend(k,{using:u}))})},e.ui.position={fit:{left:function(e,t){var n=t.within,i=n.isWindow?n.scrollLeft:n.offset.left,s=n.width,o=e.left-t.collisionPosition.marginLeft,u=i-o,a=o+t.collisionWidth-s-i,f;t.collisionWidth>s?u>0&&a<=0?(f=e.left+u+t.collisionWidth-s-i,e.left+=u-f):a>0&&u<=0?e.left=i:u>a?e.left=i+s-t.collisionWidth:e.left=i:u>0?e.left+=u:a>0?e.left-=a:e.left=r(e.left-o,e.left)},top:function(e,t){var n=t.within,i=n.isWindow?n.scrollTop:n.offset.top,s=t.within.height,o=e.top-t.collisionPosition.marginTop,u=i-o,a=o+t.collisionHeight-s-i,f;t.collisionHeight>s?u>0&&a<=0?(f=e.top+u+t.collisionHeight-s-i,e.top+=u-f):a>0&&u<=0?e.top=i:u>a?e.top=i+s-t.collisionHeight:e.top=i:u>0?e.top+=u:a>0?e.top-=a:e.top=r(e.top-o,e.top)}},flip:{left:function(e,t){var n=t.within,r=n.offset.left+n.scrollLeft,s=n.width,o=n.isWindow?n.scrollLeft:n.offset.left,u=e.left-t.collisionPosition.marginLeft,a=u-o,f=u+t.collisionWidth-s-o,l=t.my[0]==="left"?-t.elemWidth:t.my[0]==="right"?t.elemWidth:0,c=t.at[0]==="left"?t.targetWidth:t.at[0]==="right"?-t.targetWidth:0,h=-2*t.offset[0],p,d;if(a<0){p=e.left+l+c+h+t.collisionWidth-s-r;if(p<0||p<i(a))e.left+=l+c+h}else if(f>0){d=e.left-t.collisionPosition.marginLeft+l+c+h-o;if(d>0||i(d)<f)e.left+=l+c+h}},top:function(e,t){var n=t.within,r=n.offset.top+n.scrollTop,s=n.height,o=n.isWindow?n.scrollTop:n.offset.top,u=e.top-t.collisionPosition.marginTop,a=u-o,f=u+t.collisionHeight-s-o,l=t.my[1]==="top",c=l?-t.elemHeight:t.my[1]==="bottom"?t.elemHeight:0,h=t.at[1]==="top"?t.targetHeight:t.at[1]==="bottom"?-t.targetHeight:0,p=-2*t.offset[1],d,v;a<0?(v=e.top+c+h+p+t.collisionHeight-s-r,e.top+c+h+p>a&&(v<0||v<i(a))&&(e.top+=c+h+p)):f>0&&(d=e.top-t.collisionPosition.marginTop+c+h+p-o,e.top+c+h+p>f&&(d>0||i(d)<f)&&(e.top+=c+h+p))}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}},function(){var t,r,i,s,o,u=document.getElementsByTagName("body")[0],a=document.createElement("div");t=document.createElement(u?"div":"body"),i={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},u&&e.extend(i,{position:"absolute",left:"-1000px",top:"-1000px"});for(o in i)t.style[o]=i[o];t.appendChild(a),r=u||document.documentElement,r.insertBefore(t,r.firstChild),a.style.cssText="position: absolute; left: 10.7432222px;",s=e(a).offset().left,n=s>10&&s<11,t.innerHTML="",r.removeChild(t)}()})();var a=e.ui.position;e.widget("ui.draggable",e.ui.mouse,{version:"1.11.0",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){this.options.helper==="original"&&!/^(?:r|a|f)/.test(this.element.css("position"))&&(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(e,t){this._super(e,t),e==="handle"&&this._setHandleClassName()},_destroy:function(){if((this.helper||this.element).is(".ui-draggable-dragging")){this.destroyOnClear=!0;return}this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),this._mouseDestroy()},_mouseCapture:function(t){var n=this.document[0],r=this.options;try{n.activeElement&&n.activeElement.nodeName.toLowerCase()!=="body"&&e(n.activeElement).blur()}catch(i){}return this.helper||r.disabled||e(t.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(t),this.handle?(e(r.iframeFix===!0?"iframe":r.iframeFix).each(function(){e("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(e(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(t){var n=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(t,!1),this.originalPageX=t.pageX,this.originalPageY=t.pageY,n.cursorAt&&this._adjustOffsetFromHelper(n.cursorAt),this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_mouseDrag:function(t,n){this.offsetParentCssPosition==="fixed"&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t,!0),this.positionAbs=this._convertPositionTo("absolute");if(!n){var r=this._uiHash();if(this._trigger("drag",t,r)===!1)return this._mouseUp({}),!1;this.position=r.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var n=this,r=!1;return e.ui.ddmanager&&!this.options.dropBehaviour&&(r=e.ui.ddmanager.drop(this,t)),this.dropped&&(r=this.dropped,this.dropped=!1),this.options.revert==="invalid"&&!r||this.options.revert==="valid"&&r||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,r)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){n._trigger("stop",t)!==!1&&n._clear()}):this._trigger("stop",t)!==!1&&this._clear(),!1},_mouseUp:function(t){return e("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),this.element.focus(),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){return this.options.handle?!!e(t.target).closest(this.element.find(this.options.handle)).length:!0},_setHandleClassName:function(){this._removeHandleClassName(),e(this.options.handle||this.element).addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.element.find(".ui-draggable-handle").addBack().removeClass("ui-draggable-handle")},_createHelper:function(t){var n=this.options,r=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t])):n.helper==="clone"?this.element.clone().removeAttr("id"):this.element;return r.parents("body").length||r.appendTo(n.appendTo==="parent"?this.element[0].parentNode:n.appendTo),r[0]!==this.element[0]&&!/(fixed|absolute)/.test(r.css("position"))&&r.css("position","absolute"),r},_adjustOffsetFromHelper:function(t){typeof t=="string"&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_isRootNode:function(e){return/(html|body)/i.test(e.tagName)||e===this.document[0]},_getParentOffset:function(){var t=this.offsetParent.offset(),n=this.document[0];return this.cssPosition==="absolute"&&this.scrollParent[0]!==n&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition!=="relative")return{top:0,left:0};var e=this.element.position(),t=this._isRootNode(this.scrollParent[0]);return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+(t?0:this.scrollParent.scrollTop()),left:e.left-(parseInt(this.helper.css("left"),10)||0)+(t?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,n,r,i=this.options,s=this.document[0];this.relative_container=null;if(!i.containment){this.containment=null;return}if(i.containment==="window"){this.containment=[e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,e(window).scrollLeft()+e(window).width()-this.helperProportions.width-this.margins.left,e(window).scrollTop()+(e(window).height()||s.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];return}if(i.containment==="document"){this.containment=[0,0,e(s).width()-this.helperProportions.width-this.margins.left,(e(s).height()||s.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];return}if(i.containment.constructor===Array){this.containment=i.containment;return}i.containment==="parent"&&(i.containment=this.helper[0].parentNode),n=e(i.containment),r=n[0];if(!r)return;t=n.css("overflow")!=="hidden",this.containment=[(parseInt(n.css("borderLeftWidth"),10)||0)+(parseInt(n.css("paddingLeft"),10)||0),(parseInt(n.css("borderTopWidth"),10)||0)+(parseInt(n.css("paddingTop"),10)||0),(t?Math.max(r.scrollWidth,r.offsetWidth):r.offsetWidth)-(parseInt(n.css("borderRightWidth"),10)||0)-(parseInt(n.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(r.scrollHeight,r.offsetHeight):r.offsetHeight)-(parseInt(n.css("borderBottomWidth"),10)||0)-(parseInt(n.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=n},_convertPositionTo:function(e,t){t||(t=this.position);var n=e==="absolute"?1:-1,r=this._isRootNode(this.scrollParent[0]);return{top:t.top+this.offset.relative.top*n+this.offset.parent.top*n-(this.cssPosition==="fixed"?-this.offset.scroll.top:r?0:this.offset.scroll.top)*n,left:t.left+this.offset.relative.left*n+this.offset.parent.left*n-(this.cssPosition==="fixed"?-this.offset.scroll.left:r?0:this.offset.scroll.left)*n}},_generatePosition:function(e,t){var n,r,i,s,o=this.options,u=this._isRootNode(this.scrollParent[0]),a=e.pageX,f=e.pageY;if(!u||!this.offset.scroll)this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()};return t&&(this.containment&&(this.relative_container?(r=this.relative_container.offset(),n=[this.containment[0]+r.left,this.containment[1]+r.top,this.containment[2]+r.left,this.containment[3]+r.top]):n=this.containment,e.pageX-this.offset.click.left<n[0]&&(a=n[0]+this.offset.click.left),e.pageY-this.offset.click.top<n[1]&&(f=n[1]+this.offset.click.top),e.pageX-this.offset.click.left>n[2]&&(a=n[2]+this.offset.click.left),e.pageY-this.offset.click.top>n[3]&&(f=n[3]+this.offset.click.top)),o.grid&&(i=o.grid[1]?this.originalPageY+Math.round((f-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY,f=n?i-this.offset.click.top>=n[1]||i-this.offset.click.top>n[3]?i:i-this.offset.click.top>=n[1]?i-o.grid[1]:i+o.grid[1]:i,s=o.grid[0]?this.originalPageX+Math.round((a-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX,a=n?s-this.offset.click.left>=n[0]||s-this.offset.click.left>n[2]?s:s-this.offset.click.left>=n[0]?s-o.grid[0]:s+o.grid[0]:s),o.axis==="y"&&(a=this.originalPageX),o.axis==="x"&&(f=this.originalPageY)),{top:f-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(this.cssPosition==="fixed"?-this.offset.scroll.top:u?0:this.offset.scroll.top),left:a-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(this.cssPosition==="fixed"?-this.offset.scroll.left:u?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]!==this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_trigger:function(t,n,r){return r=r||this._uiHash(),e.ui.plugin.call(this,t,[n,r,this],!0),t==="drag"&&(this.positionAbs=this._convertPositionTo("absolute")),e.Widget.prototype._trigger.call(this,t,n,r)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,n,r){var i=r.options,s=e.extend({},n,{item:r.element});r.sortables=[],e(i.connectToSortable).each(function(){var n=e(this).sortable("instance");n&&!n.options.disabled&&(r.sortables.push({instance:n,shouldRevert:n.options.revert}),n.refreshPositions(),n._trigger("activate",t,s))})},stop:function(t,n,r){var i=e.extend({},n,{item:r.element});e.each(r.sortables,function(){this.instance.isOver?(this.instance.isOver=0,r.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(t),this.instance.options.helper=this.instance.options._helper,r.options.helper==="original"&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",t,i))})},drag:function(t,n,r){var i=this;e.each(r.sortables,function(){var s=!1,o=this;this.instance.positionAbs=r.positionAbs,this.instance.helperProportions=r.helperProportions,this.instance.offset.click=r.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(s=!0,e.each(r.sortables,function(){return this.instance.positionAbs=r.positionAbs,this.instance.helperProportions=r.helperProportions,this.instance.offset.click=r.offset.click,this!==o&&this.instance._intersectsWith(this.instance.containerCache)&&e.contains(o.instance.element[0],this.instance.element[0])&&(s=!1),s})),s?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=e(i).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return n.helper[0]},t.target=this.instance.currentItem[0],this.instance._mouseCapture(t,!0),this.instance._mouseStart(t,!0,!0),this.instance.offset.click.top=r.offset.click.top,this.instance.offset.click.left=r.offset.click.left,this.instance.offset.parent.left-=r.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=r.offset.parent.top-this.instance.offset.parent.top,r._trigger("toSortable",t),r.dropped=this.instance.element,r.currentItem=r.element,this.instance.fromOutside=r),this.instance.currentItem&&this.instance._mouseDrag(t)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",t,this.instance._uiHash(this.instance)),this.instance._mouseStop(t,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),r._trigger("fromSortable",t),r.dropped=!1)})}}),e.ui.plugin.add("draggable","cursor",{start:function(t,n,r){var i=e("body"),s=r.options;i.css("cursor")&&(s._cursor=i.css("cursor")),i.css("cursor",s.cursor)},stop:function(t,n,r){var i=r.options;i._cursor&&e("body").css("cursor",i._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,n,r){var i=e(n.helper),s=r.options;i.css("opacity")&&(s._opacity=i.css("opacity")),i.css("opacity",s.opacity)},stop:function(t,n,r){var i=r.options;i._opacity&&e(n.helper).css("opacity",i._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(e,t,n){n.scrollParent[0]!==n.document[0]&&n.scrollParent[0].tagName!=="HTML"&&(n.overflowOffset=n.scrollParent.offset())},drag:function(t,n,r){var i=r.options,s=!1,o=r.document[0];if(r.scrollParent[0]!==o&&r.scrollParent[0].tagName!=="HTML"){if(!i.axis||i.axis!=="x")r.overflowOffset.top+r.scrollParent[0].offsetHeight-t.pageY<i.scrollSensitivity?r.scrollParent[0].scrollTop=s=r.scrollParent[0].scrollTop+i.scrollSpeed:t.pageY-r.overflowOffset.top<i.scrollSensitivity&&(r.scrollParent[0].scrollTop=s=r.scrollParent[0].scrollTop-i.scrollSpeed);if(!i.axis||i.axis!=="y")r.overflowOffset.left+r.scrollParent[0].offsetWidth-t.pageX<i.scrollSensitivity?r.scrollParent[0].scrollLeft=s=r.scrollParent[0].scrollLeft+i.scrollSpeed:t.pageX-r.overflowOffset.left<i.scrollSensitivity&&(r.scrollParent[0].scrollLeft=s=r.scrollParent[0].scrollLeft-i.scrollSpeed)}else{if(!i.axis||i.axis!=="x")t.pageY-e(o).scrollTop()<i.scrollSensitivity?s=e(o).scrollTop(e(o).scrollTop()-i.scrollSpeed):e(window).height()-(t.pageY-e(o).scrollTop())<i.scrollSensitivity&&(s=e(o).scrollTop(e(o).scrollTop()+i.scrollSpeed));if(!i.axis||i.axis!=="y")t.pageX-e(o).scrollLeft()<i.scrollSensitivity?s=e(o).scrollLeft(e(o).scrollLeft()-i.scrollSpeed):e(window).width()-(t.pageX-e(o).scrollLeft())<i.scrollSensitivity&&(s=e(o).scrollLeft(e(o).scrollLeft()+i.scrollSpeed))}s!==!1&&e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(r,t)}}),e.ui.plugin.add("draggable","snap",{start:function(t,n,r){var i=r.options;r.snapElements=[],e(i.snap.constructor!==String?i.snap.items||":data(ui-draggable)":i.snap).each(function(){var t=e(this),n=t.offset();this!==r.element[0]&&r.snapElements.push({item:this,width:t.outerWidth(),height:t.outerHeight(),top:n.top,left:n.left})})},drag:function(t,n,r){var i,s,o,u,a,f,l,c,h,p,d=r.options,v=d.snapTolerance,m=n.offset.left,g=m+r.helperProportions.width,y=n.offset.top,b=y+r.helperProportions.height;for(h=r.snapElements.length-1;h>=0;h--){a=r.snapElements[h].left,f=a+r.snapElements[h].width,l=r.snapElements[h].top,c=l+r.snapElements[h].height;if(g<a-v||m>f+v||b<l-v||y>c+v||!e.contains(r.snapElements[h].item.ownerDocument,r.snapElements[h].item)){r.snapElements[h].snapping&&r.options.snap.release&&r.options.snap.release.call(r.element,t,e.extend(r._uiHash(),{snapItem:r.snapElements[h].item})),r.snapElements[h].snapping=!1;continue}d.snapMode!=="inner"&&(i=Math.abs(l-b)<=v,s=Math.abs(c-y)<=v,o=Math.abs(a-g)<=v,u=Math.abs(f-m)<=v,i&&(n.position.top=r._convertPositionTo("relative",{top:l-r.helperProportions.height,left:0}).top-r.margins.top),s&&(n.position.top=r._convertPositionTo("relative",{top:c,left:0}).top-r.margins.top),o&&(n.position.left=r._convertPositionTo("relative",{top:0,left:a-r.helperProportions.width}).left-r.margins.left),u&&(n.position.left=r._convertPositionTo("relative",{top:0,left:f}).left-r.margins.left)),p=i||s||o||u,d.snapMode!=="outer"&&(i=Math.abs(l-y)<=v,s=Math.abs(c-b)<=v,o=Math.abs(a-m)<=v,u=Math.abs(f-g)<=v,i&&(n.position.top=r._convertPositionTo("relative",{top:l,left:0}).top-r.margins.top),s&&(n.position.top=r._convertPositionTo("relative",{top:c-r.helperProportions.height,left:0}).top-r.margins.top),o&&(n.position.left=r._convertPositionTo("relative",{top:0,left:a}).left-r.margins.left),u&&(n.position.left=r._convertPositionTo("relative",{top:0,left:f-r.helperProportions.width}).left-r.margins.left)),!r.snapElements[h].snapping&&(i||s||o||u||p)&&r.options.snap.snap&&r.options.snap.snap.call(r.element,t,e.extend(r._uiHash(),{snapItem:r.snapElements[h].item})),r.snapElements[h].snapping=i||s||o||u||p}}}),e.ui.plugin.add("draggable","stack",{start:function(t,n,r){var i,s=r.options,o=e.makeArray(e(s.stack)).sort(function(t,n){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(n).css("zIndex"),10)||0)});if(!o.length)return;i=parseInt(e(o[0]).css("zIndex"),10)||0,e(o).each(function(t){e(this).css("zIndex",i+t)}),this.css("zIndex",i+o.length)}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,n,r){var i=e(n.helper),s=r.options;i.css("zIndex")&&(s._zIndex=i.css("zIndex")),i.css("zIndex",s.zIndex)},stop:function(t,n,r){var i=r.options;i._zIndex&&e(n.helper).css("zIndex",i._zIndex)}});var f=e.ui.draggable;e.widget("ui.droppable",{version:"1.11.0",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var t,n=this.options,r=n.accept;this.isover=!1,this.isout=!0,this.accept=e.isFunction(r)?r:function(e){return e.is(r)},this.proportions=function(){if(!arguments.length)return t?t:t={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight};t=arguments[0]},this._addToManager(n.scope),n.addClasses&&this.element.addClass("ui-droppable")},_addToManager:function(t){e.ui.ddmanager.droppables[t]=e.ui.ddmanager.droppables[t]||[],e.ui.ddmanager.droppables[t].push(this)},_splice:function(e){var t=0;for(;t<e.length;t++)e[t]===this&&e.splice(t,1)},_destroy:function(){var t=e.ui.ddmanager.droppables[this.options.scope];this._splice(t),this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(t,n){if(t==="accept")this.accept=e.isFunction(n)?n:function(e){return e.is(n)};else if(t==="scope"){var r=e.ui.ddmanager.droppables[this.options.scope];this._splice(r),this._addToManager(n)}this._super(t,n)},_activate:function(t){var n=e.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),n&&this._trigger("activate",t,this.ui(n))},_deactivate:function(t){var n=e.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),n&&this._trigger("deactivate",t,this.ui(n))},_over:function(t){var n=e.ui.ddmanager.current;if(!n||(n.currentItem||n.element)[0]===this.element[0])return;this.accept.call(this.element[0],n.currentItem||n.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",t,this.ui(n)))},_out:function(t){var n=e.ui.ddmanager.current;if(!n||(n.currentItem||n.element)[0]===this.element[0])return;this.accept.call(this.element[0],n.currentItem||n.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",t,this.ui(n)))},_drop:function(t,n){var r=n||e.ui.ddmanager.current,i=!1;return!r||(r.currentItem||r.element)[0]===this.element[0]?!1:(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var t=e(this).droppable("instance");if(t.options.greedy&&!t.options.disabled&&t.options.scope===r.options.scope&&t.accept.call(t.element[0],r.currentItem||r.element)&&e.ui.intersect(r,e.extend(t,{offset:t.element.offset()}),t.options.tolerance))return i=!0,!1}),i?!1:this.accept.call(this.element[0],r.currentItem||r.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",t,this.ui(r)),this.element):!1)},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}}}),e.ui.intersect=function(){function e(e,t,n){return e>=t&&e<t+n}return function(t,n,r){if(!n.offset)return!1;var i,s,o=(t.positionAbs||t.position.absolute).left,u=(t.positionAbs||t.position.absolute).top,a=o+t.helperProportions.width,f=u+t.helperProportions.height,l=n.offset.left,c=n.offset.top,h=l+n.proportions().width,p=c+n.proportions().height;switch(r){case"fit":return l<=o&&a<=h&&c<=u&&f<=p;case"intersect":return l<o+t.helperProportions.width/2&&a-t.helperProportions.width/2<h&&c<u+t.helperProportions.height/2&&f-t.helperProportions.height/2<p;case"pointer":return i=(t.positionAbs||t.position.absolute).left+(t.clickOffset||t.offset.click).left,s=(t.positionAbs||t.position.absolute).top+(t.clickOffset||t.offset.click).top,e(s,c,n.proportions().height)&&e(i,l,n.proportions().width);case"touch":return(u>=c&&u<=p||f>=c&&f<=p||u<c&&f>p)&&(o>=l&&o<=h||a>=l&&a<=h||o<l&&a>h);default:return!1}}}(),e.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,n){var r,i,s=e.ui.ddmanager.droppables[t.options.scope]||[],o=n?n.type:null,u=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();e:for(r=0;r<s.length;r++){if(s[r].options.disabled||t&&!s[r].accept.call(s[r].element[0],t.currentItem||t.element))continue;for(i=0;i<u.length;i++)if(u[i]===s[r].element[0]){s[r].proportions().height=0;continue e}s[r].visible=s[r].element.css("display")!=="none";if(!s[r].visible)continue;o==="mousedown"&&s[r]._activate.call(s[r],n),s[r].offset=s[r].element.offset(),s[r].proportions({width:s[r].element[0].offsetWidth,height:s[r].element[0].offsetHeight})}},drop:function(t,n){var r=!1;return e.each((e.ui.ddmanager.droppables[t.options.scope]||[]).slice(),function(){if(!this.options)return;!this.options.disabled&&this.visible&&e.ui.intersect(t,this,this.options.tolerance)&&(r=this._drop.call(this,n)||r),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,n))}),r},dragStart:function(t,n){t.element.parentsUntil("body").bind("scroll.droppable",function(){t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,n)})},drag:function(t,n){t.options.refreshPositions&&e.ui.ddmanager.prepareOffsets(t,n),e.each(e.ui.ddmanager.droppables[t.options.scope]||[],function(){if(this.options.disabled||this.greedyChild||!this.visible)return;var r,i,s,o=e.ui.intersect(t,this,this.options.tolerance),u=!o&&this.isover?"isout":o&&!this.isover?"isover":null;if(!u)return;this.options.greedy&&(i=this.options.scope,s=this.element.parents(":data(ui-droppable)").filter(function(){return e(this).droppable("instance").options.scope===i}),s.length&&(r=e(s[0]).droppable("instance"),r.greedyChild=u==="isover")),r&&u==="isover"&&(r.isover=!1,r.isout=!0,r._out.call(r,n)),this[u]=!0,this[u==="isout"?"isover":"isout"]=!1,this[u==="isover"?"_over":"_out"].call(this,n),r&&u==="isout"&&(r.isout=!1,r.isover=!0,r._over.call(r,n))})},dragStop:function(t,n){t.element.parentsUntil("body").unbind("scroll.droppable"),t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,n)}};var l=e.ui.droppable,c=e.widget("ui.selectable",e.ui.mouse,{version:"1.11.0",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var t,n=this;this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){t=e(n.options.filter,n.element[0]),t.addClass("ui-selectee"),t.each(function(){var t=e(this),n=t.offset();e.data(this,"selectable-item",{element:this,$element:t,left:n.left,top:n.top,right:n.left+t.outerWidth(),bottom:n.top+t.outerHeight(),startselected:!1,selected:t.hasClass("ui-selected"),selecting:t.hasClass("ui-selecting"),unselecting:t.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=t.addClass("ui-selectee"),this._mouseInit(),this.helper=e("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(t){var n=this,r=this.options;this.opos=[t.pageX,t.pageY];if(this.options.disabled)return;this.selectees=e(r.filter,this.element[0]),this._trigger("start",t),e(r.appendTo).append(this.helper),this.helper.css({left:t.pageX,top:t.pageY,width:0,height:0}),r.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var r=e.data(this,"selectable-item");r.startselected=!0,!t.metaKey&&!t.ctrlKey&&(r.$element.removeClass("ui-selected"),r.selected=!1,r.$element.addClass("ui-unselecting"),r.unselecting=!0,n._trigger("unselecting",t,{unselecting:r.element}))}),e(t.target).parents().addBack().each(function(){var r,i=e.data(this,"selectable-item");if(i)return r=!t.metaKey&&!t.ctrlKey||!i.$element.hasClass("ui-selected"),i.$element.removeClass(r?"ui-unselecting":"ui-selected").addClass(r?"ui-selecting":"ui-unselecting"),i.unselecting=!r,i.selecting=r,i.selected=r,r?n._trigger("selecting",t,{selecting:i.element}):n._trigger("unselecting",t,{unselecting:i.element}),!1})},_mouseDrag:function(t){this.dragged=!0;if(this.options.disabled)return;var n,r=this,i=this.options,s=this.opos[0],o=this.opos[1],u=t.pageX,a=t.pageY;return s>u&&(n=u,u=s,s=n),o>a&&(n=a,a=o,o=n),this.helper.css({left:s,top:o,width:u-s,height:a-o}),this.selectees.each(function(){var n=e.data(this,"selectable-item"),f=!1;if(!n||n.element===r.element[0])return;i.tolerance==="touch"?f=!(n.left>u||n.right<s||n.top>a||n.bottom<o):i.tolerance==="fit"&&(f=n.left>s&&n.right<u&&n.top>o&&n.bottom<a),f?(n.selected&&(n.$element.removeClass("ui-selected"),n.selected=!1),n.unselecting&&(n.$element.removeClass("ui-unselecting"),n.unselecting=!1),n.selecting||(n.$element.addClass("ui-selecting"),n.selecting=!0,r._trigger("selecting",t,{selecting:n.element}))):(n.selecting&&((t.metaKey||t.ctrlKey)&&n.startselected?(n.$element.removeClass("ui-selecting"),n.selecting=!1,n.$element.addClass("ui-selected"),n.selected=!0):(n.$element.removeClass("ui-selecting"),n.selecting=!1,n.startselected&&(n.$element.addClass("ui-unselecting"),n.unselecting=!0),r._trigger("unselecting",t,{unselecting:n.element}))),n.selected&&!t.metaKey&&!t.ctrlKey&&!n.startselected&&(n.$element.removeClass("ui-selected"),n.selected=!1,n.$element.addClass("ui-unselecting"),n.unselecting=!0,r._trigger("unselecting",t,{unselecting:n.element})))}),!1},_mouseStop:function(t){var n=this;return this.dragged=!1,e(".ui-unselecting",this.element[0]).each(function(){var r=e.data(this,"selectable-item");r.$element.removeClass("ui-unselecting"),r.unselecting=!1,r.startselected=!1,n._trigger("unselected",t,{unselected:r.element})}),e(".ui-selecting",this.element[0]).each(function(){var r=e.data(this,"selectable-item");r.$element.removeClass("ui-selecting").addClass("ui-selected"),r.selecting=!1,r.selected=!0,r.startselected=!0,n._trigger("selected",t,{selected:r.element})}),this._trigger("stop",t),this.helper.remove(),!1}}),h=e.widget("ui.sortable",e.ui.mouse,{version:"1.11.0",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(e,t,n){return e>=t&&e<t+n},_isFloating:function(e){return/left|right/.test(e.css("float"))||/inline|table-cell/.test(e.css("display"))},_create:function(){var e=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?e.axis==="x"||this._isFloating(this.items[0].item):!1,this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(e,t){this._super(e,t),e==="handle"&&this._setHandleClassName()},_setHandleClassName:function(){this.element.find(".ui-sortable-handle").removeClass("ui-sortable-handle"),e.each(this.items,function(){(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item).addClass("ui-sortable-handle")})},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").find(".ui-sortable-handle").removeClass("ui-sortable-handle"),this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(t,n){var r=null,i=!1,s=this;if(this.reverting)return!1;if(this.options.disabled||this.options.type==="static")return!1;this._refreshItems(t),e(t.target).parents().each(function(){if(e.data(this,s.widgetName+"-item")===s)return r=e(this),!1}),e.data(t.target,s.widgetName+"-item")===s&&(r=e(t.target));if(!r)return!1;if(this.options.handle&&!n){e(this.options.handle,r).find("*").addBack().each(function(){this===t.target&&(i=!0)});if(!i)return!1}return this.currentItem=r,this._removeCurrentsFromItems(),!0},_mouseStart:function(t,n,r){var i,s,o=this.options;this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),o.containment&&this._setContainment(),o.cursor&&o.cursor!=="auto"&&(s=this.document.find("body"),this.storedCursor=s.css("cursor"),s.css("cursor",o.cursor),this.storedStylesheet=e("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(s)),o.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",o.opacity)),o.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",o.zIndex)),this.scrollParent[0]!==document&&this.scrollParent[0].tagName!=="HTML"&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions();if(!r)for(i=this.containers.length-1;i>=0;i--)this.containers[i]._trigger("activate",t,this._uiHash(this));return e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!o.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){var n,r,i,s,o=this.options,u=!1;this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&this.scrollParent[0].tagName!=="HTML"?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<o.scrollSensitivity?this.scrollParent[0].scrollTop=u=this.scrollParent[0].scrollTop+o.scrollSpeed:t.pageY-this.overflowOffset.top<o.scrollSensitivity&&(this.scrollParent[0].scrollTop=u=this.scrollParent[0].scrollTop-o.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<o.scrollSensitivity?this.scrollParent[0].scrollLeft=u=this.scrollParent[0].scrollLeft+o.scrollSpeed:t.pageX-this.overflowOffset.left<o.scrollSensitivity&&(this.scrollParent[0].scrollLeft=u=this.scrollParent[0].scrollLeft-o.scrollSpeed)):(t.pageY-e(document).scrollTop()<o.scrollSensitivity?u=e(document).scrollTop(e(document).scrollTop()-o.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<o.scrollSensitivity&&(u=e(document).scrollTop(e(document).scrollTop()+o.scrollSpeed)),t.pageX-e(document).scrollLeft()<o.scrollSensitivity?u=e(document).scrollLeft(e(document).scrollLeft()-o.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<o.scrollSensitivity&&(u=e(document).scrollLeft(e(document).scrollLeft()+o.scrollSpeed))),u!==!1&&e.ui.ddmanager&&!o.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t)),this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!=="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||this.options.axis!=="x")this.helper[0].style.top=this.position.top+"px";for(n=this.items.length-1;n>=0;n--){r=this.items[n],i=r.item[0],s=this._intersectsWithPointer(r);if(!s)continue;if(r.instance!==this.currentContainer)continue;if(i!==this.currentItem[0]&&this.placeholder[s===1?"next":"prev"]()[0]!==i&&!e.contains(this.placeholder[0],i)&&(this.options.type==="semi-dynamic"?!e.contains(this.element[0],i):!0)){this.direction=s===1?"down":"up";if(this.options.tolerance!=="pointer"&&!this._intersectsWithSides(r))break;this._rearrange(t,r),this._trigger("change",t,this._uiHash());break}}return this._contactContainers(t),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,n){if(!t)return;e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,t);if(this.options.revert){var r=this,i=this.placeholder.offset(),s=this.options.axis,o={};if(!s||s==="x")o.left=i.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft);if(!s||s==="y")o.top=i.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop);this.reverting=!0,e(this.helper).animate(o,parseInt(this.options.revert,10)||500,function(){r._clear(t)})}else this._clear(t,n);return!1},cancel:function(){if(this.dragging){this._mouseUp({target:null}),this.options.helper==="original"?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.options.helper!=="original"&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var n=this._getItemsAsjQuery(t&&t.connected),r=[];return t=t||{},e(n).each(function(){var n=(e(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[\-=_](.+)/);n&&r.push((t.key||n[1]+"[]")+"="+(t.key&&t.expression?n[1]:n[2]))}),!r.length&&t.key&&r.push(t.key+"="),r.join("&")},toArray:function(t){var n=this._getItemsAsjQuery(t&&t.connected),r=[];return t=t||{},n.each(function(){r.push(e(t.item||this).attr(t.attribute||"id")||"")}),r},_intersectsWith:function(e){var t=this.positionAbs.left,n=t+this.helperProportions.width,r=this.positionAbs.top,i=r+this.helperProportions.height,s=e.left,o=s+e.width,u=e.top,a=u+e.height,f=this.offset.click.top,l=this.offset.click.left,c=this.options.axis==="x"||r+f>u&&r+f<a,h=this.options.axis==="y"||t+l>s&&t+l<o,p=c&&h;return this.options.tolerance==="pointer"||this.options.forcePointerForContainers||this.options.tolerance!=="pointer"&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?p:s<t+this.helperProportions.width/2&&n-this.helperProportions.width/2<o&&u<r+this.helperProportions.height/2&&i-this.helperProportions.height/2<a},_intersectsWithPointer:function(e){var t=this.options.axis==="x"||this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top,e.height),n=this.options.axis==="y"||this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left,e.width),r=t&&n,i=this._getDragVerticalDirection(),s=this._getDragHorizontalDirection();return r?this.floating?s&&s==="right"||i==="down"?2:1:i&&(i==="down"?2:1):!1},_intersectsWithSides:function(e){var t=this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),n=this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),r=this._getDragVerticalDirection(),i=this._getDragHorizontalDirection();return this.floating&&i?i==="right"&&n||i==="left"&&!n:r&&(r==="down"&&t||r==="up"&&!t)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return e!==0&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return e!==0&&(e>0?"right":"left")},refresh:function(e){return this._refreshItems(e),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor===String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){function f(){o.push(this)}var n,r,i,s,o=[],u=[],a=this._connectWith();if(a&&t)for(n=a.length-1;n>=0;n--){i=e(a[n]);for(r=i.length-1;r>=0;r--)s=e.data(i[r],this.widgetFullName),s&&s!==this&&!s.options.disabled&&u.push([e.isFunction(s.options.items)?s.options.items.call(s.element):e(s.options.items,s.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),s])}u.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(n=u.length-1;n>=0;n--)u[n][0].each(f);return e(o)},_removeCurrentsFromItems:function(){var t=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=e.grep(this.items,function(e){for(var n=0;n<t.length;n++)if(t[n]===e.item[0])return!1;return!0})},_refreshItems:function(t){this.items=[],this.containers=[this];var n,r,i,s,o,u,a,f,l=this.items,c=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]],h=this._connectWith();if(h&&this.ready)for(n=h.length-1;n>=0;n--){i=e(h[n]);for(r=i.length-1;r>=0;r--)s=e.data(i[r],this.widgetFullName),s&&s!==this&&!s.options.disabled&&(c.push([e.isFunction(s.options.items)?s.options.items.call(s.element[0],t,{item:this.currentItem}):e(s.options.items,s.element),s]),this.containers.push(s))}for(n=c.length-1;n>=0;n--){o=c[n][1],u=c[n][0];for(r=0,f=u.length;r<f;r++)a=e(u[r]),a.data(this.widgetName+"-item",o),l.push({item:a,instance:o,width:0,height:0,left:0,top:0})}},refreshPositions:function(t){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var n,r,i,s;for(n=this.items.length-1;n>=0;n--){r=this.items[n];if(r.instance!==this.currentContainer&&this.currentContainer&&r.item[0]!==this.currentItem[0])continue;i=this.options.toleranceElement?e(this.options.toleranceElement,r.item):r.item,t||(r.width=i.outerWidth(),r.height=i.outerHeight()),s=i.offset(),r.left=s.left,r.top=s.top}if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(n=this.containers.length-1;n>=0;n--)s=this.containers[n].element.offset(),this.containers[n].containerCache.left=s.left,this.containers[n].containerCache.top=s.top,this.containers[n].containerCache.width=this.containers[n].element.outerWidth(),this.containers[n].containerCache.height=this.containers[n].element.outerHeight();return this},_createPlaceholder:function(t){t=t||this;var n,r=t.options;if(!r.placeholder||r.placeholder.constructor===String)n=r.placeholder,r.placeholder={element:function(){var r=t.currentItem[0].nodeName.toLowerCase(),i=e("<"+r+">",t.document[0]).addClass(n||t.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return r==="tr"?t.currentItem.children().each(function(){e("<td>&#160;</td>",t.document[0]).attr("colspan",e(this).attr("colspan")||1).appendTo(i)}):r==="img"&&i.attr("src",t.currentItem.attr("src")),n||i.css("visibility","hidden"),i},update:function(e,i){if(n&&!r.forcePlaceholderSize)return;i.height()||i.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css("paddingTop")||0,10)-parseInt(t.currentItem.css("paddingBottom")||0,10)),i.width()||i.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css("paddingLeft")||0,10)-parseInt(t.currentItem.css("paddingRight")||0,10))}};t.placeholder=e(r.placeholder.element.call(t.element,t.currentItem)),t.currentItem.after(t.placeholder),r.placeholder.update(t,t.placeholder)},_contactContainers:function(t){var n,r,i,s,o,u,a,f,l,c,h=null,p=null;for(n=this.containers.length-1;n>=0;n--){if(e.contains(this.currentItem[0],this.containers[n].element[0]))continue;if(this._intersectsWith(this.containers[n].containerCache)){if(h&&e.contains(this.containers[n].element[0],h.element[0]))continue;h=this.containers[n],p=n}else this.containers[n].containerCache.over&&(this.containers[n]._trigger("out",t,this._uiHash(this)),this.containers[n].containerCache.over=0)}if(!h)return;if(this.containers.length===1)this.containers[p].containerCache.over||(this.containers[p]._trigger("over",t,this._uiHash(this)),this.containers[p].containerCache.over=1);else{i=1e4,s=null,l=h.floating||this._isFloating(this.currentItem),o=l?"left":"top",u=l?"width":"height",c=l?"clientX":"clientY";for(r=this.items.length-1;r>=0;r--){if(!e.contains(this.containers[p].element[0],this.items[r].item[0]))continue;if(this.items[r].item[0]===this.currentItem[0])continue;a=this.items[r].item.offset()[o],f=!1,t[c]-a>this.items[r][u]/2&&(f=!0),Math.abs(t[c]-a)<i&&(i=Math.abs(t[c]-a),s=this.items[r],this.direction=f?"up":"down")}if(!s&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[p])return;s?this._rearrange(t,s,null,!0):this._rearrange(t,null,this.containers[p].element,!0),this._trigger("change",t,this._uiHash()),this.containers[p]._trigger("change",t,this._uiHash(this)),this.currentContainer=this.containers[p],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[p]._trigger("over",t,this._uiHash(this)),this.containers[p].containerCache.over=1}},_createHelper:function(t){var n=this.options,r=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t,this.currentItem])):n.helper==="clone"?this.currentItem.clone():this.currentItem;return r.parents("body").length||e(n.appendTo!=="parent"?n.appendTo:this.currentItem[0].parentNode)[0].appendChild(r[0]),r[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!r[0].style.width||n.forceHelperSize)&&r.width(this.currentItem.width()),(!r[0].style.height||n.forceHelperSize)&&r.height(this.currentItem.height()),r},_adjustOffsetFromHelper:function(t){typeof t=="string"&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();this.cssPosition==="absolute"&&this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()==="html"&&e.ui.ie)t={top:0,left:0};return{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition==="relative"){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,n,r,i=this.options;i.containment==="parent"&&(i.containment=this.helper[0].parentNode);if(i.containment==="document"||i.containment==="window")this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,e(i.containment==="document"?document:window).width()-this.helperProportions.width-this.margins.left,(e(i.containment==="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];/^(document|window|parent)$/.test(i.containment)||(t=e(i.containment)[0],n=e(i.containment).offset(),r=e(t).css("overflow")!=="hidden",this.containment=[n.left+(parseInt(e(t).css("borderLeftWidth"),10)||0)+(parseInt(e(t).css("paddingLeft"),10)||0)-this.margins.left,n.top+(parseInt(e(t).css("borderTopWidth"),10)||0)+(parseInt(e(t).css("paddingTop"),10)||0)-this.margins.top,n.left+(r?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(e(t).css("borderLeftWidth"),10)||0)-(parseInt(e(t).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,n.top+(r?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(e(t).css("borderTopWidth"),10)||0)-(parseInt(e(t).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(t,n){n||(n=this.position);var r=t==="absolute"?1:-1,i=this.cssPosition!=="absolute"||this.scrollParent[0]!==document&&!!e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,s=/(html|body)/i.test(i[0].tagName);return{top:n.top+this.offset.relative.top*r+this.offset.parent.top*r-(this.cssPosition==="fixed"?-this.scrollParent.scrollTop():s?0:i.scrollTop())*r,left:n.left+this.offset.relative.left*r+this.offset.parent.left*r-(this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():s?0:i.scrollLeft())*r}},_generatePosition:function(t){var n,r,i=this.options,s=t.pageX,o=t.pageY,u=this.cssPosition!=="absolute"||this.scrollParent[0]!==document&&!!e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,a=/(html|body)/i.test(u[0].tagName);return this.cssPosition==="relative"&&(this.scrollParent[0]===document||this.scrollParent[0]===this.offsetParent[0])&&(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(s=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(o=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(s=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(o=this.containment[3]+this.offset.click.top)),i.grid&&(n=this.originalPageY+Math.round((o-this.originalPageY)/i.grid[1])*i.grid[1],o=this.containment?n-this.offset.click.top>=this.containment[1]&&n-this.offset.click.top<=this.containment[3]?n:n-this.offset.click.top>=this.containment[1]?n-i.grid[1]:n+i.grid[1]:n,r=this.originalPageX+Math.round((s-this.originalPageX)/i.grid[0])*i.grid[0],s=this.containment?r-this.offset.click.left>=this.containment[0]&&r-this.offset.click.left<=this.containment[2]?r:r-this.offset.click.left>=this.containment[0]?r-i.grid[0]:r+i.grid[0]:r)),{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(this.cssPosition==="fixed"?-this.scrollParent.scrollTop():a?0:u.scrollTop()),left:s-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():a?0:u.scrollLeft())}},_rearrange:function(e,t,n,r){n?n[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],this.direction==="down"?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var i=this.counter;this._delay(function(){i===this.counter&&this.refreshPositions(!r)})},_clear:function(e,t){function i(e,t,n){return function(r){n._trigger(e,r,t._uiHash(t))}}this.reverting=!1;var n,r=[];!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null;if(this.helper[0]===this.currentItem[0]){for(n in this._storedCSS)if(this._storedCSS[n]==="auto"||this._storedCSS[n]==="static")this._storedCSS[n]="";this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();this.fromOutside&&!t&&r.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))}),(this.fromOutside||this.domPosition.prev!==this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!==this.currentItem.parent()[0])&&!t&&r.push(function(e){this._trigger("update",e,this._uiHash())}),this!==this.currentContainer&&(t||(r.push(function(e){this._trigger("remove",e,this._uiHash())}),r.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),r.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer))));for(n=this.containers.length-1;n>=0;n--)t||r.push(i("deactivate",this,this.containers[n])),this.containers[n].containerCache.over&&(r.push(i("out",this,this.containers[n])),this.containers[n].containerCache.over=0);this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex",this._storedZIndex==="auto"?"":this._storedZIndex),this.dragging=!1;if(this.cancelHelperRemoval){if(!t){this._trigger("beforeStop",e,this._uiHash());for(n=0;n<r.length;n++)r[n].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!1}t||this._trigger("beforeStop",e,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null;if(!t){for(n=0;n<r.length;n++)r[n].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){e.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(t){var n=t||this;return{helper:n.helper,placeholder:n.placeholder||e([]),position:n.position,originalPosition:n.originalPosition,offset:n.positionAbs,item:n.currentItem,sender:t?t.element:null}}});e.extend(e.ui,{datepicker:{version:"1.11.0"}});var p;e.extend(v.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return g(this._defaults,e||{}),this},_attachDatepicker:function(t,n){var r,i,s;r=t.nodeName.toLowerCase(),i=r==="div"||r==="span",t.id||(this.uuid+=1,t.id="dp"+this.uuid),s=this._newInst(e(t),i),s.settings=e.extend({},n||{}),r==="input"?this._connectDatepicker(t,s):i&&this._inlineDatepicker(t,s)},_newInst:function(t,n){var r=t[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:r,input:t,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:n,dpDiv:n?m(e("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(t,n){var r=e(t);n.append=e([]),n.trigger=e([]);if(r.hasClass(this.markerClassName))return;this._attachments(r,n),r.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(n),e.data(t,"datepicker",n),n.settings.disabled&&this._disableDatepicker(t)},_attachments:function(t,n){var r,i,s,o=this._get(n,"appendText"),u=this._get(n,"isRTL");n.append&&n.append.remove(),o&&(n.append=e("<span class='"+this._appendClass+"'>"+o+"</span>"),t[u?"before":"after"](n.append)),t.unbind("focus",this._showDatepicker),n.trigger&&n.trigger.remove(),r=this._get(n,"showOn"),(r==="focus"||r==="both")&&t.focus(this._showDatepicker);if(r==="button"||r==="both")i=this._get(n,"buttonText"),s=this._get(n,"buttonImage"),n.trigger=e(this._get(n,"buttonImageOnly")?e("<img/>").addClass(this._triggerClass).attr({src:s,alt:i,title:i}):e("<button type='button'></button>").addClass(this._triggerClass).html(s?e("<img/>").attr({src:s,alt:i,title:i}):i)),t[u?"before":"after"](n.trigger),n.trigger.click(function(){return e.datepicker._datepickerShowing&&e.datepicker._lastInput===t[0]?e.datepicker._hideDatepicker():e.datepicker._datepickerShowing&&e.datepicker._lastInput!==t[0]?(e.datepicker._hideDatepicker(),e.datepicker._showDatepicker(t[0])):e.datepicker._showDatepicker(t[0]),!1})},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t,n,r,i,s=new Date(2009,11,20),o=this._get(e,"dateFormat");o.match(/[DM]/)&&(t=function(e){n=0,r=0;for(i=0;i<e.length;i++)e[i].length>n&&(n=e[i].length,r=i);return r},s.setMonth(t(this._get(e,o.match(/MM/)?"monthNames":"monthNamesShort"))),s.setDate(t(this._get(e,o.match(/DD/)?"dayNames":"dayNamesShort"))+20-s.getDay())),e.input.attr("size",this._formatDate(e,s).length)}},_inlineDatepicker:function(t,n){var r=e(t);if(r.hasClass(this.markerClassName))return;r.addClass(this.markerClassName).append(n.dpDiv),e.data(t,"datepicker",n),this._setDate(n,this._getDefaultDate(n),!0),this._updateDatepicker(n),this._updateAlternate(n),n.settings.disabled&&this._disableDatepicker(t),n.dpDiv.css("display","block")},_dialogDatepicker:function(t,n,r,i,s){var o,u,a,f,l,c=this._dialogInst;return c||(this.uuid+=1,o="dp"+this.uuid,this._dialogInput=e("<input type='text' id='"+o+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),e("body").append(this._dialogInput),c=this._dialogInst=this._newInst(this._dialogInput,!1),c.settings={},e.data(this._dialogInput[0],"datepicker",c)),g(c.settings,i||{}),n=n&&n.constructor===Date?this._formatDate(c,n):n,this._dialogInput.val(n),this._pos=s?s.length?s:[s.pageX,s.pageY]:null,this._pos||(u=document.documentElement.clientWidth,a=document.documentElement.clientHeight,f=document.documentElement.scrollLeft||document.body.scrollLeft,l=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[u/2-100+f,a/2-150+l]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),c.settings.onSelect=r,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),e.blockUI&&e.blockUI(this.dpDiv),e.data(this._dialogInput[0],"datepicker",c),this},_destroyDatepicker:function(t){var n,r=e(t),i=e.data(t,"datepicker");if(!r.hasClass(this.markerClassName))return;n=t.nodeName.toLowerCase(),e.removeData(t,"datepicker"),n==="input"?(i.append.remove(),i.trigger.remove(),r.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):(n==="div"||n==="span")&&r.removeClass(this.markerClassName).empty()},_enableDatepicker:function(t){var n,r,i=e(t),s=e.data(t,"datepicker");if(!i.hasClass(this.markerClassName))return;n=t.nodeName.toLowerCase();if(n==="input")t.disabled=!1,s.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""});else if(n==="div"||n==="span")r=i.children("."+this._inlineClass),r.children().removeClass("ui-state-disabled"),r.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1);this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e})},_disableDatepicker:function(t){var n,r,i=e(t),s=e.data(t,"datepicker");if(!i.hasClass(this.markerClassName))return;n=t.nodeName.toLowerCase();if(n==="input")t.disabled=!0,s.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"});else if(n==="div"||n==="span")r=i.children("."+this._inlineClass),r.children().addClass("ui-state-disabled"),r.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0);this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}),this._disabledInputs[this._disabledInputs.length]=t},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;t<this._disabledInputs.length;t++)if(this._disabledInputs[t]===e)return!0;return!1},_getInst:function(t){try{return e.data(t,"datepicker")}catch(n){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(t,n,r){var i,s,o,u,a=this._getInst(t);if(arguments.length===2&&typeof n=="string")return n==="defaults"?e.extend({},e.datepicker._defaults):a?n==="all"?e.extend({},a.settings):this._get(a,n):null;i=n||{},typeof n=="string"&&(i={},i[n]=r),a&&(this._curInst===a&&this._hideDatepicker(),s=this._getDateDatepicker(t,!0),o=this._getMinMaxDate(a,"min"),u=this._getMinMaxDate(a,"max"),g(a.settings,i),o!==null&&i.dateFormat!==undefined&&i.minDate===undefined&&(a.settings.minDate=this._formatDate(a,o)),u!==null&&i.dateFormat!==undefined&&i.maxDate===undefined&&(a.settings.maxDate=this._formatDate(a,u)),"disabled"in i&&(i.disabled?this._disableDatepicker(t):this._enableDatepicker(t)),this._attachments(e(t),a),this._autoSize(a),this._setDate(a,s),this._updateAlternate(a),this._updateDatepicker(a))},_changeDatepicker:function(e,t,n){this._optionDatepicker(e,t,n)},_refreshDatepicker:function(e){var t=this._getInst(e);t&&this._updateDatepicker(t)},_setDateDatepicker:function(e,t){var n=this._getInst(e);n&&(this._setDate(n,t),this._updateDatepicker(n),this._updateAlternate(n))},_getDateDatepicker:function(e,t){var n=this._getInst(e);return n&&!n.inline&&this._setDateFromField(n,t),n?this._getDate(n):null},_doKeyDown:function(t){var n,r,i,s=e.datepicker._getInst(t.target),o=!0,u=s.dpDiv.is(".ui-datepicker-rtl");s._keyEvent=!0;if(e.datepicker._datepickerShowing)switch(t.keyCode){case 9:e.datepicker._hideDatepicker(),o=!1;break;case 13:return i=e("td."+e.datepicker._dayOverClass+":not(."+e.datepicker._currentClass+")",s.dpDiv),i[0]&&e.datepicker._selectDay(t.target,s.selectedMonth,s.selectedYear,i[0]),n=e.datepicker._get(s,"onSelect"),n?(r=e.datepicker._formatDate(s),n.apply(s.input?s.input[0]:null,[r,s])):e.datepicker._hideDatepicker(),!1;case 27:e.datepicker._hideDatepicker();break;case 33:e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(s,"stepBigMonths"):-e.datepicker._get(s,"stepMonths"),"M");break;case 34:e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(s,"stepBigMonths"):+e.datepicker._get(s,"stepMonths"),"M");break;case 35:(t.ctrlKey||t.metaKey)&&e.datepicker._clearDate(t.target),o=t.ctrlKey||t.metaKey;break;case 36:(t.ctrlKey||t.metaKey)&&e.datepicker._gotoToday(t.target),o=t.ctrlKey||t.metaKey;break;case 37:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,u?1:-1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(s,"stepBigMonths"):-e.datepicker._get(s,"stepMonths"),"M");break;case 38:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,-7,"D"),o=t.ctrlKey||t.metaKey;break;case 39:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,u?-1:1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(s,"stepBigMonths"):+e.datepicker._get(s,"stepMonths"),"M");break;case 40:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,7,"D"),o=t.ctrlKey||t.metaKey;break;default:o=!1}else t.keyCode===36&&t.ctrlKey?e.datepicker._showDatepicker(this):o=!1;o&&(t.preventDefault(),t.stopPropagation())},_doKeyPress:function(t){var n,r,i=e.datepicker._getInst(t.target);if(e.datepicker._get(i,"constrainInput"))return n=e.datepicker._possibleChars(e.datepicker._get(i,"dateFormat")),r=String.fromCharCode(t.charCode==null?t.keyCode:t.charCode),t.ctrlKey||t.metaKey||r<" "||!n||n.indexOf(r)>-1},_doKeyUp:function(t){var n,r=e.datepicker._getInst(t.target);if(r.input.val()!==r.lastVal)try{n=e.datepicker.parseDate(e.datepicker._get(r,"dateFormat"),r.input?r.input.val():null,e.datepicker._getFormatConfig(r)),n&&(e.datepicker._setDateFromField(r),e.datepicker._updateAlternate(r),e.datepicker._updateDatepicker(r))}catch(i){}return!0},_showDatepicker:function(t){t=t.target||t,t.nodeName.toLowerCase()!=="input"&&(t=e("input",t.parentNode)[0]);if(e.datepicker._isDisabledDatepicker(t)||e.datepicker._lastInput===t)return;var n,r,i,s,o,u,a;n=e.datepicker._getInst(t),e.datepicker._curInst&&e.datepicker._curInst!==n&&(e.datepicker._curInst.dpDiv.stop(!0,!0),n&&e.datepicker._datepickerShowing&&e.datepicker._hideDatepicker(e.datepicker._curInst.input[0])),r=e.datepicker._get(n,"beforeShow"),i=r?r.apply(t,[t,n]):{};if(i===!1)return;g(n.settings,i),n.lastVal=null,e.datepicker._lastInput=t,e.datepicker._setDateFromField(n),e.datepicker._inDialog&&(t.value=""),e.datepicker._pos||(e.datepicker._pos=e.datepicker._findPos(t),e.datepicker._pos[1]+=t.offsetHeight),s=!1,e(t).parents().each(function(){return s|=e(this).css("position")==="fixed",!s}),o={left:e.datepicker._pos[0],top:e.datepicker._pos[1]},e.datepicker._pos=null,n.dpDiv.empty(),n.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),e.datepicker._updateDatepicker(n),o=e.datepicker._checkOffset(n,o,s),n.dpDiv.css({position:e.datepicker._inDialog&&e.blockUI?"static":s?"fixed":"absolute",display:"none",left:o.left+"px",top:o.top+"px"}),n.inline||(u=e.datepicker._get(n,"showAnim"),a=e.datepicker._get(n,"duration"),n.dpDiv.css("z-index",d(e(t))+1),e.datepicker._datepickerShowing=!0,e.effects&&e.effects.effect[u]?n.dpDiv.show(u,e.datepicker._get(n,"showOptions"),a):n.dpDiv[u||"show"](u?a:null),e.datepicker._shouldFocusInput(n)&&n.input.focus(),e.datepicker._curInst=n)},_updateDatepicker:function(t){this.maxRows=4,p=t,t.dpDiv.empty().append(this._generateHTML(t)),this._attachHandlers(t),t.dpDiv.find("."+this._dayOverClass+" a");var n,r=this._getNumberOfMonths(t),i=r[1],s=17;t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),i>1&&t.dpDiv.addClass("ui-datepicker-multi-"+i).css("width",s*i+"em"),t.dpDiv[(r[0]!==1||r[1]!==1?"add":"remove")+"Class"]("ui-datepicker-multi"),t.dpDiv[(this._get(t,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),t===e.datepicker._curInst&&e.datepicker._datepickerShowing&&e.datepicker._shouldFocusInput(t)&&t.input.focus(),t.yearshtml&&(n=t.yearshtml,setTimeout(function(){n===t.yearshtml&&t.yearshtml&&t.dpDiv.find("select.ui-datepicker-year:first").replaceWith(t.yearshtml),n=t.yearshtml=null},0))},_shouldFocusInput:function(e){return e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&!e.input.is(":focus")},_checkOffset:function(t,n,r){var i=t.dpDiv.outerWidth(),s=t.dpDiv.outerHeight(),o=t.input?t.input.outerWidth():0,u=t.input?t.input.outerHeight():0,a=document.documentElement.clientWidth+(r?0:e(document).scrollLeft()),f=document.documentElement.clientHeight+(r?0:e(document).scrollTop());return n.left-=this._get(t,"isRTL")?i-o:0,n.left-=r&&n.left===t.input.offset().left?e(document).scrollLeft():0,n.top-=r&&n.top===t.input.offset().top+u?e(document).scrollTop():0,n.left-=Math.min(n.left,n.left+i>a&&a>i?Math.abs(n.left+i-a):0),n.top-=Math.min(n.top,n.top+s>f&&f>s?Math.abs(s+u):0),n},_findPos:function(t){var n,r=this._getInst(t),i=this._get(r,"isRTL");while(t&&(t.type==="hidden"||t.nodeType!==1||e.expr.filters.hidden(t)))t=t[i?"previousSibling":"nextSibling"];return n=e(t).offset(),[n.left,n.top]},_hideDatepicker:function(t){var n,r,i,s,o=this._curInst;if(!o||t&&o!==e.data(t,"datepicker"))return;this._datepickerShowing&&(n=this._get(o,"showAnim"),r=this._get(o,"duration"),i=function(){e.datepicker._tidyDialog(o)},e.effects&&(e.effects.effect[n]||e.effects[n])?o.dpDiv.hide(n,e.datepicker._get(o,"showOptions"),r,i):o.dpDiv[n==="slideDown"?"slideUp":n==="fadeIn"?"fadeOut":"hide"](n?r:null,i),n||i(),this._datepickerShowing=!1,s=this._get(o,"onClose"),s&&s.apply(o.input?o.input[0]:null,[o.input?o.input.val():"",o]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),e.blockUI&&(e.unblockUI(),e("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(t){if(!e.datepicker._curInst)return;var n=e(t.target),r=e.datepicker._getInst(n[0]);(n[0].id!==e.datepicker._mainDivId&&n.parents("#"+e.datepicker._mainDivId).length===0&&!n.hasClass(e.datepicker.markerClassName)&&!n.closest("."+e.datepicker._triggerClass).length&&e.datepicker._datepickerShowing&&(!e.datepicker._inDialog||!e.blockUI)||n.hasClass(e.datepicker.markerClassName)&&e.datepicker._curInst!==r)&&e.datepicker._hideDatepicker()},_adjustDate:function(t,n,r){var i=e(t),s=this._getInst(i[0]);if(this._isDisabledDatepicker(i[0]))return;this._adjustInstDate(s,n+(r==="M"?this._get(s,"showCurrentAtPos"):0),r),this._updateDatepicker(s)},_gotoToday:function(t){var n,r=e(t),i=this._getInst(r[0]);this._get(i,"gotoCurrent")&&i.currentDay?(i.selectedDay=i.currentDay,i.drawMonth=i.selectedMonth=i.currentMonth,i.drawYear=i.selectedYear=i.currentYear):(n=new Date,i.selectedDay=n.getDate(),i.drawMonth=i.selectedMonth=n.getMonth(),i.drawYear=i.selectedYear=n.getFullYear()),this._notifyChange(i),this._adjustDate(r)},_selectMonthYear:function(t,n,r){var i=e(t),s=this._getInst(i[0]);s["selected"+(r==="M"?"Month":"Year")]=s["draw"+(r==="M"?"Month":"Year")]=parseInt(n.options[n.selectedIndex].value,10),this._notifyChange(s),this._adjustDate(i)},_selectDay:function(t,n,r,i){var s,o=e(t);if(e(i).hasClass(this._unselectableClass)||this._isDisabledDatepicker(o[0]))return;s=this._getInst(o[0]),s.selectedDay=s.currentDay=e("a",i).html(),s.selectedMonth=s.currentMonth=n,s.selectedYear=s.currentYear=r,this._selectDate(t,this._formatDate(s,s.currentDay,s.currentMonth,s.currentYear))},_clearDate:function(t){var n=e(t);this._selectDate(n,"")},_selectDate:function(t,n){var r,i=e(t),s=this._getInst(i[0]);n=n!=null?n:this._formatDate(s),s.input&&s.input.val(n),this._updateAlternate(s),r=this._get(s,"onSelect"),r?r.apply(s.input?s.input[0]:null,[n,s]):s.input&&s.input.trigger("change"),s.inline?this._updateDatepicker(s):(this._hideDatepicker(),this._lastInput=s.input[0],typeof s.input[0]!="object"&&s.input.focus(),this._lastInput=null)},_updateAlternate:function(t){var n,r,i,s=this._get(t,"altField");s&&(n=this._get(t,"altFormat")||this._get(t,"dateFormat"),r=this._getDate(t),i=this.formatDate(n,r,this._getFormatConfig(t)),e(s).each(function(){e(this).val(i)}))},noWeekends:function(e){var t=e.getDay();return[t>0&&t<6,""]},iso8601Week:function(e){var t,n=new Date(e.getTime());return n.setDate(n.getDate()+4-(n.getDay()||7)),t=n.getTime(),n.setMonth(0),n.setDate(1),Math.floor(Math.round((t-n)/864e5)/7)+1},parseDate:function(t,n,r){if(t==null||n==null)throw"Invalid arguments";n=typeof n=="object"?n.toString():n+"";if(n==="")return null;var i,s,o,u=0,a=(r?r.shortYearCutoff:null)||this._defaults.shortYearCutoff,f=typeof a!="string"?a:(new Date).getFullYear()%100+parseInt(a,10),l=(r?r.dayNamesShort:null)||this._defaults.dayNamesShort,c=(r?r.dayNames:null)||this._defaults.dayNames,h=(r?r.monthNamesShort:null)||this._defaults.monthNamesShort,p=(r?r.monthNames:null)||this._defaults.monthNames,d=-1,v=-1,m=-1,g=-1,y=!1,b,w=function(e){var n=i+1<t.length&&t.charAt(i+1)===e;return n&&i++,n},E=function(e){var t=w(e),r=e==="@"?14:e==="!"?20:e==="y"&&t?4:e==="o"?3:2,i=new RegExp("^\\d{1,"+r+"}"),s=n.substring(u).match(i);if(!s)throw"Missing number at position "+u;return u+=s[0].length,parseInt(s[0],10)},S=function(t,r,i){var s=-1,o=e.map(w(t)?i:r,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)});e.each(o,function(e,t){var r=t[1];if(n.substr(u,r.length).toLowerCase()===r.toLowerCase())return s=t[0],u+=r.length,!1});if(s!==-1)return s+1;throw"Unknown name at position "+u},x=function(){if(n.charAt(u)!==t.charAt(i))throw"Unexpected literal at position "+u;u++};for(i=0;i<t.length;i++)if(y)t.charAt(i)==="'"&&!w("'")?y=!1:x();else switch(t.charAt(i)){case"d":m=E("d");break;case"D":S("D",l,c);break;case"o":g=E("o");break;case"m":v=E("m");break;case"M":v=S("M",h,p);break;case"y":d=E("y");break;case"@":b=new Date(E("@")),d=b.getFullYear(),v=b.getMonth()+1,m=b.getDate();break;case"!":b=new Date((E("!")-this._ticksTo1970)/1e4),d=b.getFullYear(),v=b.getMonth()+1,m=b.getDate();break;case"'":w("'")?x():y=!0;break;default:x()}if(u<n.length){o=n.substr(u);if(!/^\s+/.test(o))throw"Extra/unparsed characters found in date: "+o}d===-1?d=(new Date).getFullYear():d<100&&(d+=(new Date).getFullYear()-(new Date).getFullYear()%100+(d<=f?0:-100));if(g>-1){v=1,m=g;do{s=this._getDaysInMonth(d,v-1);if(m<=s)break;v++,m-=s}while(!0)}b=this._daylightSavingAdjust(new Date(d,v-1,m));if(b.getFullYear()!==d||b.getMonth()+1!==v||b.getDate()!==m)throw"Invalid date";return b},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*24*60*60*1e7,formatDate:function(e,t,n){if(!t)return"";var r,i=(n?n.dayNamesShort:null)||this._defaults.dayNamesShort,s=(n?n.dayNames:null)||this._defaults.dayNames,o=(n?n.monthNamesShort:null)||this._defaults.monthNamesShort,u=(n?n.monthNames:null)||this._defaults.monthNames,a=function(t){var n=r+1<e.length&&e.charAt(r+1)===t;return n&&r++,n},f=function(e,t,n){var r=""+t;if(a(e))while(r.length<n)r="0"+r;return r},l=function(e,t,n,r){return a(e)?r[t]:n[t]},c="",h=!1;if(t)for(r=0;r<e.length;r++)if(h)e.charAt(r)==="'"&&!a("'")?h=!1:c+=e.charAt(r);else switch(e.charAt(r)){case"d":c+=f("d",t.getDate(),2);break;case"D":c+=l("D",t.getDay(),i,s);break;case"o":c+=f("o",Math.round(((new Date(t.getFullYear(),t.getMonth(),t.getDate())).getTime()-(new Date(t.getFullYear(),0,0)).getTime())/864e5),3);break;case"m":c+=f("m",t.getMonth()+1,2);break;case"M":c+=l("M",t.getMonth(),o,u);break;case"y":c+=a("y")?t.getFullYear():(t.getYear()%100<10?"0":"")+t.getYear()%100;break;case"@":c+=t.getTime();break;case"!":c+=t.getTime()*1e4+this._ticksTo1970;break;case"'":a("'")?c+="'":h=!0;break;default:c+=e.charAt(r)}return c},_possibleChars:function(e){var t,n="",r=!1,i=function(n){var r=t+1<e.length&&e.charAt(t+1)===n;return r&&t++,r};for(t=0;t<e.length;t++)if(r)e.charAt(t)==="'"&&!i("'")?r=!1:n+=e.charAt(t);else switch(e.charAt(t)){case"d":case"m":case"y":case"@":n+="0123456789";break;case"D":case"M":return null;case"'":i("'")?n+="'":r=!0;break;default:n+=e.charAt(t)}return n},_get:function(e,t){return e.settings[t]!==undefined?e.settings[t]:this._defaults[t]},_setDateFromField:function(e,t){if(e.input.val()===e.lastVal)return;var n=this._get(e,"dateFormat"),r=e.lastVal=e.input?e.input.val():null,i=this._getDefaultDate(e),s=i,o=this._getFormatConfig(e);try{s=this.parseDate(n,r,o)||i}catch(u){r=t?"":r}e.selectedDay=s.getDate(),e.drawMonth=e.selectedMonth=s.getMonth(),e.drawYear=e.selectedYear=s.getFullYear(),e.currentDay=r?s.getDate():0,e.currentMonth=r?s.getMonth():0,e.currentYear=r?s.getFullYear():0,this._adjustInstDate(e)},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(t,n,r){var i=function(e){var t=new Date;return t.setDate(t.getDate()+e),t},s=function(n){try{return e.datepicker.parseDate(e.datepicker._get(t,"dateFormat"),n,e.datepicker._getFormatConfig(t))}catch(r){}var i=(n.toLowerCase().match(/^c/)?e.datepicker._getDate(t):null)||new Date,s=i.getFullYear(),o=i.getMonth(),u=i.getDate(),a=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,f=a.exec(n);while(f){switch(f[2]||"d"){case"d":case"D":u+=parseInt(f[1],10);break;case"w":case"W":u+=parseInt(f[1],10)*7;break;case"m":case"M":o+=parseInt(f[1],10),u=Math.min(u,e.datepicker._getDaysInMonth(s,o));break;case"y":case"Y":s+=parseInt(f[1],10),u=Math.min(u,e.datepicker._getDaysInMonth(s,o))}f=a.exec(n)}return new Date(s,o,u)},o=n==null||n===""?r:typeof n=="string"?s(n):typeof n=="number"?isNaN(n)?r:i(n):new Date(n.getTime());return o=o&&o.toString()==="Invalid Date"?r:o,o&&(o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0)),this._daylightSavingAdjust(o)},_daylightSavingAdjust:function(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null},_setDate:function(e,t,n){var r=!t,i=e.selectedMonth,s=e.selectedYear,o=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=o.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=o.getMonth(),e.drawYear=e.selectedYear=e.currentYear=o.getFullYear(),(i!==e.selectedMonth||s!==e.selectedYear)&&!n&&this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(r?"":this._formatDate(e))},_getDate:function(e){var t=!e.currentYear||e.input&&e.input.val()===""?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return t},_attachHandlers:function(t){var n=this._get(t,"stepMonths"),r="#"+t.id.replace(/\\\\/g,"\\");t.dpDiv.find("[data-handler]").map(function(){var t={prev:function(){e.datepicker._adjustDate(r,-n,"M")},next:function(){e.datepicker._adjustDate(r,+n,"M")},hide:function(){e.datepicker._hideDatepicker()},today:function(){e.datepicker._gotoToday(r)},selectDay:function(){return e.datepicker._selectDay(r,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return e.datepicker._selectMonthYear(r,this,"M"),!1},selectYear:function(){return e.datepicker._selectMonthYear(r,this,"Y"),!1}};e(this).bind(this.getAttribute("data-event"),t[this.getAttribute("data-handler")])})},_generateHTML:function(e){var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q=new Date,R=this._daylightSavingAdjust(new Date(q.getFullYear(),q.getMonth(),q.getDate())),U=this._get(e,"isRTL"),z=this._get(e,"showButtonPanel"),W=this._get(e,"hideIfNoPrevNext"),X=this._get(e,"navigationAsDateFormat"),V=this._getNumberOfMonths(e),$=this._get(e,"showCurrentAtPos"),J=this._get(e,"stepMonths"),K=V[0]!==1||V[1]!==1,Q=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),G=this._getMinMaxDate(e,"min"),Y=this._getMinMaxDate(e,"max"),Z=e.drawMonth-$,et=e.drawYear;Z<0&&(Z+=12,et--);if(Y){t=this._daylightSavingAdjust(new Date(Y.getFullYear(),Y.getMonth()-V[0]*V[1]+1,Y.getDate())),t=G&&t<G?G:t;while(this._daylightSavingAdjust(new Date(et,Z,1))>t)Z--,Z<0&&(Z=11,et--)}e.drawMonth=Z,e.drawYear=et,n=this._get(e,"prevText"),n=X?this.formatDate(n,this._daylightSavingAdjust(new Date(et,Z-J,1)),this._getFormatConfig(e)):n,r=this._canAdjustMonth(e,-1,et,Z)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"e":"w")+"'>"+n+"</span></a>":W?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"e":"w")+"'>"+n+"</span></a>",i=this._get(e,"nextText"),i=X?this.formatDate(i,this._daylightSavingAdjust(new Date(et,Z+J,1)),this._getFormatConfig(e)):i,s=this._canAdjustMonth(e,1,et,Z)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"w":"e")+"'>"+i+"</span></a>":W?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"w":"e")+"'>"+i+"</span></a>",o=this._get(e,"currentText"),u=this._get(e,"gotoCurrent")&&e.currentDay?Q:R,o=X?this.formatDate(o,u,this._getFormatConfig(e)):o,a=e.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(e,"closeText")+"</button>",f=z?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(U?a:"")+(this._isInRange(e,u)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+o+"</button>":"")+(U?"":a)+"</div>":"",l=parseInt(this._get(e,"firstDay"),10),l=isNaN(l)?0:l,c=this._get(e,"showWeek"),h=this._get(e,"dayNames"),p=this._get(e,"dayNamesMin"),d=this._get(e,"monthNames"),v=this._get(e,"monthNamesShort"),m=this._get(e,"beforeShowDay"),g=this._get(e,"showOtherMonths"),y=this._get(e,"selectOtherMonths"),b=this._getDefaultDate(e),w="",E;for(S=0;S<V[0];S++){x="",this.maxRows=4;for(T=0;T<V[1];T++){N=this._daylightSavingAdjust(new Date(et,Z,e.selectedDay)),C=" ui-corner-all",k="";if(K){k+="<div class='ui-datepicker-group";if(V[1]>1)switch(T){case 0:k+=" ui-datepicker-group-first",C=" ui-corner-"+(U?"right":"left");break;case V[1]-1:k+=" ui-datepicker-group-last",C=" ui-corner-"+(U?"left":"right");break;default:k+=" ui-datepicker-group-middle",C=""}k+="'>"}k+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+C+"'>"+(/all|left/.test(C)&&S===0?U?s:r:"")+(/all|right/.test(C)&&S===0?U?r:s:"")+this._generateMonthYearHeader(e,Z,et,G,Y,S>0||T>0,d,v)+"</div><table class='ui-datepicker-calendar'><thead>"+"<tr>",L=c?"<th class='ui-datepicker-week-col'>"+this._get(e,"weekHeader")+"</th>":"";for(E=0;E<7;E++)A=(E+l)%7,L+="<th scope='col'"+((E+l+6)%7>=5?" class='ui-datepicker-week-end'":"")+">"+"<span title='"+h[A]+"'>"+p[A]+"</span></th>";k+=L+"</tr></thead><tbody>",O=this._getDaysInMonth(et,Z),et===e.selectedYear&&Z===e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,O)),M=(this._getFirstDayOfMonth(et,Z)-l+7)%7,_=Math.ceil((M+O)/7),D=K?this.maxRows>_?this.maxRows:_:_,this.maxRows=D,P=this._daylightSavingAdjust(new Date(et,Z,1-M));for(H=0;H<D;H++){k+="<tr>",B=c?"<td class='ui-datepicker-week-col'>"+this._get(e,"calculateWeek")(P)+"</td>":"";for(E=0;E<7;E++)j=m?m.apply(e.input?e.input[0]:null,[P]):[!0,""],F=P.getMonth()!==Z,I=F&&!y||!j[0]||G&&P<G||Y&&P>Y,B+="<td class='"+((E+l+6)%7>=5?" ui-datepicker-week-end":"")+(F?" ui-datepicker-other-month":"")+(P.getTime()===N.getTime()&&Z===e.selectedMonth&&e._keyEvent||b.getTime()===P.getTime()&&b.getTime()===N.getTime()?" "+this._dayOverClass:"")+(I?" "+this._unselectableClass+" ui-state-disabled":"")+(F&&!g?"":" "+j[1]+(P.getTime()===Q.getTime()?" "+this._currentClass:"")+(P.getTime()===R.getTime()?" ui-datepicker-today":""))+"'"+((!F||g)&&j[2]?" title='"+j[2].replace(/'/g,"&#39;")+"'":"")+(I?"":" data-handler='selectDay' data-event='click' data-month='"+P.getMonth()+"' data-year='"+P.getFullYear()+"'")+">"+(F&&!g?"&#xa0;":I?"<span class='ui-state-default'>"+P.getDate()+"</span>":"<a class='ui-state-default"+(P.getTime()===R.getTime()?" ui-state-highlight":"")+(P.getTime()===Q.getTime()?" ui-state-active":"")+(F?" ui-priority-secondary":"")+"' href='#'>"+P.getDate()+"</a>")+"</td>",P.setDate(P.getDate()+1),P=this._daylightSavingAdjust(P);k+=B+"</tr>"}Z++,Z>11&&(Z=0,et++),k+="</tbody></table>"+(K?"</div>"+(V[0]>0&&T===V[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),x+=k}w+=x}return w+=f,e._keyEvent=!1,w},_generateMonthYearHeader:function(e,t,n,r,i,s,o,u){var a,f,l,c,h,p,d,v,m=this._get(e,"changeMonth"),g=this._get(e,"changeYear"),y=this._get(e,"showMonthAfterYear"),b="<div class='ui-datepicker-title'>",w="";if(s||!m)w+="<span class='ui-datepicker-month'>"+o[t]+"</span>";else{a=r&&r.getFullYear()===n,f=i&&i.getFullYear()===n,w+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>";for(l=0;l<12;l++)(!a||l>=r.getMonth())&&(!f||l<=i.getMonth())&&(w+="<option value='"+l+"'"+(l===t?" selected='selected'":"")+">"+u[l]+"</option>");w+="</select>"}y||(b+=w+(s||!m||!g?"&#xa0;":""));if(!e.yearshtml){e.yearshtml="";if(s||!g)b+="<span class='ui-datepicker-year'>"+n+"</span>";else{c=this._get(e,"yearRange").split(":"),h=(new Date).getFullYear(),p=function(e){var t=e.match(/c[+\-].*/)?n+parseInt(e.substring(1),10):e.match(/[+\-].*/)?h+parseInt(e,10):parseInt(e,10);return isNaN(t)?h:t},d=p(c[0]),v=Math.max(d,p(c[1]||"")),d=r?Math.max(d,r.getFullYear()):d,v=i?Math.min(v,i.getFullYear()):v,e.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";for(;d<=v;d++)e.yearshtml+="<option value='"+d+"'"+(d===n?" selected='selected'":"")+">"+d+"</option>";e.yearshtml+="</select>",b+=e.yearshtml,e.yearshtml=null}}return b+=this._get(e,"yearSuffix"),y&&(b+=(s||!m||!g?"&#xa0;":"")+w),b+="</div>",b},_adjustInstDate:function(e,t,n){var r=e.drawYear+(n==="Y"?t:0),i=e.drawMonth+(n==="M"?t:0),s=Math.min(e.selectedDay,this._getDaysInMonth(r,i))+(n==="D"?t:0),o=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(r,i,s)));e.selectedDay=o.getDate(),e.drawMonth=e.selectedMonth=o.getMonth(),e.drawYear=e.selectedYear=o.getFullYear(),(n==="M"||n==="Y")&&this._notifyChange(e)},_restrictMinMax:function(e,t){var n=this._getMinMaxDate(e,"min"),r=this._getMinMaxDate(e,"max"),i=n&&t<n?n:t;return r&&i>r?r:i},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return t==null?[1,1]:typeof t=="number"?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return(new Date(e,t,1)).getDay()},_canAdjustMonth:function(e,t,n,r){var i=this._getNumberOfMonths(e),s=this._daylightSavingAdjust(new Date(n,r+(t<0?t:i[0]*i[1]),1));return t<0&&s.setDate(this._getDaysInMonth(s.getFullYear(),s.getMonth())),this._isInRange(e,s)},_isInRange:function(e,t){var n,r,i=this._getMinMaxDate(e,"min"),s=this._getMinMaxDate(e,"max"),o=null,u=null,a=this._get(e,"yearRange");return a&&(n=a.split(":"),r=(new Date).getFullYear(),o=parseInt(n[0],10),u=parseInt(n[1],10),n[0].match(/[+\-].*/)&&(o+=r),n[1].match(/[+\-].*/)&&(u+=r)),(!i||t.getTime()>=i.getTime())&&(!s||t.getTime()<=s.getTime())&&(!o||t.getFullYear()>=o)&&(!u||t.getFullYear()<=u)},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return t=typeof t!="string"?t:(new Date).getFullYear()%100+parseInt(t,10),{shortYearCutoff:t,dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,n,r){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);var i=t?typeof t=="object"?t:this._daylightSavingAdjust(new Date(r,n,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),i,this._getFormatConfig(e))}}),e.fn.datepicker=function(t){if(!this.length)return this;e.datepicker.initialized||(e(document).mousedown(e.datepicker._checkExternalClick),e.datepicker.initialized=!0),e("#"+e.datepicker._mainDivId).length===0&&e("body").append(e.datepicker.dpDiv);var n=Array.prototype.slice.call(arguments,1);return typeof t!="string"||t!=="isDisabled"&&t!=="getDate"&&t!=="widget"?t==="option"&&arguments.length===2&&typeof arguments[1]=="string"?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(n)):this.each(function(){typeof t=="string"?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this].concat(n)):e.datepicker._attachDatepicker(this,t)}):e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(n))},e.datepicker=new v,e.datepicker.initialized=!1,e.datepicker.uuid=(new Date).getTime(),e.datepicker.version="1.11.0";var y=e.datepicker,b="ui-effects-";e.effects={effect:{}},function(t,n){function p(e,t,n){var r=a[t.type]||{};return e==null?n||!t.def?null:t.def:(e=r.floor?~~e:parseFloat(e),isNaN(e)?t.def:r.mod?(e+r.mod)%r.mod:0>e?0:r.max<e?r.max:e)}function d(t){var n=o(),r=n._rgba=[];return t=t.toLowerCase(),h(s,function(e,i){var s,o=i.re.exec(t),a=o&&i.parse(o),f=i.space||"rgba";if(a)return s=n[f](a),n[u[f].cache]=s[u[f].cache],r=n._rgba=s._rgba,!1}),r.length?(r.join()==="0,0,0,0"&&e.extend(r,c.transparent),n):c[t]}function v(e,t,n){return n=(n+1)%1,n*6<1?e+(t-e)*n*6:n*2<1?t:n*3<2?e+(t-e)*(2/3-n)*6:e}var r="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",i=/^([\-+])=\s*(\d+\.?\d*)/,s=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1]*2.55,e[2]*2.55,e[3]*2.55,e[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],o=e.Color=function(t,n,r,i){return new e.Color.fn.parse(t,n,r,i)},u={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},a={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},f=o.support={},l=e("<p>")[0],c,h=e.each;l.style.cssText="background-color:rgba(1,1,1,.5)",f.rgba=l.style.backgroundColor.indexOf("rgba")>-1,h(u,function(e,t){t.cache="_"+e,t.props.alpha={idx:3,type:"percent",def:1}}),o.fn=e.extend(o.prototype,{parse:function(t,r,i,s){if(t===n)return this._rgba=[null,null,null,null],this;if(t.jquery||t.nodeType)t=e(t).css(r),r=n;var a=this,f=e.type(t),l=this._rgba=[];r!==n&&(t=[t,r,i,s],f="array");if(f==="string")return this.parse(d(t)||c._default);if(f==="array")return h(u.rgba.props,function(e,n){l[n.idx]=p(t[n.idx],n)}),this;if(f==="object")return t instanceof o?h(u,function(e,n){t[n.cache]&&(a[n.cache]=t[n.cache].slice())}):h(u,function(n,r){var i=r.cache;h(r.props,function(e,n){if(!a[i]&&r.to){if(e==="alpha"||t[e]==null)return;a[i]=r.to(a._rgba)}a[i][n.idx]=p(t[e],n,!0)}),a[i]&&e.inArray(null,a[i].slice(0,3))<0&&(a[i][3]=1,r.from&&(a._rgba=r.from(a[i])))}),this},is:function(e){var t=o(e),n=!0,r=this;return h(u,function(e,i){var s,o=t[i.cache];return o&&(s=r[i.cache]||i.to&&i.to(r._rgba)||[],h(i.props,function(e,t){if(o[t.idx]!=null)return n=o[t.idx]===s[t.idx],n})),n}),n},_space:function(){var e=[],t=this;return h(u,function(n,r){t[r.cache]&&e.push(n)}),e.pop()},transition:function(e,t){var n=o(e),r=n._space(),i=u[r],s=this.alpha()===0?o("transparent"):this,f=s[i.cache]||i.to(s._rgba),l=f.slice();return n=n[i.cache],h(i.props,function(e,r){var i=r.idx,s=f[i],o=n[i],u=a[r.type]||{};if(o===null)return;s===null?l[i]=o:(u.mod&&(o-s>u.mod/2?s+=u.mod:s-o>u.mod/2&&(s-=u.mod)),l[i]=p((o-s)*t+s,r))}),this[r](l)},blend:function(t){if(this._rgba[3]===1)return this;var n=this._rgba.slice(),r=n.pop(),i=o(t)._rgba;return o(e.map(n,function(e,t){return(1-r)*i[t]+r*e}))},toRgbaString:function(){var t="rgba(",n=e.map(this._rgba,function(e,t){return e==null?t>2?1:0:e});return n[3]===1&&(n.pop(),t="rgb("),t+n.join()+")"},toHslaString:function(){var t="hsla(",n=e.map(this.hsla(),function(e,t){return e==null&&(e=t>2?1:0),t&&t<3&&(e=Math.round(e*100)+"%"),e});return n[3]===1&&(n.pop(),t="hsl("),t+n.join()+")"},toHexString:function(t){var n=this._rgba.slice(),r=n.pop();return t&&n.push(~~(r*255)),"#"+e.map(n,function(e){return e=(e||0).toString(16),e.length===1?"0"+e:e}).join("")},toString:function(){return this._rgba[3]===0?"transparent":this.toRgbaString()}}),o.fn.parse.prototype=o.fn,u.hsla.to=function(e){if(e[0]==null||e[1]==null||e[2]==null)return[null,null,null,e[3]];var t=e[0]/255,n=e[1]/255,r=e[2]/255,i=e[3],s=Math.max(t,n,r),o=Math.min(t,n,r),u=s-o,a=s+o,f=a*.5,l,c;return o===s?l=0:t===s?l=60*(n-r)/u+360:n===s?l=60*(r-t)/u+120:l=60*(t-n)/u+240,u===0?c=0:f<=.5?c=u/a:c=u/(2-a),[Math.round(l)%360,c,f,i==null?1:i]},u.hsla.from=function(e){if(e[0]==null||e[1]==null||e[2]==null)return[null,null,null,e[3]];var t=e[0]/360,n=e[1],r=e[2],i=e[3],s=r<=.5?r*(1+n):r+n-r*n,o=2*r-s;return[Math.round(v(o,s,t+1/3)*255),Math.round(v(o,s,t)*255),Math.round(v(o,s,t-1/3)*255),i]},h(u,function(t,r){var s=r.props,u=r.cache,a=r.to,f=r.from;o.fn[t]=function(t){a&&!this[u]&&(this[u]=a(this._rgba));if(t===n)return this[u].slice();var r,i=e.type(t),l=i==="array"||i==="object"?t:arguments,c=this[u].slice();return h(s,function(e,t){var n=l[i==="object"?e:t.idx];n==null&&(n=c[t.idx]),c[t.idx]=p(n,t)}),f?(r=o(f(c)),r[u]=c,r):o(c)},h(s,function(n,r){if(o.fn[n])return;o.fn[n]=function(s){var o=e.type(s),u=n==="alpha"?this._hsla?"hsla":"rgba":t,a=this[u](),f=a[r.idx],l;return o==="undefined"?f:(o==="function"&&(s=s.call(this,f),o=e.type(s)),s==null&&r.empty?this:(o==="string"&&(l=i.exec(s),l&&(s=f+parseFloat(l[2])*(l[1]==="+"?1:-1))),a[r.idx]=s,this[u](a)))}})}),o.hook=function(t){var n=t.split(" ");h(n,function(t,n){e.cssHooks[n]={set:function(t,r){var i,s,u="";if(r!=="transparent"&&(e.type(r)!=="string"||(i=d(r)))){r=o(i||r);if(!f.rgba&&r._rgba[3]!==1){s=n==="backgroundColor"?t.parentNode:t;while((u===""||u==="transparent")&&s&&s.style)try{u=e.css(s,"backgroundColor"),s=s.parentNode}catch(a){}r=r.blend(u&&u!=="transparent"?u:"_default")}r=r.toRgbaString()}try{t.style[n]=r}catch(a){}}},e.fx.step[n]=function(t){t.colorInit||(t.start=o(t.elem,n),t.end=o(t.end),t.colorInit=!0),e.cssHooks[n].set(t.elem,t.start.transition(t.end,t.pos))}})},o.hook(r),e.cssHooks.borderColor={expand:function(e){var t={};return h(["Top","Right","Bottom","Left"],function(n,r){t["border"+r+"Color"]=e}),t}},c=e.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),function(){function r(t){var n,r,i=t.ownerDocument.defaultView?t.ownerDocument.defaultView.getComputedStyle(t,null):t.currentStyle,s={};if(i&&i.length&&i[0]&&i[i[0]]){r=i.length;while(r--)n=i[r],typeof i[n]=="string"&&(s[e.camelCase(n)]=i[n])}else for(n in i)typeof i[n]=="string"&&(s[n]=i[n]);return s}function i(t,r){var i={},s,o;for(s in r)o=r[s],t[s]!==o&&!n[s]&&(e.fx.step[s]||!isNaN(parseFloat(o)))&&(i[s]=o);return i}var t=["add","remove","toggle"],n={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};e.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(t,n){e.fx.step[n]=function(t){if(t.end!=="none"&&!t.setAttr||t.pos===1&&!t.setAttr)e.style(t.elem,n,t.end),t.setAttr=!0}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}),e.effects.animateClass=function(n,s,o,u){var a=e.speed(s,o,u);return this.queue(function(){var s=e(this),o=s.attr("class")||"",u,f=a.children?s.find("*").addBack():s;f=f.map(function(){var t=e(this);return{el:t,start:r(this)}}),u=function(){e.each(t,function(e,t){n[t]&&s[t+"Class"](n[t])})},u(),f=f.map(function(){return this.end=r(this.el[0]),this.diff=i(this.start,this.end),this}),s.attr("class",o),f=f.map(function(){var t=this,n=e.Deferred(),r=e.extend({},a,{queue:!1,complete:function(){n.resolve(t)}});return this.el.animate(this.diff,r),n.promise()}),e.when.apply(e,f.get()).done(function(){u(),e.each(arguments,function(){var t=this.el;e.each(this.diff,function(e){t.css(e,"")})}),a.complete.call(s[0])})})},e.fn.extend({addClass:function(t){return function(n,r,i,s){return r?e.effects.animateClass.call(this,{add:n},r,i,s):t.apply(this,arguments)}}(e.fn.addClass),removeClass:function(t){return function(n,r,i,s){return arguments.length>1?e.effects.animateClass.call(this,{remove:n},r,i,s):t.apply(this,arguments)}}(e.fn.removeClass),toggleClass:function(t){return function(n,r,i,s,o){return typeof r=="boolean"||r===undefined?i?e.effects.animateClass.call(this,r?{add:n}:{remove:n},i,s,o):t.apply(this,arguments):e.effects.animateClass.call(this,{toggle:n},r,i,s)}}(e.fn.toggleClass),switchClass:function(t,n,r,i,s){return e.effects.animateClass.call(this,{add:n,remove:t},r,i,s)}})}(),function(){function t(t,n,r,i){e.isPlainObject(t)&&(n=t,t=t.effect),t={effect:t},n==null&&(n={}),e.isFunction(n)&&(i=n,r=null,n={});if(typeof n=="number"||e.fx.speeds[n])i=r,r=n,n={};return e.isFunction(r)&&(i=r,r=null),n&&e.extend(t,n),r=r||n.duration,t.duration=e.fx.off?0:typeof r=="number"?r:r in e.fx.speeds?e.fx.speeds[r]:e.fx.speeds._default,t.complete=i||n.complete,t}function n(t){return!t||typeof t=="number"||e.fx.speeds[t]?!0:typeof t=="string"&&!e.effects.effect[t]?!0:e.isFunction(t)?!0:typeof t=="object"&&!t.effect?!0:!1}e.extend(e.effects,{version:"1.11.0",save:function(e,t){for(var n=0;n<t.length;n++)t[n]!==null&&e.data(b+t[n],e[0].style[t[n]])},restore:function(e,t){var n,r;for(r=0;r<t.length;r++)t[r]!==null&&(n=e.data(b+t[r]),n===undefined&&(n=""),e.css(t[r],n))},setMode:function(e,t){return t==="toggle"&&(t=e.is(":hidden")?"show":"hide"),t},getBaseline:function(e,t){var n,r;switch(e[0]){case"top":n=0;break;case"middle":n=.5;break;case"bottom":n=1;break;default:n=e[0]/t.height}switch(e[1]){case"left":r=0;break;case"center":r=.5;break;case"right":r=1;break;default:r=e[1]/t.width}return{x:r,y:n}},createWrapper:function(t){if(t.parent().is(".ui-effects-wrapper"))return t.parent();var n={width:t.outerWidth(!0),height:t.outerHeight(!0),"float":t.css("float")},r=e("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),i={width:t.width(),height:t.height()},s=document.activeElement;try{s.id}catch(o){s=document.body}return t.wrap(r),(t[0]===s||e.contains(t[0],s))&&e(s).focus(),r=t.parent(),t.css("position")==="static"?(r.css({position:"relative"}),t.css({position:"relative"})):(e.extend(n,{position:t.css("position"),zIndex:t.css("z-index")}),e.each(["top","left","bottom","right"],function(e,r){n[r]=t.css(r),isNaN(parseInt(n[r],10))&&(n[r]="auto")}),t.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),t.css(i),r.css(n).show()},removeWrapper:function(t){var n=document.activeElement;return t.parent().is(".ui-effects-wrapper")&&(t.parent().replaceWith(t),(t[0]===n||e.contains(t[0],n))&&e(n).focus()),t},setTransition:function(t,n,r,i){return i=i||{},e.each(n,function(e,n){var s=t.cssUnit(n);s[0]>0&&(i[n]=s[0]*r+s[1])}),i}}),e.fn.extend({effect:function(){function o(t){function u(){e.isFunction(i)&&i.call(r[0]),e.isFunction(t)&&t()}var r=e(this),i=n.complete,o=n.mode;(r.is(":hidden")?o==="hide":o==="show")?(r[o](),u()):s.call(r[0],n,u)}var n=t.apply(this,arguments),r=n.mode,i=n.queue,s=e.effects.effect[n.effect];return e.fx.off||!s?r?this[r](n.duration,n.complete):this.each(function(){n.complete&&n.complete.call(this)}):i===!1?this.each(o):this.queue(i||"fx",o)},show:function(e){return function(r){if(n(r))return e.apply(this,arguments);var i=t.apply(this,arguments);return i.mode="show",this.effect.call(this,i)}}(e.fn.show),hide:function(e){return function(r){if(n(r))return e.apply(this,arguments);var i=t.apply(this,arguments);return i.mode="hide",this.effect.call(this,i)}}(e.fn.hide),toggle:function(e){return function(r){if(n(r)||typeof r=="boolean")return e.apply(this,arguments);var i=t.apply(this,arguments);return i.mode="toggle",this.effect.call(this,i)}}(e.fn.toggle),cssUnit:function(t){var n=this.css(t),r=[];return e.each(["em","px","%","pt"],function(e,t){n.indexOf(t)>0&&(r=[parseFloat(n),t])}),r}})}(),function(){var t={};e.each(["Quad","Cubic","Quart","Quint","Expo"],function(e,n){t[n]=function(t){return Math.pow(t,e+2)}}),e.extend(t,{Sine:function(e){return 1-Math.cos(e*Math.PI/2)},Circ:function(e){return 1-Math.sqrt(1-e*e)},Elastic:function(e){return e===0||e===1?e:-Math.pow(2,8*(e-1))*Math.sin(((e-1)*80-7.5)*Math.PI/15)},Back:function(e){return e*e*(3*e-2)},Bounce:function(e){var t,n=4;while(e<((t=Math.pow(2,--n))-1)/11);return 1/Math.pow(4,3-n)-7.5625*Math.pow((t*3-2)/22-e,2)}}),e.each(t,function(t,n){e.easing["easeIn"+t]=n,e.easing["easeOut"+t]=function(e){return 1-n(1-e)},e.easing["easeInOut"+t]=function(e){return e<.5?n(e*2)/2:1-n(e*-2+2)/2}})}();var w=e.effects,E=e.effects.effect.blind=function(t,n){var r=e(this),i=/up|down|vertical/,s=/up|left|vertical|horizontal/,o=["position","top","bottom","left","right","height","width"],u=e.effects.setMode(r,t.mode||"hide"),a=t.direction||"up",f=i.test(a),l=f?"height":"width",c=f?"top":"left",h=s.test(a),p={},d=u==="show",v,m,g;r.parent().is(".ui-effects-wrapper")?e.effects.save(r.parent(),o):e.effects.save(r,o),r.show(),v=e.effects.createWrapper(r).css({overflow:"hidden"}),m=v[l](),g=parseFloat(v.css(c))||0,p[l]=d?m:0,h||(r.css(f?"bottom":"right",0).css(f?"top":"left","auto").css({position:"absolute"}),p[c]=d?g:m+g),d&&(v.css(l,0),h||v.css(c,g+m)),v.animate(p,{duration:t.duration,easing:t.easing,queue:!1,complete:function(){u==="hide"&&r.hide(),e.effects.restore(r,o),e.effects.removeWrapper(r),n()}})},S=e.effects.effect.bounce=function(t,n){var r=e(this),i=["position","top","bottom","left","right","height","width"],s=e.effects.setMode(r,t.mode||"effect"),o=s==="hide",u=s==="show",a=t.direction||"up",f=t.distance,l=t.times||5,c=l*2+(u||o?1:0),h=t.duration/c,p=t.easing,d=a==="up"||a==="down"?"top":"left",v=a==="up"||a==="left",m,g,y,b=r.queue(),w=b.length;(u||o)&&i.push("opacity"),e.effects.save(r,i),r.show(),e.effects.createWrapper(r),f||(f=r[d==="top"?"outerHeight":"outerWidth"]()/3),u&&(y={opacity:1},y[d]=0,r.css("opacity",0).css(d,v?-f*2:f*2).animate(y,h,p)),o&&(f/=Math.pow(2,l-1)),y={},y[d]=0;for(m=0;m<l;m++)g={},g[d]=(v?"-=":"+=")+f,r.animate(g,h,p).animate(y,h,p),f=o?f*2:f/2;o&&(g={opacity:0},g[d]=(v?"-=":"+=")+f,r.animate(g,h,p)),r.queue(function(){o&&r.hide(),e.effects.restore(r,i),e.effects.removeWrapper(r),n()}),w>1&&b.splice.apply(b,[1,0].concat(b.splice(w,c+1))),r.dequeue()},x=e.effects.effect.clip=function(t,n){var r=e(this),i=["position","top","bottom","left","right","height","width"],s=e.effects.setMode(r,t.mode||"hide"),o=s==="show",u=t.direction||"vertical",a=u==="vertical",f=a?"height":"width",l=a?"top":"left",c={},h,p,d;e.effects.save(r,i),r.show(),h=e.effects.createWrapper(r).css({overflow:"hidden"}),p=r[0].tagName==="IMG"?h:r,d=p[f](),o&&(p.css(f,0),p.css(l,d/2)),c[f]=o?d:0,c[l]=o?0:d/2,p.animate(c,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){o||r.hide(),e.effects.restore(r,i),e.effects.removeWrapper(r),n()}})},T=e.effects.effect.drop=function(t,n){var r=e(this),i=["position","top","bottom","left","right","opacity","height","width"],s=e.effects.setMode(r,t.mode||"hide"),o=s==="show",u=t.direction||"left",a=u==="up"||u==="down"?"top":"left",f=u==="up"||u==="left"?"pos":"neg",l={opacity:o?1:0},c;e.effects.save(r,i),r.show(),e.effects.createWrapper(r),c=t.distance||r[a==="top"?"outerHeight":"outerWidth"](!0)/2,o&&r.css("opacity",0).css(a,f==="pos"?-c:c),l[a]=(o?f==="pos"?"+=":"-=":f==="pos"?"-=":"+=")+c,r.animate(l,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){s==="hide"&&r.hide(),e.effects.restore(r,i),e.effects.removeWrapper(r),n()}})},N=e.effects.effect.explode=function(t,n){function y(){c.push(this),c.length===r*i&&b()}function b(){s.css({visibility:"visible"}),e(c).remove(),u||s.hide(),n()}var r=t.pieces?Math.round(Math.sqrt(t.pieces)):3,i=r,s=e(this),o=e.effects.setMode(s,t.mode||"hide"),u=o==="show",a=s.show().css("visibility","hidden").offset(),f=Math.ceil(s.outerWidth()/i),l=Math.ceil(s.outerHeight()/r),c=[],h,p,d,v,m,g;for(h=0;h<r;h++){v=a.top+h*l,g=h-(r-1)/2;for(p=0;p<i;p++)d=a.left+p*f,m=p-(i-1)/2,s.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-p*f,top:-h*l}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:f,height:l,left:d+(u?m*f:0),top:v+(u?g*l:0),opacity:u?0:1}).animate({left:d+(u?0:m*f),top:v+(u?0:g*l),opacity:u?1:0},t.duration||500,t.easing,y)}},C=e.effects.effect.fade=function(t,n){var r=e(this),i=e.effects.setMode(r,t.mode||"toggle");r.animate({opacity:i},{queue:!1,duration:t.duration,easing:t.easing,complete:n})},k=e.effects.effect.fold=function(t,n){var r=e(this),i=["position","top","bottom","left","right","height","width"],s=e.effects.setMode(r,t.mode||"hide"),o=s==="show",u=s==="hide",a=t.size||15,f=/([0-9]+)%/.exec(a),l=!!t.horizFirst,c=o!==l,h=c?["width","height"]:["height","width"],p=t.duration/2,d,v,m={},g={};e.effects.save(r,i),r.show(),d=e.effects.createWrapper(r).css({overflow:"hidden"}),v=c?[d.width(),d.height()]:[d.height(),d.width()],f&&(a=parseInt(f[1],10)/100*v[u?0:1]),o&&d.css(l?{height:0,width:a}:{height:a,width:0}),m[h[0]]=o?v[0]:a,g[h[1]]=o?v[1]:0,d.animate(m,p,t.easing).animate(g,p,t.easing,function(){u&&r.hide(),e.effects.restore(r,i),e.effects.removeWrapper(r),n()})},L=e.effects.effect.highlight=function(t,n){var r=e(this),i=["backgroundImage","backgroundColor","opacity"],s=e.effects.setMode(r,t.mode||"show"),o={backgroundColor:r.css("backgroundColor")};s==="hide"&&(o.opacity=0),e.effects.save(r,i),r.show().css({backgroundImage:"none",backgroundColor:t.color||"#ffff99"}).animate(o,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){s==="hide"&&r.hide(),e.effects.restore(r,i),n()}})},A=e.effects.effect.size=function(t,n){var r,i,s,o=e(this),u=["position","top","bottom","left","right","width","height","overflow","opacity"],a=["position","top","bottom","left","right","overflow","opacity"],f=["width","height","overflow"],l=["fontSize"],c=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],h=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],p=e.effects.setMode(o,t.mode||"effect"),d=t.restore||p!=="effect",v=t.scale||"both",m=t.origin||["middle","center"],g=o.css("position"),y=d?u:a,b={height:0,width:0,outerHeight:0,outerWidth:0};p==="show"&&o.show(),r={height:o.height(),width:o.width(),outerHeight:o.outerHeight(),outerWidth:o.outerWidth()},t.mode==="toggle"&&p==="show"?(o.from=t.to||b,o.to=t.from||r):(o.from=t.from||(p==="show"?b:r),o.to=t.to||(p==="hide"?b:r)),s={from:{y:o.from.height/r.height,x:o.from.width/r.width},to:{y:o.to.height/r.height,x:o.to.width/r.width}};if(v==="box"||v==="both")s.from.y!==s.to.y&&(y=y.concat(c),o.from=e.effects.setTransition(o,c,s.from.y,o.from),o.to=e.effects.setTransition(o,c,s.to.y,o.to)),s.from.x!==s.to.x&&(y=y.concat(h),o.from=e.effects.setTransition(o,h,s.from.x,o.from),o.to=e.effects.setTransition(o,h,s.to.x,o.to));(v==="content"||v==="both")&&s.from.y!==s.to.y&&(y=y.concat(l).concat(f),o.from=e.effects.setTransition(o,l,s.from.y,o.from),o.to=e.effects.setTransition(o,l,s.to.y,o.to)),e.effects.save(o,y),o.show(),e.effects.createWrapper(o),o.css("overflow","hidden").css(o.from),m&&(i=e.effects.getBaseline(m,r),o.from.top=(r.outerHeight-o.outerHeight())*i.y,o.from.left=(r.outerWidth-o.outerWidth())*i.x,o.to.top=(r.outerHeight-o.to.outerHeight)*i.y,o.to.left=(r.outerWidth-o.to.outerWidth)*i.x),o.css(o.from);if(v==="content"||v==="both")c=c.concat(["marginTop","marginBottom"]).concat(l),h=h.concat(["marginLeft","marginRight"]),f=u.concat(c).concat(h),o.find("*[width]").each(function(){var n=e(this),r={height:n.height(),width:n.width(),outerHeight:n.outerHeight(),outerWidth:n.outerWidth()};d&&e.effects.save(n,f),n.from={height:r.height*s.from.y,width:r.width*s.from.x,outerHeight:r.outerHeight*s.from.y,outerWidth:r.outerWidth*s.from.x},n.to={height:r.height*s.to.y,width:r.width*s.to.x,outerHeight:r.height*s.to.y,outerWidth:r.width*s.to.x},s.from.y!==s.to.y&&(n.from=e.effects.setTransition(n,c,s.from.y,n.from),n.to=e.effects.setTransition(n,c,s.to.y,n.to)),s.from.x!==s.to.x&&(n.from=e.effects.setTransition(n,h,s.from.x,n.from),n.to=e.effects.setTransition(n,h,s.to.x,n.to)),n.css(n.from),n.animate(n.to,t.duration,t.easing,function(){d&&e.effects.restore(n,f)})});o.animate(o.to,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){o.to.opacity===0&&o.css("opacity",o.from.opacity),p==="hide"&&o.hide(),e.effects.restore(o,y),d||(g==="static"?o.css({position:"relative",top:o.to.top,left:o.to.left}):e.each(["top","left"],function(e,t){o.css(t,function(t,n){var r=parseInt(n,10),i=e?o.to.left:o.to.top;return n==="auto"?i+"px":r+i+"px"})})),e.effects.removeWrapper(o),n()}})},O=e.effects.effect.scale=function(t,n){var r=e(this),i=e.extend(!0,{},t),s=e.effects.setMode(r,t.mode||"effect"),o=parseInt(t.percent,10)||(parseInt(t.percent,10)===0?0:s==="hide"?0:100),u=t.direction||"both",a=t.origin,f={height:r.height(),width:r.width(),outerHeight:r.outerHeight(),outerWidth:r.outerWidth()},l={y:u!=="horizontal"?o/100:1,x:u!=="vertical"?o/100:1};i.effect="size",i.queue=!1,i.complete=n,s!=="effect"&&(i.origin=a||["middle","center"],i.restore=!0),i.from=t.from||(s==="show"?{height:0,width:0,outerHeight:0,outerWidth:0}:f),i.to={height:f.height*l.y,width:f.width*l.x,outerHeight:f.outerHeight*l.y,outerWidth:f.outerWidth*l.x},i.fade&&(s==="show"&&(i.from.opacity=0,i.to.opacity=1),s==="hide"&&(i.from.opacity=1,i.to.opacity=0)),r.effect(i)},M=e.effects.effect.puff=function(t,n){var r=e(this),i=e.effects.setMode(r,t.mode||"hide"),s=i==="hide",o=parseInt(t.percent,10)||150,u=o/100,a={height:r.height(),width:r.width(),outerHeight:r.outerHeight(),outerWidth:r.outerWidth()};e.extend(t,{effect:"scale",queue:!1,fade:!0,mode:i,complete:n,percent:s?o:100,from:s?a:{height:a.height*u,width:a.width*u,outerHeight:a.outerHeight*u,outerWidth:a.outerWidth*u}}),r.effect(t)},_=e.effects.effect.pulsate=function(t,n){var r=e(this),i=e.effects.setMode(r,t.mode||"show"),s=i==="show",o=i==="hide",u=s||i==="hide",a=(t.times||5)*2+(u?1:0),f=t.duration/a,l=0,c=r.queue(),h=c.length,p;if(s||!r.is(":visible"))r.css("opacity",0).show(),l=1;for(p=1;p<a;p++)r.animate({opacity:l},f,t.easing),l=1-l;r.animate({opacity:l},f,t.easing),r.queue(function(){o&&r.hide(),n()}),h>1&&c.splice.apply(c,[1,0].concat(c.splice(h,a+1))),r.dequeue()},D=e.effects.effect.shake=function(t,n){var r=e(this),i=["position","top","bottom","left","right","height","width"],s=e.effects.setMode(r,t.mode||"effect"),o=t.direction||"left",u=t.distance||20,a=t.times||3,f=a*2+1,l=Math.round(t.duration/f),c=o==="up"||o==="down"?"top":"left",h=o==="up"||o==="left",p={},d={},v={},m,g=r.queue(),y=g.length;e.effects.save(r,i),r.show(),e.effects.createWrapper(r),p[c]=(h?"-=":"+=")+u,d[c]=(h?"+=":"-=")+u*2,v[c]=(h?"-=":"+=")+u*2,r.animate(p,l,t.easing);for(m=1;m<a;m++)r.animate(d,l,t.easing).animate(v,l,t.easing);r.animate(d,l,t.easing).animate(p,l/2,t.easing).queue(function(){s==="hide"&&r.hide(),e.effects.restore(r,i),e.effects.removeWrapper(r),n()}),y>1&&g.splice.apply(g,[1,0].concat(g.splice(y,f+1))),r.dequeue()},P=e.effects.effect.slide=function(t,n){var r=e(this),i=["position","top","bottom","left","right","width","height"],s=e.effects.setMode(r,t.mode||"show"),o=s==="show",u=t.direction||"left",a=u==="up"||u==="down"?"top":"left",f=u==="up"||u==="left",l,c={};e.effects.save(r,i),r.show(),l=t.distance||r[a==="top"?"outerHeight":"outerWidth"](!0),e.effects.createWrapper(r).css({overflow:"hidden"}),o&&r.css(a,f?isNaN(l)?"-"+l:-l:l),c[a]=(o?f?"+=":"-=":f?"-=":"+=")+l,r.animate(c,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){s==="hide"&&r.hide(),e.effects.restore(r,i),e.effects.removeWrapper(r),n()}})},H=e.effects.effect.transfer=function(t,n){var r=e(this),i=e(t.to),s=i.css("position")==="fixed",o=e("body"),u=s?o.scrollTop():0,a=s?o.scrollLeft():0,f=i.offset(),l={top:f.top-u,left:f.left-a,height:i.innerHeight(),width:i.innerWidth()},c=r.offset(),h=e("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(t.className).css({top:c.top-u,left:c.left-a,height:r.innerHeight(),width:r.innerWidth(),position:s?"fixed":"absolute"}).animate(l,t.duration,t.easing,function(){h.remove(),n()})}}),tadpoles.define("services/datePicker",["require","ko","jquery","lodash","jqueryui"],function(e){var t=e("ko"),n=e("jquery"),r=e("lodash");return e("jqueryui"),t.bindingHandlers.datepicker={setDates:function(e,t){var r=n(e).data("dpOptions");if(!t){r.startDate=null,r.endDate=null;return}r.startDate=new Date(t.getFullYear(),t.getMonth(),t.getDate()-t.getDay()),r.endDate=new Date(t.getFullYear(),t.getMonth(),t.getDate()-t.getDay()+6)},init:function(e,i,s){function u(){var t=n(e).datepicker("getDate");o.onChange?o.onChange(t):l(t)}function a(){var t=n(e).data("dpOptions");return t&&t.selectWeek}var o=s().datepickerOptions||{};n(e).data("dpOptions",{selectWeek:o.selectWeek,startDate:null,endDate:null});var f=function(){r.defer(function(){n(".ui-weekpicker").find(".ui-datepicker-current-day a").addClass("ui-state-active").removeClass("ui-state-default")})};o.onSelect=function(r,i){var s=n(this).datepicker("getDate");t.bindingHandlers.datepicker.setDates(e,s);if(a()){var o=n(e).data("dpOptions"),l=o?o.startDate:null;s-l!=0&&(n(this).datepicker("setDate",l),n(e).blur()),f()}u()},o.beforeShowDay=function(t){if(!a())return[!0,""];var r="",i=n(e).data("dpOptions"),s=i?i.startDate:null,o=i?i.endDate:null;return t>=s&&t<=o&&(r="ui-datepicker-current-day"),[!0,r]},o.beforeShow=function(e,t){if(!a())return;t.dpDiv.on("mouseover.weekPicker",".ui-datepicker-calendar tr",function(){var e=n(this);r.defer(function(){e.find("td a").addClass("ui-state-hover")})}),t.dpDiv.on("mouseleave.weekPicker",".ui-datepicker-calendar tr",function(){var e=n(this);r.defer(function(){e.find("td a").removeClass("ui-state-hover")})}),t.dpDiv.addClass("ui-weekpicker"),f()},o.onClose=function(e,t){t.dpDiv.off(".weekPicker")},o.onChangeMonthYear=function(e,t,n){a()&&f()},n(e).datepicker(o);var l=i();t.utils.registerEventHandler(e,"change",function(){u()}),t.utils.domNodeDisposal.addDisposeCallback(e,function(){n(e).datepicker("destroy")})},update:function(e,r,i){var s=t.utils.unwrapObservable(r()),o=n(e).datepicker("getDate"),u=i().datepickerOptions||{},a=n(e).data("dpOptions");a.selectWeek=u.selectWeek,s-o!==0&&(n(e).datepicker("setDate",s),t.bindingHandlers.datepicker.setDates(e,s))}},{}}),tadpoles.define("services/alerts",["require","ko","lodash","services/modal"],function(e){var t=e("ko"),n=e("lodash"),r=e("services/modal"),i=function(){return!0},s=r.extend({className:"Alerts",initialize:function(e){var n=this;r.initialize.call(n,e),n.type=t.observable("ok"),n.title=t.observable("alert"),n.message=t.observable("message"),n.alertStyle=t.observable("error"),n.buttonStyle=t.observable("danger"),n.templateName=t.observable(),n.templateData=t.observable(),n.errors=t.observableArray([]),n.success=i,n.cancel=i,n.okDisplay=t.computed(function(){return n.type()==="yesno"?"yes":n.type()==="retry"?"retry":"ok"}),n.cancelDisplay=t.computed(function(){return n.type()==="yesno"?"no":n.type()==="retry"?"cancel":"approve"})},show:function(e){e=e||{},n.defaults(e,{style:"error",success:i,cancel:i,type:"ok",templateName:null,templateData:null,errors:[]}),this.type(e.type),this.title(e.title),this.message(e.message),this.errors(e.errors),this.templateName(e.templateName),this.templateData(e.templateData),e.style==="error"?(this.alertStyle("error"),this.buttonStyle("danger")):e.style==="warning"?(this.alertStyle("warning"),this.buttonStyle("warning")):e.style==="info"?(this.alertStyle("info"),this.buttonStyle("info")):e.style==="success"&&(this.alertStyle("success"),this.buttonStyle("success")),this.success=e.success,this.cancel=e.cancel,this.open()},showAlert:function(e,t,n,r,i){this.show({title:e,message:t,style:n||"error",errors:r,width:i||""})},showYesNo:function(e){e=e||{},n.defaults(e,{title:"Confirm",message:"Are you sure you want to perform this actions?",style:"warning",type:"yesno",yes:i,no:i}),e.success=e.yes,e.cancel=e.no,this.show(e)},showRetry:function(e){e=e||{},e.message=e.message||"Something went wrong on our end, please try again",n.defaults(e,{title:"Oops!",style:"error",type:"retry",yes:i,no:i}),e.success=e.retry,e.cancel=e.cancel,this.show(e)},showApproveOk:function(e){e=e||{},n.defaults(e,{type:"approveok",approve:i,no:i}),e.no=e.approve,e.yes=e.ok,this.showYesNo(e)},close:function(e){e==="success"?this.success():e==="cancel"&&this.cancel(),r.close.call(this)}}),o=s.create({template:"view/modals/alertModal"});return o}),tadpoles.define("model/requestResults",["require","ko","selfish"],function(e){var t=e("ko"),n=e("selfish"),r=n.Base.extend({className:"RequestResults",initialize:function(){var e=this;e.errors=t.observableArray([])},clear:function(){this.errors([])}});return r}),tadpoles.define("services/profiler",["require","selfish","lodash"],function(e){var t=e("selfish"),n=e("lodash"),r=t.Base.extend({className:"Profiler",initialize:function(){var t=this;t.stats={}},statForId:function(e){var t=this.stats[e];return t||(t={lastIndex:-1,nextIndex:0,count:0,start:0,values:[]},this.stats[e]=t),t},start:function(e){this.statForId(e).start=(new Date).getTime()},stop:function(t){var n=this.stats[t];if(!n||!n.start)return;var r=(new Date).getTime()-n.start;n.nextIndex===n.length?n.values.push(r):n.values[n.nextIndex]=r,n.lastIndex=n.nextIndex,n.nextIndex++,n.nextIndex===10&&(n.nextIndex=0),n.count++},count:function(e){this.statForId(e).count++},reset:function(){this.stats={}},getStats:function(){return n.map(this.stats,function(e,t){var r=e.values.length>0?Math.floor(n.reduce(e.values,function(e,t){return e+t})/e.values.length):0;return t+": count "+e.count+" last +"+(e.lastIndex>=0&&e.lastIndex<e.values.length?e.values[e.lastIndex]:"n/a")+" avg +"+r})},print:function(){n.each(this.getStats(),function(e){console.log(e)})}});return r}),tadpoles.define("services/profilers",["require","selfish","services/profiler","lodash"],function(e){var t=e("selfish"),n=e("services/profiler"),r=e("lodash"),i=t.Base.extend({className:"Profiler",initialize:function(){var t=this;t.profilers={}},getProfiler:function(t){var r=this.profilers[t];return r||(r=n.create(),this.profilers[t]=r),r},print:function(){r.each(this.profilers,function(e,t){console.log(t+":"),r.each(e.getStats(),function(e){console.log("    "+e)})})},reset:function(){r.each(this.profilers,function(e){e.reset()})}});return i.create()}),tadpoles.define("services/uuid",["require"],function(e){function l(e,t,n){var r=t&&n||0,i=0;t=t||[],e.toLowerCase().replace(/[0-9a-f]{2}/g,function(e){i<16&&(t[r+i++]=a[e])});while(i<16)t[r+i++]=0;return t}function c(e,t){var n=t||0,r=u;return r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]}function g(e,t,n){var r=t&&n||0,i=t||[];e=e||{};var s=e.clockseq!=null?e.clockseq:d,o=e.msecs!=null?e.msecs:(new Date).getTime(),u=e.nsecs!=null?e.nsecs:m+1,a=o-v+(u-m)/1e4;a<0&&e.clockseq==null&&(s=s+1&16383),(a<0||o>v)&&e.nsecs==null&&(u=0);if(u>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");v=o,m=u,d=s,o+=122192928e5;var f=((o&268435455)*1e4+u)%4294967296;i[r++]=f>>>24&255,i[r++]=f>>>16&255,i[r++]=f>>>8&255,i[r++]=f&255;var l=o/4294967296*1e4&268435455;i[r++]=l>>>8&255,i[r++]=l&255,i[r++]=l>>>24&15|16,i[r++]=l>>>16&255,i[r++]=s>>>8|128,i[r++]=s&255;var h=e.node||p,g;for(g=0;g<6;g+=1)i[r+g]=h[g];return t||c(i)}function y(e,t,n){var r=t&&n||0;typeof e=="string"&&(t=e=="binary"?new o(16):null,e=null),e=e||{};var i=e.random||(e.rng||s)();i[6]=i[6]&15|64,i[8]=i[8]&63|128;if(t){var u;for(u=0;u<16;u+=1)t[r+u]=i[u]}return t||c(i)}function w(){return b.encodeByteArray(y("binary"),!0).slice(0,-2)}var t,n,r=new Array(16);t=function(){var e,t=r,n=0;for(n=0,e;n<16;n+=1)(n&3)==0&&(e=Math.random()*4294967296),t[n]=e>>>((n&3)<<3)&255;return t};if(window.crypto&&window.crypto.getRandomValues){var i=new Uint32Array(4);n=function(){crypto.getRandomValues(i);var e;for(e=0;e<16;e+=1)r[e]=i[e>>2]>>>(e&3)*8&255;return r}}var s=n||t,o=typeof Buffer=="function"?Buffer:Array,u=[],a={},f;for(f=0;f<256;f+=1)u[f]=(f+256).toString(16).substr(1),a[u[f]]=f;var h=s(),p=[h[0]|1,h[1],h[2],h[3],h[4],h[5]],d=(h[6]<<8|h[7])&16383,v=0,m=0,b={};b.byteToCharMap_=null,b.charToByteMap_=null,b.byteToCharMapWebSafe_=null,b.charToByteMapWebSafe_=null,b.ENCODED_VALS_BASE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",b.ENCODED_VALS=b.ENCODED_VALS_BASE+"+/=",b.ENCODED_VALS_WEBSAFE=b.ENCODED_VALS_BASE+"-_.",b.encodeByteArray=function(e,t){b.init_();var n=t?b.byteToCharMapWebSafe_:b.byteToCharMap_,r=[];for(var i=0;i<e.length;i+=3){var s=e[i],o=i+1<e.length,u=o?e[i+1]:0,a=i+2<e.length,f=a?e[i+2]:0,l=s>>2,c=(s&3)<<4|u>>4,h=(u&15)<<2|f>>6,p=f&63;a||(p=64,o||(h=64)),r.push(n[l],n[c],n[h],n[p])}return r.join("")},b.init_=function(){if(!b.byteToCharMap_){b.byteToCharMap_={},b.charToByteMap_={},b.byteToCharMapWebSafe_={},b.charToByteMapWebSafe_={};for(var e=0;e<b.ENCODED_VALS.length;e++)b.byteToCharMap_[e]=b.ENCODED_VALS.charAt(e),b.charToByteMap_[b.byteToCharMap_[e]]=e,b.byteToCharMapWebSafe_[e]=b.ENCODED_VALS_WEBSAFE.charAt(e),b.charToByteMapWebSafe_[b.byteToCharMapWebSafe_[e]]=e}};var E=y;return E.v1=g,E.v4=y,E.short=w,E.parse=l,E.unparse=c,E.BufferClass=o,E.mathRNG=t,E.whatwgRNG=n,E}),tadpoles.define("model/user",["require","lodash","selfish","services/config"],function(e){var t=e("lodash"),n=e("selfish"),r=e("services/config"),i={APP_ADMIN:"AppAdmin",ACCOUNT_ADMIN:"AccountAdmin",LOCATION_ADMIN:"LocationAdmin",REGIONAL_ADMIN:"RegionalAdmin",TEACHER:"Employee",GUARDIAN:"Guardian"},s=[i.ACCOUNT_ADMIN,i.LOCATION_ADMIN,i.TEACHER],o=n.Base.extend({className:"User",initialize:function(e,t){var n=this;n.user=t||{},n.person=e||{roles:[]}},isAdmin:function(){return t.intersection([i.APP_ADMIN,i.ACCOUNT_ADMIN,i.LOCATION_ADMIN,i.REGIONAL_ADMIN],this.person.roles).length>0},isAccountAdmin:function(){return t.contains(this.person.roles,i.ACCOUNT_ADMIN)||t.contains(this.person.roles,i.REGIONAL_ADMIN)},isCenterAdmin:function(){return t.contains(this.person.roles,i.LOCATION_ADMIN)},isTeacher:function(){return t.contains(this.person.roles,i.TEACHER)},isCsr:function(){return t.contains(this.person.roles,i.APP_ADMIN)},isRegionalAdmin:function(){return t.contains(this.person.roles,i.REGIONAL_ADMIN)||this.person.role===i.REGIONAL_ADMIN},classroom:function(){return this.person.homeroom_key},location:function(){return this.person.location},uid:function(){return this.person.uid}});return o.Roles=i,o.EmployeeRoles=s,o.CurrentUser=o.create(r.person,r.user),o});var testCount=0;tadpoles.define("model/remote",["require","jquery","lodash","ko","selfish","services/config","model/requestResults","emit","services/profilers","utilities","services/uuid","model/user"],function(e){var t=e("jquery"),n=e("lodash"),r=e("ko"),i=e("selfish"),s=e("services/config"),o=e("model/requestResults"),u=e("emit"),a=e("services/profilers"),f=null,l=e("utilities"),c=e("services/uuid"),h=e("model/user"),p=function(){return!0},d=a.getProfiler("remote"),v=i.Base.extend({className:"Remote",initialize:function(e){e=e||{};var t=this;t.concurrent=e.concurrent,t.uploading=r.observable(!1),t.bytesSent=r.observable(0),t.bytesTotal=r.observable(0),t.processing=r.observable(!1),t.results=o.create(),t.hasErrors=r.pureComputed(function(){return t.results.errors().length>0}),t.success=e.success||p,t.error=e.error||p,t.complete=e.complete||p,t.cancelled=e.cancelled||p,t.path=e.path,t.method=e.method||"get",t.files=r.observableArray([]),t.fileNames=r.pureComputed(function(){var e=n.map(t.files(),function(e){return e.files[0].name});return e}),t.hasAttachedFile=r.pureComputed(function(){return t.files()&&t.files().length>0}),t.fileName=r.pureComputed(function(){var e=t.fileNames();return e&&e.length>0?e[0]:null}),t.uploadComplete=function(){t.uploading(!1)},t.progress=function(e,r){t.bytesSent(e),t.bytesTotal(r),r&&r===e&&n.delay(function(){t.uploading(!1)},1e3)},t.pctUploaded=r.pureComputed(function(){return t.bytesTotal()==0?"0%":(t.bytesSent()/t.bytesTotal()*100).toFixed(0)+"%"}),t.useCursor=r.observable(e.useCursor||!1),t.cursor=r.observable(),t.lastRequestId=r.observable()},onLastRequestComplete:function(e){var t=this.lastRequestId(),n=function(r){r.requestId===t&&(u.removeListener(n),e())};u.on("requestCompleted",n),setTimeout(function(){u.removeListener(n)},15e3)},dispose:function(){var t=this;t.hasErrors.dispose(),t.fileName.dispose(),t.pctUploaded.dispose()},cancel:function(){this.lastRequestId(c.v4())},clear:function(){this.concurrent||this.processing(!1),this.results.clear(),this.files([]),this.clearProgress()},clearCursor:function(){this.cursor(null)},clearFiles:function(){this.files([])},clearProgress:function(){this.bytesSent(0),this.bytesTotal(0)},requestData:function(){return{}},makeRequest:function(e){var r=this;e=e||{};var i=e.success||r.success,o=e.error||r.error,a=e.complete||r.complete,p=e.cancelled||r.cancelled,v=e.path||r.path,m=n.isUndefined(e.file)?r.files().length?r.files()[0]:null:e.file,g=e.data||r.requestData();r.useCursor()&&r.cursor()&&(g.cursor=r.cursor()),g.client="dashboard",s.isProviderApp&&(f=l.lazyLoadModule(f,"services/connection"),g.token=f.getToken());var y=e.requestId||c.v4();this.lastRequestId(y),m&&r.uploading(!0),r.processing(!0);var b=function(e,t,n){if(!r.concurrent&&y!==r.lastRequestId())return;var s=n.getResponseHeader("X-TADPOLES-UID"),a=h.CurrentUser;if(s&&a&&a.uid()&&a.uid()!==s){u.emit("sessionExpired",{});return}var f=e.error_code||"unknown",l=e.error||null;e.errors&&e.errors.length>0?(r.results.errors(e.errors),o(f,l),u.emit("requestFailed",{requestId:y}),r.clearProgress()):e.error?(r.results.errors.push(e.error),o(f,l),u.emit("requestFailed",{requestId:y}),r.clearProgress()):(r.cursor(e.cursor),r.clear(),i(e),u.emit("requestSuccess",{requestId:y}))},w=function(){if(!r.concurrent&&y!==r.lastRequestId())return;r.results.errors.push("Something went wrong on our end, please try again!"),o("unknown"),u.emit("requestFailed",{requestId:y})},E=function(e){if(!r.concurrent&&y!==r.lastRequestId()){p(y),u.emit("requestCancelled",{requestId:y}),u.emit("requestCompleted",{requestId:y});return}r.concurrent||r.processing(!1),a(e),u.emit("requestCompleted",{requestId:y})};return s.isDemo?(i(g),r.processing(!1),a(g)):m?t.ajax({url:s.baseUrl+"/remote/v1/upload",data:{targetUrl:v}}).fail(w).done(function(e){m.url=e,m.formData=g,m.submit().fail(w).done(b).always(E)}):t.ajax({url:s.baseUrl+v,type:r.method,data:g,dataType:"json",headers:{"X-TADPOLES-UID":h.CurrentUser.uid()},statusCode:{401:function(){u.emit("sessionExpired",{})}},beforeSend:function(){d.start(v.split("?")[0])},dataFilter:function(e){return d.stop(v.split("?")[0]),e},xhrFields:{withCredentials:!0}}).done(b).fail(w).always(E),y}});return v}),tadpoles.define("services/propertySaving",["require","ko","jquery","lodash","services/config","services/alerts","utilities","emit","model/remote"],function(e){function f(e){return r.isString(e)?n.trim(e):e}function l(e){var t="";return r.isDate(e)?t=e.format("isoDate"):t=e,t}function c(e,t){var n=e(),r;return typeof n=="string"?r=t().value:r=n.value,r}function h(e,n,r){var i=r.key,s,u,a=n();if(a.property==="model"&&typeof r.toProperty=="function"){var h=r.toProperty();s=h.name,u=h.value;if(o.isNull(s)||o.isNull(u))throw"Uh oh.  Email talk.to.us@tadpoles.com if you see this.  Cannot save update:  missing property name and value."}else{var p=e();typeof p=="string"?s=p:s=p.name,u=t.utils.unwrapObservable(c(e,n))}return{key:i,name:s,value:l(f(u))}}function p(e){function f(e,t){o(),e?s.showAlert("Oops!",t):s.showAlert("Oops!","We were unable to save that last change.  If you have a second, check your connectivity and try again.")}e=e||{};var n=e.url||"/remote/v1/person_property",r=e.property,o=e.error||function(){},u=e.complete||function(){};if(i.isDemo){success();return}var l=a.create({path:n,method:"post",success:e.success||function(){},error:f,complete:u});l.makeRequest({data:{person_property:t.toJSON(r)}})}function d(e,t){var n=(r.isNull(e)||r.isUndefined(e))&&(r.isNull(t)||r.isUndefined(t));return!r.isEqual(e,t)&&!n}function v(e,t){var n=e(),i=n;return r.isFunction(n)&&(i={method:n,value:t().value||t().checked}),i}var t=e("ko"),n=e("jquery"),r=e("lodash"),i=e("services/config"),s=e("services/alerts"),o=e("utilities"),u=e("emit"),a=e("model/remote");return t.bindingHandlers.saveOnUpdate={init:function(e,n,r,i){if(r().confirm)return;var s=t.utils.unwrapObservable(c(n,r));e.saveOnUpdateLastValue=f(s)},update:function(e,n,s,o){function b(){y.name==="labels"&&(o.labels(y.value),o.newLabel(null))}if(s().confirm)return;var u=c(n,s),a=t.utils.unwrapObservable(u),l=f(a);a!==l&&r.defer(function(){u(l)});var v=e.saveOnUpdateLastValue;if(!d(l,v))return;var m=s(),g=m.url,y=h(n,s,o);if(i.isDemo){b();return}e.saveOnUpdateLastValue=l;if(o.disableRemoteSaving&&o.disableRemoteSaving())return;o.isRemoteSaving&&o.isRemoteSaving(!0),p({url:g,property:y,success:b,error:function(){var t=c(n,s);e.saveOnUpdateLastValue=v,t(v)},complete:function(){o.isRemoteSaving&&o.isRemoteSaving(!1)}})}},t.bindingHandlers.confirm={init:function(e,n,r,i){var s=t.utils.unwrapObservable(n()),o=s.observable;e.confirmLastValue=f(o())},update:function(e,n,i,o){var u=t.utils.unwrapObservable(n()),a=u.name,l=u.observable,c=u.message||"Are you sure?",h=l(),v=f(h);h!==v&&r.defer(function(){l(v)});var m=e.confirmLastValue;if(!d(v,m))return;if(o.disableRemoteSaving&&o.disableRemoteSaving()){e.confirmLastValue=v;return}s.showYesNo({message:c,yes:function(){e.confirmLastValue=v,i().saveOnUpdate&&p({property:{key:o.key,name:a,value:v},success:function(){},error:function(){l(m)}})},no:function(){l(e.confirmLastValue)}})}},t.bindingHandlers.callOnUpdate={init:function(e,t,n,r){var i=n().value||n().checked;i&&(e.callOnUpdateLastValue=f(i()))},update:function(e,n,i,s){function c(){e.callOnUpdateLastValue=l,o.value(l)}function h(){}if(r.has(i(),"enable")&&!i().enable)return;var o=t.utils.unwrapObservable(v(n,i));if(!o.value&&!o.checked)return;var u=o.value(),a=f(u);u!==a&&r.defer(function(){o.value(a)});var l=e.callOnUpdateLastValue;if(!d(a,l))return;e.callOnUpdateLastValue=a,o.method({value:a,error:c,success:h})}},{}}),tadpoles.define("model/form",["require","ko","jquery","lodash","services/modal","model/remote"],function(e){var t=e("ko"),n=e("jquery"),r=e("lodash"),i=e("services/modal"),s=e("model/remote"),o=i.extend(s,{className:"Form",initialize:function(e){e=e||{};var n=this;n.formTemplate=t.observable(e.formTemplate),n.formModel=t.observable(e.formModel),n.title=t.observable(e.title),n.titleSize=t.observable(e.titleSize),n.subtitle=t.observable(e.subtitle),n.submitText=t.observable(e.submitText||"create"),n.cancelText=t.observable(e.cancelText),n.popoverParams=t.pureComputed(function(){var e=n.formModel();return e&&e.getPopoverParams?e.getPopoverParams():!1}),s.initialize.call(n,{method:"post",path:e.path,success:e.success,complete:e.complete,error:e.error}),i.initialize.call(n,{template:"view/modals/addModal",model:n,width:e.width||null,height:e.height||null,maxHeight:e.maxHeight||null})},close:function(){this.clear(),i.close.call(this)},clear:function(){this.formModel()!==this&&this.formModel().clear(),s.clear.call(this)},submit:function(){if(!this.valid())return;var e=this.formModel(),n=null;e.payload?(n={},r.each(e.payload(),function(e,r){n[r]=t.toJSON(e)})):n={data:t.toJSON(e)},this.makeRequest({data:n})},valid:function(){return!0},isEmailValid:function(e){var t=/^(([a-zA-Z0-9_\-\.]+)@([a-zA-Z0-9_\-\.]+)\.([a-zA-Z]{2,5}){1,25})$/;return e&&t.test(n.trim(e))},isStringValid:function(e){return n.trim(e)}});return o}),tadpoles.define("services/disposer",["require","lodash","selfish","ko"],function(e){var t=e("lodash"),n=e("selfish"),r=e("ko"),i=50,s=n.Base.extend({className:"Disposer",initialize:function(t){var n=this;n.stats={},n.disposerQueue=[],n.timer=null},dispose:function(n){var r=this;if(t.isNull(n)||t.isUndefined(n))return;t.isArray(n)?r.disposerQueue.push.apply(r.disposerQueue,n):r.disposerQueue.push(n),r.timer||(r.timer=t.delay(r.nextItem,i))},fastDispose:function(n){var i=this;if(t.isNull(n)||t.isUndefined(n))return;t.isArray(n)?t.each(n,function(e){r.tasks?r.tasks.schedule(e.dispose):e.dispose()}):r.tasks?r.tasks.schedule(n.dispose):n.dispose()},nextItem:function o(){var e=this;e.timer=null;var o=e.disposerQueue.shift();if(!o)return;o.dispose();if(e.disposerQueue.length===0)return;e.timer=t.delay(e.nextItem,i)},recordCreation:function(n){t.isUndefined(this.stats[n.className])&&(this.stats[n.className]=0),this.stats[n.className]+=1},recordDisposal:function(t){this.stats[t.className]-=1},printStats:function(){var n=this;n.disposerQueue.length>0?console.log("Disposer Queue is not empty ("+n.disposerQueue.length+" remaining)."):t(n.stats).keys().sort().each(function(e){console.log(e+": "+n.stats[e])})}});return s.create({})}),tadpoles.define("model/disposable",["require","selfish","services/disposer","ko"],function(e){var t=e("selfish"),n=e("services/disposer"),r=e("ko"),i=t.Base.extend({className:"Disposable",initialize:function(e){var t=this;if(t.dispose_initialized)return;t.dispose_initialized=!0,t.disposed=!1,n.recordCreation(this)},dispose:function(){if(this.disposed)return;this.disposed=!0,n.recordDisposal(this)}});return i}),tadpoles.define("services/touch",["require"],function(e){var t=!1,n=navigator.platform;if(n==="iPad"||n==="iPhone"||n==="iPod")t=!0;return{isTouchEnabled:t}}),tadpoles.define("model/actionTile",["require","selfish","model/disposable","ko","services/touch","emit"],function(e){var t=e("selfish"),n=e("model/disposable"),r=e("ko"),i=e("services/touch"),s=e("emit"),o=t.Base.extend(n,{className:"ActionTile",initialize:function(e){e=e||{},this.tileType=e.tileType||"",this.isActionsEnabled=r.observable(!1),this.isMenuEnabled=r.observable(!1),this.isSelected=r.observable(!1),this.template=e.template,n.initialize.call(this)},dispose:function(){s.removeAllListeners("menu-toggled"),n.dispose.call(this)},enableActions:i.isTouchEnabled?null:function(){this.isActionsEnabled(!0)},tryEnableActions:function(){this.enableActions&&this.enableActions()},disableActions:i.isTouchEnabled?null:function(){this.isActionsEnabled(!1),this.disableMenu()},tryDisableActions:function(){this.disableActions&&this.disableActions()},enableMenu:function(){if(this.isMenuEnabled())return;this.isMenuEnabled(!0),i.isTouchEnabled&&this.isActionsEnabled(this.isMenuEnabled()),s.emit("menu-toggled"),this.listenForOtherClicks()},disableMenu:function(e){if(!this.isMenuEnabled())return;this.stopListeningForOtherClicks(),this.isMenuEnabled(!1),e&&this.isActionsEnabled(!1),i.isTouchEnabled&&this.isActionsEnabled(this.isMenuEnabled())},disableMenuAndActions:function(){this.disableMenu(!0)},toggleMenu:function(){(this.isActionsEnabled()||i.isTouchEnabled)&&!this.isMenuEnabled()?this.enableMenu():this.disableMenu()},listenForOtherClicks:function(){this.stopListeningForOtherClicks(),s.on("menu-toggled",this.disableMenuAndActions)},stopListeningForOtherClicks:function(){s.removeAllListeners("menu-toggled")},selectionTopic:function(){return(this.isSelected()?"selected":"deselected")+":"+this.tileType},toggleSelection:function(){this.isSelected(!this.isSelected()),s.emit(this.selectionTopic(),this),typeof this.galleryGroup=="function"&&this.galleryGroup(this.isSelected()?"selected":"modal")},deselect:function(){this.isSelected(!1),typeof this.galleryGroup=="function"&&this.galleryGroup("modal")}});return o}),tadpoles.define("model/product",["require","ko","lodash","services/config","selfish","model/remote"],function(e){var t=e("ko"),n=e("lodash"),r=e("services/config"),i=e("selfish"),s=e("model/remote"),o={DOMAINS:"domains",OUTBOX:"outbox",DAILY_REPORT_BATCH_SCOPE:"daily_batch_scope",METRICS:"metrics",CUSTOM_CURRICULUM:"curriculum",BRAND:"brand",BRANDED_IMAGES:"branded_images",BRANDED_STYLE:"branded-style",BRANDED_EMAIL:"brand-emails",COPY_LESSON_LOCATION:"copy_lesson_location",UNITS_OF_LEARNING:"units-of-learning",STICKIES:"stickies",EXTERNAL_CURRICULUM:"ext-curr",PLANNING_MASTER:"planning-master",PLANNING_SLAVE:"planning-slave",DISABLE_TEACHER_CURRICULUM_EDIT:"no_teach_curr_edit",TEXT_MESSAGE:"text-message",WEEKLY_TRANSITIONS:"weekly-transitions",PLANNING_SEARCH:"planning-search",FEATURE_CUSTOM_CURRICULA_PERIODS:"custom-curricula-periods",MINUTE_MENU_SFTP:"minute-menu-sftp",WEB_DATA_IMPORT:"web-data-import",LOCK_API_FIELDS:"lock_api_fields",INCIDENT_DESTINATION:"incident-destination",DISABLE_TAG_CHILDREN_IN_LESSON_PLANS:"disable-tag-children-in-lesson-plans",GROUP_SHARE_TOGGLE_DEFAULT:"group-share-toggle-default",TAG_CHILDREN_IN_LESSON_PLANS:"tag-children-in-lesson-plans",NO_GOAL_SHARING:"no_goal_sharing",ROSTER_FORECASTER:"roster-forecaster",DOB_ON_STUDENT_ATTENDANCE_REPORT:"dob-on-student-attendance-report",CUSTOM_DAILY_REPORT:"custom-daily-report"},u={BATCH_FEATURE_LEVEL_IN_TODAY:"in-today",DOMAINS_FEATURE_LEVEL_GODDARD:"goddard-domains",UNITS_OF_LEARNING_LEVEL_BETA:"beta",UNITS_OF_LEARNING_LEVEL_DEV:"dev"},a=i.Base.extend({className:"Product",initialize:function(e){var n=this;e=e||{},n.name=e.display,n.features=t.observableArray(e.features),n.brand_logo_link_url=e.brand_logo_link_url,n.brand_logo_image_url=e.brand_logo_image_url},hasFeature:function(e){return n.find(this.features(),function(t){return t.name===e&&(t.allowed||typeof t.allowed=="undefined")})},hasFeatureLevel:function(e,t){return n.find(this.features(),function(n){return n.name===e&&n.level===t})},getFeature:function(e){return n.find(this.features(),function(t){return t.name===e})},translate:function(e,t){if(!this.hasFeature("translation"))return t||e;var r=this.getFeature("translation").value,i=e.toLowerCase();return n.has(r,i)?r[i]:t||e},translateStrings:function(e){var t=this;return n.map(e,function(e){return t.translate(e)})},getBrandImageUrl:function(e){if(!this.hasFeature(o.BRAND)||!this.hasFeature(o.BRANDED_IMAGES))return null;var t=this.getFeature(o.BRAND).value,r=this.getFeature(o.BRANDED_IMAGES).value;return n.contains(r,e)?"/images/5/brand/"+t+"/"+e+".png":null},getBrandStylesheet:function(e){if(!this.hasFeature(o.BRAND)||!this.hasFeature(o.BRANDED_STYLE))return null;var t=this.getFeature(o.BRAND).value;return"/stylesheets/3/brand/"+t+"/style.css"},getStartOfWeek:function(){var e=1,t=this.getFeature("start-of-week");if(!t)return e;try{e=parseInt(t.value)}catch(n){}return isNaN(e)?1:parseInt(e)},minPhotosPerChild:function(){var e=this.getFeature("min-photos-per-child");return e?parseInt(e.value):1},getEndOfWeek:function(){return(this.getStartOfWeek()+4)%7},getWeekend:function(){var e=this.getEndOfWeek(),t=(e+1)%7,n=(e+2)%7;return[t,n]},getWeekDays:function(){return n.range(this.getStartOfWeek(),this.getEndOfWeek()+1)},dobOnStudentAttendanceReport:function(){return this.hasFeature(o.DOB_ON_STUDENT_ATTENDANCE_REPORT)},updateFeature:function(e){var r=this,i=s.create({path:"/remote/v1/product/feature",method:"post",success:function(){var t=n.findIndex(r.features(),{name:e.name});if(t>=0){var i=r.features.peek();r.features.valueWillMutate(),i[t]=e,r.features.valueHasMutated()}else r.features.push(e)}}),o={feature:t.toJSON(e)};i.makeRequest({data:o})},enableFeature:function(e){var t=n.clone(n.find(this.features(),{name:e}));t||(t={name:e}),t.allowed=!0,this.updateFeature(t)},disableFeature:function(e){var t=n.clone(n.find(this.features(),{name:e}));t||(t={name:e}),t.allowed=!1,this.updateFeature(t)}});return a.Features=o,a.Levels=u,a.create(r.product)}),tadpoles.define("services/metrics",["require","ko","selfish","jquery","lodash","services/config","emit","model/user","model/product"],function(e){function h(e,t,n,r){var s=r.location,a=r.groups,f=r.day;if(n)try{n(f)}catch(l){}i.each(t,function(e){e.key==="all"?e.updateMetrics(s):e.updateMetrics(a[e.key])}),o.emit("metrics-loaded",{days:u})}var t=e("ko"),n=e("selfish"),r=e("jquery"),i=e("lodash"),s=e("services/config"),o=e("emit"),u=30,a=e("model/user"),f=e("model/product"),l={Dummy:{id:"no_metric",name:"no metric"},StudentPhotoPercent:{id:"todays_student_photo_pct",name:"% students photo'd"},ChildrenIn:{id:"in",name:"counts in"},SentPhotos:{id:"yesterdays_photos",name:"number of photos sent"},StudentPhotos:{id:"yesterdays_students_photos",name:"number of students photo'd"},DailyReports:{id:"yesterdays_dailies",name:"number of daily reports"}},c={id:"no_metric",name:"no metric"},p=n.Base.extend({className:"Metrics",initialize:function(){var e=this;e.metrics=t.observableArray([l.ChildrenIn,l.SentPhotos,l.StudentPhotos,l.DailyReports]),e.currentMetric=t.observable(e.metrics()[0]),e.metricPeriod=t.observable(),e.metricDisplay=t.pureComputed(function(){var t=e.currentMetric(),n=t.name;return t.id!=="in"&&e.metricPeriod()&&(n=n+" from "+e.metricPeriod()),n}),e.metricsEnabled=t.pureComputed(function(){return a.CurrentUser.isCsr()||f.hasFeature(f.Features.METRICS)&&a.CurrentUser.isAdmin()})},loadMetrics:function(e){if(s.isDemo)return;var t=e.location,n=e.groups,a=e.display,f={location:t.key,days:u};r.ajax({dataType:"json",url:"/metrics/account/location",data:f,success:i.bind(h,null,t,n,a),error:function(e,t,n){console.log("Error "+t+" "+n)},statusCode:{401:function(){o.emit("sessionExpired",{})}}})}});return p.MetricTypes=l,p.numberOfDaysToRetrieve=u,p.create()}),tadpoles.define("model/auditEntry",["require","lodash","selfish","model/remote","jquery"],function(e){var t=e("lodash"),n=e("selfish"),r=e("model/remote"),i=e("jquery"),s=n.Base.extend({className:"AuditEntry",initialize:function(e){this.timestamp=new Date(e.created_datetime),this.client_device_id=e.client_device_id,this.client_ip_address=e.client_ip_address,this.client_type=e.client_type,this.actor_name=e.actor_name,this.queue_time=e.queue_time,this.transactional=e.transactional;var n;this.added=[],this.removed=[],this.changed=[];for(n in e){var r=n.indexOf("old_")===0&&!t.isNull(e[n])&&!t.isUndefined(e[n]),i=n.indexOf("new_")===0&&!t.isNull(e[n])&&!t.isUndefined(e[n]);if(!r&&!i)continue;var s=n.substring(4);r&&(t.isNull(e["new_"+s])||t.isUndefined(e["new_"+s]))?this.removed.push({name:s,old:this.renderDates(e[n]),isObject:t.isObject(e[n]),isKey:this.isKey(e[n])}):i&&(t.isNull(e["old_"+s])||t.isUndefined(e["old_"+s]))?this.added.push({name:s,changed:this.renderDates(e[n]),isObject:t.isObject(e[n]),isKey:this.isKey(e[n])}):r&&!t.isUndefined(e["new_"+s])&&this.changed.push({name:s,old:this.renderDates(e[n]),changed:this.renderDates(e["new_"+s]),isObject:t.isObject(e["new_"+s]),isKey:this.isKey(e["new_"+s])})}},objectForKey:function(e,t){i(t.target).removeClass("pointable");var n=t.target.className==="new",s=this,o=r.create({path:"/admin/objectbykey",method:"get",success:function(e){t.target.textContent=JSON.stringify(e,null,4)},error:function(e){Alerts.showAlert("Oops!","No object for you!")}});o.makeRequest({data:{key:n?e.changed:e.old}})},showObject:function(e,t){i(t.target).removeClass("pointable"),t.target.className==="new"?t.target.textContent=""+JSON.stringify(e.changed,null,4):t.target.textContent=""+JSON.stringify(e.old,null,4)},isKey:function(e){return t.isString(e)&&e.length>32&&e.indexOf(" ")===-1},renderDates:function(e){var n=e,r=null;if(t.isString(e)){var i=parseFloat(e);!t.isNaN(r)&&t.isFinite(e)?r=i:r=Date.parse(e)}t.isNumber(e)&&(r=e);if(r){var s=r+"";s.length===10&&(r*=1e3),s.length===13&&(n=(new Date(r)).format("m/d h:MM:ss TT"))}return n}});return s}),tadpoles.define("model/audit",["require","lodash","model/auditEntry","services/modal","model/remote","utilities"],function(e){var t=e("lodash"),n=e("model/auditEntry"),r=e("services/modal"),i=e("model/remote"),s=null,o=e("utilities"),u=i.extend({className:"Audit",initialize:function(){i.initialize.call(this,{path:"/remote/v1/audit",method:"get"}),this.entries=[]},show:function(){s.getInstance({template:"view/modals/auditModal",model:this,width:1024}).open(this)},load:function(e,r){var i=this;this.makeRequest({data:{object_key:e},success:function(e){i.entries=t.map(e.audit,function(e){return(r||n).create(e)}),i.show()}})}});return s=o.makeSingleton(r),o.makeSingleton(u)}),tadpoles.define("model/globalFilter",["require","ko","selfish","services/config","emit","model/audit"],function(e){var t=e("ko"),n=e("selfish"),r=e("services/config"),i=e("emit"),s=n.Base.extend({className:"GlobalFilter",initialize:function(){var e=this;e.location=t.observable(),e.group=t.observable(),e.label=t.observable(),e.name=t.observable("").extend({rateLimit:{method:"notifyWhenChangesStop",timeout:250}}),e.date=t.observable(new Date),e.dateForDisplay=t.pureComputed(function(){return e.date()?e.date().format("tinyDate"):""}),e.isToday=t.pureComputed(function(){return e.date().format("isoDate")===(new Date).format("isoDate")}),e.labelSelected=t.pureComputed(function(){var t=e.label();return t&&t!=="All"}),e.groupSelected=t.pureComputed(function(){return e.group()&&e.group().key!=="all"}),e.locationSelected=t.pureComputed(function(){return e.location()}),e.isClassSelected=t.pureComputed(function(){var t=e.group();return t?t.isClass():!1}),e.group.subscribe(function(e){i.emit("class-filter-changed",{key:e.key})})},defaultLocation:function(){this.changeLocation(r.location)},changeLocation:function(t){t&&(t.isLocation=function(){return!0},t.audit=function(){var t=e("model/audit");t.getInstance().load(this.key)}),this.location(t)}});return s.create()}),tadpoles.define("model/status",["require","selfish"],function(e){var t=e("selfish"),n=t.Base.extend();return n.Statuses={INTERESTED:"interested",TOURING:"touring",VISITED:"visited",WAITING:"waiting",SCHEDULED:"scheduled",ACTIVE:"active",SUSPENDED:"suspended",GRADUATED:"graduated",DELETED:"deleted"},n.DerivedStatuses={DISENROLLING:"disenrolling"},n.AllStatuses={INTERESTED:"interested",TOURING:"touring",VISITED:"visited",WAITING:"waiting",SCHEDULED:"scheduled",ACTIVE:"active",DISENROLLING:"disenrolling",SUSPENDED:"suspended",GRADUATED:"graduated",DELETED:"deleted"},n.getDisplayableStatus=function(e){switch(e){case n.Statuses.INTERESTED:return"Interested";case n.Statuses.TOURING:return"Touring";case n.Statuses.VISITED:return"Visited";case n.Statuses.WAITING:return"Wait list";case n.Statuses.SCHEDULED:return"Scheduled";case n.Statuses.ACTIVE:return"Active";case n.DerivedStatuses.DISENROLLING:return"Disenrolling";case n.Statuses.SUSPENDED:return"Inactive";case n.Statuses.GRADUATED:return"Graduated";case n.Statuses.DELETED:return"Deleted";default:return"Unknown"}},n}),tadpoles.define("services/children",["require","ko","lodash","services/config","utilities","selfish","emit","model/globalFilter","services/disposer","model/status"],function(e){var t=e("ko"),n=e("lodash"),r=e("services/config"),i=e("utilities"),s=e("selfish"),o=e("emit"),u=e("model/globalFilter"),a=e("services/disposer"),f=e("model/status"),l=null,c=s.Base.extend({className:"Children",initialize:function(e){var s=this;s.children=t.observableArray([]),s.childrenByKey=t.pureComputed(function(){var e={};return n.each(s.children(),function(t){e[t.key]=t}),e}),s.childrenForLocationAndLabel=t.pureComputed(function(){return n.filter(s.children(),function(e){return e.hasLabel(u.label())&&u.locationSelected()})}),s.activeChildrenForSelectedGroup=t.pureComputed(function(){return u.group()?n.filter(u.group().children(),function(e){return f.Statuses.ACTIVE===e.status()}):[]}).extend({rateLimit:200}),s.activeEnrolledChildrenForSelectedGroup=t.pureComputed(function(){var e=u.group();if(!e)return[];var t=s.childrenForLocationAndLabel();return n.filter(t,function(t){return f.Statuses.ACTIVE===t.status()&&(e.isLocation()||t.isInHomeroom(e))})}).extend({rateLimit:200}),s.childrenForCurrentGroupOnDailyReport=t.pureComputed(function(){return s.activeChildrenForSelectedGroup().sort(function(e,t){var n=e.dailyReportSort(),r=t.dailyReportSort();return n===r?0:n>r?1:-1})}),s.childrenWithPhotosLookup=t.observable({}),s.events=[],s.ouboxEvents=[],o.on("events-update",function(e){e.source==="events"?s.events=n.filter(e.events,function(e){return e.hasMedia()}):s.ouboxEvents=n.filter(e.events,function(e){return e.isToday()&&e.hasMedia()});var t=s.events.concat(s.ouboxEvents),r=n(t).map(function(e){return e.members()}).flatten().groupBy().value();n.each(n.keys(r),function(e){r[e]=r[e].length}),s.childrenWithPhotosLookup(r)}),o.on("inactiveChildrenLoaded",function(e){var t=e.location;if(!s.isActiveLocation(t))return;var r=n.map(e.dependants,function(t){return t.location=e.location,l.create(t)}),i=s.children();s.children(i.concat(r)),s.sortChildren()}),o.on("graduatedChildrenLoaded",function(e){var t=e.location;if(!s.isActiveLocation(t))return;var r=n.map(e.dependants,function(t){return t.location=e.location,l.create(t)}),i=s.children();s.children(i.concat(r)),s.sortChildren()}),o.on("activeChildrenLoaded",function(e){l=i.lazyLoadModule(l,"model/child"),a.dispose(s.children());var t=n.map(e.dependants,function(t){return t.location=e.location,l.create(t)});s.children(t),s.sortChildren(),o.emit("childrenLoaded",{location:e.location}),o.emit("parametersLoaded",{}),o.emit("parameterRequestComplete",{}),r.isDemo&&i.getURLParameter("tpsuite")===null&&s.initializeForDemo()}),o.on("child-update-received",function(e){if(i.isNull(s.childrenByKey()[e.key])){l=i.lazyLoadModule(l,"model/child"),e.location_key&&(e.location=n(r.locations).find(function(t){return e.location_key===t.key}));var t=l.create(e);s.addChild(t)}})},isActiveLocation:function(e){var t=u.location.peek();return e.key==t.key},reset:function(){a.fastDispose(this.children()),this.children([])},getChild:function(e){return this.childrenByKey()[e]},addChild:function(e){var t=this.childrenByKey()[e.key];return i.isNull(t)&&(t=e,this.children.push(e),this.sortChildren()),t},removeChild:function(e){var t=null,r=n.findIndex(this.children(),function(t){return t.key===e.key});return r>=0&&(t=this.children().splice(r,1),a.dispose(t),this.sortChildren()),t},sortChildren:function(){this.children.sort(function(e,t){var n=e.sort(),r=t.sort();return n===r?0:n>r?1:-1})},initializeForDemo:function(){var e=5e3;n.each(this.children(),function(t,r){var i=e*(r+1)+r*1e3;n.delay(t.requestAttendance,i)})}});return i.makeSingleton(c)}),tadpoles.define("model/measurable",["require","lodash","ko","utilities","services/metrics","services/children","model/disposable","model/product"],function(e){var t=e("lodash"),n=e("ko"),r=e("utilities"),i=e("services/metrics"),s=e("services/children"),o=e("model/disposable"),u=e("model/product"),a=o.extend({className:"Measurable",initialize:function(e){var o=this;o.hoveredMetric=n.observable(""),o.metrics=n.observableArray(),o.metricsByDay={},o.currentMetric=n.pureComputed(function(){return i.currentMetric()}),o.metricTemplate=n.pureComputed(function(){return o.currentMetric().id==="in"?"view/tiles/studentAndStaffTile":"view/tiles/classMetricTile"}),o.metricClass=n.pureComputed(function(){return o.currentMetric().id==="todays_student_photo_pct"?"stat-double":"stat-medium"}),o.numChildrenIn=function(){},o.childrenInToday=function(){},o.childrenWithoutPhotos=n.pureComputed(function(){var e=s.getInstance().childrenWithPhotosLookup();return t.filter(o.childrenInToday(),function(t){return!e[t.key]||e[t.key]<u.minPhotosPerChild()})}),o.displayedMetric=n.pureComputed(function(){var e=i.currentMetric();if(e===i.MetricTypes.ChildrenIn)return o.numChildrenIn();if(e===i.MetricTypes.StudentPhotoPercent){var n=o.childrenInToday();if(!n||n.length==0)return"-";var a=s.getInstance().childrenWithPhotosLookup(),f=t.filter(n,function(e){return a[e.key]>=u.minPhotosPerChild()});return(f.length/n.length*100).toFixed(0)+"%"}if(e===i.MetricTypes.Dummy)return"-";var l=o.metrics();if(r.isNull(l)||l.length===0)return"-";var c=l[l.length-1];return e.id==="yesterdays_dailies"?c.kids_w_daily:e.id==="yesterdays_photos"?c.attachments:e.id==="yesterdays_students_photos"?c.kids_w_photos:0})},dispose:function(){var t=this;t.currentMetric.dispose(),t.metricTemplate.dispose(),t.metricClass.dispose(),t.childrenWithoutPhotos.dispose(),t.displayedMetric.dispose(),o.dispose.call(this)},getPopoverParams:function(){var e=u.minPhotosPerChild()>1?"Children without "+u.minPhotosPerChild()+" photos":"Children without a photo";return i.currentMetric()===i.MetricTypes.StudentPhotoPercent&&this.childrenWithoutPhotos().length>0?{content:"<div data-bind=\"template: { name: 'view/popovers/kidsWithoutPhotos' }\"></div>",placement:"in bottom",trigger:"hover",bindContent:!0,template:'<div class="popover"><div class="arrow"></div><div class="popover-inner" data-bind="click:hidePopover, clickBubble:false" style="width: 310px;"><div class="popover-title"><h4 style="display: inline; vertical-align: middle;">'+e+'</h4><button style="margin-left: 10px" class="btn btn-mini btn-success" data-bind="visible:isClass(), click:sendUnphotoedStudentsSticky, clickBubble:false">Remind As Sticky</button><div></div></div><div class="popover-content"><p></p></div></div></div>'}:!1},updateMetrics:function(e){var n=this;this.metrics(e),t.each(e,function(e){n.metricsByDay[e.date]=e})},metricValues:function(e){var n=this.metrics();return t.pluck(n,e)},metricDates:function(){return t.map(this.metrics(),function(e){return e.date})},dateToDay:function(e){var t=e.date,n=e.dateString;return t||(t=r.convertPlatformDateStringToDate(n)),t.getMonth()+1+"/"+t.getDate()},metricLabels:function(){var e=this.metrics();return t.map(e,function(e){return a.dateToDay(e.date)})},metricValue:function(e,t){var n=this.metricsByDay[t];if(!n)return 0;var r=n[e]||0;return r},hoveredMetricAndDay:function(e,t){this.hoveredMetric(this.metricValue(e,t))},childrenWithoutPhotosDetail:function(e){if(u.minPhotosPerChild()>1){var t=s.getInstance().childrenWithPhotosLookup();if(!t[e])return"no photos";var n=t[e];return n+" photo"+(n>1?"s":"")}return""}});return a.METRIC_KIDS_WITH_PHOTOS="kids_w_photos",a.METRIC_TOTAL_PHOTOS="attachments",a.METRIC_PERCENTAGE_MEDIA_DAILY_REPORTS="per_med_dr",a.METRIC_STUDENTS_NO_MEDIA_DAILY_REPORTS="no_med_dr",a.METRIC_FACEBOOK_SHARES="fb_shares",a.METRIC_FACEBOOK_VIEWS="fb_views",a.METRIC_PAPER_SAVED="paper_saved",a.METRIC_PARENT_ACCESS_EMAIL="parent_access_email",a.METRIC_PARENT_ACCESS_WEB="parent_access_web",a.METRIC_PARENT_ACCESS_MOBILE_APP="parent_access_mobile_app",a}),tadpoles.define("model/attendancePersons",["require"],function(e){return{Students:"students",Staff:"staff",Sick:"sick",All:"combined"}}),tadpoles.define("model/personTypeable",["require","selfish","ko","model/attendancePersons"],function(e){var t=e("selfish"),n=e("ko"),r=e("model/attendancePersons"),i=t.Base.extend({className:"PersonTypeable",initialize:function(){var t=this;t.activePersons=n.observable(r.All),t.studentsActive=n.computed(function(){return t.activePersons()===r.Students}),t.staffActive=n.computed(function(){return t.activePersons()===r.Staff}),t.sickActive=n.computed(function(){return t.activePersons()===r.Sick}),t.allActive=n.computed(function(){return t.activePersons()===r.All})},chooseStudents:function(){this.activePersons(r.Students)},chooseStaff:function(){this.activePersons(r.Staff)},chooseSick:function(){this.activePersons(r.Sick)},chooseAll:function(){this.activePersons(r.All)}});return i}),tadpoles.define("model/detailViewPanel",["require","ko","selfish","emit","model/globalFilter","services/metrics","model/user","model/personTypeable","utilities"],function(e){var t=e("ko"),n=e("selfish"),r=e("emit"),i=e("model/globalFilter"),s=e("services/metrics"),o=e("model/user"),u=e("model/personTypeable"),a=e("utilities"),f={OBSERVATIONS:"observations",LESSONS:"lessons",DAILY_REPORTS:"daily reports",ATTENDANCE_DETAILS:"attendance",ROSTER:"roster",COMMUNICATIONS:"communications",PORTFOLIO:"portfolio",METRICS:"metrics"},l={RATIOS:"ratios",EXPECTED_REMAINING:"expected / remaining",EXPECTED_IN:"expected / in",STUDENTS_IN:"students in",STAFF_IN:"staff in"},c=n.Base.extend(u,{className:"DetailViewPanel",initialize:function(e){var n=this;u.initialize.call(this),n.activeView=t.observable(),n.observationsActive=t.pureComputed(function(){return n.activeView()===f.OBSERVATIONS}),n.dailyReportsActive=t.pureComputed(function(){return n.activeView()===f.DAILY_REPORTS}),n.attendanceDetailsActive=t.pureComputed(function(){return n.activeView()===f.ATTENDANCE_DETAILS}),n.rosterActive=t.pureComputed(function(){return n.activeView()===f.ROSTER}),n.communicationsActive=t.pureComputed(function(){return n.activeView()===f.COMMUNICATIONS}),n.lessonsActive=t.pureComputed(function(){return n.activeView()===f.LESSONS}),n.portfolioActive=t.pureComputed(function(){return n.activeView()===f.PORTFOLIO}),n.metricsActive=t.pureComputed(function(){return n.activeView()===f.METRICS}),n.metricsEnabled=t.pureComputed(function(){return s.metricsEnabled()}),n.observationsWasActive=t.observable(!1),n.dailyReportsWasActive=t.observable(!1),n.attendanceDetailsWasActive=t.observable(!1),n.rosterWasActive=t.observable(!1),n.communicationsWasActive=t.observable(!1),n.lessonsWasActive=t.observable(!1),n.portfolioWasActive=t.observable(!1),n.metricsWasActive=t.observable(!1),n.nameFilter=i.name,o.CurrentUser.isAdmin()?this.chooseAttendanceDetails():this.chooseLessons(),this.activeView.subscribe(function(e){r.emit("detailViewActive",{name:e}),r.emit("detailViewActive:"+e)}),n.countOption=t.observable(l.RATIOS)},chooseObservations:function(){s.currentMetric(s.MetricTypes.StudentPhotoPercent),this.activeView(f.OBSERVATIONS),this.observationsWasActive(!0)},chooseDailyReports:function(){s.currentMetric(s.MetricTypes.Dummy),this.activeView(f.DAILY_REPORTS),this.dailyReportsWasActive(!0)},chooseAttendanceDetails:function(){s.currentMetric(s.MetricTypes.ChildrenIn),this.activeView(f.ATTENDANCE_DETAILS),this.attendanceDetailsWasActive(!0),r.emit("attendance-details:active",{})},chooseRoster:function(){s.currentMetric(s.MetricTypes.ChildrenIn),this.activeView(f.ROSTER),this.rosterWasActive(!0)},chooseCommunications:function(){s.currentMetric(s.MetricTypes.Dummy),this.activeView(f.COMMUNICATIONS),this.communicationsWasActive(!0)},chooseLessons:function(){s.currentMetric(s.MetricTypes.Dummy),this.activeView(f.LESSONS),this.lessonsWasActive(!0)},choosePortfolio:function(){s.currentMetric(s.MetricTypes.Dummy),this.activeView(f.PORTFOLIO),this.portfolioWasActive(!0)},chooseMetrics:function(){this.activeView(f.METRICS),this.metricsWasActive(!0)}});return c.Views=f,c.CountOptions=l,a.makeSingleton(c)}),tadpoles.define("print",["jquery"],function(e){(function(t){var n;t.fn.jqprint=function(r){n=t.extend({},t.fn.jqprint.defaults,r);var i=this instanceof e?this:t(this),s=t("<iframe  />");n.debug||s.css({position:"absolute",width:"0px",height:"0px",left:"-600px",top:"-600px"}),s.appendTo("body");var o=s[0].contentWindow.document;n.importCSS&&(t("link[media=print]").length>0?t("link[media=print]").each(function(){o.write("<link type='text/css' rel='stylesheet' href='"+t(this).attr("href")+"' media='print' />")}):t("link").each(function(){o.write("<link type='text/css' rel='stylesheet' href='"+t(this).attr("href")+"' />")})),n.printContainer?o.write(i.outer()):i.each(function(){o.write(t(this).html())}),t(o.getElementsByTagName("body")[0]).css({backgroundColor:"#FFF"}),o.close(),s[0].contentWindow.focus(),setTimeout(function(){s[0].contentWindow.print()},1e3)},t.fn.jqprint.defaults={debug:!1,importCSS:!0,printContainer:!0,operaSupport:!0},e.fn.outer=function(){return t(t("<div></div>").html(this.clone())).html()}})(e)}),tadpoles.define("model/printable",["require","print","selfish","jquery","ko"],function(e){var t=e("print"),n=e("selfish"),r=e("jquery"),i=e("ko"),s={standard:"standard",legal:"legal"},o=n.Base.extend({className:"Printable",initialize:function(e){var t=this;this.isPrinting=i.observable(!1),this.size=i.observable(s.standard),this.printableElementId=e,this.isSizeLegal=i.pureComputed(function(){return t.size()===s.legal})},print:function(){this.isPrinting(!0),this.size(s.standard),r("#"+this.printableElementId).jqprint(),this.isPrinting(!1)},printLegal:function(){this.isPrinting(!0),this.size(s.legal),r("#"+this.printableElementId).jqprint(),this.isPrinting(!1)}});return o}),tadpoles.define("model/planningMaster",["require","model/product","selfish","ko","services/config"],function(e){var t=e("model/product"),n=e("selfish"),r=e("ko"),i=e("services/config"),s=n.Base.extend({className:"PlanningMaster",initialize:function(){var e=this;e.isCurriculaMetricAccountGroupMaster=r.pureComputed(function(){var e=t.getFeature(t.Features.PLANNING_MASTER);return e&&e.value["master-account"]===i.account.external_name&&e.value["account-group"]&&t.hasFeature(t.Features.FEATURE_CUSTOM_CURRICULA_PERIODS)}),e.isMasterAccount=r.pureComputed(function(){var e=t.getFeature(t.Features.PLANNING_MASTER);return e?e.value["master-account"]===i.account.external_name:!0})}});return s}),tadpoles.define("model/assessment/ratingMetric",["require","selfish","ko","lodash","emit","model/globalFilter","model/planningMaster"],function(e){var t=e("selfish"),n=e("ko"),r=e("lodash"),i=e("emit"),s=e("model/globalFilter"),o=e("model/planningMaster"),u=t.Base.extend(o,{className:"RatingMetric",initialize:function(e){var t=this;o.initialize.call(t),t.ratings={},t.metricType=n.observable(),t.goalId=e.goal_id,t.goalName=e.goal_name,t.subjectName=e.subject_name,t.rated=n.observable(),t.unmet=n.observable(),t.improved=n.observable(),t.meets=n.observable(),t.exceeds=n.observable(),t.ratedRatio=n.observable(),t.unmetRatio=n.observable(),t.improvedRatio=n.observable(),t.meetsRatio=n.observable(),t.exceedsRatio=n.observable(),i.on("rating-metric-filter-change",function(e){e.metricType&&t.metricType()!==e.metricType&&t.metricType(e.metricType),t.updateRatings()})},clearRatings:function(){this.rated("0%"),this.unmet("0%"),this.improved("0%"),this.meets("0%"),this.exceeds("0%"),this.ratedRatio("0/0"),this.unmetRatio("0/0"),this.improvedRatio("0/0"),this.meetsRatio("0/0"),this.exceedsRatio("0/0")},updateRatings:function(e){var t=this;this.isCurriculaMetricAccountGroupMaster()&&(e="all"),e=e||(s.group()?s.group().key:null);var n=t.ratings[e]?t.ratings[e]:null;if(!n){t.clearRatings();return}var r=t.metricType()==="progress"?n.ratings[0]:0,i=n.total_ratings-r,o=t.metricType()==="progress"?n.total_ratings-n.ratings[0]:-n.ratings[0];t.ratedRatio(o+"/"+n.total_ratings),t.unmetRatio(n.ratings[1]+"/"+i),t.improvedRatio(n.ratings[2]+"/"+i),t.meetsRatio(n.ratings[3]+"/"+i),t.exceedsRatio(n.ratings[4]+"/"+i),t.rated(t.formatPct(o,n.total_ratings)),t.unmet(t.formatPct(n.ratings[1],i)),t.improved(t.formatPct(n.ratings[2],i)),t.meets(t.formatPct(n.ratings[3],i)),t.exceeds(t.formatPct(n.ratings[4],i))},addRatings:function(e){var t=e.class_id==="__all__"?"all":e.class_id;this.ratings[t]=e},getPopoverParams:function(){return this.metricType()==="progress"?{title:this.goalName,content:"<div data-bind=\"template: { name: 'view/popovers/ratingRatios' }\"></div>",placement:"bottom",trigger:"hover",template:'<div class="popover"><div class="arrow"></div><div class="popover-inner" style="width: 400px"><h3 class="popover-title"></h3><div class="popover-content"><p></p></div></div></div>',bindContent:!0}:{}},formatPct:function(e,t){return t?(e/t*100).toFixed(0)+"%":"0%"}});return u}),tadpoles.define("model/assessment/assessmentMetrics",["require","selfish","model/printable","lodash","model/assessment/ratingMetric","ko","emit","model/globalFilter"],function(e){var t=e("selfish"),n=e("model/printable"),r=e("lodash"),i=e("model/assessment/ratingMetric"),s=e("ko"),o=e("emit"),u=e("model/globalFilter"),a=t.Base.extend(n,{className:"AssessmentMetrics",initialize:function(e){var t=this;t.metrics=e,t.curriculumId=e.curriculum_id,t.curriculumName=e.curriculum_name,t.totalChildren=e.completion_counts.total,t.unassessed=e.completion_counts.unassessed,t.assessmentStarted=e.completion_counts.assessment_started,t.assessmentMostlyComplete=e.completion_counts.assessment_mostly_complete,t.assessmentComplete=e.completion_counts.assessment_complete,t.unassessedPct=i.formatPct(t.unassessed,t.totalChildren),t.assessmentStartedPct=i.formatPct(t.assessmentStarted,t.totalChildren-t.unassessed),t.assessmentMostlyCompletePct=i.formatPct(t.assessmentMostlyComplete,t.totalChildren-t.unassessed),t.assessmentCompletePct=i.formatPct(t.assessmentComplete,t.totalChildren-t.unassessed),t.color=t.colorForMetric(t.assessmentMostlyComplete+t.assessmentComplete,t.totalChildren),n.initialize.call(t,"assess-printable");var a={};r.each(t.metrics.ratings,function(e){var t=a[e.goal_id];t||(t=a[e.goal_id]=i.create(e)),t.addRatings(e)}),t.ratingCount=s.observable(r.size(a)),t.domainMetrics=r(a).groupBy("subjectName").map(function(e,t){return{name:t,ratings:r.sortBy(e,"goal_name")}}).sortBy("name").value(),t.updateRatings(u.group()?u.group().key:"all"),o.on("class-filter-changed",function(e){t.updateRatings(e.key)})},updateRatings:function(e){var t=this;r(t.domainMetrics).pluck("ratings").flatten().each(function(t){t.updateRatings(e)})},clearRatings:function(){var e=this;r(e.domainMetrics).pluck("ratings").flatten().each(function(e){e.clearRatings()})},classesWithAssessments:function(){var e=this;return r(e.metrics.ratings).uniq("class_id").map(function(e){return{id:e.class_id,name:e.class_name}}).value()},colorForMetric:function(e,t){if(t){var n=e/t;return n<.6?"rgba(218, 79, 73, 0.2)":n<.9?"rgba(250, 167, 50, 0.2)":"rgba(91, 183, 91, 0.2)"}return"rgb(219, 219, 219)"}});return a}),tadpoles.define("model/assessment/participationMetrics",["require","selfish","ko","lodash","model/printable"],function(e){var t=e("selfish"),n=e("ko"),r=e("lodash"),i=e("model/printable"),s=t.Base.extend({className:"AccountParticipationMetric",initialize:function(e){var t=this;t.name=e.name,t.assessmentComplete=t.formatPct(e.completionCounts.assessment_complete,e.completionCounts.total),t.assessmentMostlyComplete=t.formatPct(e.completionCounts.assessment_mostly_complete,e.completionCounts.total),t.assessmentStarted=t.formatPct(e.completionCounts.assessment_started,e.completionCounts.total),t.unassessed=t.formatPct(e.completionCounts.unassessed,e.completionCounts.total),t.assessmentCompleteColor=t.colorForMetric(e.completionCounts.assessment_complete,e.completionCounts.total),t.assessmentStartedColor=t.colorForMetric(e.completionCounts.assessment_started,e.completionCounts.total),t.unassessedColor=t.colorForMetric(e.completionCounts.unassessed,e.completionCounts.total)},formatPct:function(e,t){return t?(e/t*100).toFixed(0)+"%":"0%"},colorForMetric:function(e,t){if(t){var n=e/t;return n<.6?"#DA4F49":n<.9?"#FAA732":"#5bb75b"}return"#DA4F49"}}),o=t.Base.extend(i,{className:"ParticipationMetrics",initialize:function(e){var t=this;i.initialize.call(t,"assess-printable"),t.accountMetrics=n.observable(r(e).map(function(e,t){return s.create(r.size(e)?{name:t,completionCounts:r.reduce(e,function(e,t){return e.completion_counts.assessment_mostly_complete+=t.completion_counts.assessment_mostly_complete,e.completion_counts.assessment_complete+=t.completion_counts.assessment_complete,e.completion_counts.assessment_started+=t.completion_counts.assessment_started,e.completion_counts.unassessed+=t.completion_counts.unassessed,e.completion_counts.total+=t.completion_counts.total,e}).completion_counts}:{name:t,completionCounts:o.emptyCompletionCounts})}).sortBy("name").value())}});return o.emptyCompletionCounts={assessment_mostly_complete:0,assessment_complete:0,assessment_started:0,unassessed:0,total:0},o}),tadpoles.define("model/selectable",["require","selfish","ko","emit"],function(e){var t=e("selfish"),n=e("ko"),r=e("emit"),i=t.Base.extend({className:"Selectable",initialize:function(e){e=e||{},this.key=e.key,this.group=e.group,this.selected=n.observable(e.selected),this.selectedColor=e.selectedColor||"#FAA732",this.template=e.template,this.index=e.index},toggleSelection:function(){this.selected(!this.selected())},select:function(){this.selected(!0),this.group&&r.emit(this.group+"-selected",this)},deselect:function(){this.selected(!1)}});return i}),tadpoles.define("model/period",["require","lodash","ko","selfish","model/selectable","emit"],function(e){var t=e("lodash"),n=e("ko"),r=e("selfish"),i=e("model/selectable"),s=e("emit"),o=r.Base.extend(i,{className:"Period",initialize:function(e){e=e||{};var r=this;i.initialize.call(this,e),r.template="view/tiles/monthTile",this.id=e.id,this.name=n.observable(e.name),this.displayName=n.pureComputed(function(){if(!r.name())return;return r.name()[0].toUpperCase()+(r.name().length>1?r.name()[1]:"")}),this.fullName=n.pureComputed(function(){return r.name()});var s=new Date;t.isNumber(e.start_date)?s=new Date(e.start_date):e.start_date&&s.setISO8601(e.start_date),this.startDate=n.observable(s);var o=new Date;t.isNumber(e.end_date)?o=new Date(e.end_date):e.end_date&&o.setISO8601(e.end_date),this.endDate=n.observable(o),this.caption=n.observable(this.startDate().format("yyyy")),this.key=this.startDate().format("dd-mm-yyyy")+this.endDate().format("dd-mm-yyyy")},getLastDayOfPeriod:function(){return this.endDate().yesterday()}});return o.createPeriod=function(e,t,n,r,i,s){return o.create({id:e,name:t,start_date:n,end_date:r,group:i,selectedColor:s})},o}),tadpoles.define("model/month",["require","lodash","ko","selfish","model/period","emit"],function(e){var t=e("lodash"),n=e("ko"),r=e("selfish"),i=e("model/period"),s=e("emit"),o=r.Base.extend(i,{className:"Month",initialize:function(e){e=e||{};var t=this;i.initialize.call(this,e),t.template="view/tiles/monthTile",e.all?(t.caption(""),t.name("all"),t.startDate(new Date(0)),t.endDate(new Date)):(t.name(t.startDate().format("mmm").toLowerCase()),t.caption(t.startDate().format("yyyy"))),t.displayName=n.pureComputed(function(){return t.name()}),t.fullName=n.pureComputed(function(){return t.name()+" "+t.caption()}),t.key=e.all?"all":t.startDate().format("mm-yyyy")}});return o.createMonths=function(e,t,n,r){var i=new Date(t),s=new Date(e),u=new Date(i.getFullYear(),i.getMonth(),1),a=new Date(s.getFullYear(),s.getMonth(),1),f=[],l=new Date(u.getTime());while(l.getTime()>=a.getTime())f.push(o.create({start_date:(new Date(l.getTime())).getTime(),end_date:(new Date(l.getFullYear(),l.getMonth()+1,1,0,0,0,0)).getTime(),group:n,selectedColor:r})),l.setMonth(l.getMonth()-1);return f},o}),tadpoles.define("model/curriculaPeriods",["require","ko","services/config","selfish","model/product","model/month","model/period","model/selectable","model/user","emit","utilities","lodash"],function(e){var t=e("ko"),n=e("services/config"),r=e("selfish"),i=null,s=e("model/product"),o=e("model/month"),u=e("model/period"),a=e("model/selectable"),f=e("model/user"),l=e("emit"),c=e("utilities"),h=e("lodash"),p=r.Base.extend({className:"CurriculaPeriods",initialize:function(e){var n=this;n.selectedPeriod=t.observable(),l.on("curricula-loaded",function(){n.loadCurriculaPeriods()})},loadCurricula:function(e){var t=this;i=c.lazyLoadModule(i,"services/curricula"),i.getInstance().getCurriculaDeferred().done(function(n){t.loadCurriculaPeriods(),e(i.getInstance())})},loadCurriculaPeriods:function(){var e=this;i=c.lazyLoadModule(i,"services/curricula");var t=i.getInstance();e.customCurriculaPeriodsActive()&&e.curriculumPeriods(t.coreCurriculum().periods)},customCurriculaPeriodsActive:function(){return s.hasFeature(s.Features.FEATURE_CUSTOM_CURRICULA_PERIODS)},isMasterAccount:function(){var e=s.getFeature(s.Features.PLANNING_MASTER);return e?e.value["master-account"]===n.account.external_name:!0},curriculaPeriodSelectables:function(e){var t=this,n=e.omitAll?[]:[o.create({all:!0,group:e.group,selectedColor:e.selectedColor})];return n.push.apply(n,h(t.curriculumPeriods()).map(function(t){var n=u.create(h.assign({},t,e));return n}).sortBy(function(e){return e.startDate()}).reverse().each(function(e,t){e.index=t}).value()),!e.omitAdd&&(f.CurrentUser.isAccountAdmin()||f.CurrentUser.isCsr())&&t.isMasterAccount()&&n.push(a.create({key:"add",template:"view/tiles/addTile",group:e.group,selectedColor:e.selectedColor})),n},hasPeriods:function(){return this.customCurriculaPeriodsActive()&&this.curriculumPeriods()&&this.curriculumPeriods().length>0}});return p.curriculumPeriods=t.observable([]),p}),tadpoles.define("model/modal/editPeriodModal",["require","model/remote","services/modal","model/period","services/alerts","ko","lodash"],function(e){var t=e("model/remote"),n=e("services/modal"),r=e("model/period"),i=e("services/alerts"),s=e("ko"),o=e("lodash"),u=n.extend(t,{className:"EditPeriodModal",initialize:function(e){n.initialize.call(this,{template:"view/modals/editPeriods",width:"320px",model:this}),t.initialize.call(this,{path:"/remote/v1/curriculum/upsert_period",method:"post"});var r=this;r.observations=null,r.periodId=s.observable(),r.periodName=s.observable(),r.periodStartDate=s.observable(),r.periodEndDate=s.observable(),r.requestData=s.pureComputed(function(){if(!r.periodStartDate()||!r.periodEndDate())return;return{id:r.periodId(),name:r.periodName(),start_date:r.periodStartDate().f("yyyy-MM-dd"),end_date:r.periodEndDate().tomorrow().f("yyyy-MM-dd"),capture_time:Math.floor((new Date).getTime()/1e3),client_update_timestamp:(new Date).getTime()}})},deletePeriod:function(){var e=this;i.showYesNo({message:"Delete "+e.periodName()+"?",yes:function(){var t=e.requestData();t.deleted=!0,e.makeRequest({data:{period:s.toJSON(t)},success:function(t){var n=e.observations.curriculumPeriods(),r=o.findIndex(n,{id:t.id});r>-1&&(n.splice(r,1),e.observations.selectedPeriod(null),e.observations.curriculumPeriods(n))}}),e.close()}})},updatePeriod:function(){var e=this,t=[];e.periodName()||t.push("Name is required"),e.periodStartDate()||t.push("Start date is required"),e.periodEndDate()||t.push("End date is required");if(t.length){i.showAlert("Something is not quite right!","Please fix the following before continuing:","warning",t);return}e.makeRequest({data:{period:s.toJSON(this.requestData())},success:function(t){var n=e.observations.curriculumPeriods(),r=o.find(n,{id:t.id});r?(r.name=t.name,r.start_date=t.start_date,r.end_date=t.end_date):n.push(t),e.observations.curriculumPeriods(n)}}),e.close()},open:function(e,t){this.observations=e,t&&(this.periodId(t.id),this.periodName(t.name()),this.periodStartDate(t.startDate()),this.periodEndDate(t.endDate().yesterday())),n.open.call(this)},close:function(){this.reset(),n.close.call(this)},reset:function(){this.periodId(null),this.periodName(null),this.periodStartDate(null),this.periodEndDate(null)}});return u}),tadpoles.define("model/observationMetrics",["require","ko","selfish","lodash","services/config","model/remote","model/assessment/assessmentMetrics","model/assessment/participationMetrics","model/month","emit","model/globalFilter","model/curriculaPeriods","model/modal/editPeriodModal","model/product","model/planningMaster","utilities"],function(e){var t=e("ko"),n=e("selfish"),r=e("lodash"),i=e("services/config"),s=e("model/remote"),o=e("model/assessment/assessmentMetrics"),u=e("model/assessment/participationMetrics"),a=e("model/month"),f=e("emit"),l=e("model/globalFilter"),c=e("model/curriculaPeriods"),h=e("model/modal/editPeriodModal"),p=e("model/product"),d=e("model/planningMaster"),v=e("utilities"),m={INDIVIDUAL:"individual",PROGRESS:"progress",PARTICIPATION:"participation",GROWTH:"growth"},g=h.create({}),y=n.Base.extend(c,d,{className:"ObservationMetrics",initialize:function(e){var n=this;c.initialize.call(this,{}),d.initialize.call(n),n.loading=!1,n.totalChildren=t.observable("-"),n.unassessed=t.observable("-"),n.assessmentStarted=t.observable("-"),n.assessmentComplete=t.observable("-"),n.assessmentMostlyComplete=t.observable("-"),n.assessmentMetricsForCurricula=t.observable([]),n.activeCurriculumId=t.observable(),n.activeCurriculumName=t.observable(),n.ratingCount=t.pureComputed(function(){return r(n.assessmentMetricsForCurricula()).map(function(e){return e.ratingCount()}).reduce(function(e,t){return e+t})}),n.assessmentMetrics=t.observable(),n.assessmentMetrics.subscribe(function(e){n.portfolioViewType()===m.PROGRESS&&n.updateRollupStats(e||n.rollupAccountAssessmentMetrics())}),n.participationMetrics=t.observable(),n.rollupAccountAssessmentMetrics=function(){var e={curriculumName:n.isCurriculaMetricAccountGroupMaster()?i.account.external_name:l.location().name,totalChildren:0,unassessed:0,assessmentStarted:0,assessmentMostlyComplete:0,assessmentComplete:0};return n.assessmentMetricsForCurricula().length&&n.portfolioViewType()===m.PROGRESS?r.each(n.assessmentMetricsForCurricula(),function(t){e.totalChildren+=t.totalChildren,e.unassessed+=t.unassessed,e.assessmentStarted+=t.assessmentStarted,e.assessmentMostyComplete+=t.assessmentMostyComplete,e.assessmentComplete+=t.assessmentComplete}):(e.totalChildren="-",e.unassessed="-",e.assessmentStarted="-",e.assessmentMostlyComplete="-",e.assessmentComplete="-"),e},n.portfolioViewType=t.observable(),n.portfolioViewType.subscribe(function(e){e!==m.PROGRESS&&(n.totalChildren("-"),n.unassessed("-"),n.assessmentStarted("-"),n.assessmentMostlyComplete("-"),n.assessmentComplete("-"))}),n.portfolioViewType(n.isCurriculaMetricAccountGroupMaster()&&n.customCurriculaPeriodsActive()?m.PROGRESS:m.INDIVIDUAL),n.isPortfolioIndividualView=t.pureComputed(function(){return n.portfolioViewType()===m.INDIVIDUAL}),n.isPortfolioProgressView=t.pureComputed(function(){return n.portfolioViewType()===m.PROGRESS}),n.isPortfolioParticipationView=t.pureComputed(function(){return n.portfolioViewType()===m.PARTICIPATION}),n.isPortfolioGrowthView=t.pureComputed(function(){return n.portfolioViewType()===m.GROWTH}),n.chooseIndividialView=function(){n.portfolioViewType(m.INDIVIDUAL)},n.chooseProgressView=function(){n.portfolioViewType(m.PROGRESS),n.participationMetrics(null)},n.chooseParticipationView=function(){n.portfolioViewType(m.PARTICIPATION)},n.chooseGrowthView=function(){n.portfolioViewType(m.GROWTH),!n.selectedDeltaPeriod()&&n.assessmentMetrics()&&n.assessmentMetrics().clearRatings()},n.reportVisible=t.pureComputed(function(){return(n.activeCurriculumId()||n.isPortfolioParticipationView())&&n.hasPeriods()}),n.assessmentClasses=t.observable([]),n.selectedDeltaPeriod=t.observable(),f.on("obs-metric-month-selected",function(e){if(e.key==="add"){g.open(n);return}n.selectedPeriod(e.key!=="all"?e:null);if(!n.periods)return;r.each(n.periods(),function(t,n){t.key!==e.key&&t.deselect()})}),n.periods=t.computed(function(){if(n.customCurriculaPeriodsActive())return n.curriculaPeriodSelectables({group:"obs-metric-month",omitAll:!0});var e=new Date;e.setFullYear(e.getFullYear()-1);var t=a.createMonths(e.getTime(),(new Date).getTime(),"obs-metric-month");return t[0].select(),t}),n.periods.subscribe(function(e){var t=r.findIndex(e,function(e){return e.selected()});if(t===-1){var n=(new Date).getTime();r.each(e,function(e){e.startDate&&e.startDate().getTime()<=n&&e.endDate().getTime()>n&&e.select()})}}),n.clearDeltaPeriodSelection=function(e){if(!n.deltaPeriods)return;r.each(n.deltaPeriods(),function(t){t.key!==e.key&&t.deselect()})},f.on("obs-metric-month-delta-selected",function(e){n.selectedDeltaPeriod(e.key!=="all"?e:null),n.clearDeltaPeriodSelection(e)}),n.deltaPeriods=t.computed(function(){if(n.customCurriculaPeriodsActive())return n.curriculaPeriodSelectables({group:"obs-metric-month-delta",selectedColor:"#5bb75b",omitAdd:!0,omitAll:!0});var e=new Date;e.setFullYear(e.getFullYear()-1);var t=a.createMonths(e.getTime(),(new Date).getTime(),"obs-metric-month-delta","#5bb75b");return t[1].select(),t}),n.deltaPeriods.subscribe(function(e){var t=r.findIndex(e,function(e){return e.selected()});t===-1&&n.selectedPeriod()&&n.selectedPeriod().index+1<n.deltaPeriods().length&&n.deltaPeriods()[n.selectedPeriod().index+1].select()}),n.reportHeader=t.pureComputed(function(){if(!l.location()||!n.selectedPeriod())return;var e=n.selectedPeriod().name();return n.portfolioViewType()===m.GROWTH&&n.selectedDeltaPeriod()&&(e+=" to "+n.selectedDeltaPeriod().name()),n.portfolioViewType()!==m.PARTICIPATION&&(e+=" - "+l.location().name,l.group()&&l.group().key!=="all"&&(e+=", "+l.group().name()+" room")),e}),n.handleParticipation=function(e){n.participationMetrics(e)},n.editPeriod=function(){g.open(n,n.selectedPeriod())},n.printReport=function(){n.portfolioViewType()===m.PARTICIPATION&&n.participationMetrics()?n.participationMetrics().print():n.assessmentMetrics()&&n.assessmentMetrics().print()},n.loadAssessmentMetrics=t.computed(function(){if(!l.location()||n.portfolioViewType()===m.INDIVIDUAL||!n.selectedPeriod()||n.portfolioViewType()===m.GROWTH&&!n.selectedDeltaPeriod())return;var e={type:n.portfolioViewType()===m.PROGRESS||n.portfolioViewType()===m.PARTICIPATION?"progress":"growth",location_key:l.location().key};e.sum=n.portfolioViewType()!==m.PARTICIPATION,n.selectedPeriod()&&(e.end_date=n.selectedPeriod().endDate().format("isoDate"),e.start_date=n.selectedPeriod().startDate().format("isoDate"));if(n.selectedDeltaPeriod()&&n.selectedPeriod()&&n.portfolioViewType()===m.GROWTH){var t=r.sortBy([n.selectedPeriod(),n.selectedDeltaPeriod()],function(e){return e.startDate().format("isoDate")});e.start_date=t[1].startDate().format("isoDate"),e.end_date=t[1].endDate().format("isoDate"),e.delta_start_date=t[0].startDate().format("isoDate"),e.delta_end_date=t[0].endDate().format("isoDate")}if(n.loading)return;n.loading=!0,n.assessmentMetricsLoader.makeRequest({data:e,success:function(e){if(n.portfolioViewType()===m.PARTICIPATION){n.handleParticipation(u.create(e));return}n.assessmentMetricsForCurricula(r.map(e,function(e){return o.create(e)})),f.emit("rating-metric-filter-change",{metricType:n.portfolioViewType()}),n.activeCurriculumId()?n.selectCurriculum(n.activeCurriculumId()):n.updateRollupStats(n.rollupAccountAssessmentMetrics())},complete:function(){n.loading=!1}})}),n.assessmentMetricsLoader=s.create({path:"/remote/v1/assessment/metrics",method:"get"}),f.on("class-filter-changed",function(e){if(!l.group())return;var t=l.group().curriculumId();t&&n.activeCurriculumId()!==t&&n.selectCurriculum(t),l.group().key==="all"?(n.activeCurriculumId(null),n.updateRollupStats(n.rollupAccountAssessmentMetrics())):n.assessmentMetrics()&&n.portfolioViewType()===m.PROGRESS&&n.updateRollupStats(n.assessmentMetrics())})},selectCurriculum:function(e){this.activeCurriculumId(e),this.assessmentMetrics(r.find(this.assessmentMetricsForCurricula(),{curriculumId:e}))},updateRollupStats:function(e){var t=this;t.activeCurriculumName(e.curriculumName),t.totalChildren(e.totalChildren),t.unassessed(e.unassessed),t.assessmentStarted(e.assessmentStarted),t.assessmentMostlyComplete(e.assessmentMostlyComplete),t.assessmentComplete(e.assessmentComplete)}});return y.PortfolioViewTypes=m,v.makeSingleton(y)}),tadpoles.define("services/groups",["require","ko","lodash","services/config","selfish","emit","utilities","model/globalFilter","model/user","model/product","model/remote","model/detailViewPanel","model/observationMetrics","model/status","services/disposer"],function(e){function m(e,t){var r=e.sortableValue(),i=t.sortableValue();return r<i?-1:r>i?1:r===i?0:n.isString(r)&&n.isNumber(i)?1:n.isNumber(r)&&n.isString(i)?-1:0}var t=e("ko"),n=e("lodash"),r=e("services/config"),i=e("selfish"),s=e("emit"),o=e("utilities"),u=e("model/globalFilter"),a=null,f=e("model/user"),l=e("model/product"),c=e("model/remote"),h=e("model/detailViewPanel"),p=e("model/observationMetrics"),d=e("model/status"),v=e("services/disposer"),g=i.Base.extend({className:"Groups",initialize:function(i){var a=this,c=o.lazyLoadModule(c,"model/group");a.groups=t.observableArray(),a.simpleGroupCache={},a.showInactiveGroups=t.observable(!1),a.groups.subscribe(function(e){if(e.length>0){var t=e[0].location_key();a.getSimpleGroupsForLocation(t,!0)(n.map(e,function(e){return{key:e.key,name:e.name(),child_type:e.child_type(),isActive:e.isActive()}}))}}),a.groupsByKey=t.pureComputed(function(){var e={};return n.each(a.groups(),function(t){e[t.key]=t}),e}),a.groupsForCurrentLocation=t.pureComputed(function(){return n.filter(a.groups(),function(e){return(a.showInactiveGroups()||e.isActive())&&(!f.CurrentUser.classroom()||f.CurrentUser.classroom()===e.key)}).sort(m)}),a.allGroupsForCurrentLocation=t.pureComputed(function(){return n.filter(a.groups(),function(e){return(a.showInactiveGroups()||e.isActive())&&e.isInLocation(u.location())}).sort(m)}),a.allGroups=t.pureComputed(function(){return n.filter(a.groups(),function(e){return a.showInactiveGroups()||e.isActive()}).sort(m)}),a.simpleGroupsForAllLocations=t.pureComputed(function(){return l.hasFeature(l.Features.COPY_LESSON_LOCATION)?n(r.locations).map(function(e){return a.getSimpleGroupsForLocation(e.key)()}).flatten().value():[]}),a.simpleGroupsForAllLocations(),a.allGroup=c.create({name:"All",key:"all"}),a.groupsForLocationDisplay=t.pureComputed(function(){var e=a.groupsForCurrentLocation().slice(0);return f.CurrentUser.classroom()||e.splice(0,0,a.allGroup),h.getInstance().portfolioActive()&&!p.getInstance().isPortfolioIndividualView()&&(e=n.filter(e,function(e){return e.key==="all"||e.curriculumId()})),e}),a.groupsForCurrentLocationWithChildren=t.pureComputed(function(){var e=a.groupsForCurrentLocation().slice(0),t=n.filter(e,function(e){return e.hasChildrenAssignedToHomeroom()});return s.emit("groups-for-current-location-w-children-updated",{}),t}),a.allForCurrentLocationWithChildren=t.pureComputed(function(){var e=a.groupsForCurrentLocationWithChildren().slice(0);return f.CurrentUser.classroom()||e.splice(0,0,a.allGroup),e}),u.location.subscribe(a.load),s.on("class-update-received",function(e){if(e.action==="upsert"){var r=c.create(e.object),i=n.find(a.groups(),{key:r.key});i?(a.groups.valueWillMutate(),i.name(r.name()),i.status(r.status()),i.child_type(r.child_type()),i.curriculumId(r.curriculumId()),i.sort(r.sort()),i.ratio1(r.ratio1()),i.ratio2(r.ratio2()),i.capacity(r.capacity()),a.groups.valueHasMutated()):a.groups.push(r),r.status()==="inactive"&&s.emit("class-deleted",t.toJS(a))}})},toggleInactiveClasses:function(){this.showInactiveGroups(!this.showInactiveGroups())},reset:function(){v.fastDispose(this.groups()),this.groups([])},getSimpleGroupsForLocation:function(n,r){return this.simpleGroupCache[n]||(this.simpleGroupCache[n]=t.observableArray(),!r&&n&&this.loadSimpleGroupsForLocation(n,this.simpleGroupCache[n])),this.simpleGroupCache[n]},getActiveSimpleGroupsForLocation:function(t,r){var i=this.getSimpleGroupsForLocation(t)();return n(i).filter(function(e){return e.isActive}).value()},getGroup:function(t){return this.groupsByKey()[t]},addGroup:function(t){if(this.getGroup(t.key))return;this.groups.push(t)},defaultGroup:function(){this.groupsForCurrentLocation()&&this.groupsForCurrentLocation().length===1?u.group(this.groupsForCurrentLocation()[0]):u.group(this.allGroup)},groupsInSameStage:function(t){var r=this,i=[t];if(!t.isLocation()){var s;l.hasFeature(l.Features.COPY_LESSON_LOCATION)?s=r.simpleGroupsForAllLocations():s=r.getSimpleGroupsForLocation(u.location().key)();var o=n(s).filter(function(e){return e.isActive&&e.key!==t.key&&e.child_type===t.child_type()}).value();i=i.concat(o)}return i},loadLocal:function(){var t=o.lazyLoadModule(t,"model/group");this.groups(n.map([{key:"demoInfants",name:"Turtles",child_type:"infant",curriculum_id:"infant",location_key:"demoLocationKey",capacity:6},{key:"demoToddlers",name:"Cubs",child_type:"toddler",curriculum_id:"toddler",location_key:"demoLocationKey",capacity:8},{key:"demoPreschool",name:"Tigers",child_type:"preschool",curriculum_id:"preschool",location_key:"demoLocationKey",capacity:10},{key:"demoSchool",name:"Bears",child_type:"school",location_key:"demoLocationKey",capacity:10},{key:"demoSchool2",name:"Giraffes",child_type:"school",curriculum_id:"school",location_key:"demoLocationKey",capacity:12}],function(e){return t.create(e)}))},loadRemote:function(){var t=o.lazyLoadModule(t,"model/group"),r=this,i=c.create({path:"/remote/v1/class?location="+u.location().key+"&include_inactive=True",success:function(e){r.groups(n.map(e,function(e){return t.create(e)})),r.defaultGroup()}});i.makeRequest()},loadSimpleGroupsForLocation:function(t,r){var i=c.create({path:"/remote/v1/class?location="+t,success:function(e){r(n.map(e,function(e){return{key:e.key,name:e.name,child_type:e.child_type}}))}});i.makeRequest()},load:function(){this.reset(),r.isDemo?this.loadLocal():this.loadRemote()}});return o.makeSingleton(g)}),tadpoles.define("jstz",["require"],function(e){var t=function(){var e="s",n={DAY:864e5,HOUR:36e5,MINUTE:6e4,SECOND:1e3,BASELINE_YEAR:2014,MAX_SCORE:864e6,AMBIGUITIES:{"America/Denver":["America/Mazatlan"],"Europe/London":["Africa/Casablanca"],"America/Chicago":["America/Mexico_City"],"America/Asuncion":["America/Campo_Grande","America/Santiago"],"America/Montevideo":["America/Sao_Paulo","America/Santiago"],"Asia/Beirut":["Asia/Amman","Asia/Jerusalem","Europe/Helsinki","Asia/Damascus","Africa/Cairo","Asia/Gaza","Europe/Minsk"],"Pacific/Auckland":["Pacific/Fiji"],"America/Los_Angeles":["America/Santa_Isabel"],"America/New_York":["America/Havana"],"America/Halifax":["America/Goose_Bay"],"America/Godthab":["America/Miquelon"],"Asia/Dubai":["Asia/Yerevan"],"Asia/Jakarta":["Asia/Krasnoyarsk"],"Asia/Shanghai":["Asia/Irkutsk","Australia/Perth"],"Australia/Sydney":["Australia/Lord_Howe"],"Asia/Tokyo":["Asia/Yakutsk"],"Asia/Dhaka":["Asia/Omsk"],"Asia/Baku":["Asia/Yerevan"],"Australia/Brisbane":["Asia/Vladivostok"],"Pacific/Noumea":["Asia/Vladivostok"],"Pacific/Majuro":["Asia/Kamchatka","Pacific/Fiji"],"Pacific/Tongatapu":["Pacific/Apia"],"Asia/Baghdad":["Europe/Minsk","Europe/Moscow"],"Asia/Karachi":["Asia/Yekaterinburg"],"Africa/Johannesburg":["Asia/Gaza","Africa/Cairo"]}},r=function(t){var n=-t.getTimezoneOffset();return n!==null?n:0},i=function(){var i=r(new Date(n.BASELINE_YEAR,0,2)),s=r(new Date(n.BASELINE_YEAR,5,2)),o=i-s;return o<0?i+",1":o>0?s+",1,"+e:i+",0"},s=function(){var t,n;if(typeof Intl=="undefined"||typeof Intl.DateTimeFormat=="undefined")return;t=Intl.DateTimeFormat();if(typeof t=="undefined"||typeof t.resolvedOptions=="undefined")return;n=t.resolvedOptions().timeZone;if(n&&(n.indexOf("/")>-1||n==="UTC"))return n},o=function(t){var n=(new Date(t,0,1,0,0,1,0)).getTime(),r=(new Date(t,12,31,23,59,59)).getTime(),i=n,s=(new Date(i)).getTimezoneOffset(),o=null,a=null;while(i<r-864e5){var f=new Date(i),l=f.getTimezoneOffset();l!==s&&(l<s&&(o=f),l>s&&(a=f),s=l),i+=864e5}return o&&a?{s:u(o).getTime(),e:u(a).getTime()}:!1},u=function h(e,t,r){typeof t=="undefined"&&(t=n.DAY,r=n.HOUR);var i=(new Date(e.getTime()-t)).getTime(),s=e.getTime()+t,o=(new Date(i)).getTimezoneOffset(),u=i,a=null;while(u<s-r){var f=new Date(u),l=f.getTimezoneOffset();if(l!==o){a=f;break}u+=r}return t===n.DAY?h(a,n.HOUR,n.MINUTE):t===n.HOUR?h(a,n.MINUTE,n.SECOND):a},a=function(t,n,r,i){if(r!=="N/A")return r;if(n==="Asia/Beirut"){if(i.name==="Africa/Cairo"&&t[6].s===13983768e5&&t[6].e===14116788e5)return 0;if(i.name==="Asia/Jerusalem"&&t[6].s===13959648e5&&t[6].e===14118588e5)return 0}else if(n==="America/Santiago"){if(i.name==="America/Asuncion"&&t[6].s===14124816e5&&t[6].e===1397358e6)return 0;if(i.name==="America/Campo_Grande"&&t[6].s===14136912e5&&t[6].e===13925196e5)return 0}else if(n==="America/Montevideo"){if(i.name==="America/Sao_Paulo"&&t[6].s===14136876e5&&t[6].e===1392516e6)return 0}else if(n==="Pacific/Auckland"&&i.name==="Pacific/Fiji"&&t[6].s===14142456e5&&t[6].e===13961016e5)return 0;return r},f=function(r,i){var s=function(t){var s=0;for(var o=0;o<r.length;o++)if(!!t.rules[o]&&!!r[o]){if(!(r[o].s>=t.rules[o].s&&r[o].e<=t.rules[o].e)){s="N/A";break}s=0,s+=Math.abs(r[o].s-t.rules[o].s),s+=Math.abs(t.rules[o].e-r[o].e);if(s>n.MAX_SCORE){s="N/A";break}}return s=a(r,i,s,t),s},o={},u=t.olson.dst_rules.zones,f=u.length,l=n.AMBIGUITIES[i];for(var c=0;c<f;c++){var h=u[c],p=s(u[c]);p!=="N/A"&&(o[h.name]=p)}for(var d in o)if(o.hasOwnProperty(d))for(var v=0;v<l.length;v++)if(l[v]===d)return d;return i},l=function(n){var r=function(){var n=[];for(var r=0;r<t.olson.dst_rules.years.length;r++){var i=o(t.olson.dst_rules.years[r]);n.push(i)}return n},i=function(t){for(var n=0;n<t.length;n++)if(t[n]!==!1)return!0;return!1},s=r(),u=i(s);return u?f(s,n):n},c=function(){var r=s();return r||(r=t.olson.timezones[i()],typeof n.AMBIGUITIES[r]!="undefined"&&(r=l(r))),{name:function(){return r}}};return{determine:c}}();return t.olson=t.olson||{},t.olson.timezones={"-720,0":"Etc/GMT+12","-660,0":"Pacific/Pago_Pago","-660,1,s":"Pacific/Apia","-600,1":"America/Adak","-600,0":"Pacific/Honolulu","-570,0":"Pacific/Marquesas","-540,0":"Pacific/Gambier","-540,1":"America/Anchorage","-480,1":"America/Los_Angeles","-480,0":"Pacific/Pitcairn","-420,0":"America/Phoenix","-420,1":"America/Denver","-360,0":"America/Guatemala","-360,1":"America/Chicago","-360,1,s":"Pacific/Easter","-300,0":"America/Bogota","-300,1":"America/New_York","-270,0":"America/Caracas","-240,1":"America/Halifax","-240,0":"America/Santo_Domingo","-240,1,s":"America/Asuncion","-210,1":"America/St_Johns","-180,1":"America/Godthab","-180,0":"America/Argentina/Buenos_Aires","-180,1,s":"America/Montevideo","-120,0":"America/Noronha","-120,1":"America/Noronha","-60,1":"Atlantic/Azores","-60,0":"Atlantic/Cape_Verde","0,0":"UTC","0,1":"Europe/London","60,1":"Europe/Berlin","60,0":"Africa/Lagos","60,1,s":"Africa/Windhoek","120,1":"Asia/Beirut","120,0":"Africa/Johannesburg","180,0":"Asia/Baghdad","180,1":"Europe/Moscow","210,1":"Asia/Tehran","240,0":"Asia/Dubai","240,1":"Asia/Baku","270,0":"Asia/Kabul","300,1":"Asia/Yekaterinburg","300,0":"Asia/Karachi","330,0":"Asia/Kolkata","345,0":"Asia/Kathmandu","360,0":"Asia/Dhaka","360,1":"Asia/Omsk","390,0":"Asia/Rangoon","420,1":"Asia/Krasnoyarsk","420,0":"Asia/Jakarta","480,0":"Asia/Shanghai","480,1":"Asia/Irkutsk","525,0":"Australia/Eucla","525,1,s":"Australia/Eucla","540,1":"Asia/Yakutsk","540,0":"Asia/Tokyo","570,0":"Australia/Darwin","570,1,s":"Australia/Adelaide","600,0":"Australia/Brisbane","600,1":"Asia/Vladivostok","600,1,s":"Australia/Sydney","630,1,s":"Australia/Lord_Howe","660,1":"Asia/Kamchatka","660,0":"Pacific/Noumea","690,0":"Pacific/Norfolk","720,1,s":"Pacific/Auckland","720,0":"Pacific/Majuro","765,1,s":"Pacific/Chatham","780,0":"Pacific/Tongatapu","780,1,s":"Pacific/Apia","840,0":"Pacific/Kiritimati"},t.olson.dst_rules={years:[2008,2009,2010,2011,2012,2013,2014],zones:[{name:"Africa/Cairo",rules:[{e:12199572e5,s:12090744e5},{e:1250802e6,s:1240524e6},{e:12858804e5,s:12840696e5},!1,!1,!1,{e:14116788e5,s:1406844e6}]},{name:"Africa/Casablanca",rules:[{e:12202236e5,s:12122784e5},{e:12508092e5,s:12438144e5},{e:1281222e6,s:12727584e5},{e:13120668e5,s:13017888e5},{e:13489704e5,s:1345428e6},{e:13828392e5,s:13761e8},{e:14142888e5,s:14069448e5}]},{name:"America/Asuncion",rules:[{e:12050316e5,s:12243888e5},{e:12364812e5,s:12558384e5},{e:12709548e5,s:12860784e5},{e:13024044e5,s:1317528e6},{e:1333854e6,s:13495824e5},{e:1364094e6,s:1381032e6},{e:13955436e5,s:14124816e5}]},{name:"America/Campo_Grande",rules:[{e:12032172e5,s:12243888e5},{e:12346668e5,s:12558384e5},{e:12667212e5,s:1287288e6},{e:12981708e5,s:13187376e5},{e:13302252e5,s:1350792e6},{e:136107e7,s:13822416e5},{e:13925196e5,s:14136912e5}]},{name:"America/Goose_Bay",rules:[{e:122559486e4,s:120503526e4},{e:125704446e4,s:123648486e4},{e:128909886e4,s:126853926e4},{e:13205556e5,s:129998886e4},{e:13520052e5,s:13314456e5},{e:13834548e5,s:13628952e5},{e:14149044e5,s:13943448e5}]},{name:"America/Havana",rules:[{e:12249972e5,s:12056436e5},{e:12564468e5,s:12364884e5},{e:12885012e5,s:12685428e5},{e:13211604e5,s:13005972e5},{e:13520052e5,s:13332564e5},{e:13834548e5,s:13628916e5},{e:14149044e5,s:13943412e5}]},{name:"America/Mazatlan",rules:[{e:1225008e6,s:12074724e5},{e:12564576e5,s:1238922e6},{e:1288512e6,s:12703716e5},{e:13199616e5,s:13018212e5},{e:13514112e5,s:13332708e5},{e:13828608e5,s:13653252e5},{e:14143104e5,s:13967748e5}]},{name:"America/Mexico_City",rules:[{e:12250044e5,s:12074688e5},{e:1256454e6,s:12389184e5},{e:12885084e5,s:1270368e6},{e:1319958e6,s:13018176e5},{e:13514076e5,s:13332672e5},{e:13828572e5,s:13653216e5},{e:14143068e5,s:13967712e5}]},{name:"America/Miquelon",rules:[{e:12255984e5,s:12050388e5},{e:1257048e6,s:12364884e5},{e:12891024e5,s:12685428e5},{e:1320552e6,s:12999924e5},{e:13520016e5,s:1331442e6},{e:13834512e5,s:13628916e5},{e:14149008e5,s:13943412e5}]},{name:"America/Santa_Isabel",rules:[{e:12250116e5,s:1207476e6},{e:12564612e5,s:12389256e5},{e:12885156e5,s:12703752e5},{e:13199652e5,s:13018248e5},{e:13514148e5,s:13332744e5},{e:13828644e5,s:13653288e5},{e:1414314e6,s:13967784e5}]},{name:"America/Santiago",rules:[{e:1206846e6,s:1223784e6},{e:1237086e6,s:12552336e5},{e:127035e7,s:12866832e5},{e:13048236e5,s:13138992e5},{e:13356684e5,s:13465584e5},{e:1367118e6,s:13786128e5},{e:13985676e5,s:14100624e5}]},{name:"America/Sao_Paulo",rules:[{e:12032136e5,s:12243852e5},{e:12346632e5,s:12558348e5},{e:12667176e5,s:12872844e5},{e:12981672e5,s:1318734e6},{e:13302216e5,s:13507884e5},{e:13610664e5,s:1382238e6},{e:1392516e6,s:14136876e5}]},{name:"Asia/Amman",rules:[{e:1225404e6,s:12066552e5},{e:12568536e5,s:12381048e5},{e:12883032e5,s:12695544e5},{e:13197528e5,s:13016088e5},!1,!1,{e:14147064e5,s:13959576e5}]},{name:"Asia/Damascus",rules:[{e:12254868e5,s:120726e7},{e:125685e7,s:12381048e5},{e:12882996e5,s:12701592e5},{e:13197492e5,s:13016088e5},{e:13511988e5,s:13330584e5},{e:13826484e5,s:1364508e6},{e:14147028e5,s:13959576e5}]},{name:"Asia/Dubai",rules:[!1,!1,!1,!1,!1,!1,!1]},{name:"Asia/Gaza",rules:[{e:12199572e5,s:12066552e5},{e:12520152e5,s:12381048e5},{e:1281474e6,s:126964086e4},{e:1312146e6,s:130160886e4},{e:13481784e5,s:13330584e5},{e:13802292e5,s:1364508e6},{e:1414098e6,s:13959576e5}]},{name:"Asia/Irkutsk",rules:[{e:12249576e5,s:12068136e5},{e:12564072e5,s:12382632e5},{e:12884616e5,s:12697128e5},!1,!1,!1,!1]},{name:"Asia/Jerusalem",rules:[{e:12231612e5,s:12066624e5},{e:1254006e6,s:1238112e6},{e:1284246e6,s:12695616e5},{e:131751e7,s:1301616e6},{e:13483548e5,s:13330656e5},{e:13828284e5,s:13645152e5},{e:1414278e6,s:13959648e5}]},{name:"Asia/Kamchatka",rules:[{e:12249432e5,s:12067992e5},{e:12563928e5,s:12382488e5},{e:12884508e5,s:12696984e5},!1,!1,!1,!1]},{name:"Asia/Krasnoyarsk",rules:[{e:12249612e5,s:12068172e5},{e:12564108e5,s:12382668e5},{e:12884652e5,s:12697164e5},!1,!1,!1,!1]},{name:"Asia/Omsk",rules:[{e:12249648e5,s:12068208e5},{e:12564144e5,s:12382704e5},{e:12884688e5,s:126972e7},!1,!1,!1,!1]},{name:"Asia/Vladivostok",rules:[{e:12249504e5,s:12068064e5},{e:12564e8,s:1238256e6},{e:12884544e5,s:12697056e5},!1,!1,!1,!1]},{name:"Asia/Yakutsk",rules:[{e:1224954e6,s:120681e7},{e:12564036e5,s:12382596e5},{e:1288458e6,s:12697092e5},!1,!1,!1,!1]},{name:"Asia/Yekaterinburg",rules:[{e:12249684e5,s:12068244e5},{e:1256418e6,s:1238274e6},{e:12884724e5,s:12697236e5},!1,!1,!1,!1]},{name:"Asia/Yerevan",rules:[{e:1224972e6,s:1206828e6},{e:12564216e5,s:12382776e5},{e:1288476e6,s:12697272e5},{e:13199256e5,s:13011768e5},!1,!1,!1]},{name:"Australia/Lord_Howe",rules:[{e:12074076e5,s:12231342e5},{e:12388572e5,s:12545838e5},{e:12703068e5,s:12860334e5},{e:13017564e5,s:1317483e6},{e:1333206e6,s:13495374e5},{e:13652604e5,s:1380987e6},{e:139671e7,s:14124366e5}]},{name:"Australia/Perth",rules:[{e:12068136e5,s:12249576e5},!1,!1,!1,!1,!1,!1]},{name:"Europe/Helsinki",rules:[{e:12249828e5,s:12068388e5},{e:12564324e5,s:12382884e5},{e:12884868e5,s:1269738e6},{e:13199364e5,s:13011876e5},{e:1351386e6,s:13326372e5},{e:13828356e5,s:13646916e5},{e:14142852e5,s:13961412e5}]},{name:"Europe/Minsk",rules:[{e:12249792e5,s:12068352e5},{e:12564288e5,s:12382848e5},{e:12884832e5,s:12697344e5},!1,!1,!1,!1]},{name:"Europe/Moscow",rules:[{e:12249756e5,s:12068316e5},{e:12564252e5,s:12382812e5},{e:12884796e5,s:12697308e5},!1,!1,!1,!1]},{name:"Pacific/Apia",rules:[!1,!1,!1,{e:13017528e5,s:13168728e5},{e:13332024e5,s:13489272e5},{e:13652568e5,s:13803768e5},{e:13967064e5,s:14118264e5}]},{name:"Pacific/Fiji",rules:[!1,!1,{e:12696984e5,s:12878424e5},{e:13271544e5,s:1319292e6},{e:1358604e6,s:13507416e5},{e:139005e7,s:1382796e6},{e:14215032e5,s:14148504e5}]},{name:"Europe/London",rules:[{e:12249828e5,s:12068388e5},{e:12564324e5,s:12382884e5},{e:12884868e5,s:1269738e6},{e:13199364e5,s:13011876e5},{e:1351386e6,s:13326372e5},{e:13828356e5,s:13646916e5},{e:14142852e5,s:13961412e5}]}]},t}),tadpoles.define("model/updateable",["require","selfish","lodash"],function(e){var t=e("selfish"),n=e("lodash"),r=t.Base.extend({className:"Updateable",initialize:function(){},updateProperty:function(e,t){n.has(this,e)&&(n.isFunction(this[e])?this[e](t):this[e]=t)}});return r}),tadpoles.define("model/imageTile",["require","selfish","ko","services/config"],function(e){var t=e("selfish"),n=e("ko"),r=e("services/config"),i=t.Base.extend({className:"ImageTile",initialize:function(e){e=e||{};var t=r.baseUrl+"/remote/v1/attachment?key=",i=this;i.attachmentKey=n.observable(),i.defaultImageFunction=n.observable(function(){return"/images/1/profile/contact.png"}),i.defaultImage=n.pureComputed(function(){return i.defaultImageFunction()()}),i.backgroundImage=n.pureComputed(function(){var e=i.attachmentKey();if(e)return e.indexOf("demo")===0?"url('/images/1/demo/"+e+"_small.jpg')":"url('"+t+e+"&thumbnail=true')";var n=i.defaultImage();return n?"url('"+r.baseUrl+i.defaultImage()+"')":null}),i.smallImageUrl=n.pureComputed(function(){var e=i.attachmentKey();return e?e.indexOf("demo")===0?"/images/1/demo/"+e+"_small.jpg":t+e+"&thumbnail=true":r.baseUrl+i.defaultImage()}),i.largeImage=n.pureComputed(function(){var e=i.attachmentKey(),n;return e?e.indexOf("demo")===0?n="/images/1/demo/"+e+"_large.jpg":n=t+e:n=r.baseUrl+i.defaultImage(),n})},dispose:function(){var e=this;e.defaultImage.dispose(),e.backgroundImage.dispose(),e.smallImageUrl.dispose(),e.largeImage.dispose()}});return i}),tadpoles.define("model/absenceForm",["require","selfish","ko","lodash","services/config","model/form","utilities","services/uuid","model/globalFilter","jstz","services/alerts","model/remote","emit"],function(e){var t=e("selfish"),n=e("ko"),r=e("lodash"),i=e("services/config"),s=e("model/form"),o=e("utilities"),u=e("services/uuid"),a=e("model/globalFilter");e("jstz");var f=e("services/alerts"),l=e("model/remote"),c=e("emit"),h=null,p={SICK:"sick",VACATION:"vacation",OTHER:"excused"},d=t.Base.extend({className:"AbsenceRow",initialize:function(e){e=e||{},this.id=n.observable(u.short()),this.startDate=e.start_date,this.returnDate=e.return_date,this.type=e.type,this.reason=e.reason,this.excused=e.excused},absenceTextStart:function(){return(this.type==="excused"?"other":this.type)+": "+this.startDate.format("shortDate")},absenceTextEnd:function(){var e="";return this.returnDate&&(e=this.returnDate.format("shortDate")),this.excused||(e+=" (unexcused)"),e},includesToday:function(){var e=Date.now();return e>=this.startDate&&e<this.returnDate}}),v=s.extend({className:"AbsenceForm",initialize:function(e){e=e||{};var t=this;s.initialize.call(t,{title:"out a day",formTemplate:"view/modals/absenceForm",formModel:t,path:"/remote/v1/absence",submitText:"Save and Close",cancelText:"Cancel",success:function(){t.absences()?t.person().scheduled_absences(r(t.absences()).filter(function(e){return e.type&&e.startDate}).map(function(e){var t={start_date:e.startDate.format("isoDate"),return_date:e.returnDate.format("isoDate"),type:e.type,reason:e.reason,excused:e.excused};return t}).value()):t.person().scheduled_absences([]);if(i.isDemo){h=o.lazyLoadModule(h,"model/checkpoint");var e={action:t.activeType(),action_time:t.startDate().getTime()/1e3,end_date:t.returnDate().getTime()/1e3,end_local_date:t.returnDate().getTime()/1e3,excused:!0,group:a.groupSelected()?a.group().key:t.person().homeroom_key(),in_time:t.startDate(),out_time:t.startDate(),member:t.person().key,location:t.person().location().key,person_type:"child"},e=h.create(e);c.emit("checkpoint-received",e),t.person().checkpoint(e),c.emit("attendanceChanged",{location:t.person().location(),group:t.person().group(),key:t.person().key,checkpoint:e})}t.close()}}),t.absenceLoader=l.create({path:"/remote/v1/absence",method:"get",complete:function(){},success:function(e){t.absences(r.map(e,function(e){return d.create({type:e.type,start_date:o.convertPlatformDateStringToDate(e.start_date),return_date:o.convertPlatformDateStringToDate(e.return_date),reason:e.reason,excused:e.excused})}))},error:function(){f.showAlert("Oops!","We were unable to load student absences.  If you have a second, check your connectivity and try again.")}}),t.person=n.observable(),t.absences=n.observableArray([]),t.activeType=n.observable(),t.isSick=n.pureComputed(function(){return t.activeType()===p.SICK}),t.isVacation=n.pureComputed(function(){return t.activeType()===p.VACATION}),t.isOther=n.pureComputed(function(){return t.activeType()===p.OTHER}),t.excused=n.observable(),t.reason=n.observable(),t.startDate=n.observable(),t.returnDate=n.observable(),t.startDate.subscribe(t.updateReturnDate)},chooseSick:function(){this.activeType()===p.SICK?this.activeType(null):this.activeType(p.SICK)},chooseVacation:function(){this.activeType()===p.VACATION?this.activeType(null):(this.reason(null),this.activeType(p.VACATION))},chooseOther:function(){this.activeType()===p.OTHER?this.activeType(null):this.activeType(p.OTHER)},setExcused:function(e){this.excused(e)},updateReturnDate:function(){if(!this.startDate()){this.returnDate(null);return}var e=new Date(this.startDate());if(!this.returnDate()||(new Date(this.returnDate())).setHours(0,0,0,0)<=e.setHours(0,0,0,0)){var t=this.person().nextDateScheduledIn(e);this.returnDate(t)}},addAbsence:function(){if(this.activeType()){if(!this.startDate())return f.showAlert("Something is not quite right!","Please fix the following before continuing:","warning",["Start date is required"]),!1;var e=new Date(this.startDate());e.setHours(0,0,0,0);var t=null;this.returnDate()?t=new Date(this.returnDate()):t=this.person().nextDateScheduledIn(e),t.setHours(0,0,0,0);if(t<=e)return f.showAlert("Something is not quite right!","Please fix the following before continuing:","warning",["Return date must be after start date"]),!1;var n=r(this.absences()).find(function(n){return e<n.returnDate&&t>n.startDate});if(n)return f.showAlert("Something is not quite right!","Please fix the following before continuing:","warning",["Absence must not overlap with another absence"]),!1;this.absences.push(d.create({type:this.activeType(),start_date:e,return_date:t,reason:this.reason(),excused:this.excused()}))}return!0},deleteAbsence:function(e){this.absences.remove(function(t){return t.id()===e.id()}),this.activeType(null)},valid:function(){return this.addAbsence()},payload:function(){var e=r(this.absences()).filter(function(e){return e.type&&e.startDate}).map(function(e,t){var n={start_date:e.startDate.format("isoDate"),return_date:e.returnDate.format("isoDate"),type:e.type,reason:e.reason,excused:e.excused};return n}).value(),t=Math.round((new Date).getTime()/1e3),n={absences:e,action_time:t,trackable_key:this.person().key,location:a.location().key,source:"local",cut:(new Date).getTime(),group:a.groupSelected()?a.group().key:this.person().homeroom_key()},i=this.person().checkpoint();return i&&"key"in i&&this.person().getStateForCheckpoint(i)==="in"&&(n.last_checkpoint_key=i.key),n},loadAbsences:function(e){i.isDemo?this.absences(r.map(e.scheduled_absences(),function(e){return d.create({type:e.type,start_date:o.convertPlatformDateStringToDate(e.start_date),return_date:o.convertPlatformDateStringToDate(e.return_date),reason:e.reason,excused:e.excused})})):this.absenceLoader.makeRequest({data:{trackable_key:e.key}})},open:function(e){var t=this;this.person(e),this.subtitle(e.displayName()),this.loadAbsences(e),this.futureAbsences=n.pureComputed(function(){return r(t.absences()).filter(function(e){return!e.includesToday()}).value()}),this.currentAbsences=n.pureComputed(function(){return r(t.absences()).filter(function(e){return e.includesToday()}).value()}),this.resetForm(),s.open.call(this)},close:function(){this.resetForm(),this.person(null),this.absences([]),s.close.call(this)},resetForm:function(){this.returnDate(null),this.startDate(new Date),this.reason(null),this.excused(!0),this.activeType(p.SICK)}});return o.makeSingleton(v)}),tadpoles.define("model/moveModal",["require","services/modal"],function(e){var t=e("services/modal"),n=t.extend({className:"MoveModal",initialize:function(){var e=this;t.initialize.call(e,{template:"view/modals/moveModal",model:null,clearModelOnClose:!0})}});return n}),function(e){typeof tadpoles.define=="function"&&tadpoles.define.amd?tadpoles.define("jquery.ui.widget",["jquery"],e):e(jQuery)}(function(e,t){var n=0,r=Array.prototype.slice,i=e.cleanData;e.cleanData=function(t){for(var n=0,r;(r=t[n])!=null;n++)try{e(r).triggerHandler("remove")}catch(s){}i(t)},e.widget=function(t,n,r){var i,s,o,u,a={},f=t.split(".")[0];t=t.split(".")[1],i=f+"-"+t,r||(r=n,n=e.Widget),e.expr[":"][i.toLowerCase()]=function(t){return!!e.data(t,i)},e[f]=e[f]||{},s=e[f][t],o=e[f][t]=function(e,t){if(!this._createWidget)return new o(e,t);arguments.length&&this._createWidget(e,t)},e.extend(o,s,{version:r.version,_proto:e.extend({},r),_childConstructors:[]}),u=new n,u.options=e.widget.extend({},u.options),e.each(r,function(t,r){if(!e.isFunction(r)){a[t]=r;return}a[t]=function(){var e=function(){return n.prototype[t].apply(this,arguments)},i=function(e){return n.prototype[t].apply(this,e)};return function(){var t=this._super,n=this._superApply,s;return this._super=e,this._superApply=i,s=r.apply(this,arguments),this._super=t,this._superApply=n,s}}()}),o.prototype=e.widget.extend(u,{widgetEventPrefix:s?u.widgetEventPrefix:t},a,{constructor:o,namespace:f,widgetName:t,widgetFullName:i}),s?(e.each(s._childConstructors,function(t,n){var r=n.prototype;e.widget(r.namespace+"."+r.widgetName,o,n._proto)}),delete s._childConstructors):n._childConstructors.push(o),e.widget.bridge(t,o)},e.widget.extend=function(n){var i=r.call(arguments,1),s=0,o=i.length,u,a;for(;s<o;s++)for(u in i[s])a=i[s][u],i[s].hasOwnProperty(u)&&a!==t&&(e.isPlainObject(a)?n[u]=e.isPlainObject(n[u])?e.widget.extend({},n[u],a):e.widget.extend({},a):n[u]=a);return n},e.widget.bridge=function(n,i){var s=i.prototype.widgetFullName||n;e.fn[n]=function(o){var u=typeof o=="string",a=r.call(arguments,1),f=this;return o=!u&&a.length?e.widget.extend.apply(null,[o].concat(a)):o,u?this.each(function(){var r,i=e.data(this,s);if(!i)return e.error("cannot call methods on "+n+" prior to initialization; "+"attempted to call method '"+o+"'");if(!e.isFunction(i[o])||o.charAt(0)==="_")return e.error("no such method '"+o+"' for "+n+" widget instance");r=i[o].apply(i,a);if(r!==i&&r!==t)return f=r&&r.jquery?f.pushStack(r.get()):r,!1}):this.each(function(){var t=e.data(this,s);t?t.option(o||{})._init():e.data(this,s,new i(o,this))}),f}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,r){r=e(r||this.defaultElement||this)[0],this.element=e(r),this.uuid=n++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),r!==this&&(e.data(r,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===r&&this.destroy()}}),this.document=e(r.style?r.ownerDocument:r.document||r),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(n,r){var i=n,s,o,u;if(arguments.length===0)return e.widget.extend({},this.options);if(typeof n=="string"){i={},s=n.split("."),n=s.shift();if(s.length){o=i[n]=e.widget.extend({},this.options[n]);for(u=0;u<s.length-1;u++)o[s[u]]=o[s[u]]||{},o=o[s[u]];n=s.pop();if(r===t)return o[n]===t?null:o[n];o[n]=r}else{if(r===t)return this.options[n]===t?null:this.options[n];i[n]=r}}return this._setOptions(i),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,e==="disabled"&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(t,n,r){var i,s=this;typeof t!="boolean"&&(r=n,n=t,t=!1),r?(n=i=e(n),this.bindings=this.bindings.add(n)):(r=n,n=this.element,i=this.widget()),e.each(r,function(r,o){function u(){if(!t&&(s.options.disabled===!0||e(this).hasClass("ui-state-disabled")))return;return(typeof o=="string"?s[o]:o).apply(s,arguments)}typeof o!="string"&&(u.guid=o.guid=o.guid||u.guid||e.guid++);var a=r.match(/^(\w+)\s*(.*)$/),f=a[1]+s.eventNamespace,l=a[2];l?i.delegate(l,f,u):n.bind(f,u)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function n(){return(typeof e=="string"?r[e]:e).apply(r,arguments)}var r=this;return setTimeout(n,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,n,r){var i,s,o=this.options[t];r=r||{},n=e.Event(n),n.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),n.target=this.element[0],s=n.originalEvent;if(s)for(i in s)i in n||(n[i]=s[i]);return this.element.trigger(n,r),!(e.isFunction(o)&&o.apply(this.element[0],[n].concat(r))===!1||n.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,n){e.Widget.prototype["_"+t]=function(r,i,s){typeof i=="string"&&(i={effect:i});var o,u=i?i===!0||typeof i=="number"?n:i.effect||n:t;i=i||{},typeof i=="number"&&(i={duration:i}),o=!e.isEmptyObject(i),i.complete=s,i.delay&&r.delay(i.delay),o&&e.effects&&e.effects.effect[u]?r[t](i):u!==t&&r[u]?r[u](i.duration,i.easing,s):r.queue(function(n){e(this)[t](),s&&s.call(r[0]),n()})}})}),function(e){typeof tadpoles.define=="function"&&tadpoles.define.amd?tadpoles.define("fileUpload",["jquery","jquery.ui.widget"],e):e(window.jQuery)}(function(e){e.support.xhrFileUpload=!!window.XMLHttpRequestUpload&&!!window.FileReader,e.support.xhrFormDataFileUpload=!!window.FormData,e.propHooks.elements={get:function(t){return e.nodeName(t,"form")?e.grep(t.elements,function(t){return!e.nodeName(t,"input")||t.type!=="file"}):null}},e.widget("blueimp.fileupload",{options:{dropZone:e(document),pasteZone:e(document),fileInput:undefined,replaceFileInput:!0,paramName:undefined,singleFileUploads:!0,limitMultiFileUploads:undefined,sequentialUploads:!1,limitConcurrentUploads:undefined,forceIframeTransport:!1,redirect:undefined,redirectParamName:undefined,postMessage:undefined,multipart:!0,maxChunkSize:undefined,uploadedBytes:undefined,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,formData:function(e){return e.serializeArray()},add:function(e,t){t.submit()},processData:!1,contentType:!1,cache:!1},_refreshOptionsList:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_BitrateTimer:function(){this.timestamp=+(new Date),this.loaded=0,this.bitrate=0,this.getBitrate=function(e,t,n){var r=e-this.timestamp;if(!this.bitrate||!n||r>n)this.bitrate=(t-this.loaded)*(1e3/r)*8,this.loaded=t,this.timestamp=e;return this.bitrate}},_isXHRUpload:function(t){return!t.forceIframeTransport&&(!t.multipart&&e.support.xhrFileUpload||e.support.xhrFormDataFileUpload)},_getFormData:function(t){var n;return typeof t.formData=="function"?t.formData(t.form):e.isArray(t.formData)?t.formData:t.formData?(n=[],e.each(t.formData,function(e,t){n.push({name:e,value:t})}),n):[]},_getTotal:function(t){var n=0;return e.each(t,function(e,t){n+=t.size||1}),n},_onProgress:function(e,t){if(e.lengthComputable){var n=+(new Date),r,i;if(t._time&&t.progressInterval&&n-t._time<t.progressInterval&&e.loaded!==e.total)return;t._time=n,r=t.total||this._getTotal(t.files),i=parseInt(e.loaded/e.total*(t.chunkSize||r),10)+(t.uploadedBytes||0),this._loaded+=i-(t.loaded||t.uploadedBytes||0),t.lengthComputable=!0,t.loaded=i,t.total=r,t.bitrate=t._bitrateTimer.getBitrate(n,i,t.bitrateInterval),this._trigger("progress",e,t),this._trigger("progressall",e,{lengthComputable:!0,loaded:this._loaded,total:this._total,bitrate:this._bitrateTimer.getBitrate(n,this._loaded,t.bitrateInterval)})}},_initProgressListener:function(t){var n=this,r=t.xhr?t.xhr():e.ajaxSettings.xhr();r.upload&&(e(r.upload).bind("progress",function(e){var r=e.originalEvent;e.lengthComputable=r.lengthComputable,e.loaded=r.loaded,e.total=r.total,n._onProgress(e,t)}),t.xhr=function(){return r})},_initXHRData:function(t){var n,r=t.files[0],i=t.multipart||!e.support.xhrFileUpload,s=t.paramName[0];t.headers=t.headers||{},t.contentRange&&(t.headers["Content-Range"]=t.contentRange),i?e.support.xhrFormDataFileUpload&&(t.postMessage?(n=this._getFormData(t),t.blob?n.push({name:s,value:t.blob}):e.each(t.files,function(e,r){n.push({name:t.paramName[e]||s,value:r})})):(t.formData instanceof FormData?n=t.formData:(n=new FormData,e.each(this._getFormData(t),function(e,t){n.append(t.name,t.value)})),t.blob?(t.headers["Content-Disposition"]='attachment; filename="'+encodeURI(r.name)+'"',n.append(s,t.blob,r.name)):e.each(t.files,function(e,r){(window.Blob&&r instanceof Blob||window.File&&r instanceof File)&&n.append(t.paramName[e]||s,r,r.name)})),t.data=n):(t.headers["Content-Disposition"]='attachment; filename="'+encodeURI(r.name)+'"',t.contentType=r.type,t.data=t.blob||r),t.blob=null},_initIframeSettings:function(t){t.dataType="iframe "+(t.dataType||""),t.formData=this._getFormData(t),t.redirect&&e("<a></a>").prop("href",t.url).prop("host")!==location.host&&t.formData.push({name:t.redirectParamName||"redirect",value:t.redirect})},_initDataSettings:function(e){this._isXHRUpload(e)?(this._chunkedUpload(e,!0)||(e.data||this._initXHRData(e),this._initProgressListener(e)),e.postMessage&&(e.dataType="postmessage "+(e.dataType||""))):this._initIframeSettings(e,"iframe")},_getParamName:function(t){var n=e(t.fileInput),r=t.paramName;return r?e.isArray(r)||(r=[r]):(r=[],n.each(function(){var t=e(this),n=t.prop("name")||"files[]",i=(t.prop("files")||[1]).length;while(i)r.push(n),i-=1}),r.length||(r=[n.prop("name")||"files[]"])),r},_initFormSettings:function(t){if(!t.form||!t.form.length)t.form=e(t.fileInput.prop("form")),t.form.length||(t.form=e(this.options.fileInput.prop("form")));t.paramName=this._getParamName(t),t.url||(t.url=t.form.prop("action")||location.href),t.type=(t.type||t.form.prop("method")||"").toUpperCase(),t.type!=="POST"&&t.type!=="PUT"&&t.type!=="PATCH"&&(t.type="POST"),t.formAcceptCharset||(t.formAcceptCharset=t.form.attr("accept-charset"))},_getAJAXSettings:function(t){var n=e.extend({},this.options,t);return this._initFormSettings(n),this._initDataSettings(n),n},_enhancePromise:function(e){return e.success=e.done,e.error=e.fail,e.complete=e.always,e},_getXHRPromise:function(t,n,r){var i=e.Deferred(),s=i.promise();return n=n||this.options.context||s,t===!0?i.resolveWith(n,r):t===!1&&i.rejectWith(n,r),s.abort=i.promise,this._enhancePromise(s)},_getUploadedBytes:function(e){var t=e.getResponseHeader("Range"),n=t&&t.split("-"),r=n&&n.length>1&&parseInt(n[1],10);return r&&r+1},_chunkedUpload:function(t,n){var r=this,i=t.files[0],s=i.size,o=t.uploadedBytes=t.uploadedBytes||0,u=t.maxChunkSize||s,a=i.slice||i.webkitSlice||i.mozSlice,f=e.Deferred(),l=f.promise(),c,h;return!(this._isXHRUpload(t)&&a&&(o||u<s))||t.data?!1:n?!0:o>=s?(i.error="Uploaded bytes exceed file size",this._getXHRPromise(!1,t.context,[null,"error",i.error])):(h=function(){var n=e.extend({},t);n.blob=a.call(i,o,o+u,i.type),n.chunkSize=n.blob.size,n.contentRange="bytes "+o+"-"+(o+n.chunkSize-1)+"/"+s,r._initXHRData(n),r._initProgressListener(n),c=(r._trigger("chunksend",null,n)!==!1&&e.ajax(n)||r._getXHRPromise(!1,n.context)).done(function(i,u,a){o=r._getUploadedBytes(a)||o+n.chunkSize,(!n.loaded||n.loaded<n.total)&&r._onProgress(e.Event("progress",{lengthComputable:!0,loaded:o-n.uploadedBytes,total:o-n.uploadedBytes}),n),t.uploadedBytes=n.uploadedBytes=o,n.result=i,n.textStatus=u,n.jqXHR=a,r._trigger("chunkdone",null,n),r._trigger("chunkalways",null,n),o<s?h():f.resolveWith(n.context,[i,u,a])}).fail(function(e,t,i){n.jqXHR=e,n.textStatus=t,n.errorThrown=i,r._trigger("chunkfail",null,n),r._trigger("chunkalways",null,n),f.rejectWith(n.context,[e,t,i])})},this._enhancePromise(l),l.abort=function(){return c.abort()},h(),l)},_beforeSend:function(e,t){this._active===0&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer),this._active+=1,this._loaded+=t.uploadedBytes||0,this._total+=this._getTotal(t.files)},_onDone:function(t,n,r,i){if(!this._isXHRUpload(i)||!i.loaded||i.loaded<i.total){var s=this._getTotal(i.files)||1;this._onProgress(e.Event("progress",{lengthComputable:!0,loaded:s,total:s}),i)}i.result=t,i.textStatus=n,i.jqXHR=r,this._trigger("done",null,i)},_onFail:function(e,t,n,r){r.jqXHR=e,r.textStatus=t,r.errorThrown=n,this._trigger("fail",null,r),r.recalculateProgress&&(this._loaded-=r.loaded||r.uploadedBytes||0,this._total-=r.total||this._getTotal(r.files))},_onAlways:function(e,t,n,r){this._active-=1,this._trigger("always",null,r),this._active===0&&(this._trigger("stop"),this._loaded=this._total=0,this._bitrateTimer=null)},_onSend:function(t,n){var r=this,i,s,o,u,a=r._getAJAXSettings(n),f=function(){return r._sending+=1,a._bitrateTimer=new r._BitrateTimer,i=i||((s||r._trigger("send",t,a)===!1)&&r._getXHRPromise(!1,a.context,s)||r._chunkedUpload(a)||e.ajax(a)).done(function(e,t,n){r._onDone(e,t,n,a)}).fail(function(e,t,n){r._onFail(e,t,n,a)}).always(function(e,t,n){r._sending-=1,r._onAlways(e,t,n,a);if(a.limitConcurrentUploads&&a.limitConcurrentUploads>r._sending){var i=r._slots.shift(),s;while(i){s=i.state?i.state()==="pending":!i.isRejected();if(s){i.resolve();break}i=r._slots.shift()}}}),i};return this._beforeSend(t,a),this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending?(this.options.limitConcurrentUploads>1?(o=e.Deferred(),this._slots.push(o),u=o.pipe(f)):u=this._sequence=this._sequence.pipe(f,f),u.abort=function(){return s=[undefined,"abort","abort"],i?i.abort():(o&&o.rejectWith(a.context,s),f())},this._enhancePromise(u)):f()},_onAdd:function(t,n){var r=this,i=!0,s=e.extend({},this.options,n),o=s.limitMultiFileUploads,u=this._getParamName(s),a,f,l,c;if(!s.singleFileUploads&&!o||!this._isXHRUpload(s))l=[n.files],a=[u];else if(!s.singleFileUploads&&o){l=[],a=[];for(c=0;c<n.files.length;c+=o)l.push(n.files.slice(c,c+o)),f=u.slice(c,c+o),f.length||(f=u),a.push(f)}else a=u;return n.originalFiles=n.files,e.each(l||n.files,function(s,o){var u=e.extend({},n);return u.files=l?o:[o],u.paramName=a[s],u.submit=function(){return u.jqXHR=this.jqXHR=r._trigger("submit",t,this)!==!1&&r._onSend(t,this),this.jqXHR},i=r._trigger("add",t,u),i}),i},_replaceFileInput:function(t){var n=t.clone(!0);e("<form></form>").append(n)[0].reset(),t.after(n).detach(),e.cleanData(t.unbind("remove")),this.options.fileInput=this.options.fileInput.map(function(e,r){return r===t[0]?n[0]:r}),t[0]===this.element[0]&&(this.element=n)},_handleFileTreeEntry:function(t,n){var r=this,i=e.Deferred(),s=function(e){e&&!e.entry&&(e.entry=t),i.resolve([e])},o;return n=n||"",t.isFile?t._file?(t._file.relativePath=n,i.resolve(t._file)):t.file(function(e){e.relativePath=n,i.resolve(e)},s):t.isDirectory?(o=t.createReader(),o.readEntries(function(e){r._handleFileTreeEntries(e,n+t.name+"/").done(function(e){i.resolve(e)}).fail(s)},s)):i.resolve([]),i.promise()},_handleFileTreeEntries:function(t,n){var r=this;return e.when.apply(e,e.map(t,function(e){return r._handleFileTreeEntry(e,n)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(t){t=t||{};var n=t.items;return n&&n.length&&(n[0].webkitGetAsEntry||n[0].getAsEntry)?this._handleFileTreeEntries(e.map(n,function(e){var t;return e.webkitGetAsEntry?(t=e.webkitGetAsEntry(),t&&(t._file=e.getAsFile()),t):e.getAsEntry()})):e.Deferred().resolve(e.makeArray(t.files)).promise()},_getSingleFileInputFiles:function(t){t=e(t);var n=t.prop("webkitEntries")||t.prop("entries"),r,i;if(n&&n.length)return this._handleFileTreeEntries(n);r=e.makeArray(t.prop("files"));if(!r.length){i=t.prop("value");if(!i)return e.Deferred().resolve([]).promise();r=[{name:i.replace(/^.*\\/,"")}]}else r[0].name===undefined&&r[0].fileName&&e.each(r,function(e,t){t.name=t.fileName,t.size=t.fileSize});return e.Deferred().resolve(r).promise()},_getFileInputFiles:function(t){return t instanceof e&&t.length!==1?e.when.apply(e,e.map(t,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)}):this._getSingleFileInputFiles(t)},_onChange:function(t){var n=this,r={fileInput:e(t.target),form:e(t.target.form)};this._getFileInputFiles(r.fileInput).always(function(e){r.files=e,n.options.replaceFileInput&&n._replaceFileInput(r.fileInput),n._trigger("change",t,r)!==!1&&n._onAdd(t,r)})},_onPaste:function(t){var n=t.originalEvent.clipboardData,r=n&&n.items||[],i={files:[]};e.each(r,function(e,t){var n=t.getAsFile&&t.getAsFile();n&&i.files.push(n)});if(this._trigger("paste",t,i)===!1||this._onAdd(t,i)===!1)return!1},_onDrop:function(e){var t=this,n=e.dataTransfer=e.originalEvent.dataTransfer,r={};n&&n.files&&n.files.length&&e.preventDefault(),this._getDroppedFiles(n).always(function(n){r.files=n,t._trigger("drop",e,r)!==!1&&t._onAdd(e,r)})},_onDragOver:function(t){var n=t.dataTransfer=t.originalEvent.dataTransfer;if(this._trigger("dragover",t)===!1)return!1;n&&e.inArray("Files",n.types)!==-1&&(n.dropEffect="copy",t.preventDefault())},_initEventHandlers:function(){this._isXHRUpload(this.options)&&(this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop}),this._on(this.options.pasteZone,{paste:this._onPaste})),this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragover drop"),this._off(this.options.pasteZone,"paste"),this._off(this.options.fileInput,"change")},_setOption:function(t,n){var r=e.inArray(t,this._refreshOptionsList)!==-1;r&&this._destroyEventHandlers(),this._super(t,n),r&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var t=this.options;t.fileInput===undefined?t.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):t.fileInput instanceof e||(t.fileInput=e(t.fileInput)),t.dropZone instanceof e||(t.dropZone=e(t.dropZone)),t.pasteZone instanceof e||(t.pasteZone=e(t.pasteZone))},_create:function(){var t=this.options;e.extend(t,e(this.element[0].cloneNode(!1)).data()),this._initSpecialOptions(),this._slots=[],this._sequence=this._getXHRPromise(!0),this._sending=this._active=this._loaded=this._total=0,this._initEventHandlers()},_destroy:function(){this._destroyEventHandlers()},add:function(t){var n=this;if(!t||this.options.disabled)return;t.fileInput&&!t.files?this._getFileInputFiles(t.fileInput).always(function(e){t.files=e,n._onAdd(null,t)}):(t.files=e.makeArray(t.files),this._onAdd(null,t))},send:function(t){if(t&&!this.options.disabled){if(t.fileInput&&!t.files){var n=this,r=e.Deferred(),i=r.promise(),s,o;return i.abort=function(){return o=!0,s?s.abort():(r.reject(null,"abort","abort"),i)},this._getFileInputFiles(t.fileInput).always(function(e){if(o)return;t.files=e,s=n._onSend(null,t).then(function(e,t,n){r.resolve(e,t,n)},function(e,t,n){r.reject(e,t,n)})}),this._enhancePromise(i)}t.files=e.makeArray(t.files);if(t.files.length)return this._onSend(null,t)}return this._getXHRPromise(!1,t&&t.context)}})}),tadpoles.define("services/fileUpload",["require","ko","jquery","services/alerts","lodash","fileUpload"],function(e){var t=e("ko"),n=e("jquery"),r=e("services/alerts"),i=e("lodash");return e("fileUpload"),t.bindingHandlers.fileUpload={init:function(e,t,s,o){var u=t(),a=s().uploadType||"pdf",f=s().progress,l=s().done;n(e).fileupload({dataType:"json",dropZone:n(e),add:function(e,t){var n="(.|/)("+a+")$",s=new RegExp(n,"i"),o=i.find(t.files,function(e){return!s.test(e.name)});if(o){r.showAlert("Oops!","You can only upload a "+a);return}var f=i.find(t.files,function(e){return e.size>15728640});if(f){r.showAlert("Oops!","Your "+a+" is too big!  Please keep the filesize below 15MB");return}u&&u.push(t)},progressall:function(e,t){f&&f(t.loaded,t.total)},done:function(e,t){l&&l()}})}},{}}),tadpoles.define("model/communication",["require","ko","jquery","lodash","services/config","model/remote","model/globalFilter","services/groups","services/alerts","jstz","services/uuid","utilities","emit","utilities","model/status","services/children","services/fileUpload"],function(e){var t=e("ko"),n=e("jquery"),r=e("lodash"),i=e("services/config"),s=e("model/remote"),o=e("model/globalFilter"),u=e("services/groups"),a=e("services/alerts"),f=e("jstz"),l=e("services/uuid"),c=f.determine(),h=e("utilities"),p=e("emit"),d=null,v=e("utilities"),m=null,g=e("model/status"),y=e("services/children");e("services/fileUpload");var b={NOTE:"note",ALERT:"alert",STICKY:"sticky",TEXT:"text"},w={SENT:"sent",SCHEDULED:"scheduled"},E=s.extend({className:"Communications",initialize:function(e){var n=this;e=e||{},s.initialize.call(n,{concurrent:!0,path:"/remote/v1/event",method:"post",error:function(e,t){n.processing(!1);if(n.hasFailures())a.showRetry({message:t,retry:function(){n.sendEventRequests(r.values(n.failedRequests))},cancel:function(){n.reset()}});else{var i=t?t:"Something went wrong on our end, please try again";a.showAlert("Oops!",i),n.reset()}},success:function(){n.processing(!1),n.selectedGroups().length===0&&(n.reset(),a.showAlert("Message Sent!","Your message has been successfully sent","success"))}}),n.activeRequests={},n.failedRequests={},p.on("requestSuccess",function(e){delete n.activeRequests[e.requestId],delete n.failedRequests[e.requestId]}),p.on("requestFailed",function(e){var t=n.activeRequests[e.requestId];t&&(t.requestId=e.requestId,n.failedRequests[e.requestId]=t,delete n.activeRequests[e.requestId])}),n.sentNotesViewType=t.observable(w.SENT),n.sentNotesViewTypeSentActive=t.pureComputed(function(){return n.sentNotesViewType()===w.SENT||!o.isToday()}),n.sentNotesViewTypeScheduledActive=t.pureComputed(function(){return n.sentNotesViewType()===w.SCHEDULED&&o.isToday()}),n.notesForSelection=t.pureComputed(function(){d=v.lazyLoadModule(d,"services/events");var e=d.notesForSelection();return r(e).filter(function(e){return n.sentNotesViewTypeSentActive()&&!e.isScheduled()||n.sentNotesViewTypeScheduledActive()&&e.isScheduled()}).sortBy(function(e){return e.event_eta()||e.event_time}).value()}),n.sentNotesNumDisplay=t.pureComputed(function(){return n.notesForSelection().length+(n.sentNotesViewTypeSentActive()?" sent ":" scheduled ")}),n.scheduledSendActive=t.observable(!1),n.scheduleDate=t.observable(new Date),n.scheduleTime=t.observable((new Date).getTime()/1e3),n.scheduleDisplay=t.pureComputed(function(){var e=new Date(n.scheduleTime()*1e3);return"scheduled for "+n.scheduleDate().format("mediumDate")+" at "+e.format("shortTime")}),n.parentMessageFocus=t.observable(),n.content=t.observable(),n.parentCommDisabled=t.observable(),n.staffCommunicationMode=t.observable(r.isUndefined(e.staffCommunicationMode)?!0:e.staffCommunicationMode),n.rosterSendMode=t.observable(e.rosterSendMode),n.activeType=t.observable(b.NOTE),n.alertTypeVisible=t.pureComputed(function(){return n.staffCommunicationMode()}),n.stickyTypeVisible=t.pureComputed(function(){return n.staffCommunicationMode()}),n.sendCommunicationButtonVisible=t.pureComputed(function(){return n.staffCommunicationMode()}),n.chooseRecipientSelectVisible=t.pureComputed(function(){return n.staffCommunicationMode()}),n.noteTypeActive=t.pureComputed(function(){return n.activeType()===b.NOTE}),n.alertTypeActive=t.pureComputed(function(){return n.activeType()===b.ALERT}),n.stickyTypeActive=t.pureComputed(function(){return n.activeType()===b.STICKY}),n.textTypeActive=t.pureComputed(function(){return n.activeType()===b.TEXT}),n.sendTypeVisible=t.pureComputed(function(){return!n.rosterSendMode()}),n.sendButtonText=t.pureComputed(function(){var e=n.scheduledSendActive()?"schedule ":"send ";return n.noteTypeActive()?e+="email":n.alertTypeActive()?e+="emergency alert":n.textTypeActive()?e+="text message":e+="sticky note",e}),n.scheduleButtonText=t.pureComputed(function(){var e="send ";return n.noteTypeActive()?e+="email":n.alertTypeActive()?e+="emergency alert":n.textTypeActive()?e+="text message":e+="sticky note",e+" later"}),n.instructions=t.pureComputed(function(){if(n.alertTypeActive())return"your emergency message (130 characters maximum)";if(n.textTypeActive())return"your text message (140 characters maximum)";if(n.noteTypeActive())return"your message to parents";if(n.stickyTypeActive())return"your message to teacher(s)"}),n.selectedGroups=t.observableArray([]),n.caregiverOptions=t.pureComputed(function(){var e;return n.stickyTypeActive()?e=[{name:"All Devices",key:"__all__"}]:e=[{name:"All Parents & Staff",key:"__all__"},{name:"Staff",key:"__staff__"}],e}),n.groupOptions=t.pureComputed(function(){return r.filter(u.getInstance().groupsForCurrentLocation(),function(e){return!r.find(n.selectedGroups(),{key:e.key})})}),n.hasGroupOptions=t.pureComputed(function(){return n.groupOptions().length}),n.rosterOptions=t.pureComputed(function(){return m||(m=v.lazyLoadModule(m,"model/roster")),r.filter(m.groups(),function(e){return e.selectedCount()>0&&e.value()!==g.Statuses.ACTIVE})}),n.hasRosterOptions=t.pureComputed(function(){return n.rosterOptions().length&&n.noteTypeActive()}),n.selectedRecipient=t.observable(e.selectedRecipient),n.selectedRecipient.subscribe(function(e){if(!e)return;var t=u.getInstance().getGroup(e);t?n.selectedGroups.push(t):n.selectedGroups.removeAll()}),n.removeSelectedGroup=function(){n.selectedGroups.remove(this)},n.removeSelectedFiles=function(){var e=this;r.each(n.files(),function(t){t.files[0].name===e&&n.files.remove(t)})},o.location.subscribe(function(e){e&&n.parentCommDisabled(o.location().parent_communication_disabled)})},hasFailures:function(){return!r.isEmpty(this.failedRequests)},toggleScheduleOptions:function(){this.scheduledSendActive(!this.scheduledSendActive())},toggleParentCommunication:function(){var e=this,t=!e.parentCommDisabled(),n=s.create({path:"/remote/v1/location",method:"post",success:function(){o.location().parent_communication_disabled=t,e.parentCommDisabled(t)},error:function(){a.showAlert("Oops!","We were unable to save that last change.  If you have a second, check your connectivity and try again.")}});n.makeRequest({data:{location:o.location().key,property:"parent_communication_disabled",value:t}})},chooseNotesViewTypeSent:function(){this.sentNotesViewType(w.SENT)},chooseNotesViewTypeScheduled:function(){this.sentNotesViewType(w.SCHEDULED)},chooseTypeNote:function(){this.selectedRecipient(null),this.selectedGroups.removeAll(),this.activeType(b.NOTE)},chooseTypeSticky:function(){this.clearFiles(),this.selectedRecipient(null),this.selectedGroups.removeAll();var e=u.getInstance().getGroup(o.group().key);e&&this.selectedGroups.push(e),this.activeType(b.STICKY)},chooseTypeText:function(){this.selectedRecipient(null),this.selectedGroups.removeAll(),this.clearFiles();var e=this.content();this.activeType(b.TEXT),e&&e.length>140&&this.content(e.substring(0,140))},chooseTypeAlert:function(){this.selectedRecipient("__all__"),this.selectedGroups.removeAll(),this.clearFiles();var e=this.content();e&&e.length>130&&this.content(e.substring(0,130)),this.activeType(b.ALERT),this.scheduledSendActive(!1)},getVisibility:function(){var e;return this.stickyTypeActive()?e=["t"]:e=this.selectedRecipient()==="__staff__"?["d","t"]:["p","d","t"],e},getMembers:function(){if(!this.isPipelineNote())return null;var e=this.getRosterGroupName(),t=this.rosterSendMode()?o.group().childrenForRoster():y.getInstance().children();return r(t).filter(function(t){return t.statuses().indexOf(e)!==-1}).map(function(e){return e.key}).value()},isPipelineNote:function(){var e=this.selectedRecipient();return e&&e.indexOf("roster_")!==-1},getRosterGroupName:function(){return this.selectedRecipient().split("_")[1]},getScope:function(){return this.selectedRecipient()==="__all__"?"location":this.selectedRecipient()==="__staff__"?"staff":this.isPipelineNote()?"dependant":"group"},getAction:function(){return this.noteTypeActive()?"ShareOnly":this.alertTypeActive()?"Alert":this.textTypeActive()?"Text":"StickyNote"},getRecipientText:function(){if(this.isPipelineNote()){var e=this.getRosterGroupName();return"parents of "+e+" children"}return"unknown"},createEventRequests:function(e){var t=this,n={type:"Note",action:this.getAction(),event_time:(new Date).getTime()/1e3,location:o.location().key,group:e,members:this.getMembers(),scope:this.getScope(),comment:this.content(),tz:c.name(),visibility:this.getVisibility(),uuid:l.v4()};t.isPipelineNote()&&(n.members_display=[t.getRosterGroupName()]);var s=[{event:n,file:this.files().length?this.files()[0]:null}];if(this.scheduledSendActive()){var u=new Date(this.scheduleDate()),a=new Date(this.scheduleTime()*1e3);u.setHours(a.getHours()),u.setMinutes(a.getMinutes()),n.event_eta=u.getTime()/1e3}n.grouped_event_id=this.grouped_event_id,this.files()&&this.files().length>1&&r.each(this.files().slice(1),function(e){var t=r.clone(n);t.uuid=l.v4(),s.push({event:t,file:e})}),n.grouped_event_is_primary=!0;if(i.isDemo){var f=r.clone(n);f.key=l.short(),f.create_time=(new Date).getTime()/1e3,f.event_date=(new Date).format("isoDate"),f.in_outbox=!1,f.location_display=o.location().name;var d=h.lazyLoadModule(d,"services/events");p.emit("new-event",d.newEvent(f))}return s},sendUploadSuccess:function(){var e=this,n={id:this.grouped_event_id,location:o.location().key,groups:r.map(e.selectedGroups(),function(e){return e.key})};e.selectedGroups.removeAll(),this.makeRequest({path:"/remote/v1/event/grouped/success",data:{grouped_event:t.toJSON(n)},success:function(){e.grouped_event_id=null,e.success()},complete:function(){}})},sendEventRequests:function(e,n){var i=this;n=r.isUndefined(n)?10:n;var s=r.after(e.length,function(t){if(i.hasFailures()){var s=t&&r.isString(t.error)?t.error:null,o=t&&r.isString(t.error_code)?t.error_code:null;o==="TransactionFailed"&&n?i.sendEventRequests(r.values(i.failedRequests),n-1):i.error(o,s)}else i.isGroupedEventSend()?i.sendUploadSuccess():i.success()});r.each(e,function(e){var n=i.makeRequest({data:{event:t.toJSON(e.event)},file:e.file,complete:s,cancelled:s,success:function(){},error:function(){},requestId:e.requestId});i.activeRequests[n]=e})},isGroupedEventSend:function(){return this.grouped_event_id||this.selectedGroups().length>1||this.files().length>1},sendMessage:function(){var e=[];this.isGroupedEventSend()&&(this.grouped_event_id=l.v4());if(this.selectedGroups().length){var t=this.selectedGroups().pop();e=this.createEventRequests(t.key)}else e=this.createEventRequests();this.sendEventRequests(e)},getRecipientPromptText:function(){var e=this,t="",n=r(this.caregiverOptions()).find({key:this.selectedRecipient()});return n?n.name:e.selectedGroups().length?(r.each(e.selectedGroups(),function(n,r){r&&(r===e.selectedGroups().length-1?t+=" and ":t+=", "),t+=n.name()}),t):e.getRecipientText()},submit:function(){var e=this;if(this.stickyTypeActive()){this.sendMessage();return}var t=e.getRecipientPromptText();this.getScope()==="group"&&(t="all parents of "+t);var n=this.scheduledSendActive()?"scheduled for ":"sent to ";a.showYesNo({message:"This message will be "+n+t+".  Continue?",yes:function(){e.onConfirmSubmit(),e.clearSchedule()}})},onConfirmSubmit:function(){this.sendMessage()},valid:function(){return this.content()&&this.content().length>0&&(this.selectedRecipient()||this.selectedGroups().length)},reset:function(){this.selectedRecipient(this.noteTypeActive()?null:"__all__"),this.content(""),this.selectedGroups.removeAll(),this.failedRequests={},this.activeRequests={}},clearSchedule:function(){this.scheduleDate(new Date),this.scheduleTime((new Date).getTime()/1e3),this.scheduledSendActive(!1)}});return E.CommunicationType=b,E}),tadpoles.define("model/modal/parentCommunicationsModal",["require","services/modal","model/communication"],function(e){var t=e("services/modal"),n=e("model/communication"),r=n.extend(t,{className:"ParentCommunicationsModal",initialize:function(e){var r=this;r.student=e,n.initialize.call(r,{staffCommunicationMode:!1}),t.initialize.call(r,{width:635,template:"view/modals/communicationsModal"})},title:function(){return this.student?this.student.displayName():""},open:function(){t.open.call(this)},close:function(){t.close.call(this)},onConfirmSubmit:function(){n.onConfirmSubmit.call(this),this.close()},getScope:function(){return"dependant"},getMembers:function(){return[this.student.key]},getRecipientText:function(){return(this.student.firstName()?this.student.firstName():this.student.displayName())+"'s parents and guardians"},valid:function(){return this.content()&&this.content().length>0}});return r}),tadpoles.define("model/schedule",["require","ko","lodash","selfish","utilities","emit"],function(e){var t=e("ko"),n=e("lodash"),r=e("selfish"),i=e("utilities"),s=e("emit"),o=r.Base.extend({className:"Schedule",initialize:function(e,n,r){function u(){s.emit("enrollmentChange",{child:o.child})}var o=this;o.monday=t.observable(e.monday),o.tuesday=t.observable(e.tuesday),o.wednesday=t.observable(e.wednesday),o.thursday=t.observable(e.thursday),o.friday=t.observable(e.friday),o.saturday=t.observable(e.saturday),o.sunday=t.observable(e.sunday),o.enrollment_date=t.observable(i.convertPlatformDateStringToDate(n.ed)),o.graduation_date=t.observable(i.convertPlatformDateStringToDate(n.gd)),o.return_date=t.observable(i.convertPlatformDateStringToDate(n.rd)),o.enrollment=t.observable(n.en),o.key=r.key,o.child=r,o.week=[this.sunday,this.monday,this.tuesday,this.wednesday,this.thursday,this.friday,this.saturday],o.disableRemoteSaving=t.observable(!1),o.isRemoteSaving=t.observable(!1),o.scheduleSubscriptions=[o.enrollment.subscribe(u),o.monday.subscribe(u),o.tuesday.subscribe(u),o.wednesday.subscribe(u),o.thursday.subscribe(u),o.friday.subscribe(u),o.saturday.subscribe(u),o.sunday.subscribe(u),o.enrollment_date.subscribe(u),o.graduation_date.subscribe(u)]},dispose:function(){this.child=null,this.key=null,n.each(this.scheduleSubscriptions,function(e){e.dispose()})},saveProperty:function(e,t,n){e=="schedule"&&(t=this.toScheduleByte(),e="sb"),this.child.saveProperty(e,t,n)},updateSchedule:function(e){this.monday(e.monday),this.tuesday(e.tuesday),this.wednesday(e.wednesday),this.thursday(e.thursday),this.friday(e.friday),this.saturday(e.saturday),this.sunday(e.sunday)},toProperty:function(e){return{name:"sb",value:this.toScheduleByte()}},toScheduleByte:function(){var e=0;return this.monday()&&(e+=1),this.tuesday()&&(e+=2),this.wednesday()&&(e+=4),this.thursday()&&(e+=8),this.friday()&&(e+=16),this.saturday()&&(e+=32),this.sunday()&&(e+=64),e},isScheduledToday:function(){return this.week[(new Date).getDay()]()},isScheduled:function(e){return this.week[e.getDay()]()},isDisenrolling:function(){try{var e=(this.graduation_date().getTime()-(new Date).getTime())/1e3/60/60/24;return e<90&&e>-1}catch(t){return!1}},isEnrolled:function(e){return!this.enrollment_date()||this.enrollment_date().getTime()<=e.getTime()},isGraduated:function(e){return this.graduation_date()&&this.graduation_date().getTime()<e.getTime()},isReturning:function(){try{return this.return_date().getTime()-(new Date).getTime()>0}catch(e){return!1}}});return o.enrollmentTypes=["Day","Morning","Afternoon","Before/After School"],o}),tadpoles.define("model/subscription",["require","ko","selfish"],function(e){var t=e("ko"),n=e("selfish"),r=n.Base.extend({className:"Subscription",initialize:function(e){this.topic=e.topic,this.channels=e.channels||[]},toUpload:function(){return{topic:this.topic,channels:this.channels}}});return r}),tadpoles.define("model/subscriber",["require","selfish","lodash","ko","model/subscription"],function(e){var t=e("selfish"),n=e("lodash"),r=e("ko"),i=e("model/subscription"),s={UnscheduledCheckin:"unsched-checkin"},o={All:"all",Email:"email",Push:"push"},u=t.Base.extend({className:"Subscriber",initialize:function(e){e=e||{};var t=this;t.subscriptions=r.observableArray(n.map(e.subscriptions,function(e){return i.create(e)}))},hasSubscription:function(e,t){return n.find(this.subscriptions(),function(r){return r.topic===e&&r.channels.length>0&&(!t||n.contains(r.channels,o.All)||n.contains(r.channels,t))})?!0:!1},addSubscription:function(e,t){var r=t||o.All,s=n.find(this.subscriptions(),function(t){return t.topic===e});s&&!n.contains(s.channels,r)?(this.subscriptions.valueWillMutate(),s.channels.push(r),this.subscriptions.valueHasMutated()):s||this.subscriptions.push(i.create({topic:e,channels:[r]}))},removeSubscription:function(e,t){var r=t||o.All,i=n.find(this.subscriptions(),function(t){return t.topic===e});if(!i)return;this.subscriptions.valueWillMutate(),n.remove(i.channels,function(e){return e===r}),this.subscriptions.valueHasMutated(),i.channels.length===0&&this.subscriptions.remove(function(t){return t.topic===e})},toggleSubscription:function(e,t){this.hasSubscription(e,t)?this.removeSubscription(e,t):this.addSubscription(e,t)},TOPICS:s,CHANNELS:o});return u}),tadpoles.define("model/person",["require","selfish","ko","services/config","emit","jquery","lodash","utilities","model/disposable","services/alerts","model/updateable","model/imageTile","model/actionTile","utilities","model/globalFilter","model/absenceForm","model/moveModal","model/modal/parentCommunicationsModal","model/remote","model/user","services/groups","jstz","model/status","model/schedule","model/subscriber","model/audit"],function(e){function O(e){return(new Date(e)).format("isoDate")===A}var t=e("selfish"),n=e("ko"),r=e("services/config"),i=e("emit"),s=e("jquery"),o=e("lodash"),u=e("utilities"),a=e("model/disposable"),f=e("services/alerts"),l=e("model/updateable"),c=e("model/imageTile"),h=e("model/actionTile"),p=e("utilities"),d=e("model/globalFilter"),v=e("model/absenceForm"),m=e("model/moveModal"),g=e("model/modal/parentCommunicationsModal"),y=e("model/remote"),b=e("model/user"),w=null,E=e("services/groups"),S=e("jstz"),x=S.determine(),T=e("model/status"),N=e("model/schedule"),C=e("model/subscriber"),k=e("model/audit"),L=m.create(),A=(new Date).format("isoDate"),M=t.Base.extend(l,c,h,T,C,a,{className:"Person",initialize:function(t){var r=this;a.initialize.call(r),h.initialize.call(r),c.initialize.call(r),C.initialize.call(r,t),t=t||{},r.key=t.key,r.type=n.observable(t.type),r.isEmployee=n.pureComputed(function(){return r.type()==="employee"}),r.isChild=n.pureComputed(function(){return r.type()!=="employee"}),r.attachmentKey(t.image_attachment),r.defaultImageFunction(function(){return r.key==="__add__"?null:r.type()==="medical"?"/images/3/profile/medical.png":r.type()==="employee"?"/images/1/profile/provider.png":"/images/1/profile/contact.png"}),r.firstName=n.observable(t.first_name),r.lastName=n.observable(t.last_name),r.note=n.observable(t.note),r.birthDate=n.observable(u.convertPlatformDateStringToDate(t.birth_date)),r.tourDate=n.observable(p.convertPlatformDateStringToDate(t.tour_date)),r.rawFullName=n.observable((t.first_name||"")+(t.first_name&&t.last_name?" ":"")+(t.last_name||"")),r.fullName=n.computed({read:function(){return r.rawFullName()},write:function(t){r.rawFullName(t),t=s.trim(t);var n=t.split(" ");r.firstName(n.length>0?s.trim(n[0]):null),r.lastName(n.length>1?s.trim(n[1]):null)},owner:r}),r.pin=n.observable(t.pin),r.group=n.observable(),r.homeroom_key=n.observable(t.homeroom_key),r.homeroomKeySubscription=r.homeroom_key.subscribe(function(){r.isOut()&&r.group(r.homeroom_key())}),r.family=n.observable(t.family),r.mobile_number=n.observable(t.mobile_number),r.home_number=n.observable(t.home_number),r.work_number=n.observable(t.work_number),r.email=n.observable(t.email),r.schedule=n.observable(N.create(r.inflateScheduleByte(t.sb),t,r)),r.primaryPhoneNumber=n.pureComputed(function(){if(!p.isNull(r.mobile_number()))return r.mobile_number();if(!p.isNull(r.work_number()))return r.work_number();if(!p.isNull(r.home_number()))return r.home_number()}),r.displayName=n.pureComputed(function(){var t=r.firstName(),n=r.lastName();return t&&n?t+" "+n:t?t:n?n:"?"}),w=u.lazyLoadModule(w,"model/checkpoint"),r.checkpoint=n.observable(),r.checkpointSubscription=r.checkpoint.subscribe(function(t){r.getStateForCheckpoint(t)==="in"?r.group(t.group):r.group(r.homeroom_key())}),r.checkpoint(w.create(t.last_checkpoint||{action:"out"})),r.displayNameLower=n.pureComputed(function(){return r.displayName().toLowerCase()}),r.isSick=n.pureComputed(function(){var t=r.checkpoint();return t?r.getStateForCheckpoint(t)==="sick":!1}),r.isVacation=n.pureComputed(function(){var t=r.checkpoint();return t?t.action!=="vacation"?!1:t.endDate?new Date<t.endDate?!0:!1:!0:!1}),r.status=n.observable(t.status),r.statusSubscription=r.status.subscribe(function(e){r.schedule()&&o.contains([T.Statuses.SUSPENDED,T.Statuses.DELETED,T.Statuses.GRADUATED],e)&&r.schedule().return_date(null)}),r.displayableStatus=n.pureComputed(function(){return r.getDisplayableStatus(r.status())}),r.isActive=n.pureComputed(function(){return r.status()===T.Statuses.ACTIVE}),r.isSuspended=n.pureComputed(function(){return r.status()===T.Statuses.SUSPENDED}),r.isDisenrolling=n.pureComputed(function(){return r.schedule().isDisenrolling()&&r.isActive()}),r.isTouring=n.pureComputed(function(){return r.tourDate()&&r.tourDate().format("isoDate")===(new Date).format("isoDate")}),r.isReturning=n.pureComputed(function(){return r.schedule().isReturning()}),r.statuses=n.pureComputed(function(){var t=[];return t.push(r.status()),r.isDisenrolling()&&t.push("disenrolling"),t}),r.isOtherAbsence=n.pureComputed(function(){var t=r.checkpoint();return t?r.getStateForCheckpoint(t)==="excused":!1}),r.isScheduledToday=n.pureComputed(function(){return r.status()===T.Statuses.ACTIVE&&(r.type()==="employee"||(r.schedule()?r.schedule().isScheduledToday():!1))}),r.wasInToday=n.pureComputed(function(){var t=(new Date).format("isoDate");return d.date().format("isoDate")!==t?!1:r.checkpoint()&&r.checkpoint().inTime()&&r.checkpoint().inTime().format("isoDate")===t&&!r.checkpoint().isTooQuickToActuallyBeIn()}),r.isOutForReason=n.pureComputed(function(){return!r.wasInToday()&&(r.isSick()||r.isVacation()||r.isOtherAbsence()||!r.isScheduledToday())}),r.vacationText=n.pureComputed(function(){var t=r.checkpoint(),n="vacation";return t.displayEndDate&&(n=n+" "+t.displayEndDate),n}),r.outText=n.pureComputed(function(){return r.isSick()?"sick":r.isVacation()?r.vacationText():r.isOtherAbsence()?"absent":r.isScheduledToday()?"":"unscheduled"}),r.sort=n.pureComputed(function(){return((!r.isScheduledToday()&&!r.wasInToday()?"d_":r.isOutForReason()?"c_":"a_")+r.lastName()+" "+r.firstName()).toLowerCase()}),r.isRemoteSaving=n.observable(!1),r.disableRemoteSaving=n.observable(!1),r.isScheduleRemoteSaving=n.pureComputed(function(){if(r.schedule)return r.schedule().isRemoteSaving()}),r.showWhereToFindMe=n.pureComputed(function(){return r.isVisiting()&&(d.groupSelected()&&r.isInHomeroom(d.group())||r.homeroom_key()&&!r.group())}),r.whereToFindMe=n.pureComputed(function(){var t=E.getInstance().getGroup(r.group());return t?"in "+t.name():"not in room"}),r.homeroom=n.pureComputed(function(){return E.getInstance().getGroup(r.homeroom_key())}),r.age=n.pureComputed(function(){return null}),r.scheduled_absences=n.observableArray(t.scheduled_absences||[])},dispose:function(){var t=this;t.isEmployee.dispose(),t.isChild.dispose(),t.fullName.dispose(),t.homeroomKeySubscription.dispose(),t.primaryPhoneNumber.dispose(),t.displayName.dispose(),t.checkpointSubscription.dispose(),t.displayNameLower.dispose(),t.isSick.dispose(),t.isVacation.dispose(),t.statusSubscription.dispose(),t.displayableStatus.dispose(),t.isActive.dispose(),t.isSuspended.dispose(),t.isDisenrolling.dispose(),t.isTouring.dispose(),t.isReturning.dispose(),t.statuses.dispose(),t.isOtherAbsence.dispose(),t.isScheduledToday.dispose(),t.wasInToday.dispose(),t.isOutForReason.dispose(),t.vacationText.dispose(),t.outText.dispose(),t.sort.dispose(),t.isScheduleRemoteSaving.dispose(),t.showWhereToFindMe.dispose(),t.whereToFindMe.dispose(),t.homeroom.dispose(),t.age.dispose(),t.checkpoint()&&t.checkpoint().dispose(),t.schedule()&&t.schedule().dispose(),h.dispose.call(this),c.dispose.call(this),a.dispose.call(this)},sortValueForGroup:function(t){var n=this.sort();return t&&t.key===this.homeroom_key()&&this.isVisiting()&&(n=("b_"+this.lastName()+" "+this.firstName()).toLowerCase()),n},outToday:function(){v.getInstance().open(this)},nextDateScheduledIn:function(t){var n=null,r=864e5;if(this.schedule()){n=new Date(t.getTime()+r);var i=t.getDay();while(!this.schedule().isScheduled(n)){if(n.getDay()===i){n=null;break}n.setTime(n.getTime()+r)}}if(!n){n=new Date(t.getTime()+r);while(n.getDay()===0||n.getDay()===6)n.setTime(n.getTime()+r)}return n},requestMove:function(){return L.open(this),L},sendNote:function(){var t=g.create(this);t.open()},edit:function(){},isAdmin:function(){return!1},emailValid:function(){var t=this,n=/^(([a-zA-Z0-9_\-\.]+)@([a-zA-Z0-9_\-\.]+)\.([a-zA-Z]{2,5}){1,25})$/;return n.test(s.trim(t.email()))},link:function(){return"#"+this.key},notifyAttendanceChange:function(){i.emit("attendanceChanged",{location:this.location(),group:this.group(),key:this.key,checkpoint:this.checkpoint()})},requestAttendance:function(){this.toggleAttendance(),this.tryDisableActions(),this.notifyAttendanceChange()},hasLabel:function(t){var n=!t||t==="All"||this.labels()&&this.labels().indexOf(t)!==-1;return n},addLabel:function(){if(s.trim(this.newLabel())==="")return;this.labels.push(this.newLabel()),this.saveProperty("labels",this.labels()),this.newLabel("")},removeLabel:function(t){this.labels.remove(t),this.saveProperty("labels",this.labels())},saveProperty:function(t,i,o){function l(){t==="labels"&&a.labels(i),a.isRemoteSaving(!1),a.newLabel(null)}var u=this.key,a=this;this.isRemoteSaving(!0);if(r.isDemo){l();return}var c={key:u,name:t,value:i};s.ajax("/remote/v1/person_property",{data:{person_property:n.toJSON(c)},type:"post",contentType:"application/x-www-form-urlencoded",success:l,error:function(){o&&o(),f.showAlert("Oops!","We were unable to save that last change.  If you have a second, check your connectivity and try again."),a.isRemoteSaving(!1)}})},createNewCheckpoint:function(t,n,i){var s=new Date,o=Math.round((new Date).getTime()/1e3),u={action:t,member_key:this.key,action_time:o,location:d.location().key,source:"local",cut:(new Date).getTime(),group:d.groupSelected()?d.group().key:this.homeroom_key(),tz:x.name()};n&&(u.note=n),t==="in"?u.in_time=s.toISOString():u.out_time=s.toISOString(),i&&(u.end_date=Math.round(i.getTime()/1e3));var a=this.checkpoint();return r.isDemo&&a&&a.inTime()&&(u.in_time=a.inTime().toISOString()),"key"in a&&this.getStateForCheckpoint(a)==="in"&&(u.key=a.key),u},uploadCheckpoint:function(t,i){var s=this;w=u.lazyLoadModule(w,"model/checkpoint");var o=w.create(t);this.checkpoint(o);if(r.isDemo)return;y.create({path:"/remote/v1/checkpoint",method:"post",success:function(e){var t=w.create(e.checkpoint);s.checkpoint(t),i&&i.dispose()},error:function(){s.checkpoint(i),s.notifyAttendanceChange(),f.showAlert("Oops!","We were unable to save that last change.  If you have a second, check your connectivity and try again.")},done:function(){o.dispose()}}).makeRequest({data:{checkpoint:n.toJSON(t),device_time:(new Date).getTime()}})},toggleAttendance:function(){var t,n=this.checkpoint();this.getStateForCheckpoint(this.checkpoint())==="in"?t="out":t="in";var r=this.createNewCheckpoint(t);this.uploadCheckpoint(r,n)},isInGroup:function(t){return!t||t.key==="all"||this.group()===t.key},isVisiting:function(){return this.isIn()&&(!this.group()||this.group()!==this.homeroom_key())},isInHomeroom:function(t){return!t||this.homeroom_key()===t.key},getStateForCheckpoint:function(t){return t?O(t.actionTime)?t.action:"out":"out"},isInState:function(t){var n=this.checkpoint();return n?this.getStateForCheckpoint(n)===t:!1},isIn:function(){return this.isInState("in")},isOut:function(){var t=this.checkpoint();return t?this.getStateForCheckpoint(t)!=="in":!0},isOutToday:function(){var t=this.checkpoint();if(!t)return!1;var n=this.getStateForCheckpoint(t);return n!=="in"&&n!=="out"},pipelineNote:function(){},otherState:function(){return this.isOut()?"in":"out"},changeGroup:function(t){var n=this;n.isRemoteSaving(!0);var r=y.create({path:"/remote/v1/dependant/move",method:"post",complete:function(){n.isRemoteSaving(!1)},success:t.success,error:function(){f.showAlert("Oops!","We were unable to save that last change.  If you have a second, check your connectivity and try again."),t.error()}});r.makeRequest({data:{child_key:n.key,group_key:t.value,move_type:t.move_type}})},move:function(t){t=t||{};if(!t.value)return;t.move_type="m",this.changeGroup(t)},visit:function(t){t=t||{},t.move_type="v",this.changeGroup(t)},getPopoverParams:function(){var t=!1;return b.CurrentUser.isCsr()&&(t={title:"Key",content:'<div style="word-wrap:break-word;"><span data-bind="text: key"></span></div><div><button class="btn btn-danger btn-mini" style="margin-left:5px;"data-bind="click:function() { $data.audit(); }">Audit</button> <button class="btn btn-success btn-mini" data-bind="click: possess">Login As</button></div>',placement:"in bottom",trigger:"click",bindContent:!0}),t},updateProperty:function(t,n){if(t==="sb")this.schedule().updateSchedule(this.inflateScheduleByte(n));else if(t==="first_name")this.firstName(n);else if(t==="last_name")this.lastName(n);else{if(t==="group"&&this.isOut())return;l.updateProperty.call(this,t,n)}},updateEmail:function(t){var n=this;n.isRemoteSaving(!0);var r=y.create({path:"/remote/v1/employee/update",method:"post",complete:function(){n.isRemoteSaving(!1)},success:t.success,error:function(n,r){n?f.showAlert("Oops!",r):f.showAlert("Oops!","We were unable to save that last change.  If you have a second, check your connectivity and try again."),t.error()}});r.makeRequest({data:{key:n.key,name:"email",value:t.value}})},inflateScheduleByte:function(t){var n=null;return p.isNull(t)?n={monday:!1,tuesday:!1,wednesday:!1,thursday:!1,friday:!1,saturday:!1,sunday:!1}:n={monday:Boolean(t&1),tuesday:Boolean(t&2),wednesday:Boolean(t&4),thursday:Boolean(t&8),friday:Boolean(t&16),saturday:Boolean(t&32),sunday:Boolean(t&64)},n},updateSubscriptionProperty:function(t,n,r){var i=this;i.isRemoteSaving(!0);var s=y.create({path:"/remote/v1/person/subscription",method:"post",complete:function(){i.isRemoteSaving(!1)},success:function(){r.value?i.addSubscription(t,n):i.removeSubscription(t,n),r.success()},error:function(){f.showAlert("Oops!","We were unable to save that last change.  If you have a second, check your connectivity and try again."),r.error()}});s.makeRequest({data:{key:i.key,action:r.value?"add":"remove",topic:t,channel:n}})},possess:function(){var t=this;if(!b.CurrentUser.isCsr())return;s.ajax({url:"/admin/possess",type:"post",data:{key:this.key}}).done(function(){location.href=t.type()==="employee"?"/atwork/enter":"/parents"}).fail(function(){f.showAlert("Oops!","Something went wrong on our end, please try again")})},audit:function(){s("#"+this.key+"-pop").popover("hide"),k.getInstance().load(this.key)}});return M}),tadpoles.define("model/employee",["require","ko","lodash","services/config","model/person","model/actionTile","model/imageTile","services/alerts","model/remote","services/modal","model/user","services/groups","model/product","emit","utilities"],function(e){var t=e("ko"),n=e("lodash"),r=e("services/config"),i=e("model/person"),s=e("model/actionTile"),o=e("model/imageTile"),u=e("services/alerts"),a=e("model/remote"),f=e("services/modal"),l=e("model/user"),c=e("services/groups"),h=e("model/product"),p=e("emit"),d=e("utilities"),v,m=[{value:l.Roles.ACCOUNT_ADMIN,name:"Account Admin"},{value:l.Roles.LOCATION_ADMIN,name:"Center Admin"},{value:l.Roles.TEACHER,name:"Teacher"}],g={name:"All",key:null},y=i.extend(o,s,{className:"Employee",initialize:function(e){var s=this;e=e||{group:{}},e.type="employee",i.initialize.call(s,e),s.receiveUnscheduledCheckins=t.observable(s.hasSubscription(s.TOPICS.UnscheduledCheckin,s.CHANNELS.Email)),s.location=t.observable(e.location||null),s.locationName=t.pureComputed(function(){var e="All";if(s.location()){var t=n.find(r.locations,function(e){return e.key===s.location()});t&&(e=t.name)}return e}),s.classroomName=t.pureComputed(function(){var e="All";if(s.homeroom_key()){var t=n.find(c.getInstance().allGroups(),function(e){return e.key===s.homeroom_key()});t&&(e=t.name)}return e}),s.cprTrainingDate=t.observable(d.convertPlatformDateStringToDate(e.cpr_training_date)),s.firstAidTrainingDate=t.observable(d.convertPlatformDateStringToDate(e.first_aid_training_date)),s.nextPhysicalDate=t.observable(d.convertPlatformDateStringToDate(e.next_physical_date)),s.note(e.note),s.allowEmployeeWebLogin=t.observable(e.allow_employee_web_login),s.emailSubscription=s.email.subscribe(function(e){n.isUndefined(s.allowEmployeeWebLogin())&&s.allowEmployeeWebLogin(e!=null)}),s.roles=t.observableArray(e.roles),s.role=t.observable(n.find(l.EmployeeRoles,function(e){return n.contains(s.roles(),e)})),s.roleSubscription=s.role.subscribe(function(e){e!==l.Roles.TEACHER&&s.homeroom_key(null),e===l.Roles.ACCOUNT_ADMIN&&s.location(null)}),s.roleName=t.pureComputed(function(){var e="None";return n.each(s.Roles,function(t){t.value===s.role()&&(e=t.name)}),e}),s.isAdmin=function(){return n.contains([l.Roles.APP_ADMIN,l.Roles.ACCOUNT_ADMIN,l.Roles.LOCATION_ADMIN,l.Roles.REGIONAL_ADMIN],s.role())},s.errors=t.observableArray([]),s.valid=t.computed(function(){var e=[],t=s,n=t.firstName()&&t.firstName().length>0;n||e.push("A first name is required");var r=t.lastName()&&t.lastName().length>0;r||e.push("A last name is required");var i=!t.email()||t.emailValid();i||e.push("A valid email address is required");var o=t.role();o||e.push("Role is required");var u=t.location()||t.isRole("AccountAdmin");return u||e.push("Location is required for Location Admins and Teachers"),s.errors(e),n&&r&&i&&o&&u}),s.status(s.Statuses.ACTIVE),s.canMove=t.pureComputed(function(){return s.isRole(l.Roles.TEACHER)||s.isIn()}),s.userCanEdit=t.pureComputed(function(){return l.CurrentUser.isCsr()?!0:l.CurrentUser.isAdmin()?s.key===l.CurrentUser.person.key?!0:l.CurrentUser.isAccountAdmin()||!s.isRole(l.Roles.ACCOUNT_ADMIN)?!0:!1:!1}),s.userCanChangeRole=t.pureComputed(function(){if(l.CurrentUser.isCsr())return!0;if(!s.userCanEdit())return!1;var e=h.getFeature(h.Features.LOCK_API_FIELDS);return e&&!l.CurrentUser.isAccountAdmin()?!1:!0}),s.userCanDelete=t.pureComputed(function(){return s.userCanEdit()?s.key===l.CurrentUser.person.key?!1:!0:!1}),s.isCurrentUser=t.pureComputed(function(){return s.key===l.CurrentUser.person.key}),s.simpleGroupsForLocation=t.pureComputed(function(){var t=n.clone(c.getInstance().getActiveSimpleGroupsForLocation(s.location()));return t.splice(0,0,g),t})},dispose:function(){var t=this;t.locationName.dispose(),t.classroomName.dispose(),t.emailSubscription.dispose(),t.roleSubscription.dispose(),t.roleName.dispose(),t.valid.dispose(),t.canMove.dispose(),t.userCanEdit.dispose(),t.userCanChangeRole.dispose(),t.userCanDelete.dispose(),t.isCurrentUser.dispose(),i.dispose.call(this),o.dispose.call(this),s.dispose.call(this)},edit:function(){v||(v=f.create({template:"view/modals/editEmployee",model:null})),v.open(this)},remove:function(e){var t=this;u.showYesNo({message:"Are you sure you want to delete "+this.firstName()+" "+this.lastName()+"?",yes:function(){var e=a.create({path:"/remote/v1/employee/delete",method:"post",success:function(e){p.emit("employee-deleted",t.key),v.close()},error:function(){u.showAlert("Oops!","Something went wrong on our end, please try again")}});e.makeRequest({data:{employee_key:t.key}})}})},clear:function(){this.firstName(null),this.lastName(null),this.fullName(null),this.email(null),this.location(null),this.homeroom_key(null),this.mobile_number(null),this.home_number(null),this.work_number(null),this.role(null),this.roles([]),this.allowEmployeeWebLogin(null)},isRole:function(e){var t=this.role();return t?t===e:!1},payload:function(){return{data:{first_name:this.firstName(),last_name:this.lastName(),email:this.email(),pin:this.pin(),role:this.role(),location:this.location(),homeroom_key:this.homeroom_key(),mobile_number:this.mobile_number(),home_number:this.home_number(),work_number:this.work_number(),allow_employee_web_login:this.allowEmployeeWebLogin()&&d.isEmail(this.email())}}},tileClicked:function(){this.isActive()?this.toggleMenu():this.edit()},classroomsForLocation:function(){var e=n.clone(c.getInstance().allGroupsForCurrentLocation());return e.splice(0,0,g),e},updateEmailWithConfirmation:function(e){var t=this;if(t.isRole("Employee"))t.updateEmail(e),t.email()||t.allowEmployeeWebLogin(!1);else{var n="Change email address?",r="Changing this email address will log out any device currently using it to access Tadpoles. If you have added a new address in its place, that will become the new login and you will need to log in again immediately.  Continue?";u.showYesNo({title:n,message:r,yes:function(){t.updateEmail(e)},no:function(){e.error()}})}},updateRole:function(e){var n=this;n.isRemoteSaving(!0);var r=a.create({path:"/remote/v1/person_property",method:"post",complete:function(){n.isRemoteSaving(!1)},success:e.success,error:function(t,n){t?u.showAlert("Oops!",n):u.showAlert("Oops!","We were unable to save that last change.  If you have a second, check your connectivity and try again."),e.error()}});r.makeRequest({data:{person_property:t.toJSON({key:n.key,name:"role",value:e.value})}})},updateRoleWithConfirmation:function(e){var t=this;if(t.isRole("Employee")){var n;t.key===l.CurrentUser.person.key?n="Changing your role to Teacher will remove all admin capabilities, including device log in, and log you out immediately. Continue?":n="Changing the role of an Administrator to Teacher will remove all admin capabilities, including device log in. Continue?",u.showYesNo({title:"Change role?",message:n,yes:function(){t.updateRole(e)},no:function(){e.error()}})}else t.updateRole(e)},updateAllowEmployeeWebLogin:function(e){var n=this;n.isRemoteSaving(!0);var r=a.create({path:"/remote/v1/person/updateAllowEmployeeWebLogin",method:"post",complete:function(){n.isRemoteSaving(!1)},success:function(){},error:function(t,n){t?u.showAlert("Oops!",n):u.showAlert("Oops!","We were unable to save that last change.  If you have a second, check your connectivity and try again."),e.error()}});r.makeRequest({data:{data:t.toJSON({key:n.key,allow_employee_web_login:n.allowEmployeeWebLogin()})}})}});return y.Roles=m,y}),tadpoles.define("model/modal/addEmployeeForm",["require","ko","services/config","model/form","services/alerts","utilities"],function(e){var t=e("ko"),n=e("services/config"),r=e("model/form"),i=e("services/alerts"),s=e("utilities"),o=null,u=null,a=r.extend({className:"AddEmployeeForm",initialize:function(){var e=this;o=s.lazyLoadModule(o,"model/employee"),r.initialize.call(this,{title:"add employee",formTemplate:"view/modals/addEmployeeForm",formModel:o.create(),formBodyHeight:680,path:"/remote/v1/employee/create",success:function(t){n.isDemo&&(t.employee={key:e.formModel().firstName()+(new Date).getTime(),first_name:e.formModel().firstName(),last_name:e.formModel().lastName(),email:e.formModel().email(),roles:[e.formModel().role()],group:{key:e.formModel().group()},homeroom_key:e.formModel().homeroom_key(),location:e.formModel().location(),mobile_number:e.formModel().mobile_number(),allow_employee_web_login:e.formModel().allowEmployeeWebLogin()});var r=o.create(t.employee);u=s.lazyLoadModule(u,"services/employees"),u.getInstance().upsertEmployee(r),e.close()}})},valid:function(){return this.formModel().valid()?!0:(i.showAlert("Something is not quite right!","Please fix the following before continuing:","warning",this.formModel().errors()),!1)}});return s.makeSingleton(a)}),tadpoles.define("services/employees",["require","ko","lodash","utilities","selfish","model/form","emit","model/employee","model/globalFilter","model/user","model/modal/addEmployeeForm","services/disposer"],function(e){var t=e("ko"),n=e("lodash"),r=e("utilities"),i=e("selfish"),s=e("model/form"),o=e("emit"),u=e("model/employee"),a=e("model/globalFilter"),f=e("model/user"),l=e("model/modal/addEmployeeForm"),c=e("services/disposer"),h=i.Base.extend({className:"Employees",initialize:function(){var e=this;e.employees=t.observableArray(),e.filteredEmployees=t.pureComputed(function r(){var r=n.filter(e.employees(),function(e){return!a.locationSelected()||e.role()===f.Roles.ACCOUNT_ADMIN||e.location()===a.location().key||!e.location()&&e.role()===f.Roles.LOCATION_ADMIN});return r}),e.sortedEmployees=t.pureComputed(function(){return n.sortBy(e.filteredEmployees(),function(e){return e.lastName()?e.lastName().toLowerCase():" "+e.firstName()})}),o.on("employee-deleted",function(t){e.removeByKey(t)}),e.roleChoices=t.pureComputed(function(){return n.reject(u.Roles,function(e){return f.CurrentUser.isTeacher()||f.CurrentUser.isCenterAdmin()&&e.value==="AccountAdmin"})}),o.on("employeesLoaded",function(t){c.dispose(e.employees()),e.employees(n.map(t.employees,function(e){return u.create(e)})),o.emit("employeeLoadComplete",{}),o.emit("remindersLoaded",{reminderType:"employee",reminders:t.reminders})}),o.on("employee-update-received",function(t){if(t.action==="upsert"){var n=u.create(t.object);e.upsertEmployee(n)}else t.action==="delete"&&e.removeByKey(t.key)})},getEmployee:function(t){return n.find(this.employees(),function(e){return e.key===t})},upsertEmployee:function(t){var r=this.employees(),i=n.findIndex(r,function(e){return e.key===t.key});i>=0?(r[i].dispose(),r[i]=t):r.push(t),this.employees(r)},removeByKey:function(t){this.employees.remove(function(e){return e.key===t})},createEmployee:function(){var t=l.getInstance();f.CurrentUser.isCenterAdmin()&&t.formModel().location(f.CurrentUser.location()),t.open()},reset:function(){c.dispose(this.employees()),this.employees([])}});return r.makeSingleton(h)}),tadpoles.define("model/editClassModal",["require","services/modal","utilities","ko"],function(e){var t=e("services/modal"),n=e("utilities"),r=e("ko"),i=null,s=t.extend({className:"EditClassModal",initialize:function(){var e=this;t.initialize.call(e,{template:"view/modals/editClass",model:null,clearModelOnClose:!0}),i=n.lazyLoadModule(i,"services/curricula"),e.curriculumChoices=r.pureComputed(function(){var e=i.getInstance().curriculumChoices().slice();return e.unshift({id:"",name:"None"}),e})}});return s}),tadpoles.define("model/wrapped",["require","selfish","ko"],function(e){var t=e("selfish"),n=e("ko"),r=t.Base.extend({className:"Wrapped",initialize:function(e){e=e||{},this.wrapped=n.observable(e.wrapped)}});return r}),tadpoles.define("model/modal/moveClassForm",["require","ko","model/form","utilities","services/groups","selfish","model/wrapped","model/selectable","services/alerts","model/globalFilter","lodash"],function(e){var t=e("ko"),n=e("model/form"),r=e("utilities"),i=e("services/groups"),s=e("selfish"),o=e("model/wrapped"),u=e("model/selectable"),a=e("services/alerts"),f=e("model/globalFilter"),l=e("lodash"),c=s.Base.extend(o,u,{className:"SelectableClassroom",initialize:function(e){o.initialize.call(this,e),u.initialize.call(this,e)}}),h=n.extend({className:"MoveClassForm",initialize:function(){var e=this;e.sourceClass=t.observable(),e.destinationClass=t.observable(),e.classrooms=t.observableArray([]),e.selectedClassrooms=t.computed(function(){var t=e.destinationClass(),n=e.sourceClass(),r=null,i=l(e.classrooms()).filter(function(e){return e.selected()?(t===e||n===e.wrapped()?e.selected(!1):r=e,!0):!1}).value();return e.destinationClass(r),i}),n.initialize.call(e,{title:"move children",formTemplate:"view/modals/moveClass",formModel:e,path:"/remote/v1/class/move",width:680,submitText:"move",success:function(){e.close()}})},payload:function(){var e={src_class_key:this.sourceClass().key,dest_class_key:this.destinationClass().wrapped().key};return e},open:function(e){this.sourceClass(e),this.title("move children from "+e.name());var t=i.getInstance().groupsForCurrentLocation();this.classrooms(l(t).filter(function(t){return t.key!==e.key}).map(function(e){return c.create({wrapped:e})}).value()),n.open.call(this)},close:function(){this.sourceClass(null),this.destinationClass(null),this.classrooms([]),n.close.call(this)},valid:function(){return this.destinationClass()?!0:(a.showAlert("Missing Info","You need to select a destination classroom","warning"),!1)}});return r.makeSingleton(h)}),tadpoles.define("model/group",["require","ko","lodash","jquery","utilities","selfish","model/actionTile","services/alerts","model/remote","model/measurable","emit","model/globalFilter","model/status","services/groups","services/uuid","model/disposable","jstz","services/children","model/detailViewPanel","services/employees","model/editClassModal","model/modal/moveClassForm","model/audit"],function(e){var t=e("ko"),n=e("lodash"),r=e("jquery"),i=e("utilities"),s=e("selfish"),o=e("model/actionTile"),u=e("services/alerts"),a=e("model/remote"),f=e("model/measurable"),l=e("emit"),c=e("model/globalFilter"),h=e("model/status"),p=e("services/groups"),d=e("services/uuid"),v=e("model/disposable"),m=e("jstz"),g=e("services/children"),y=e("model/detailViewPanel"),b=t.observable(!1);l.on("attendanceChanged",function(){b(!b())}),l.on("checkpointsLoaded",function(){b(!b())});var w={infant:1,toddler:2,preschool:3,school:4,kids:5,"undefined":6},E=s.Base.extend(v,o,f,{className:"Group",initialize:function(r){function u(e){var t=c.name().toLowerCase();return t===""&&s.key==="all"?e:(e=n.filter(e,function(e){var n=e.displayNameLower.peek()?e.displayNameLower.peek():"";return(e.isInGroup(s)||e.isInHomeroom(s))&&n.indexOf(t)!==-1}),e)}function a(e){var t=c.name().toLowerCase();return n.filter(s.children(),function(n){var r=n.displayNameLower.peek()?n.displayNameLower.peek():"";return n.status()===h.Statuses.ACTIVE&&n.isInState(e)&&n.isInGroup(s)&&r.indexOf(t)!==-1})}function l(){var e=c.name().toLowerCase();return n.filter(s.children(),function(t){var n=t.displayNameLower.peek()?t.displayNameLower.peek():"";return t.status()===h.Statuses.ACTIVE&&t.isOutToday()&&t.isInGroup(s)&&n.indexOf(e)!==-1})}function d(e){var t=c.name().toLowerCase();return n.filter(s.staff(),function(n){var r=n.displayNameLower.peek()?n.displayNameLower.peek():"";return n.isInState(e)&&n.isInGroup(s)&&r.indexOf(t)!==-1})}r=r||{key:null,name:null},v.initialize.call(this),o.initialize.call(this),f.initialize.call(this);var s=this;s.key=r.key,s.name=t.observable(r.name),s.status=t.observable(r.status||h.Statuses.ACTIVE),s.child_type=t.observable(r.child_type),s.curriculumId=t.observable(r.curriculum_id),s.sort=t.observable(r.sort),s.xid=t.observable(r.xid),s.displayable_child_type=t.pureComputed(function(){var e=s.child_type();return e==="kids"?"any":e}),s.location_key=t.observable(r.location_key),s.ratio1=t.observable(r.ratio1),s.ratio2=t.observable(r.ratio2),s.capacity=t.observable(r.capacity),s.minEnrollAgeYear=t.observable(Math.floor(r.min_enroll_age_months/12)),s.minEnrollAgeMonth=t.observable(r.min_enroll_age_months%12),s.maxEnrollAgeYear=t.observable(Math.floor(r.max_enroll_age_months/12)),s.maxEnrollAgeMonth=t.observable(r.max_enroll_age_months%12),s.minEnrollAgeInMonths=t.pureComputed(function(){return s.minEnrollAgeYear()*12+s.minEnrollAgeMonth()}),s.maxEnrollAgeInMonths=t.pureComputed(function(){return s.maxEnrollAgeYear()*12+s.maxEnrollAgeMonth()}),s.calculateCapacity=function(){return s.isClass()?s.capacity():n.reduce(p.getInstance().allGroups(),function(e,t){return e+(t.capacity()?Number(t.capacity()):0)},0)},s.children=t.pureComputed(function(){var e=g.getInstance().childrenForLocationAndLabel();return u(e)}).extend({rateLimit:250}),s.staff=t.pureComputed(function(){var t=e("services/employees"),n=t.getInstance().filteredEmployees();return u(n)}).extend({rateLimit:250}),s.childrenForRoster=t.pureComputed(function(){var e=n.filter(s.children(),function(e){return e.statuses().indexOf(E.statusFilter())!==-1});return e.sort(function(e,t){var n=e.rosterSortValue(),r=t.rosterSortValue();return n===r?0:n>r?1:-1}),e}),s.childrenAssignedToHomeroom=t.pureComputed(function(){var e=g.getInstance().childrenForLocationAndLabel();return s.isLocation()?e:n.filter(e,function(e){return e.isInHomeroom(s)})}).extend({rateLimit:200}),s.valid=t.pureComputed(function(){return s.name()&&s.name().length>0&&s.child_type()&&s.location_key()&&s.location_key().length>0}),s.childrenInToday=t.pureComputed(function(){return n.filter(s.childrenAssignedToHomeroom(),function(e){return e.wasInToday()})}),s.sortableValue=t.pureComputed(function(){if(s.key==="all")return 0;if(!i.isNull(s.sort())){var e=Number(s.sort());if(!n.isNaN(e))return e}if(i.isNull(s.name()))return"0";var t=w[s.child_type()];return i.isNull(t)&&(t=10),"_"+t+"_"+s.name().toLowerCase()}),s.isActive=t.pureComputed(function(){return s.status()===h.Statuses.ACTIVE}),s.staffIn=t.pureComputed(function(){return b(),n(d("in")).sortBy(function(e){return e.sortValueForGroup(s)}).value()}).extend({rateLimit:200}),s.childrenIn=t.pureComputed(function(){return b(),a("in")}).extend({rateLimit:200}),s.childrenOut=t.pureComputed(function(){b();var e=c.name().toLowerCase();return n(s.children()).filter(function(t){var n=t.displayNameLower.peek()?t.displayNameLower.peek():"";return(!t.isInState("in")||t.isInHomeroom(s)&&t.isVisiting())&&t.status()===h.Statuses.ACTIVE&&n.indexOf(e)!==-1}).sortBy(function(e){return e.sortValueForGroup(s)}).value()}).extend({rateLimit:200}),s.staffOut=t.pureComputed(function(){b();var e=c.name().toLowerCase();return n(s.staff()).filter(function(t){var n=t.displayNameLower.peek()?t.displayNameLower.peek():"";return(!t.isInState("in")||t.isInHomeroom(s)&&t.isVisiting())&&n.indexOf(e)!==-1}).sortBy(function(e){return e.sortValueForGroup(s)}).value()}).extend({rateLimit:200}),s.childrenOutToday=t.pureComputed(function(){return b(),l()}).extend({rateLimit:200}),s.numChildrenIn=t.pureComputed(function(){return s.childrenIn().length}),s.numStaffIn=t.pureComputed(function(){return s.staffIn().length}),s.numChildrenOut=t.pureComputed(function(){return n(s.childrenOut()).filter(function(e){return!e.isOutForReason()&&!e.wasInToday()}).value().length}),s.numChildrenExpected=t.pureComputed(function(){return n(s.childrenAssignedToHomeroom()).filter(function(e){return e.isScheduledToday()&&!e.isOutForReason()}).value().length}),s.numStaffOut=t.pureComputed(function(){return s.staffOut().length}),s.displayableCombinedIn=t.pureComputed(function(){return s.numChildrenIn()+"/"+s.numStaffIn()}),s.displayableCombinedOut=t.pureComputed(function(){return s.numChildrenOut()+"/"+s.numStaffOut()}),s.peopleIn=t.pureComputed(function(){var e=[];if(y.getInstance().staffActive()||y.getInstance().allActive())e=e.concat(s.staffIn());if(y.getInstance().studentsActive()||y.getInstance().allActive())e=e.concat(s.childrenIn());return e}),s.peopleOut=t.pureComputed(function(){var e=[];if(y.getInstance().staffActive()||y.getInstance().allActive())e=e.concat(s.staffOut());if(y.getInstance().studentsActive()||y.getInstance().allActive())e=e.concat(s.childrenOut());return e}),s.isRemoteSaving=t.observable(!1),s.maximumNumberOfChildrenAllowed=t.pureComputed(function(){var e=s.numStaffIn();if(e===0)return 0;var t=s.ratio1();if(i.isNull(t))return undefined;if(e===1)return t;var n=s.ratio2();return e===2?i.isNull(n)?t*2:n:i.isNull(n)?t*e:n/2*e}),s.isOutOfRatio=t.pureComputed(function(){var e=s.numChildrenIn(),t=s.maximumNumberOfChildrenAllowed();return t===undefined?!1:e<=t?!1:!0}),s.requiredRatio=t.pureComputed(function(){var e=s.child_type();return e==="infant"?4:e==="toddler"?5:e==="preschool"?6:e==="school"?8:12}),s.color=t.pureComputed(function(){var e=s.child_type();return s.isActive()?e==="infant"?"#E3F3F8":e==="toddler"?"#EFE9FA":e==="preschool"?"#FAECE9":e==="school"?"#E9FAEB":e==="any"||e==="kids"?"#DBDBDB":s.isLocation?"#DBDBDB":"white":"#DA4F49"}),s.darkColor=t.pureComputed(function(){var e=s.child_type();return e==="infant"?"#8888F8":e==="toddler"?"purple":e==="preschool"?"orange":e==="school"?"green":e==="any"||e==="kids"?"grey":s.isLocation?"grey":"white"})},dispose:function(){var t=this;t.displayable_child_type.dispose(),t.children.dispose(),t.staff.dispose(),t.childrenForRoster.dispose(),t.childrenAssignedToHomeroom.dispose(),t.valid.dispose(),t.childrenInToday.dispose(),t.sortableValue.dispose(),t.isActive.dispose(),t.staffIn.dispose(),t.childrenIn.dispose(),t.childrenOut.dispose(),t.staffOut.dispose(),t.childrenOutToday.dispose(),t.numChildrenIn.dispose(),t.numStaffIn.dispose(),t.numChildrenOut.dispose(),t.numChildrenExpected.dispose(),t.numStaffOut.dispose(),t.displayableCombinedIn.dispose(),t.displayableCombinedOut.dispose(),t.peopleIn.dispose(),t.peopleOut.dispose(),t.maximumNumberOfChildrenAllowed.dispose(),t.isOutOfRatio.dispose(),t.requiredRatio.dispose(),t.color.dispose(),t.darkColor.dispose(),o.dispose.call(this),f.dispose.call(this),v.dispose.call(this)},isInLocation:function(t){return t?this.location_key()&&this.location_key()===t.key:!1},isLocation:function(){return this.key==="all"},isClass:function(){return this.key!=="all"},clear:function(){this.name(""),this.child_type(null)},remove:function(){var n=this;if(n.children().length>0){u.showAlert("Not yet!",this.name()+" class still has children.  Please move or delete all children before removing the class.");return}u.showYesNo({message:"Are you sure you want to delete "+this.name()+"?",yes:function(){var e=a.create({path:"/remote/v1/class",method:"post",success:function(){n.status("inactive"),l.emit("class-deleted",t.toJS(n))},error:function(e,t){e==="API_LOCK"?u.showAlert("Oops!",t):u.showAlert("Oops!","Something went wrong on our end, please try again")}});e.makeRequest({data:{key:n.key,name:"status",value:"inactive"}})}})},revive:function(){var t=this;u.showYesNo({message:"Are you sure you want to revive "+this.name()+"?",yes:function(){var e=a.create({path:"/remote/v1/class",method:"post",success:function(){t.status("active")},error:function(e,t){e==="API_LOCK"?u.showAlert("Oops!",t):u.showAlert("Oops!","Something went wrong on our end, please try again")}});e.makeRequest({data:{key:t.key,name:"status",value:"active"}})}})},selectAndToggleMenu:function(){c.group(this),this.toggleMenu()},requestEdit:function(){var n=e("model/editClassModal"),r=n.create();r.open(this)},requestMove:function(){var n=e("model/modal/moveClassForm");n.getInstance().open(this)},changeValue:function(t,n){var r=this;r.isRemoteSaving(!0);var i=a.create({path:"/remote/v1/class/change_"+t,method:"post",complete:function(){r.isRemoteSaving(!1)},success:n.success,error:function(){u.showAlert("Oops!","We were unable to save that last change.  If you have a second, check your connectivity and try again."),n.error()}}),s={class_key:r.key};s["class_"+t]=n.value,i.makeRequest({data:s})},changeMinEnrollAgeInMonths:n.throttle(function(){this.changeValue("min_enroll_age_months",{value:this.minEnrollAgeInMonths()})},5e3,{leading:!1,trailing:!0}),changeMaxEnrollAgeInMonths:n.throttle(function(){this.changeValue("max_enroll_age_months",{value:this.maxEnrollAgeInMonths()})},5e3,{leading:!1,trailing:!0}),changeType:function(t){this.changeValue("type",t)},changeSort:function(t){this.changeValue("sort",t)},changeName:function(t){this.changeValue("name",t)},changeRatio1:function(t){this.changeValue("ratio1",t)},changeRatio2:function(t){this.changeValue("ratio2",t)},changeCapacity:function(t){this.changeValue("capacity",t)},changeCurriculumId:function(t){function r(e){n(e),l.emit("curriculumChanged",{})}var n=t.success||function(){};t.success=r,this.changeValue("curriculum_id",t)},hasChildrenAssignedToHomeroom:function(){var t=this.childrenAssignedToHomeroom();return t.length>0},payload:function(){return{data:{location_key:this.location_key(),name:this.name(),child_type:this.child_type(),curriculum_id:this.curriculumId}}},createUnphotoedStudentNamesSticky:function(){function t(e){return e.firstName()+(e.lastName()&&e.lastName().length>0?" "+e.lastName()[0]:"")}var r=n.sortBy(this.childrenWithoutPhotos(),function(e){return e.firstName()}),i=(new Date).format("shortTime"),s=r.length+" "+(r.length===1?"child":"children")+" without a photo at "+i+" - ";return s+=n.reduce(r,function(e,n){var r=e.length>0?", ":"";return e+r+t(n)},""),s},hidePopover:function(){r(".popover").each(function(){r(this).hide()})},audit:function(){if(this.isLocation())return;var n=e("model/audit");n.getInstance().load(this.key)},sendUnphotoedStudentsSticky:n.throttle(function(){this.hidePopover();var n=a.create({path:"/remote/v1/event",method:"post",error:function(e,t){var n=t?t:"Something went wrong on our end, please try again";u.showAlert("Oops!",n)},success:function(){}}),r={type:"Note",action:"StickyNote",event_time:(new Date).getTime()/1e3,location:c.location().key,group:this.key,scope:"group",comment:this.createUnphotoedStudentNamesSticky(),tz:m.determine().name(),visibility:["t"],uuid:d.v4()};n.makeRequest({data:{event:t.toJSON(r)}})},250,{trailing:!1})});return E.statusFilter=t.observable(h.Statuses.ACTIVE),E.yearOptions=[{value:0,text:"0 year"},{value:1,text:"1 year"},{value:2,text:"2 year"},{value:3,text:"3 year"},{value:4,text:"4 year"},{value:5,text:"5 year"},{value:6,text:"6 year"}],E.monthOptions=[{value:0,text:"0 month"},{value:1,text:"1 month"},{value:2,text:"2 month"},{value:3,text:"3 month"},{value:4,text:"4 month"},{value:5,text:"5 month"},{value:6,text:"6 month"},{value:7,text:"7 month"},{value:8,text:"8 month"},{value:9,text:"9 month"},{value:10,text:"10 month"},{value:11,text:"11 month"}],E}),tadpoles.define("services/guardians",["require","jquery","ko","lodash","services/config","selfish","emit","utilities","model/remote"],function(e){var t=e("jquery"),n=e("ko"),r=e("lodash"),i=e("services/config"),s=e("selfish"),o=e("emit"),u=e("utilities"),a=e("model/remote"),f=null,l=s.Base.extend({className:"Guardians",initialize:function(e){var t=this;t.synchronized=n.observable(),t.guardians=n.observableArray([]),t.guardiansByKey=n.pureComputed(function(){var e={};return r.each(t.guardians(),function(t){e[t.key]=t}),e}),o.on("activeChildrenLoaded",function(e){if(i.isDemo){f=u.lazyLoadModule(f,"model/guardian");var n=r.map(r.uniq(r.flatten(r.pluck(e.dependants,"guardians")),function(e){return e.key}),function(e){return f.create(e)});t.guardians(n)}})},reset:function(){this.guardians([]),this.synchronized(!1)},getGuardian:function(e){return this.guardiansByKey()[e]},addGuardian:function(e){if(this.getGuardian(e.key))return;this.guardians.push(e)},addGuardians:function(e){var t=r.reject(e,function(e){return this.getGuardian(e.key)});this.guardians(this.guardians().concat(t))},getGuardiansForChildDeferred:function(e){f=u.lazyLoadModule(f,"model/guardian");var n=this,s=new t.Deferred;if(this.synchronized()||i.isDemo){var o=r.filter(this.guardians(),function(t){return t.family()===e.family()});s.resolve(o)}else{var l=a.create({path:"/remote/v1/guardians?child="+e.key,method:"get",success:function(e){var t=[];r.each(e.guardians,function(e){var n=f.create(e);t.push(n)}),s.resolve(t)},error:function(e){s.reject()}});l.makeRequest()}return s.promise()}});return u.makeSingleton(l)}),tadpoles.define("model/modal/addGuardianForm",["require","ko","services/config","model/form","services/alerts","services/children","utilities","services/guardians"],function(e){var t=e("ko"),n=e("services/config"),r=e("model/form"),i=e("services/alerts"),s=null,o=e("services/children"),u=e("utilities"),a=e("services/guardians"),f=r.extend({className:"AddGuardianForm",initialize:function(){s=u.lazyLoadModule(s,"model/guardian");var e=this;r.initialize.call(this,{title:"add contact",width:"510px",formTemplate:"view/modals/addGuardianForm",formModel:s.create(),path:"/remote/v1/dependant/guardian/create",success:function(t){var r=e.formModel().dependant_key(),i=o.getInstance().getChild(r),u=n.isDemo?{key:(i?i.key:"")+(new Date).getTime(),group:{key:(i?i.key:"")+(new Date).getTime()},first_name:e.formModel().firstName(),last_name:e.formModel().lastName(),email:e.formModel().email(),type:e.formModel().type(),home_number:e.formModel().home_number(),work_number:e.formModel().work_number(),mobile_number:e.formModel().mobile_number(),pin:e.formModel().pin()}:t,f=s.create(u);a.getInstance().addGuardian(f),i&&i.guardians.push(f),e.close()}})},valid:function(){return this.formModel().valid()?!0:(i.showAlert("Something is not quite right!","Please fix the following before continuing:","warning",this.formModel().errors()),!1)}});return u.makeSingleton(f)}),tadpoles.define("model/guardian",["require","ko","utilities","services/alerts","services/modal","model/remote","model/person","model/modal/addGuardianForm","services/children"],function(e){var t=e("ko"),n=e("utilities"),r=e("services/alerts"),i=e("services/modal"),s=e("model/remote"),o=e("model/person"),u=e("model/modal/addGuardianForm"),a=e("services/children"),f={primary:1,medical:2,guardian:3,emergency:4,authorized:5,friend:6,individual:7,provider:8,contact:9,other:10},l=i.create({template:"view/modals/editGuardian",model:null,width:"510px"}),c=o.extend({className:"Guardian",initialize:function(e){var n=this;e=e||{},e.family=e.group?e.group.key:null,n.errors=t.observableArray([]),o.initialize.call(n,e),n.dependant_key=t.observable(e.dependant_key),n.note=t.observable(e.note),n.special_note=t.observable(e.special_note)},dispose:function(){o.dispose.call(this)},add:function(e){var t=u.getInstance();t.formModel().dependant_key(e.key),t.open()},edit:function(e){return this.dependant_key(e?e.key:null),l.open(this),l},remove:function(){var e=this,n=a.getInstance().getChild(this.dependant_key());r.showYesNo({message:"Are you sure you want to delete "+this.firstName()+" "+this.lastName()+"?",yes:function(){var i=s.create({path:"/remote/v1/dependant/guardian/delete",method:"post",success:function(){n.removeGuardian(e.key),l.close()},error:function(){r.showAlert("Oops!","Something went wrong on our end, please try again")}});i.makeRequest({data:{guardian:t.toJSON({key:e.key}),dependant:t.toJSON({key:n.key})}})}})},payload:function(){return{dependant:this.dependant_key(),guardian:{first_name:this.firstName(),last_name:this.lastName(),email:this.email(),type:this.type(),mobile_number:this.mobile_number(),home_number:this.home_number(),work_number:this.work_number(),dependant_key:this.dependant_key(),note:this.note(),special_note:this.special_note(),pin:this.pin()}}},clear:function(){this.fullName(null),this.firstName(null),this.lastName(null),this.email(null),this.type(null),this.mobile_number(null),this.home_number(null),this.work_number(null),this.pin(null),this.note(null),this.special_note(null)},valid:function(){var e=[],t=this,n=t.firstName()&&t.firstName().length>0,r=t.lastName()&&t.lastName().length>0,i=n&&r;n&&!r&&e.push("Both first and last name are required");var s=!t.email()||t.emailValid();s||e.push("A valid email address is required");var o=t.type();o||e.push("Type is required");var u=i||t.emailValid();return u||e.push("You must provide either a full name or email (or both)"),this.errors(e),t.dependant_key()&&u&&s&&o},sortValue:function(){var e=this.type(),t=f[e];return n.isNull(t)&&(t=99),t+"_"+this.sort()}});return c}),tadpoles.define("model/child",["require","ko","lodash","services/config","utilities","services/modal","services/guardians","model/guardian","model/person","model/detailViewPanel","model/user","services/alerts","model/remote","services/children","model/globalFilter","services/disposer"],function(e){var t=e("ko"),n=e("lodash"),r=e("services/config"),i=e("utilities"),s=e("services/modal"),o=null,u=e("services/guardians"),a=e("model/guardian"),f=e("model/person"),l=e("model/detailViewPanel"),c=e("model/user"),h=e("services/alerts"),p=e("model/remote"),d=e("services/children"),v=e("model/globalFilter"),m=e("services/disposer"),g=null,y=s.extend({className:"ProfileModal",initialize:function(e){var n=this;this.loadingGuardians=t.observable(!1),s.initialize.call(n,e)},open:function(e){var t=this;s.open.call(y,e),this.loadingGuardians(!0),u.getInstance().getGuardiansForChildDeferred(e).done(function(n){e.guardians(n),t.loadingGuardians(!1)})},close:function(){y.model().guardians([]),y.model().removedChild()&&d.getInstance().removeChild({key:y.model().key}),y.model().removedChild(!1),s.close.call(y)}}).create({template:"view/modals/editChildProfile",model:null,width:920,clearModelOnClose:!0}),b=null,w=f.extend({className:"Child",initialize:function(r){f.initialize.call(this,r);var s=this;s.note=t.observable(r.note),s.special_note=t.observable(r.special_note),s.isSelected=t.observable(!1),s.group()||s.group(r.group.key),s.family=t.observable(r.family),s.key=r.key,s.location=t.observable(r.location),s.location_key=t.observable(r.location?r.location.key:null),s.attachmentKey(r.image_attachment),s.labels=t.observableArray(r.labels||[]),s.newLabel=t.observable(),s.isEditing=t.observable(!1),s.child_type=t.observable(r.child_type||"toddler"),s.tsg_link_error=r.tsg_link_status==="failed",s.curriculum_id=t.observable(r.curriculum_id?r.curriculum_id:null),s.age=t.pureComputed(function(){var t=null;if(s.birthDate()){var n=new Date,r=n,i=s.birthDate();s.birthDate()>n?(r=s.birthDate(),i=n,t="Due in "):t="";var o=r.getUTCFullYear()-i.getUTCFullYear(),u=r.getMonth()-i.getMonth(),a=r.getDate()<i.getDate();(u<0||u===0&&a)&&o--,o>=2&&(t+=o+"y ");var f=u+(o===1?12:0);a?u>0?f--:u<=0&&(f+=11):u<0&&(f+=12),t+=f+"m"}return t}),s.nextMedicalDate=t.observable(i.convertPlatformDateStringToDate(r.nm)),s.reportStatus=t.observable(!1).extend({throttle:200}),s.reportStatusCSS=t.pureComputed(function(){var t=s.reportStatus();return t==="no email"?"noemail":t}),s.guardians=t.observableArray([]),s.guardiansJSON=r.guardiansJSON,s.guardiansForDisplay=t.pureComputed(function(){var t=n.sortBy(s.guardians(),function(e){return e.sortValue()});return t.push(a.create({first_name:"add",key:"__add__"})),t}),s.displayableNote=t.pureComputed(function(){return i.valueOrNbsp(s.note())}),s.displayableSpecialNote=t.pureComputed(function(){return n.compose(i.valueOrNbsp,s.special_note)}),s.shouldShowDetail=t.pureComputed(function(){return s.isSelected()}),s.canMove=t.observable(!0);var o={resent:"01",spam:"02","soft-bounced":"03",rejected:"04","no email":"05",opened:"06",delivered:"07",sent:"08",unviewed:"09"};s.dailyReportSort=t.pureComputed(function(){var t=s.reportStatus(),n=o[t];return n||(!s.wasInToday()||s.isOutForReason()?n="11":n="10"),(n+"_"+s.lastName()+" "+s.firstName()).toLowerCase()}),s.rosterSortValue=t.pureComputed(function(){var t=0;return s.status()===s.Statuses.TOURING||s.status()===s.Statuses.VISITED?s.tourDate()&&(t=s.tourDate().getTime()):s.birthDate()&&(t=s.birthDate().getTime()),t}),s.editStartOfDay=function(){},s.pipelineNote=t.pureComputed(function(){var t=null;return s.status()===s.Statuses.SCHEDULED&&s.schedule().enrollment_date()?t="Enroll: "+s.schedule().enrollment_date().format("tinyDate"):s.status()!==s.Statuses.TOURING&&s.status()!==s.Statuses.VISITED||!s.tourDate()?s.isDisenrolling()?s.isReturning()?t="Out: "+s.schedule().graduation_date().format("tinyDate")+" - "+s.schedule().return_date().format("tinyDate"):t="Leaving: "+s.schedule().graduation_date().format("tinyDate"):s.isSuspended()&&(s.isReturning()&&s.schedule().graduation_date()?t="Out: "+s.schedule().graduation_date().format("tinyDate")+" - "+s.schedule().return_date().format("tinyDate"):s.isReturning()?t="Returning: "+s.schedule().return_date().format("tinyDate"):s.schedule().graduation_date()&&(t="Left: "+s.schedule().graduation_date().format("tinyDate"))):t="Tour: "+s.tourDate().format("tinyDate"),t}),s.errors=t.observableArray([]),s.valid=t.computed(function(){var t=[],n=s.location();n||t.push("Location is required");var r=s.homeroom_key();return r||t.push("Homeroom is required"),s.errors(t),n&&r}),s.removedChild=t.observable(),g=i.lazyLoadModule(g,"services/curricula"),s.curriculumChoices=t.pureComputed(function(){var e=g.getInstance().curriculumChoices().slice();return e.unshift({id:"",name:"homeroom default"}),e})},dispose:function(){var t=this;t.age.dispose(),t.reportStatusCSS.dispose(),t.displayableNote.dispose(),t.displayableSpecialNote.dispose(),t.shouldShowDetail.dispose(),t.dailyReportSort.dispose(),t.rosterSortValue.dispose(),t.pipelineNote.dispose(),t.valid.dispose(),m.dispose(t.guardiansForDisplay()),t.guardiansForDisplay.dispose(),f.dispose.call(this)},changeLocation:function(t){t=t||{};var i=this;i.isRemoteSaving(!0);var s=p.create({path:"/remote/v1/dependant/relocate",method:"post",complete:function(){i.isRemoteSaving(!1)},success:function(){t.value===v.location().key?i.removedChild()&&i.removedChild(!1):i.removedChild(!0),i.location(n(r.locations).find(function(e){return t.value===e.key})),i.location_key(i.location().key)},error:function(){h.showAlert("Oops!","We were unable to save that last change.  If you have a second, check your connectivity and try again.")}});s.makeRequest({data:{member_key:i.key,location_key:t.value}})},edit:function(){return y.open(this),y},selectGuardians:function(){this.selectedTab("guardians")},selectEnroll:function(){this.selectedTab("enroll")},showPortfolio:function(){return b||(o=i.lazyLoadModule(o,"model/observations"),b=o.create({template:"view/modals/observations",model:null,width:775})),b.open(this),b},removeGuardian:function(t){this.guardians.remove(function(e){return e.key===t})},getPopoverParams:function(){var t=!1;return c.CurrentUser.isCsr()&&(t={title:"Key",content:'<div style="word-wrap:break-word;"><span data-bind="text: key"></span></div><div style="margin-top:15px;"><button class="btn btn-danger btn-mini" style="margin-left:5px;" data-bind="click:function() { $data.audit(); }">Audit</button><div class="clearfix"></div></div>',placement:"bottom",trigger:"click",bindContent:!0}),t},tileClicked:function(){if(l.getInstance().portfolioActive())return this.showPortfolio();l.getInstance().rosterActive()?this.edit():this.toggleMenu()},updateProperty:function(n,r){n==="ed"?this.schedule().enrollment_date(i.convertPlatformDateStringToDate(r)):n==="gd"?this.schedule().graduation_date(i.convertPlatformDateStringToDate(r)):n==="en"?this.schedule().enrollment=t.observable(r):n==="birth_date"?this.birthDate(i.convertPlatformDateStringToDate(r)):n==="tour_date"?this.tourDate(i.convertPlatformDateStringToDate(r)):n==="nm"?this.nextMedicalDate(i.convertPlatformDateStringToDate(r)):f.updateProperty.call(this,n,r)},setTourDate:function(n){n=n||{};var r=this,i=r.schedule(),s=r.status(),o=i.enrollment_date()?new Date(i.enrollment_date()):null,u=i.graduation_date()?new Date(i.graduation_date()):null,a=o,f=u;if(s===r.Statuses.TOURING||s===r.Statuses.INTERESTED)a=n.value?new Date(n.value):null,f=n.value?new Date(n.value):null;var l=s;s===r.Statuses.INTERESTED&&n.value?l=r.Statuses.TOURING:s===r.Statuses.TOURING&&!n.value&&(l=r.Statuses.INTERESTED),r.disableRemoteSaving(!0),r.status(l),i.disableRemoteSaving(!0),i.enrollment_date(a),i.graduation_date(f),r.isRemoteSaving(!0);var c=p.create({path:"/remote/v1/person_property",method:"post",complete:function(){r.isRemoteSaving(!1),r.disableRemoteSaving(!1),i.disableRemoteSaving(!1)},success:n.success,error:function(){r.status(s),i.enrollment_date(o),i.graduation_date(u),h.showAlert("Oops!","We were unable to save that last change.  If you have a second, check your connectivity and try again."),n.error()}});c.makeRequest({data:{person_property:t.toJSON({key:r.key,name:"tour_date",value:n.value})}})},moveHomeroom:function(n){var r=this;r.curriculum_id()!=null&&r.curriculum_id().length>0&&h.showYesNo({message:"This child's curriculum has been overridden. Would you like to clear the override?",yes:function(){var e=p.create({path:"/remote/v1/person_property",method:"post",complete:function(){r.isRemoteSaving(!1),r.curriculum_id("")},success:n.success,error:function(){h.showAlert("Oops!","We were unable to save that last change.  If you have a second, check your connectivity and try again."),n.error()}});e.makeRequest({data:{person_property:t.toJSON({key:r.key,name:"curriculum_id",value:""})}})},no:function(){}}),r.move(n)}});return w}),tadpoles.define("model/quickAdd",["require","ko","jquery","lodash","services/config","services/groups","services/children","model/child","services/guardians","model/guardian","model/form"],function(e){var t=e("ko"),n=e("jquery"),r=e("lodash"),i=e("services/config"),s=e("services/groups"),o=e("services/children"),u=e("model/child"),a=e("services/guardians"),f=e("model/guardian"),l=e("model/form"),c=l.extend({className:"QuickAdd",initialize:function(e){var c=this;l.initialize.call(this,{title:"add child",formTemplate:"view/quickAdd",formModel:this,width:"910",path:"/remote/v1/dependant/create",success:function(e){var n;if(i.isDemo){var l=s.getInstance().getGroup(c.groupKey()),h=c.firstName()+(new Date).getTime();n={key:h,family:h,first_name:c.firstName(),last_name:c.lastName(),child_type:l.child_type,status:"active",group:l},n.guardians=[],r.each(c.selectedGuardians(),function(e){var i=r.clone(t.toJS(e.guardian));i.key=i.key+h,i.first_name=i.firstName,i.last_name=i.lastName,i.image_attachment=i.attachmentKey,i.group={key:h},n.guardians.push(i)})}else n=e.dependant;n.location=r(i.locations).find(function(e){return n.location_key===e.key});var p=u.create(n);p=o.getInstance().addChild(p),r.each(n.guardians,function(e){a.getInstance().addGuardian(f.create(e))}),c.close(),p.edit()}}),c.locationKey=t.observable(),c.groupKey=t.observable(),c.firstName=t.observable(),c.lastName=t.observable(),c.rawFullName=t.observable(),c.fullName=t.computed({read:function(){return c.rawFullName()},write:function(e){c.rawFullName(e),e=n.trim(e);var t=e.split(" ");c.firstName(t.length>0?n.trim(t[0]):null),c.lastName(t.length>1?n.trim(t[1]):null)},owner:c}),c.loadingGuardians=t.observable(!1),c.sibling=t.observable(),c.siblings=t.pureComputed(function(){var e=[],n=c.lastName()?c.lastName().toLowerCase():null;return n&&(e=r.map(r.filter(o.getInstance().children(),function(e){var t=e.lastName.peek()?e.lastName.peek().toLowerCase():null;return n===t}),function(e){return{child:e,selected:t.observable(),toggleSelection:function(){this.selected(!this.selected())}}})),e.length===0&&c.sibling(null),e}),c.sibling.subscribe(function(e){c.guardians([]);if(!e){c.loadingGuardians(!1);return}c.loadingGuardians(!0),a.getInstance().getGuardiansForChildDeferred(e).done(function(n){if(!c.sibling()||e.key!==c.sibling().key)return;var i=r.map(n,function(e){return{guardian:e,selected:t.observable(),toggleSelection:function(){this.selected(!this.selected())}}});c.guardians(i),c.loadingGuardians(!1)})}),c.guardians=t.observableArray(),c.selectedGuardians=t.pureComputed(function(){return r.filter(c.guardians(),function(e){return e.selected()})})},selectSibling:function(e){e.selected(!e.selected()),this.sibling(e.selected()?e.child:null),r.each(this.siblings(),function(t){e.child.key!==t.child.key&&t.selected(null)})},payload:function(){var e={dependant:{first_name:this.firstName(),last_name:this.lastName(),location:this.locationKey(),group:this.groupKey()}},t=r.map(this.selectedGuardians(),function(e){return{key:e.guardian.key}});return e.dependant.guardians=t,e},clear:function(){this.fullName(""),this.locationKey(null),this.groupKey(null)},valid:function(){return this.firstName()&&this.firstName().length>0&&this.locationKey()&&this.groupKey()}});return c}),tadpoles.define("services/connection",["require","services/config","emit","jquery","lodash","channels"],function(e){function y(){if(g)return;g=!0}function b(){v!==d.Disconnected&&(v=d.Disconnecting);if(f){try{console.log("Connection: closeIfOpen: attempting close"),f.close(),console.log("Connection: closeIfOpen: close called")}catch(e){console.log("Connection: closeIfOpen: close failed"+e)}f=null}}function w(){l&&clearTimeout(l)}function E(){if(!t.channel.isDummy)return;b(),w(),p=null}function x(){w(),l=setTimeout(S,s)}function T(e){return e&&(e.code===401||e.code===400||e.code===-1||e.code===503)}function N(e){return!1}function k(){console.log("onConnect"),v=d.Connected,m=0,c.onSuccess&&c.onSuccess()}function L(e){if(T(e)){try{r("#wcs-iframe").remove()}catch(t){console.log("wcs-iframe removal failed")}v=d.ChannelDead}else N(e)&&(v=v===d.Disconnecting?d.Terminated:d.Disconnected);console.log("onSocketError "+e.description+" "+e.code),v!==d.Terminated&&v!==d.Disconnecting&&(n.emit("message-gap"),c.onError&&(console.log("Connection: calling onError"),c.onError())),A()}function O(){console.log("onSocketClose");if(v===d.Connected||v===d.Connecting)v=d.Disconnected;c.onClose&&(console.log("Connection: calling onClose"),c.onClose()),A()}function M(){console.log("Connection: createNewSocket");if(v!==d.Connecting&&v!==d.Connected){console.log("Connection: createNewSocket: try");try{v=d.Connecting,m+=1,f=h.open({onopen:k,onmessage:c.onMessage,onerror:L,onclose:O}),console.log("Connection: createNewSocket: openCalled")}catch(e){console.log("Connection: createNewSocket: exception "+e),S()}}}function _(e){e?setTimeout(M,2e3):setTimeout(M,o)}function D(e){function o(e){console.log("Connection: handleError"),e==="MAINT"?n.emit("maintenance"):n.emit("connection-failed"),s()}console.log("Create channel with topic");if(t.channel.isDummy){n.emit("connection-failed",{permanent:!0});return}var s=i.once(function(){console.log("Connection: retryConnection"),setTimeout(function(){D(e)},a)});c=e,x();var u=e.topic;b(),console.log("Connection: /topic/register");try{r.ajax("/topic/register",{data:{topic:u},statusCode:{401:function(){console.log("Connection: session expired"),n.emit("sessionExpired",{})},500:o},type:"get",contentType:"application/x-www-form-urlencoded",success:function(e){console.log("Connection: ajax success call back");var t=e;if(t.error){o(t.error_code);return}p=t.token,i.delay(function(){h=new goog.appengine.Channel(t.token),console.log("Connection: created channel"),_(!0),console.log("Connection: retry called")},1e3)},error:function(){o()}})}catch(f){console.log("Connection: exception in ajax attempt")}console.log("Connection: ajax submitted")}function P(){return p}var t=e("services/config"),n=e("emit"),r=e("jquery"),i=e("lodash");e("channels");var s=54e5,o=1e4,u=6e3,a=6e3,f,l,c,h,p,d={Connected:1,Connecting:2,Disconnected:3,Disconnecting:4,Terminated:5,ChannelDead:6},v=d.Disconnected,m=0,g=!1,S=i.debounce(function(){E(),setTimeout(function(){D(c)},u)},2e3),C=null,A=i.debounce(function(){v===d.ChannelDead||v===d.Disconnected?(v=d.Disconnected,console.log("Connection: RestartChannel"),S()):v===d.Disconnected?(console.log("Connection: RetryNewSocket"),_()):v==d.Terminated||v==d.Disconnecting?(console.log("Connection: Terminated"),v==d.Terminated):console.log("Connection: Else in state "+v),v!==d.Terminated&&v!==d.Connected&&n.emit("connection-failed")},5e3);return t.resetConnection=function(){L({description:"manual restart initiated",code:400})},{testRestrictions:y,connectWithTopic:D,disconnect:E,getToken:P}}),tadpoles.define("model/eventType",{DailyReport:"dailyreport",Note:"note",Activity:"activity",Milestone:"milestone"}),tadpoles.define("model/destinationType",{DailyReport:{key:"dailyreport",name:"Daily Report"},Email:{key:"email",name:"Email"},Portfolio:{key:"portfolio",name:"Portfolio"}}),tadpoles.define("model/modal/editEventForm",["require","ko","lodash","jquery","services/config","model/form","model/actionTile","utilities","selfish","services/uuid","model/globalFilter","services/groups","services/alerts","model/product","model/destinationType","services/children"],function(e){var t=e("ko"),n=e("lodash"),r=e("jquery"),i=e("services/config"),s=e("model/form"),o=e("model/actionTile"),u=e("utilities"),a=e("selfish"),f=e("services/uuid"),l=e("model/globalFilter"),c=e("services/groups"),h=e("services/alerts"),p=e("model/product"),d=e("model/destinationType"),v=e("services/children"),m=a.Base.extend({className:"Tag",initialize:function(e,t,n){this.type=e,this.key=t,this.display=n}}),g=a.Base.extend(o,{className:"Location",initialize:function(e,t){o.initialize.call(this),this.key=e,this.name=t}}),y=[{value:d.DailyReport,name:d.DailyReport.name},{value:d.Email,name:d.Email.name},{value:d.Portfolio,name:d.Portfolio.name}],b=s.extend({className:"EditEventForm",initialize:function(e){e=e||{};var r=this;s.initialize.call(r,{title:"edit observation",formTemplate:"view/modals/editEvent",formModel:r,width:"720px",path:"/remote/v1/event/update",submitText:"submit",success:function(){if(r.inOutbox()){var e=r.tags()[0].display;r.event().member_display(e),r.scope()==="dependant"?(r.event().members(n(r.tags()).map(function(e){return e.key}).value()),r.event().members_display(n(r.tags()).map(function(e){return e.display}).value())):(r.event().members([]),r.event().members_display([e]),r.scope()==="group"&&r.event().group(r.tags()[0].key)),r.event().scope(r.scope()),r.event().comment(r.note()),r.destination()&&r.event().setDestinationValues(r.destination())}r.close()}}),this.event=t.observable(),this.isScheduled=t.pureComputed(function(){return r.event()&&r.event().isScheduled()}),this.scope=t.observable(),this.note=t.observable(),this.attachment=t.observable(),this.tags=t.observableArray([]),this.tagSearchText=t.observable(),this.destination=t.observable(),this.scheduleDate=t.observable(new Date),this.scheduleTime=t.observable((new Date).getTime()/1e3),this.typeahead=t.pureComputed(function(){return r.getTypeAheadFunc()}),this.deliveryChoices=t.pureComputed(function(){return n.reject(y,function(e){return!1})})},addTag:function(e,t,n){this.tags.push(m.create(e,t,n))},removeTag:function(e){this.tags.remove(function(t){return t.key===e})},valid:function(){return this.inOutbox()&&(!this.tags()||this.tags().length==0)?(h.showAlert("Something is not quite right!","Please fix the following before continuing:","warning",["At least one tag is required"]),!1):!0},payload:function(){var e={key:this.event().key,comment:this.note()};this.isScheduled()&&(this.event().updateEta(this.scheduleDate(),this.scheduleTime()),e.event_eta=this.event().event_eta());if(this.inOutbox()){var t=null;this.scope()==="dependant"&&(t=n(this.tags()).map(function(e,t){return e.key}).value()),e.members=t;var r=this.event().group;this.scope()==="group"?r=this.tags()[0].key:this.scope()==="location"&&(r=null),e.group=r,e.location=this.location_key,e.scope=this.scope();if(this.destination()){var i=this.event().getDestinationValues(this.destination());e.action=i.action,e.visibility=i.visibility}}return{event:e}},open:function(e){var r=this;this.event(e),this.title(e.type==="note"?"edit note":"edit observation"),this.scope(e.scope()),this.eventId=e.id(),this.location_display=e.location_display,this.location_key=e.location;if(this.isScheduled()){var i=new Date(e.event_eta()*1e3);this.scheduleDate(i),this.scheduleTime(e.event_eta())}this.note(e.comment()),this.attachment(e.new_attachments&&e.new_attachments.length>0?e.new_attachments[0]:null),this.attachmentWidth=this.attachment()?this.attachment().width:"",this.attachmentHeight=this.attachment()?this.attachment().height:"",this.tags(n(e.members_display()).map(function(t,n){var r=e.location,i=null;return e.scope()==="dependant"?r=e.members()[n]:e.scope()==="group"&&(r=e.group()),m.create(e.scope(),r,t)}).value()),this.taggedChildren=t.pureComputed(function(){return n.filter(v.getInstance().activeChildrenForSelectedGroup(),function(e){return n(n(r.tags()).pluck(function(e){return e.key}).compact().value()).indexOf(e.key)>-1})}),this.taggedGroups=t.pureComputed(function(){var e=c.getInstance().groupsForCurrentLocation();return t.utils.arrayFilter(e,function(e){return n(n(r.tags()).pluck(function(e){return e.key}).compact().value()).indexOf(e.key)>-1})}),this.taggedLocation=t.pureComputed(function(){return r.tags().length>0?g.create(e.location,e.location_display):[]}),this.width(this.hasMedia()?720:560),this.destination(e.getDestinationType()),s.open.call(this)},close:function(){this.event(null),this.note(null),this.attachment(null),this.tags([]),this.tagSearchText(null),this.scope(null),this.destination(null),r("#inputTag").val(""),s.close.call(this)},hasAttachment:function(){return this.attachment()},hasImage:function(){return this.hasAttachment()&&this.attachment().mime_type.indexOf("image")!==-1},hasVideo:function(){return this.hasAttachment()&&this.attachment().mime_type.indexOf("video")!==-1},hasMedia:function(){return this.hasImage()||this.hasVideo()},inOutbox:function(){return this.event()&&this.event().inOutbox()},canEditEventDestination:function(){var e=p.getFeature(p.Features.INCIDENT_DESTINATION);return!e||e.value!=="portfolio"||this.event()&&this.event().type!=="incident"},image:function(){var e=null;return this.hasImage()&&(e="url('"+this.imageUrl()+"')"),e},imageUrl:function(){var e=null;return this.hasMedia()&&(i.isDemo?e="/images/1/demo/"+this.attachment().key+"_large.jpg":(e="/remote/v1/attachment?key="+this.attachment().key,this.hasVideo()&&(e+="&thumbnail=true"))),e},showDetails:function(){this.hasMedia()&&r("#a-"+this.eventId).click()},getTypeAheadFunc:function(){var e=this;return{source:function(r,i){var s=n(v.getInstance().activeChildrenForSelectedGroup()).filter(function(t){return n(e.tags()).pluck(function(e){return e.key}).compact().value().indexOf(t.key)==-1}).pluck(function(e){return t.toJSON({type:"dependant",key:e.key,display:e.fullName(),imageUrl:e.smallImageUrl()})}).compact().value(),o=n(c.getInstance().groupsForCurrentLocation()).filter(function(t){return n(e.tags()).pluck(function(e){return e.key}).compact().value().indexOf(t.key)==-1}).pluck(function(e){return t.toJSON({type:"group",key:e.key,display:e.name(),css:e.child_type()})}).compact().value(),u=s.concat(o);(e.scope()!=="location"||e.tags().length==0)&&u.push(t.toJSON({type:"location",key:e.location_key,display:e.location_display,css:"location"})),i(u)},matcher:function(e){var t=r.parseJSON(e);return~t.display.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(e){var t=[],n=[],i=[],s;while(s=e.shift()){var o=r.parseJSON(s);o.display.toLowerCase().indexOf(this.query.toLowerCase())?~o.display.indexOf(this.query)?n.push(s):i.push(s):t.push(s)}return t.concat(n,i)},highlighter:function(e){var t=r.parseJSON(e),n=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),i=t.display.replace(new RegExp("("+n+")","ig"),function(e,t){return"<strong>"+t+"</strong>"}),s='<div class="typeahead">';return t.type=="dependant"?(s+='<div style="display:inline-block;width:60px;height:60px"><img src='+t.imageUrl+' style="width:60px"/></div>',s+='<div style="display:inline-block;margin-left:20px;margin-top:20px"><span>'+i+"</span></div>"):(s+="<div>",s+='<div style="display:inline-block;width:60px;height:60px" class="'+t.css+'">',s+='<div style="display:inline-block;margin-left:80px;margin-top:20px"><span>'+i+"</span></div>",s+="</div>"),s+="</div>",s},handler:function(t){var n=r.parseJSON(t);n.type!=="dependant"?e.tags([]):e.scope()!=="dependant"&&e.tags([]),e.scope(n.type),e.tagSearchText(""),r("#inputTag").val(""),e.addTag(n.type,n.key,n.display)}}}});return u.makeSingleton(b)}),tadpoles.define("model/mediaTile",["require","ko","selfish","model/imageTile","jquery"],function(e){function s(e){var t=document.createElement("IFRAME");t.setAttribute("style","display:none;"),t.setAttribute("src",e),t.style.width="0px",t.style.height="0px",document.body.appendChild(t)}var t=e("ko"),n=e("selfish"),r=e("model/imageTile"),i=e("jquery"),o=n.Base.extend(r,{className:"MediaTile",initialize:function(){r.initialize.call(this);var e=this;e.attachment=t.observable(),e.mediaTitle=t.observable(),e.galleryGroup=t.observable(""),e.isvideo=t.observable(),e.ispdf=t.observable(),e.width=t.observable(),e.height=t.observable(),e.attachmentSubscription=e.attachment.subscribe(function(t){t?(e.ispdf(t.mime_type.substr(0,"application/pdf".length)==="application/pdf"),e.isvideo(t.mime_type.substr(0,"image".length)!=="image"&&!e.ispdf()),e.attachmentKey(t.key),e.width(t.width),e.height(t.height)):(e.isvideo(!1),e.attachmentKey(""),e.width(),e.height())}),e.attachmentId=t.pureComputed(function(){return e.attachmentKey()?e.attachmentKey()+"-"+e.galleryGroup():""})},dispose:function(){var t=this;t.attachmentSubscription.dispose(),t.attachmentId.dispose(),r.dispose.call(this)},getNote:function(){return this.mediaTitle()},view:function(){this.ispdf()?window.open("/remote/v1/attachment?key="+this.attachmentKey(),"_blank"):i("#a-"+this.id()).click()},getDownloadURL:function(){return this.attachmentUrl()+"&download=true"},download:function(){window.location.href=this.getDownloadURL()},downloadWithOthers:function(){s(this.getDownloadURL())},attachmentUrl:function(){return"/remote/v1/attachment?key="+this.attachmentKey()}});return o.makeFrame=s,o}),tadpoles.define("services/facebook",["require","lodash","ko","services/uuid","selfish","emit"],function(e){var t=e("lodash"),n=e("ko"),r=e("services/uuid"),i=e("selfish"),s=e("emit"),o=i.Base.extend({className:"Facebook",initialize:function(e){var t=this;t.requestId=r.short(),window.loginComplete=function(e){s.emit("fb-login-complete:"+t.requestId,{code:e})}},login:function(e){this.requestId=r.short();var t="https://www.facebook.com/dialog/oauth?client_id=171299459627214&redirect_uri=http://"+window.location.host+"/m/fbauth&scope=publish_actions",n=480,i=640,o=screen.width/2-i/2,u=screen.height/2-n/2,a=window.open(t,"","height="+n+",width="+i+",top="+u+",left="+o);window.focus&&a.focus(),s.once("fb-login-complete:"+this.requestId,e)}});return o.create({})}),tadpoles.define("model/event",["require","ko","jquery","lodash","services/config","emit","services/alerts","selfish","model/remote","model/actionTile","services/children","model/modal/editEventForm","model/mediaTile","services/facebook","model/audit","model/destinationType","model/disposable","model/status","utilities"],function(e){var t=e("ko"),n=e("jquery"),r=e("lodash"),i=e("services/config"),s=e("emit"),o=e("services/alerts"),u=e("selfish"),a=e("model/remote"),f=e("model/actionTile"),l=e("services/children"),c=e("model/modal/editEventForm"),h=e("model/mediaTile"),p=e("services/facebook"),d=e("model/audit"),v=e("model/destinationType"),m=e("model/disposable"),g=e("model/status"),y=e("utilities"),b={JPEG:"image/jpeg",PNG:"image/png",PDF:"application/pdf"},w=u.Base.extend(f,m,{className:"Event",initialize:function(e){var n=this;m.initialize.call(n),f.initialize.call(n,{tileType:"event"}),n.key=e.key,n.inOutbox=t.observable(e.in_outbox),n.action=t.observable(e.action),n.type=e.type?e.type.toLowerCase():"note",n.labels=e.labels||[],n.milestones=e.milestones||[],n.create_time=e.create_time,n.event_time=e.event_time,n.event_eta=t.observable(e.event_eta),n.scheduleDisplay=t.pureComputed(function(){return n.isScheduled()?(new Date(n.event_eta()*1e3)).format("m/d h:MM TT"):""}),n.date=n.event_time?new Date(n.event_time*1e3):null,n.comment=t.observable(e.comment),n.new_attachments=e.new_attachments,n.attachment=n.new_attachments&&n.new_attachments.length>0?n.new_attachments[0]:null,n.member_display=t.observable(e.member_display),n.members_display=t.observableArray(e.members_display),n.scope=t.observable(e.scope),n.members=t.observableArray(e.members),n.group=t.observable(e.group),n.grouped_event_id=e.grouped_event_id,n.grouped_event_is_primary=e.grouped_event_is_primary,n.location=e.location,n.location_display=e.location_display,n.visibility=t.observable(e.visibility||[]),n.galleryGroup=t.observable(n.inOutbox()?"outbox":"default"),n.id=t.pureComputed(function(){return n.key+"-"+n.galleryGroup()}),n.showTitle=t.observable(!0),n.showTitleAsDate=t.observable(!1),n.portfolioView=t.observable(!1),n.isDependantEvent=t.pureComputed(function(){return n.scope()==="dependant"}),n.c_domains=t.observableArray(e.c_domains),n.title=t.computed(function(){if(n.members_display().length===1&&r.contains(g.Statuses,n.members_display()[0]))return n.members_display()[0];if(n.showTitleAsDate())return n.getCurrentEventDateUTC().format("tinyDate");if(!n.showTitle())return"";var e=n.getFirstMemberName();return e&&n.members()&&n.members().length>1&&(e+=" & "+(n.members().length-1)),e}),n.memberNames=t.pureComputed(function(){return r(n.members()).map(function(e){var t=l.getInstance().getChild(e);return t?t.displayName():null}).compact().value()}),n.titleLower=t.pureComputed(function(){return n.title().toLowerCase()}),n.width=this.attachment?this.attachment.width:"",n.height=this.attachment?this.attachment.height:"",n.goals=e.c_goals||[],n.goalLabels=e.c_goal_labels||[],n.tooltip=t.pureComputed(function(){if(n.type==="dailyreport")return"Click to view";var e=[],t=null;return n.type!=="note"&&(t=n.title(),t&&e.push(t)),t=n.comment(),t&&e.push(t),e.join("<br/>")}),n.sentType=t.pureComputed(function(){return!n.action()&&!n.hasMedia()||n.action()==="ShareOnly"||n.action()==="StickyNote"||n.action()==="Alert"||n.action()==="Text"?null:n.type==="incident"?"incident":r.contains(n.visibility(),"p")?n.action()==="AddToDaily"||n.scope()!=="dependant"&&n.action()!=="Notify"?"to daily":"to parents":"to portfolio"}),n.sentTypeCSS=t.pureComputed(function(){var e=n.sentType();return e?e==="incident"?"incident":e==="to daily"?"daily":e==="to parents"?"parents":e==="to portfolio"?"portfolio":null:null}),n.canShowInGallery=t.pureComputed(function(){var e=n.sentTypeCSS();return n.hasImage()&&(e==="parents"||e==="daily")}),n.headerCSS=t.pureComputed(function(){return n.action()==="Alert"?"ealert":n.action()==="StickyNote"?"sticky":n.scope()==="staff"?"staff":"mask"}),n.isScheduled=t.pureComputed(function(){var e=new Date;return n.event_eta()&&new Date(n.event_eta()*1e3)>e})},dispose:function(){var t=this;t.isDependantEvent.dispose(),t.title.dispose(),t.memberNames.dispose(),t.titleLower.dispose(),t.tooltip.dispose(),t.sentType.dispose(),t.sentTypeCSS.dispose(),t.canShowInGallery.dispose(),t.headerCSS.dispose(),f.dispose.call(t),m.dispose.call(t)},isToday:function(){return this.date&&this.date.format("isoDate")===(new Date).format("isoDate")},hasAttachment:function(){return this.attachment},hasImage:function(){return this.hasAttachment()&&this.attachment.mime_type.indexOf("image")!==-1},hasFile:function(){return this.hasAttachment()&&this.attachment.mime_type.indexOf("application")!==-1},hasVideo:function(){return this.hasAttachment()&&this.attachment.mime_type.indexOf("video")!==-1},hasMedia:function(){return this.hasImage()||this.hasVideo()},getFirstMemberName:function(e){var t,n="";if(this.members())for(t=0;t<this.members().length;t+=1){var r=l.getInstance().getChild(this.members()[t]);if(r){n=r.displayName();break}}if(!n)if(this.member_display())n=this.member_display();else if(this.members_display())for(t=0;t<this.members_display().length;t+=1){n=this.members_display()[t];if(n)break}if(!e&&this.isDependantEvent()){var i=n.split(" ");i&&i.length>1&&(n=i[0])}return n},backgroundImage:function(){var e=null;return this.hasMedia()?i.isDemo?e="url('/images/1/demo/"+this.attachment.key+"_small.jpg')":e="url('/remote/v1/attachment?thumbnail=true&key="+this.attachment.key+"')":this.hasFile()&&(e="url('/images/5/paperclip.png')"),e},backgroundLargeImage:function(){var e=null;return this.hasMedia()?i.isDemo?e="url('/images/1/demo/"+this.attachment.key+"_large.jpg')":e="url('/remote/v1/attachment?key="+this.attachment.key+"')":this.hasFile()&&(e="url('/images/5/paperclip.png')"),e},attachmentUrl:function(){var e=null;return this.hasAttachment()&&(i.isDemo&&this.hasMedia()?e="/images/1/demo/"+this.attachment.key+"_large.jpg":e="/remote/v1/attachment?key="+this.attachment.key),e},doApprove:function(){var e=this,t=a.create({path:"/remote/v1/event/approve",method:"post",error:function(){o.showAlert("Oops!","Something went wrong on our end, please try again")},success:function(){e.inOutbox(!1),s.emit("new-event",e)}});t.makeRequest({data:{key:e.key}})},doResend:function(){var e=this,t=a.create({path:"/remote/v1/event/resend",method:"post",error:function(){o.showAlert("Oops!","Something went wrong on our end, please try again")},success:function(){e.inOutbox(!1),s.emit("new-event",e)}});t.makeRequest({data:{key:e.key,v:2}})},hideTooltip:function(){var e=n("#t-"+this.id());if(!e)return;e.tooltip("hide")},getPopoverParams:function(){return this.portfolioView()?!1:{content:"<div data-bind=\"template: { name: 'view/popovers/photoPopover' }\"></div>",placement:"in top",trigger:"hover",bindContent:!0,template:'<div class="popover"><div class="arrow"></div><div class="popover-inner"><div class="popover-content"><p></p></div></div></div>'}},resend:function(e,t){var n=this;o.showYesNo({message:"Resend this observation?",yes:function(){n.doResend()}})},approve:function(e,t){var n=this;if(!n.inOutbox())return;n.hideTooltip(),n.tryDisableActions(),n.doApprove()},edit:function(){c.getInstance().open(this)},remove:function(){var e=this;o.showYesNo({message:"Are you sure you want to delete this observation?",yes:function(){var t=a.create({path:"/remote/v1/event/delete",method:"post",success:function(t){s.emit("observation-deleted",e.key)},error:function(){o.showAlert("Oops!","Something went wrong on our end, please try again")}});t.makeRequest({data:{key:e.key}})}})},fullAttachmentURL:function(){return(location.protocol==="http"?"http://":"https://")+location.hostname+this.attachmentUrl()},getElement:function(){return n("#a-"+this.id())},showDetails:function(e,t){if(t.isTrigger)return;if(this.hasMedia())n("#a-"+this.id()).click();else{var i={title:"Note",message:this.comment(),style:"info"},s=this;if(this.hasFile()){var u=null;u=y.lazyLoadModule(u,"services/events");var a=this.grouped_event_id?r(u.unGroupedNotesForSelection()).filter(function(e){return e.grouped_event_id===s.grouped_event_id&&(!s.group()||s.group()===e.group())}).map(function(e){return{name:e.attachment.filename,download:function(){window.open(e.attachmentUrl())}}}).value():[{name:s.attachment.filename,download:function(){window.open(s.attachmentUrl())}}];i.templateName="view/modals/fileAttachment",i.templateData={attachments:a}}this.inOutbox()?(i.approve=function(){s.approve()},o.showApproveOk(i)):o.show(i)}},createEmailSubject:function(){var e;return this.type=="activity"?e="See what "+this.member_display()+" is doing!":e="See what "+this.member_display()+" did!",encodeURIComponent(e)},createEmailBody:function(e){return encodeURIComponent((this.comment()?this.comment()+"\r\n":"")+"http://"+window.location.host+"/m/"+(this.hasVideo()?"v":"p")+"/"+e+"\r\n\r\n\r\n---\r\nSent by Tadpoles at "+this.location_display+"\r\nhttp://www.tadpoles.com/about")},download:function(){this.hasAttachment()&&(window.location.href=this.getDownloadURL())},shareToFacebook:function(){p.login(this.doFacebookPost)},doFacebookPost:function(e){var t=this,n=a.create({path:"/remote/v1/fb/share",method:"post",success:function(e){o.showAlert("Woohoo!","Your "+(t.hasVideo()?"video":"photo")+" has been shared to facebook!","success")},error:function(e,t){o.showAlert("Oops!",t||"Something went wrong on our end, please try again")}});n.makeRequest({data:{code:e.code,event_key:t.key}})},shareViaEmail:function(){var e=this,t=a.create({path:"/remote/v1/share/token",method:"get",success:function(t){window.location.href="mailto:?subject="+e.createEmailSubject()+"&body="+e.createEmailBody(t.token)},error:function(e,t){o.showAlert("Oops!",t||"Something went wrong on our end, please try again")}});t.makeRequest({data:{event_key:e.key}})},canShare:function(){return this.members().length===1},getDownloadURL:function(){return"/remote/v1/attachment?key="+this.attachment.key+"&download=true"},downloadWithOthers:function(){h.makeFrame(this.getDownloadURL())},audit:function(){d.getInstance().load(this.key)},getDestinationType:function(){return this.action()==="AddToDaily"?v.DailyReport:this.action()==="Notify"&&r.contains(this.visibility(),"p")?v.Email:v.Portfolio},setDestinationValues:function(e){var t=this.getDestinationValues(e);this.action(t.action),this.visibility(t.visibility)},getDestinationValues:function(e){var t={};return e==v.DailyReport?(t.action="AddToDaily",t.visibility=["p","d","t"]):e==v.Email?(t.action="Notify",t.visibility=["p","d","t"]):e==v.Portfolio&&(t.action="Notify",t.visibility=["d","t"]),t},getCurrentEventDateUTC:function(){return this.date?new Date(this.date.valueOf()+this.date.getTimezoneOffset()*6e4):null},updateEta:function(e,t){var n=new Date(e),r=new Date(t*1e3);n.setHours(r.getHours()),n.setMinutes(r.getMinutes()),this.event_eta(n.getTime()/1e3)}});return w}),tadpoles.define("model/dailyReportEntry",["require","lodash","ko","selfish","model/mediaTile","utilities"],function(e){var t=e("lodash"),n=e("ko"),r=e("selfish"),i=e("model/mediaTile"),s=e("utilities"),o=r.Base.extend(i,{className:"DailyReportEntry",initialize:function(e,r){i.initialize.call(this),this.id=n.observable(e.id),this.client_update_timestamp=e.client_update_timestamp,this.deleted=e.deleted,this.type_name=e.type_name||e.type,this.capture_time=e.capture_time,this.action_time=e.action_time||e.start_time,this.note=e.note||"",this.stage=e.stage||e.child_type,this.owner=e.owner,this.edited=e.edited,this.fromLesson=e.fp,this.parent=e.parent,this.actor=e.actor,this.attachment(t.isFunction(e.attachment)?e.attachment():e.attachment),this.link_id=e.link_id,this.removed_link_id=e.removed_link_id,this.linked_photo_entry=null,this.mediaTitle(e.note),this.galleryGroup(r),this.editable=e.parent&&s.isParent()||!e.parent&&!s.isParent(),this.editors=e.editors||[]},dispose:function(){i.dispose.call(this)},getTimeDisplay:function(){return this.action_time?(new Date(this.action_time*1e3)).format("shortTime"):""},getPrimary:function(){return this.getTimeDisplay()},getNote:function(){var e=this.getPrimary();return this.note?(e?" - ":"")+this.note:""},getActor:function(){return this.actor&&this.actor.split(" ").map(function(e){return e[0]}).join("")},getEditors:function(){var e="";return t.each(this.editors,function(t,n){n===0?e="edited by: "+t:e+=", "+t}),e},toUpload:function(){return{id:this.id(),type_name:this.type_name,client_update_timestamp:this.client_update_timestamp,deleted:this.deleted,capture_time:this.capture_time,action_time:this.action_time,note:this.note,stage:this.stage,owner:this.owner,edited:this.edited,actor:this.actor,parent:this.parent}},serialize:function(){return{id:this.id(),type_name:this.type_name,client_update_timestamp:this.client_update_timestamp,deleted:this.deleted,capture_time:this.capture_time,action_time:this.action_time,note:this.note,stage:this.stage,owner:this.owner,edited:this.edited,actor:this.actor,parent:this.parent,fp:this.fromLesson,attachment:t.clone(this.attachment())}}});return o}),tadpoles.define("model/mealEntry",["require","model/dailyReportEntry","lodash"],function(e){var t=e("model/dailyReportEntry"),n=e("lodash"),r=t.extend({className:"MealEntry",initialize:function(e){t.initialize.call(this,e),this.type_name="food",this.meal_type=e.meal_type||(e.measure?"bottle":"")||(e.classification=="fooddrop"?e.classification:""),this.meal_name=e.meal_name||e.classification||"",this.foods=e.foods||e.details||"",this.amount=!n.isUndefined(e.amount)&&!n.isNull(e.amount)?e.amount:n.isNull(e.quantity)?"":e.quantity,this.amountOffered=e.amount_offered,this.contents=e.contents||"",this.reminder_period=e.reminder_period,this.ord=e.ord||0,this.prepared_actor=e.prepared_actor},getPrimary:function(){var e="",t=this.getTimeDisplay();if(this.meal_type==="bottle"){e=t;var r=!n.isUndefined(this.amount)&&!n.isNull(this.amount),i=!n.isUndefined(this.amountOffered)&&!n.isNull(this.amountOffered),s=this.contents;e&&(r||i||s)&&(e+=" - "),r&&(e+=this.amount+"oz "),r&&this.contents&&(e+="of "),s&&(e+=this.contents+" "),i&&(e+="("+this.amountOffered+"oz offered)")}else if(this.meal_type==="breastfeeding")e=t,e+=" - breastfed";else if(this.meal_type==="fooddrop")e="Brought "+this.foods;else{this.meal_name&&(e+=this.meal_name),t&&(e+=(e?" ":"")+t);if(this.foods||this.amount)e+=(e?" - ":"")+"Had ";this.amount&&(e+=this.amount),this.foods&&(e+=(this.amount?" of the ":"")+this.foods)}return e},toUpload:function(){var e=t.toUpload.call(this);return e.amount=this.amount,e.amount_offered=this.amountOffered||null,e.contents=this.contents||null,e.meal_name=this.meal_name||null,e.meal_type=this.meal_type,e.foods=this.foods||null,e.reminder_period=this.reminder_period||null,e.ord=this.ord||0,e.prepared_actor=this.prepared_actor,e.v=6,e},serialize:function(){return n.extend(t.serialize.call(this),{meal_type:this.meal_type,meal_name:this.meal_name,foods:this.foods,amount:this.amount,amount_offered:this.amount_offered,contents:this.contents,reminder_period:this.reminder_period,ord:this.ord,prepared_actor:this.prepared_actor})},clone:function(){return r.create(this.serialize())}});return r}),tadpoles.define("model/daily_report/mealDistributionEntry",["require","model/dailyReportEntry"],function(e){var t=e("model/dailyReportEntry"),n=t.extend({className:"MealDistributionEntry",initialize:function(e){t.initialize.call(this,e),this.type_name="mdist",this.meal_name=e.meal_name||e.classification||"",this.meal_type="food"},getPrimary:function(){return""},toUpload:function(){var e=t.toUpload.call(this);return e.meal_name=this.meal_name||null,e}});return n}),tadpoles.define("model/daily_report/aggregatedMealEntry",["require","lodash","jquery","model/dailyReportEntry","utilities"],function(e){var t=e("lodash"),n=e("jquery"),r=e("model/dailyReportEntry"),i=e("utilities"),s=r.extend({className:"AggregatedMealEntry",initialize:function(e){e=e||[{}];var s=e.length>0?e[0].parent:i.isParent();r.initialize.call(this,{type_name:"food",deleted:!1,id:"aggregatedMeal",parent:s});var o=t.find(e,{type_name:"food"});this.dist=t.find(e,{type_name:"mdist"}),this.entries=t(e).reject({type_name:"mdist"}).sortBy("ord").value(),this.capture_time=t.reduce(e,function(e,t){return Math.max(t.capture_time,e)},0),this.action_time=this.dist?this.dist.action_time:o.action_time,this.stage=e[0].stage,this.meal_type=o?o.meal_type:"food",this.meal_name=this.dist?this.dist.meal_name:o.meal_name||"",this.note=n.trim(t.reduce(e,function(e,t){return e+(t.note?(e?" - ":"")+t.note:"")},"")),this.actor=t.reduce(e,function(e,t){return t.actor||e},null),this.reminder_period=t.reduce(e,function(e,t){return e?Math.min(t.reminder_period,e):t.reminder_period||0},0),this.editors=t(e).pluck("editors").flatten().uniq().value()},getPrimary:function(){var e="",n=this.getTimeDisplay();if(this.meal_type==="bottle"){e+=n;var r=!t.isUndefined(this.entries[0].amount)&&!t.isNull(this.entries[0].amount),i=!t.isUndefined(this.entries[0].amountOffered)&&!t.isNull(this.entries[0].amountOffered),s=this.entries[0].contents;e&&(r||i||s)&&(e+=" - "),r&&(e+=this.entries[0].amount+"oz "),r&&this.entries[0].contents&&(e+="of "),s&&(e+=this.entries[0].contents+" "),i&&(e+="("+this.entries[0].amountOffered+"oz offered)")}else if(this.meal_type==="breastfeeding")e+=n,e+=" - breastfed";else if(this.meal_type==="fooddrop")e+="Brought "+t(this.entries).pluck("foods").compact().value().join(", ");else{this.meal_name&&(e+=this.meal_name),n&&(e+=(e?" ":"")+n);var o=t.sortBy(t.filter(this.entries,function(e){return e.foods||e.amount}),function(e){return e.amount&&e.foods?1:0});o.length>0&&(e+=(e?" - ":"")+"Had "),t.each(o,function(t,n){e+=n>0?",":"",t.amount&&(e+=" "+t.amount),t.foods&&(e+=(t.amount?" of the ":" ")+t.foods)})}return e},toUpload:function(){return t.map(this.entries,function(e){return e.toUpload()})},clone:function(){var e=t.map(this.entries,function(e){return e.clone()});return s.create(e)}});return s}),tadpoles.define("model/daily_report/aggregatedParentNoteEntry",["require","lodash","jquery","model/dailyReportEntry","utilities"],function(e){var t=e("lodash"),n=e("jquery"),r=e("model/dailyReportEntry"),i=e("utilities"),s=r.extend({className:"AggregatedParentNoteEntry",initialize:function(e){e=e||[{}],r.initialize.call(this,{type_name:"note",deleted:!1,id:"aggregatedParentNote"}),this.entries=e,this.capture_time=t.reduce(e,function(e,t){return Math.max(t.capture_time,e)},0),this.action_time=t.reduce(e,function(e,t){return Math.max(t.action_time,e)},0),this.stage=e[0].stage,this.note_type="aggregate",this.parent=!0,this.note=n.trim(t.reduce(e,function(e,t){return e+(t.note?(e?"\n":"")+t.note:"")},"")),this.editable=i.isParent()},getPrimary:function(){return""},getNote:function(){return this.note},toUpload:function(){return t.map(this.entries,function(e){return e.toUpload()})},clone:function(){var e=t.map(this.entries,function(e){return e.clone()});return s.create(e)}});return s}),tadpoles.define("model/bathroomEntry",["require","model/dailyReportEntry","model/product","lodash"],function(e){var t=e("model/dailyReportEntry"),n=e("model/product"),r=e("lodash"),i=t.extend({className:"BathroomEntry",initialize:function(e){t.initialize.call(this,e),this.type_name="bathroom",this.bathroom_type=e.bathroom_type,this.events=e.events||(e.classification?e.classification.split(","):[])},getPrimary:function(){var e=this.getTimeDisplay(),t=n.translateStrings(this.events);return e+(e&&this.events.length>0?" - ":"")+t.join(", ")},toUpload:function(){var e=t.toUpload.call(this);return e.bathroom_type=this.bathroom_type,e.events=this.events,e},serialize:function(){return r.extend(t.serialize.call(this),{bathroom_type:this.bathroom_type,events:this.events})},clone:function(){return i.create(this.serialize())}});return i}),tadpoles.define("model/medsEntry",["require","lodash","model/dailyReportEntry"],function(e){var t=e("lodash"),n=e("model/dailyReportEntry"),r=n.extend({className:"MedsEntry",initialize:function(e){n.initialize.call(this,e),this.medicine=e.medicine||e.details||"",this.amount=e.amount||e.quantity||"",this.measure=e.measure||""},getPrimary:function(){var e=this.getTimeDisplay(),t=this.amount?this.amount+this.measure:"",n=t+(t&&this.medicine?" ":"")+this.medicine;return e+(e&&n?" - ":"")+n},serialize:function(){return t.extend(n.serialize.call(this),{medicine:this.medicine,amount:this.amount,measure:this.measure})},clone:function(){return r.create(this.serialize())}});return r}),tadpoles.define("model/curriculum/curriculumEntry",["require","selfish"],function(e){var t=e("selfish"),n=t.Base.extend({className:"CurriculumEntry",initialize:function(e){this.id=e.id,this.name=e.name,this.client_update_timestamp=e.client_update_timestamp,this.deleted=e.deleted,this.type=e.type,this.capture_time=e.capture_time,this.sort=e.sort,this.ro=e.ro},toUpload:function(){return{id:this.id,name:this.name,type:this.type,client_update_timestamp:this.client_update_timestamp,deleted:this.deleted,capture_time:this.capture_time,sort:this.sort}}});return n}),tadpoles.define("model/curriculum/domainEntry",["require","model/curriculum/curriculumEntry"],function(e){var t=e("model/curriculum/curriculumEntry"),n=t.extend({className:"DomainEntry",initialize:function(e){t.initialize.call(this,e),this.type="d",this.st=e.st},toUpload:function(){var e=t.toUpload.call(this);return e}});return n}),tadpoles.define("model/curriculum/outcomeEntry",["require","model/curriculum/curriculumEntry","lodash"],function(e){var t=e("model/curriculum/curriculumEntry"),n=e("lodash"),r=function(e){return n(e).reduce(function(e,t,n){return n===0?t:e+", "+t},"")},i=t.extend({className:"OutcomeEntry",initialize:function(e){t.initialize.call(this,e),this.type="o",this.name=e.name,this.domainId=e.domain_id,this.externalId=e.e_id,this.hierarchy=e.hierarchy},toUpload:function(){var e=t.toUpload.call(this);return e.domain_id=this.domainId,e.e_id=this.externalId,e.hierarchy=this.hierarchy,e},displayText:function(){return this.name+(this.externalId?" ("+this.externalId+")":"")},hierarchyText:function(){return r(this.hierarchy)}});return i}),tadpoles.define("model/curriculum/unitTreeEntry",["require","selfish","ko","lodash"],function(e){var t=e("selfish"),n=e("ko"),r=e("lodash"),i=t.Base.extend({className:"UnitTreeEntry",initialize:function(e){var t=this;this.indent=0,this.children=n.observableArray(),this.parent=n.observable(),this.visible=n.observable(!0),this.top=n.observable(!1),this.expanded=n.observable(!1),this.top.subscribe(function(e){e&&(t.name="top",t.indent=-1,t.expand())})},addChild:function(e,t){var n=r.findIndex(this.children(),{id:e.id});if(n>=0){var i=this.children();i[n]=e,this.children(i)}else{var s=r.isNumber(t)?t:this.children().length;e.parent(this),e.visible(this.expanded()),e.updateIndent(),this.children.splice(s,0,e)}},updateIndent:function(){if(!this.parent())return;this.indent=this.parent().indent+1,r.each(this.children(),function(e){e.updateIndent()})},removeChild:function(e){e.parent(null),e.visible(!0),e.indent=0,this.children.remove(function(t){return t.id===e.id})},expand:function(){if(this.expanded())return;this.expanded(!0),r.each(this.children(),function(e){e.visible(!0)})},collapse:function(){if(!this.expanded())return;this.expanded(!1),r.each(this.children(),function(e){e.hide()})},hide:function(){this.visible(!1),this.collapse()},hasChildren:function(){return this.children().length>0},getIndent:function(e){return e*this.indent},toggle:function(){this.expanded()?this.collapse():this.expand()},treeReset:function(){this.indent=0,this.children([]),this.parent(null),this.visible(!0),this.expanded(!1)},childList:function(){var e=[];return r.each(this.children(),function(t){e.push(t),e=e.concat(t.childList())}),e},sort:function(){this.children(r.sortBy(this.children.peek(),"numsort")),r.each(this.children(),function(e){e.sort()})},getInsertSortVal:function(e,t){var n=r.reject(this.children(),{id:e});if(t===0)return n.length>0?n[0].numsort-1:0;if(t>=n.length)return this.getNextSortVal();var i=n[t-1],s=n[t];return i.numsort+(s.numsort-i.numsort)/2},getNextSortVal:function(){return r(this.children()).pluck("numsort").reduce(function(e,t){return Math.max(e,t)},0)+1},getCurrentIndex:function(){var e=0;return this.parent()&&(e=r.findIndex(this.parent().children(),{id:this.id})),e}});return i}),tadpoles.define("model/curriculum/activity",["require","selfish","utilities","lodash"],function(e){var t=e("selfish"),n=null,r=e("utilities"),i=e("lodash"),s=t.Base.extend({className:"Activity",initialize:function(e){this.id=e.id,this.unit_id=e.unit_id,this.name=e.name,this.numsort=e.numsort,this.client_update_timestamp=e.cut,this.description=e.description,this.domains=e.domains||[],this.goals=e.goals||[],this.materials=e.materials,this.options=e.options,this.instructions=e.instructions,this.notes=e.notes,this.deleted=e.deleted,this.members=e.members},toUpload:function(){return{id:this.id,unit_id:this.unit_id,name:this.name,numsort:this.numsort,client_update_timestamp:this.client_update_timestamp,description:this.description,domains:this.domains,goals:this.goals,materials:this.materials,options:this.options,instructions:this.instructions,notes:this.notes,deleted:this.deleted,member:this.members}},getDomains:function(){return n=r.lazyLoadModule(n,"services/curricula"),i(this.domains).map(function(e){return n.getInstance().getDomainById(e)}).compact().value()},getGoals:function(){return n=r.lazyLoadModule(n,"services/curricula"),i(this.goals).map(function(e){return n.getInstance().getOutcomeById(e)}).compact().value()},getPrimary:function(){var e=i(this.getDomains()).pluck("name").value().join(", ");return this.name&&(e+=(e?" - ":"")+this.name),e}});return s}),function(e){typeof tadpoles.define=="function"&&tadpoles.define.amd?tadpoles.define("sortable",["ko","jquery","sortable"],e):e(window.ko,jQuery)}(function(e,t){var n="ko_sortItem",r="ko_sourceIndex",i="ko_sortList",s="ko_parentList",o="ko_dragItem",u=e.utils.unwrapObservable,a=e.utils.domData.get,f=e.utils.domData.set,l=function(t,r){e.utils.arrayForEach(t,function(e){e.nodeType===1&&(f(e,n,r),f(e,s,a(e.parentNode,i)))})},c=function(t,n){var r={},i=u(t())||{},s;return i.data?(r[n]=i.data,r.name=i.template):r[n]=t(),e.utils.arrayForEach(["afterAdd","afterRender","as","beforeRemove","includeDestroyed","templateEngine","templateOptions"],function(t){r[t]=i[t]||e.bindingHandlers.sortable[t]}),n==="foreach"&&(r.afterRender?(s=r.afterRender,r.afterRender=function(e,t){l.call(t,e,t),s.call(t,e,t)}):r.afterRender=l),r},h=function(e,t){var n=u(t);if(n)for(var r=0;r<e;r++)n[r]&&u(n[r]._destroy)&&e++;return e};e.bindingHandlers.sortable={init:function(l,p,d,v,m){var g=t(l),y=u(p())||{},b=c(p,"foreach"),w={},E,S;g.contents().each(function(){this&&this.nodeType!==1&&l.removeChild(this)}),t.extend(!0,w,e.bindingHandlers.sortable),y.options&&w.options&&(e.utils.extend(w.options,y.options),delete y.options),e.utils.extend(w,y),w.connectClass&&(e.isObservable(w.allowDrop)||typeof w.allowDrop=="function")?e.computed({read:function(){var t=u(w.allowDrop),n=typeof t=="function"?t.call(this,b.foreach):t;e.utils.toggleDomNodeCssClass(l,w.connectClass,n)},disposeWhenNodeIsRemoved:l},this):e.utils.toggleDomNodeCssClass(l,w.connectClass,w.allowDrop),e.bindingHandlers.template.init(l,function(){return b},d,v,m),E=w.options.start,S=w.options.update;var x=setTimeout(function(){var c;g.sortable(e.utils.extend(w.options,{start:function(t,n){var i=n.item[0];f(i,r,e.utils.arrayIndexOf(n.item.parent().children(),i)),n.item.find("input:focus").change(),E&&E.apply(this,arguments)},receive:function(e,t){c=a(t.item[0],o),c&&(c.clone&&(c=c.clone()),w.dragged&&(c=w.dragged.call(this,c,e,t)||c))},update:function(o,u){var l,p,d,v,m,g=u.item[0],y=u.item.parent()[0],E=a(g,n)||c;c=null;if(E&&(this===y||t.contains(this,y))){l=a(g,s),d=a(g,r),p=a(g.parentNode,i),v=e.utils.arrayIndexOf(u.item.parent().children(),g),b.includeDestroyed||(d=h(d,l),v=h(v,p));if(w.beforeMove||w.afterMove)m={item:E,sourceParent:l,sourceParentNode:l&&u.sender||g.parentNode,sourceIndex:d,targetParent:p,targetIndex:v,cancelDrop:!1},w.beforeMove&&w.beforeMove.call(this,m,o,u);l?t(l===p?this:u.sender).sortable("cancel"):t(g).remove();if(m&&m.cancelDrop)return;v>=0&&(l&&(l.splice(d,1),e.processAllDeferredBindingUpdates&&e.processAllDeferredBindingUpdates()),p.splice(v,0,E)),f(g,n,null),e.processAllDeferredBindingUpdates&&e.processAllDeferredBindingUpdates(),w.afterMove&&w.afterMove.call(this,m,o,u)}S&&S.apply(this,arguments)},connectWith:w.connectClass?"."+w.connectClass:!1})),w.isEnabled!==undefined&&e.computed({read:function(){g.sortable(u(w.isEnabled)?"enable":"disable")},disposeWhenNodeIsRemoved:l})},0);return e.utils.domNodeDisposal.addDisposeCallback(l,function(){(g.data("ui-sortable")||g.data("sortable"))&&g.sortable("destroy"),clearTimeout(x)}),{controlsDescendantBindings:!0}},update:function(t,n,r,s,o){var u=c(n,"foreach");f(t,i,u.foreach),e.bindingHandlers.template.update(t,function(){return u},r,s,o)},connectClass:"ko_container",allowDrop:!0,afterMove:null,beforeMove:null,options:{}},e.bindingHandlers.draggable={init:function(n,r,i,s,a){var l=u(r())||{},h=l.options||{},p=e.utils.extend({},e.bindingHandlers.draggable.options),d=c(r,"data"),v=l.connectClass||e.bindingHandlers.draggable.connectClass,m=l.isEnabled!==undefined?l.isEnabled:e.bindingHandlers.draggable.isEnabled;return l=l.data||l,f(n,o,l),e.utils.extend(p,h),p.connectToSortable=v?"."+v:!1,t(n).draggable(p),m!==undefined&&e.computed({read:function(){t(n).draggable(u(m)?"enable":"disable")},disposeWhenNodeIsRemoved:n}),e.bindingHandlers.template.init(n,function(){return d},i,s,a)},update:function(t,n,r,i,s){var o=c(n,"data");return e.bindingHandlers.template.update(t,function(){return o},r,i,s)},connectClass:e.bindingHandlers.sortable.connectClass,options:{helper:"clone"}}}),tadpoles.define("model/curriculum/unit",["require","services/config","model/curriculum/unitTreeEntry","model/remote","model/curriculum/activity","emit","ko","services/alerts","model/globalFilter","lodash","sortable"],function(e){var t=e("services/config"),n=e("model/curriculum/unitTreeEntry"),r=e("model/remote"),i=e("model/curriculum/activity"),s=e("emit"),o=e("ko"),u=e("services/alerts"),a=e("model/globalFilter"),f=e("lodash");e("sortable");var l=n.extend({className:"Unit",initialize:function(e){n.initialize.call(this),this.id=e.id,this.curriculumId=e.curriculum_id,this.parentId=e.parent_id,this.name=e.name,this.client_update_timestamp=e.client_update_timestamp,this.deleted=e.deleted,this.scope=e.scope,this.numsort=e.numsort,this.activities=o.observableArray(e.activities||[]),this.loadingActivities=o.observable(!1)},addActivity:function(e){var t=f.findIndex(this.activities(),function(t){return t.id===e.id});if(t>=0){var n=this.activities();n[t]=e,this.activities(n)}else this.activities.push(e)},removeActivity:function(e){this.activities.remove(function(t){return t.id===e.id})},loadActivities:function(){var e=this;if(t.isDemo){s.emit("activities-loaded",{unit_id:e.id});return}var n=r.create({path:"/remote/v1/activity/query",method:"get",success:function(t){var n=f.map(t.activities,function(e){return i.create(e)});e.activities(f.sortBy(n,"numsort")),s.emit("activities-loaded",{unit_id:e.id})},complete:function(t){e.loadingActivities(!1)}});e.activities([]),e.loadingActivities(!0),n.makeRequest({data:{unit_id:e.id,curriculum_id:e.curriculumId}})},toUpload:function(){return{id:this.id,curriculum_id:this.curriculumId,parent_id:this.parentId,name:this.name,client_update_timestamp:this.client_update_timestamp,deleted:this.deleted,scope:this.scope,numsort:this.numsort}},getActivityInsertSortVal:function(e,t){var n=f.reject(this.activities(),{id:e});if(t===0)return n.length>0?n[0].numsort-1:0;if(t>=n.length)return this.getNextActivitySortVal();var r=n[t-1],i=n[t];return r.numsort+(i.numsort-r.numsort)/2},getNextActivitySortVal:function(){return f(this.activities()).pluck("numsort").reduce(function(e,t){return Math.max(e,t)},0)+1},moveActivity:function(e,t,n){var i=this,f=e.numsort;e.numsort=this.getActivityInsertSortVal(e.id,n),this.activities.remove(function(t){return t.id===e.id}),this.activities.splice(n,0,e);var l=r.create({path:"/remote/v1/activity",method:"post",success:function(){s.emit("activity-moved",{activity:e})},error:function(){e.numsort=f,i.activities.remove(function(t){return t.id===e.id}),i.activities.splice(t,0,e),u.showAlert("Oops!","Something went wrong on our end, please try again")}}),c={activity:o.toJSON(e.toUpload()),location:a.location().key};l.makeRequest({data:c})},onMove:function(e,t,n){e.cancelDrop=!0,f.defer(this.moveActivity,e.item,e.sourceIndex,e.targetIndex)}});return l}),tadpoles.define("model/curriculum/curriculum",["require","lodash","ko","services/config","model/curriculum/domainEntry","model/curriculum/outcomeEntry","model/user","utilities","emit","model/remote","model/curriculum/unit","model/period"],function(e){var t=e("lodash"),n=e("ko"),r=e("services/config"),i=e("model/curriculum/domainEntry"),s=e("model/curriculum/outcomeEntry"),o=null,u=e("model/user"),a=e("utilities"),f=e("emit"),l=e("model/remote"),c=e("model/curriculum/unit"),h=e("model/period"),p=l.extend({className:"Curriculum",initialize:function(e){var o=this;l.initialize.call(this,{path:"/remote/v1/curriculum",method:"post"}),o.deleted=e.deleted,o.key=e.key,o.id=e.id,o.name=e.name,o.external=e.external,o.creatorKey=e.creator_key,o.creatorLocationKey=e.creator_location_key,o.outcomes=[],o.domains=[],o.assessableDomains=[],o.entries=n.observableArray(),o.periods=[],o.loadingUnits=n.observable(!1),o.entriesSubscription=o.entries.subscribe(function(e){e=t(e).reject("deleted").value(),o.outcomes=t(e).filter({type:"o"}).value();var n=t(e).filter({type:"d"}).each(function(e){e.outcomes=null}).indexBy("id").value();t(o.outcomes).groupBy("domainId").each(function(e,r){var i=n[r];i&&(i.outcomes=t.sortBy(e,function(e){return e.name?e.name.toLowerCase():""}))}),o.domains=a.sortBySortValue(t.values(n),"sort","name");var r=t.filter(o.domains,function(e){return e.st==="c"}),i=t.filter(o.domains,function(e){return!e.st||e.st==="cd"}),s=t.filter(o.domains,function(e){return e.st==="d"});o.domains=t(r).concat(i).concat(s).value(),o.assessableDomains=t(n).values().reject(function(e){return!e.outcomes}).value()});var u=t(e.entries).map(function(e){var t=null;return e.type==="d"?t=i.create(e):e.type==="o"&&(t=s.create(e)),t}).compact().value();r.isDemo&&u.push(s.create({id:"toddler:art:draw",name:"draws pictures",domain_id:"toddler:art"})),o.entries(u),o.periods=e.periods||[];var h=e.units?t.map(e.units,function(e){return c.create(e)}):[];o.units=n.observableArray(h),o.activities=n.pureComputed(function(){return t(o.units()).map(function(e){return e.activities()}).flatten().value()}),f.on("unit-added",o.upsertUnit),f.on("unit-modified",o.upsertUnit),f.on("unit-removed",o.upsertUnit)},dispose:function(){var e=this;e.entriesSubscription.dispose(),e.activities.dispose(),f.off("unit-added",e.upsertUnit),f.off("unit-modified",e.upsertUnit),f.off("unit-removed",e.upsertUnit)},reportModified:function(){f.emit("upsert-curriculum",this)},upsertEntry:function(e){var n=this,r=n.entries(),i=t.findIndex(r,{id:e.id}),s=i>=0?r[i]:null;s?(e.type==="d"&&(e.outcomes=s.outcomes,e.deleted&&t.each(e.outcomes,function(e){e.deleted=!0})),r[i]=e):r.push(e),n.entries(r),this.reportModified()},findSubUnits:function(e,n){var r=this,i=[];return t.each(e,function(t){t.parentId===n.id&&(i.push(t),i=i.concat(r.findSubUnits(e,t)))}),i},upsertUnit:function(e){if(e.curriculumId!==this.id)return;var n=this.units.peek(),r=t.findIndex(n,{id:e.id});if(r<0&&!e.deleted)this.units.push(e);else if(e.deleted){var i=t.pluck(this.findSubUnits(n,e),"id").concat(e.id);this.units.remove(function(e){return t.contains(i,e.id)})}else this.units.valueWillMutate(),n[r]=e,this.units.valueHasMutated()},getPopoverParams:function(){var e=!1;return u.CurrentUser.isCsr()&&(e={title:"Key",content:'<div style="word-wrap:break-word;"><h5>Key:</h5> <span data-bind="text: key"></span></div>',placement:"in bottom",trigger:"click",bindContent:!0}),e},toUpload:function(e){var n=e?e.toUpload():[];return{id:this.id,name:this.name,deleted:this.deleted,client_update_timestamp:e?e.client_update_timestamp:(new Date).getTime(),entries:t.isArray(n)?n:[n]}},loadUnits:function(){var e=this;if(r.isDemo){f.emit("units-loaded",{curriculum_id:e.id});return}if(e.units()&&e.units().length>0){f.emit("units-loaded",{curriculum_id:e.id});return}var n=l.create({path:"/remote/v1/unit/query",method:"get",success:function(n){var r=t.map(n.units,function(e){return c.create(e)});e.units(r),f.emit("units-loaded",{curriculum_id:e.id})},complete:function(){e.loadingUnits(!1)}});e.units([]),e.loadingUnits(!0),n.makeRequest({data:{curriculum_id:e.id}})}});return p}),tadpoles.define("services/curricula",["require","lodash","jquery","ko","services/config","model/remote","model/globalFilter","utilities","emit","model/curriculum/curriculum","services/disposer"],function(e){var t=e("lodash"),n=e("jquery"),r=e("ko"),i=e("services/config"),s=e("model/remote"),o=e("model/globalFilter"),u=e("utilities"),a=e("emit"),f=null,l=e("model/curriculum/curriculum"),c=e("services/disposer"),h=s.extend({className:"Curricula",initialize:function(){var e=this;s.initialize.call(this,{method:"get"}),e.curricula=r.observable(),e.domainsById=r.pureComputed(function(){var n=e.curricula();return n?t.reduce(n.curricula,function(e,n){return t.defaults(e,t.indexBy(n.domains,"id"))},{}):{}}),e.coreCurriculum=r.observable(),e.outcomesById=r.pureComputed(function(){var n=e.curricula();return n?t.reduce(n.curricula,function(e,n){return t.defaults(e,t.indexBy(n.outcomes,"id"))},{}):{}}),e.curriculumChoices=r.pureComputed(function(){if(!e.curricula())return[];var n=t(e.curricula().curricula).reject("deleted").map(function(e){return{id:e.id,name:e.name||e.id}}).value();return n}),o.locationSelected.subscribe(function(t){if(!t)return null;e.curricula()&&c.dispose(e.curricula().curricula),e.curricula(null),e.getCurriculaDeferred()}),a.on("curriculumChanged",function(){e.getCurriculaDeferred()}),a.on("upsert-curriculum",function(t){e.upsertCurriculum(t)})},getDemoCurriculum:function(){var e={infant:["cognitive","language","movement","perception","sensory","social","special","signing","tummy"],toddler:["art","circle time","cognitive","language","movement","music","perception","sensory","social","special"],preschool:["art","circle time","cognitive","language","math","music","personal","physical","science","social","special"],school:["circle time","language","science","math","physical","personal","social","music","art","cognitive","special"]};return{curricula:t.map(e,function(e,n){return{id:n,name:n,entries:t.map(e,function(e){return{type:"d",id:n+":"+e,name:e,outcomes:[]}})}})}},upsertCurriculum:function(e){var n=t.findIndex(this.curricula().curricula,{id:e.id});this.curricula.valueWillMutate();if(n>=0){var r=this.curricula().curricula[n];e.entries(r.entries()),this.curricula().curricula[n]=e}else this.curricula().curricula.push(e);this.curricula.valueHasMutated(),a.emit("curricula-modified",this.curricula()),a.emit("curriculum-modified",e)},getCurriculaDeferred:function(){var e=this,r=new n.Deferred;return this.curricula()?r.resolve(this.curricula()):i.isDemo?(this.curricula({curricula:t.map(this.getDemoCurriculum().curricula,function(e){return l.create(e)})}),r.resolve(this.curricula())):o.locationSelected()?this.makeRequest({path:"/remote/v1/curricula?location="+o.location().key+"&format=flat",success:function(n){e.curricula()&&c.dispose(e.curricula().curricula),e.curricula({curricula:t.map(n.curricula,function(e){return t.contains(n.external_curricula_ids||[],e.id)&&(e.external=!0),l.create(e)})}),e.coreCurriculum()&&e.coreCurriculum().dispose(),n.core_curriculum&&e.coreCurriculum(l.create(n.core_curriculum)),r.resolve(e.curricula()),a.emit("curricula-loaded",{})},error:function(){r.reject()}}):(this.curricula(null),r.resolve(null)),r.promise()},DUMMY_CURRICULUM:{id:"",name:"",domains:[]},getCurriculumById:function(e){return this.curricula()?t.find(this.curricula().curricula,function(t){return t.id===e})||this.DUMMY_CURRICULUM:this.DUMMY_CURRICULUM},getDomainById:function(e){return this.domainsById()[e]},getOutcomeById:function(e){return this.outcomesById()[e]},getDomainByCurriculumAndName:function(e,n){var r=this.getCurriculumById(e);return r?t.find(r.domains,function(e){return e.name.toLowerCase()===n}):null},getCurriculumForGroupDeferred:function(e){var r=this,i=new n.Deferred;e||i.resolve(null);var s=e.curriculumId();return this.getCurriculaDeferred().done(function(e){var n=t.find(e.curricula,function(e){return e.id===s});i.resolve(n)}).fail(function(){i.reject()}),i.promise()},getCurriculumForGroup:function(e){var n=e.curriculumId();return t.find(this.curricula().curricula,function(e){return e.id===n})},editCurriculum:function(){f=u.lazyLoadModule(f,"model/curriculum/curriculaEditModal"),f.getInstance().open()}});return u.makeSingleton(h)}),tadpoles.define("model/activityEntry",["require","ko","lodash","model/dailyReportEntry","model/actionTile","model/event","services/curricula","services/alerts","model/remote","model/globalFilter","services/children"],function(e){var t=e("ko"),n=e("lodash"),r=e("model/dailyReportEntry"),i=e("model/actionTile"),s=e("model/event"),o=e("services/curricula"),u=e("services/alerts"),a=e("model/remote"),f=e("model/globalFilter"),l=e("services/children"),c=r.extend(i,{className:"ActivityEntry",initialize:function(e){i.initialize.call(this),r.initialize.call(this,e),this.type_name="activity",this.name=e.name,this.activities=e.activities||(e.classification?e.classification.split(","):[]),this.c_domains=e.c_domains||[],this.c_goals=e.c_goals,this.c_goal_labels=e.c_goal_labels,this.goals=e.goals,this.materials=e.materials,this.options=e.options,this.instructions=e.instructions,this.dataAttachmentId=e.dataAttachmentId,this.members=e.members},dispose:function(){i.dispose.call(this),r.dispose.call(this)},getPrimary:function(){var e=this.activities.join(", ");return this.name&&(e+=(e?" - ":"")+this.name),e},getNote:function(){var e=r.getNote.call(this),t=this.linked_photo_entry?this.linked_photo_entry.note:null;return(e||"")+(e&&t?" - ":"")+(t||"")},getGoals:function(){return n(this.c_goals).map(function(e){return o.getInstance().getOutcomeById(e.id)}).compact().value()},getCurricularNote:function(){var e=n(this.c_goals).map(function(e){return o.getInstance().getOutcomeById(e.id)}).value(),t=n(e).map(function(e){return e?e.name+(e.externalId?" ("+e.externalId+")":""):""}).value();return t.join(", ")},getMemberNames:function(){var e=this;return n(l.getInstance().activeChildrenForSelectedGroup()).filter(function(t){return n(e.members).contains(t.key)}).pluck(function(e){return e.fullName()})},hasLessonDetails:function(e){return this.c_goals&&this.c_goals.length>0||this.goals||this.materials||this.instructions||this.options&&this.options.length>0||this.members&&this.members.length>0&&e.subject_type!="individual"},serialize:function(){return n.extend(r.serialize.call(this),{name:this.name,activities:this.activities,c_domains:this.c_domains,c_goals:this.c_goals,c_goal_labels:this.c_goal_labels,goals:this.goals,materials:this.materials,options:this.options,instructions:this.instructions,dataAttachmentId:this.dataAttachmentId,members:this.members})},toUpload:function(){var e=r.toUpload.call(this);e.activities=this.activities,e.goals=this.goals,e.c_domains=this.c_domains,e.c_goals=this.c_goals,e.c_goal_labels=this.c_goal_labels,e.materials=this.materials,e.instructions=this.instructions,e.options=this.options,e.name=this.name,e.members=this.members,e.v=7;var t=e;if(this.dataAttachmentId){var i=n.cloneDeep(e);i.note=null,i.id=this.dataAttachmentId,i.link_id=e.id,t=[e,i]}return this.deleted&&this.linked_note_entry&&(t=[e,this.linked_note_entry.toUpload()]),t},edit:function(){if(!this.attachment())return;var e,t;this.linked_photo_entry?(e=this.linked_photo_entry.id(),t=this.linked_photo_entry.note):(e=this.id(),t=this.note);var n=s.create({key:e,comment:t});n.edit()},removeEntry:function(e){var n=this,r=a.create({path:"/remote/v1/daily_report",method:"post"}),i=this.linked_photo_entry?this.linked_photo_entry.toUpload():this.toUpload();i.deleted=!0,i.owner=e.getSelfOwner(),i.client_update_timestamp=(new Date).getTime();var s=c.create(i),o={daily_report:t.toJSON(e.toUpload(s))};f.location()&&(o.location=f.location().key),r.makeRequest({data:o,success:function(){e.upsertEntry(s),n.linked_photo_entry&&(n.attachment(null),n.linked_photo_entry=null,e.upsertEntry(n))}})},remove:function(e){if(!this.attachment())return;var t=this,n="Delete this attachment?",r="This action cannot be undone. Delete anyway?";u.showYesNo({title:n,message:r,yes:function(){t.removeEntry(e)},no:function(){}})},clone:function(){return c.create(this.serialize())}});return c}),tadpoles.define("model/noteEntry",["require","lodash","model/dailyReportEntry"],function(e){var t=e("lodash"),n=e("model/dailyReportEntry"),r=n.extend({className:"NoteEntry",initialize:function(e){n.initialize.call(this,e),this.type_name="note",this.please_bring=e.please_bring||(e.details?e.details.split(","):[]),this.feeling=e.feeling||(e.classification&&e.classification!=="outside"?e.classification:""),this.note_type=e.note_type,this.question=e.question,this.question_id=e.question_id,this.answer=e.answer,this.answer_type=e.answer_type},serialize:function(){return t.extend(n.serialize.call(this),{please_bring:this.please_bring,feeling:this.feeling,note_type:this.note_type,question:this.question,question_id:this.question_id,answer:this.answer,answer_type:this.answer_type})},toUpload:function(){var e=n.toUpload.call(this);return e.please_bring=this.please_bring,e.feeling=this.feeling||null,e.v=3,e.note_type=this.note_type||null,e.question=this.question||null,e.question_id=this.question_id||null,e.answer=this.answer||null,e.answer_type=this.answer_type||null,e},clone:function(){return r.create(this.serialize())}});return r}),tadpoles.define("model/napEntry",["require","lodash","model/dailyReportEntry"],function(e){var t=e("lodash"),n=e("model/dailyReportEntry"),r=n.extend({className:"NapEntry",initialize:function(e){n.initialize.call(this,e),this.type_name="nap",this.start_time=e.start_time,this.end_time=e.end_time,this.checks=e.checks,this.reminder_period=e.reminder_period,this.sleep_type=e.sleep_type||e.details},getTimeDisplay:function(){var e;return this.start_time&&this.end_time?(e="slept for "+(new Date(this.end_time*1e3)).humaneDate(new Date(this.start_time*1e3),!1,!1)+" from ",e+=(new Date(this.start_time*1e3)).format("shortTime"),e+=" to ",e+=(new Date(this.end_time*1e3)).format("shortTime")):this.start_time?(e="asleep starting at ",e+=(new Date(this.start_time*1e3)).format("shortTime")):this.end_time&&(e="woke up at ",e+=(new Date(this.end_time*1e3)).format("shortTime")),e},getCheckDisplayData:function(){var e=this,n=this.start_time,r=t.map(this.checks,function(t){var r=Math.floor((t-n)/60),i=e.reminder_period?r-e.reminder_period:0,s={check:(new Date(t*1e3)).format("shortTime"),css:i>0?"late":"",tooltip:i>0?i+" min late":!1};return n=t,s});return this.end_time&&this.reminder_period&&Math.floor((this.end_time-n)/60)>this.reminder_period&&r.push({check:"?",css:"late",tooltip:"missing check before nap ended"}),r},serialize:function(){return t.extend(n.serialize.call(this),{start_time:this.start_time,end_time:this.end_time,checks:this.checks,reminder_period:this.reminder_period,sleep_type:this.sleep_type})},toUpload:function(){var e=n.toUpload.call(this);return e.start_time=this.start_time,e.end_time=this.end_time,e.sleep_type=this.sleep_type,e},clone:function(){return r.create(this.serialize())}});return r}),tadpoles.define("model/daily_report/themeEntry",["require","lodash","model/dailyReportEntry"],function(e){var t=e("lodash"),n=e("model/dailyReportEntry"),r=n.extend({className:"ThemeEntry",initialize:function(e){n.initialize.call(this,e),this.type_name="theme",this.scope=e.scope,this.name=e.name},toUpload:function(){var e=n.toUpload.call(this);return e.scope=this.scope,e.name=this.name,e.note=this.note,e},getPrimary:function(){return this.name},serialize:function(){return t.extend(n.serialize.call(this),{scope:this.scope,name:this.name})},clone:function(){return r.create(this.serialize())}});return r}),tadpoles.define("model/actionHistory",["require","selfish","ko","lodash"],function(e){var t=e("selfish"),n=e("ko"),r=e("lodash"),i=t.Base.extend({className:"ActionHistory",initialize:function(e){var t=this;t.entries=n.observableArray(e||[]),t.rejections=n.pureComputed(function(){if(t.entries().length===0)return[];var e=r(t.entries()).filter(function(e){return e.action==="resent"||e.action==="delivered"||e.action==="opened"}).pluck("actor").uniq().value(),n=r.findLast(t.entries(),function(e){return e.action==="published"&&e.source==="resend"}),i=n?n.action_timestamp:0;return r(t.entries()).filter(function(t){return(t.action==="spam"||t.action==="rejected")&&!r.contains(e,t.actor)&&t.action_timestamp>i}).uniq(function(e){return e.actor}).value()}),t.spamActors=n.pureComputed(function(){return r(t.rejections()).filter(function(e){return e.action==="spam"||e.action==="rejected"}).pluck("actor").value()})},getEntryPrefix:function(e){var t="",n="";return e.channel==="push"?(e.client_type&&(t=e.client_type+" "),t+="notification"):t="email",e.action==="sent"?e.source==="intraday"?n="started report notifications for ":n=t+" sent to ":e.action==="resent"?n=t+" resent to ":e.action==="delivered"?n=t+" delivered to ":e.action==="opened"?n=t+" read by ":e.action==="rejected"||e.action==="soft-bounced"||e.action==="person-blocked"?n=t+" to ":e.action==="spam"||e.action==="optout"?n="":e.action==="no email"?n="no email sent":e.action==="published"?e.source==="checkout"?n="report published on checkout":e.source==="update"?n="report updates published":e.source==="resend"?n="report resent":n="report published manually":n=e.action+" - ",n},getEntryPostfix:function(e){var t="",n="";return e.channel==="push"?t="notifications":t="email",e.action==="rejected"?n=" was rejected":e.action==="soft-bounced"?n=" was soft bounced and will retry":e.action==="person-blocked"?n=" was blocked":e.action==="spam"?n=" marked the email as spam":e.action==="optout"&&(n=" has opted out of "+t),n},isError:function(e){return e.action==="rejected"||e.action==="spam"}});return i}),tadpoles.define("model/modal/editModal",["require","ko","lodash","services/modal","model/remote","model/globalFilter","services/alerts","emit"],function(e){var t=e("ko"),n=e("lodash"),r=e("services/modal"),i=e("model/remote"),s=e("model/globalFilter"),o=e("services/alerts"),u=e("emit"),a=r.extend(i,{className:"EditModal",initialize:function(e){e=e||{};var n=this;this.originalValue=t.observable(),this.newValue=t.observable(),this.entryTemplate=t.observable(e.template),this.typeName=t.observable(e.typeName),this.title=t.observable(e.title||e.typeName),this.isNew=t.pureComputed(function(){return!n.originalValue()}),this.focusTrigger=t.observable(!1),i.initialize.call(this,{path:"/remote/null",method:"post",success:function(){n.close()}}),r.initialize.call(this,{template:e.mainTemplate||"view/modals/curriculum/curriculumEditModal",model:this}),this.dirtyObserver=t.createDirtyObserver([])},isDirty:function(){return this.dirtyObserver.dirty()},init:function(){this.populate(),this.dirtyObserver.reset()},open:function(e){this.originalValue(e),this.init(),r.open.call(this),this.focus()},afterSave:function(e){this.onSave(),e?this.close():(this.clearEntry(),this.init(),this.focusTrigger(!0))},upload:function(e,t){var n=this;this.newValue(this.getNewValue(e));var r=this.getUploadData();s.location()&&(r.location=s.location().key),console.log("uploading change"),this.makeRequest({path:this.getUploadPath(),blobPath:this.getBlobUploadPath(),data:r,success:function(){console.log("uploading complete"),n.afterSave(t)}})},remove:function(){var e=this,t="Delete the "+this.title()+"?",n=this.getDeleteMessage();o.showYesNo({title:t,message:n,yes:function(){e.upload(!0,!0)},no:function(){}})},save:function(e){if(!this.isPopulated()){if(!this.isNew()){this.remove();return}e&&this.close();return}this.upload(!1,e)},clear:function(){i.clear.call(this)},clearEntry:function(){this.clear(),this.originalValue(null),this.newValue(null),this.onClear()},confirmAndClose:function(){if(!this.isDirty()){this.close();return}var e=this,t=this.isNew()?"Discard this entry?":"Discard any changes?",n=this.isNew()?"This new entry will not be saved!":"Any changes you have made will be lost.";o.showYesNo({title:t,message:n,yes:function(){e.close()},no:function(){}})},saveAndClose:function(){this.isDirty()?this.save(!0):this.close()},saveAndContinue:function(){this.isDirty()?this.save(!1):(this.clearEntry(),this.init())},close:function(){this.clearEntry(),this.onClose(),this.focusTrigger(!1),r.close.call(this)},focus:function(){var e=this;n.delay(function(){e.focusTrigger(!0)},500)},populate:function(){},isPopulated:function(){return!1},valid:function(){return!0},onSave:function(){},onClose:function(){},onClear:function(){},getUploadPath:function(){return"/remote/null"},getBlobUploadPath:function(){return"/remote/null"},getNewValue:function(e){return null},getUploadData:function(){return{}},getDeleteMessage:function(){return"This action cannot be undone. Delete anyway?"}});return a}),tadpoles.define("model/daily_report/entryEditModal",["require","ko","lodash","model/modal/editModal","services/uuid","emit","services/config"],function(e){var t=e("ko"),n=e("lodash"),r=e("model/modal/editModal"),i=e("services/uuid"),s=e("emit"),o=e("services/config"),u=r.extend({className:"EntryEditModal",initialize:function(e){var n=this;this.report=t.observable(),this.alert=t.observable(),this.bodyAlert=t.observable(),this.canSaveAndAddNew=t.observable(!0),this.color=t.pureComputed(function(){var e="#f2f2f2";if(n.report())switch(n.report().stage){case"infant":e="#e4eeff";break;case"toddler":e="#efe9fa";break;case"preschool":e="#ffe5c8";break;case"school":e="#e4f4e5"}return e}),this.typeahead=t.pureComputed(function(){return n.getTypeAheadFunc()}),this.hasTypeahead=t.observable(!1),this.search=t.observable(),r.initialize.call(this,{mainTemplate:"view/modals/daily_report/entryEditModal",template:e.template,typeName:e.typeName})},isLesson:function(){return this.report()?this.report().type_name==="lesson_plan":!1},open:function(e,t){this.report(e),this.report()&&this.alert(this.isLesson()&&this.report().isLocation()&&this.typeName()==="meal"?'Meals for the whole location will NOT be added to infant reports and "any age" classrooms.':null),this.width(this.getWidth()),r.open.call(this,t)},onSave:function(){var e=this.report();e.canonical(!1);var t=this.newValue();console.log("upserting local"),e.upsertEntry(t)},onClose:function(){this.report(null),this.search(null)},getUploadPath:function(){return o.isParentApp?"/remote/v1/daily_report/parent":"/remote/v1/daily_report"},getBlobUploadPath:function(){return this.getUploadPath()},getWidth:function(){return null},getNewValue:function(e){return this.createEntry({id:this.originalValue()?this.originalValue().id():i.short(),owner:this.report().getSelfOwner(),capture_time:this.originalValue()?this.originalValue().capture_time:Math.floor((new Date).getTime()/1e3),client_update_timestamp:(new Date).getTime(),stage:this.originalValue()?this.originalValue().stage:this.report().stage,deleted:e})},getUploadData:function(){return{daily_report:t.toJSON(this.report().toUpload(this.newValue()))}},getTypeAheadFunc:function(){return[]}});return u}),tadpoles.define("bootstrap",["jquery"],function(e){+function(e){function t(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var n in t)if(e.style[n]!==undefined)return{end:t[n]};return!1}e.fn.emulateTransitionEnd=function(t){var n=!1,r=this;e(this).one("bsTransitionEnd",function(){n=!0});var i=function(){n||e(r).trigger(e.support.transition.end)};return setTimeout(i,t),this},e(function(){e.support.transition=t();if(!e.support.transition)return;e.event.special.bsTransitionEnd={bindType:e.support.transition.end,delegateType:e.support.transition.end,handle:function(t){if(e(t.target).is(this))return t.handleObj.handler.apply(this,arguments)}}})}(e),!function(e){"use strict";function n(){var t=this,n=setTimeout(function(){t.$element.off(e.support.transition.end),r.call(t)},500);this.$element.one(e.support.transition.end,function(){clearTimeout(n),r.call(t)})}function r(e){this.$element.hide().trigger("hidden"),i.call(this)}function i(t){var n=this,r=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var i=e.support.transition&&r;this.$backdrop=e('<div class="modal-backdrop '+r+'" />').appendTo(document.body),this.options.backdrop!="static"&&this.$backdrop.click(e.proxy(this.hide,this)),i&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),i?this.$backdrop.one(e.support.transition.end,t):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(e.support.transition.end,e.proxy(s,this)):s.call(this)):t&&t()}function s(){this.$backdrop.remove(),this.$backdrop=null}function o(){var t=this;this.isShown&&this.options.keyboard?e(document).on("keyup.dismiss.modal",function(e){e.which==27&&t.hide()}):this.isShown||e(document).off("keyup.dismiss.modal")}var t=function(t,n){this.options=n,this.$element=e(t).delegate('[data-dismiss="modal"]',"click.dismiss.modal",e.proxy(this.hide,this))};t.prototype={constructor:t,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var t=this;if(this.isShown)return;e("body").addClass("modal-open"),this.isShown=!0,this.$element.trigger("show"),o.call(this),i.call(this,function(){var n=e.support.transition&&t.$element.hasClass("fade");!t.$element.parent().length&&t.$element.appendTo(document.body),t.$element.show(),n&&t.$element[0].offsetWidth,t.$element.addClass("in"),n?t.$element.one(e.support.transition.end,function(){t.$element.trigger("shown")}):t.$element.trigger("shown")})},hide:function(t){t&&t.preventDefault();if(!this.isShown)return;var i=this;this.isShown=!1,e("body").removeClass("modal-open"),o.call(this),this.$element.trigger("hide").removeClass("in"),e.support.transition&&this.$element.hasClass("fade")?n.call(this):r.call(this)}},e.fn.modal=function(n){return this.each(function(){var r=e(this),i=r.data("modal"),s=e.extend({},e.fn.modal.defaults,r.data(),typeof n=="object"&&n);i||r.data("modal",i=new t(this,s)),typeof n=="string"?i[n]():s.show&&i.show()})},e.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},e.fn.modal.Constructor=t,e(function(){e("body").on("click.modal.data-api",'[data-toggle="modal"]',function(t){var n=e(this),r,i=e(n.attr("data-target")||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,"")),s=i.data("modal")?"toggle":e.extend({},i.data(),n.data());t.preventDefault(),i.modal(s)})})}(e),!function(e){"use strict";function r(){e(t).parent().removeClass("open")}var t='[data-toggle="dropdown"]',n=function(t){var n=e(t).on("click.dropdown.data-api",this.toggle);e("html").on("click.dropdown.data-api",function(){n.parent().removeClass("open")})};n.prototype={constructor:n,toggle:function(t){var n=e(this),i=n.attr("data-target"),s,o;return i||(i=n.attr("href"),i=i&&i.replace(/.*(?=#[^\s]*$)/,"")),s=e(i),s.length||(s=n.parent()),o=s.hasClass("open"),r(),!o&&s.toggleClass("open"),!1}},e.fn.dropdown=function(t){return this.each(function(){var r=e(this),i=r.data("dropdown");i||r.data("dropdown",i=new n(this)),typeof t=="string"&&i[t].call(r)})},e.fn.dropdown.Constructor=n,e(function(){e("html").on("click.dropdown.data-api",r),e("body").on("click.dropdown.data-api",t,n.prototype.toggle)})}(e),!function(e){"use strict";function t(t,n){var r=e.proxy(this.process,this),i=e(t).is("body")?e(window):e(t),s;this.options=e.extend({},e.fn.scrollspy.defaults,n),this.$scrollElement=i.on("scroll.scroll.data-api",r),this.selector=(this.options.target||(s=e(t).attr("href"))&&s.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a",this.$body=e("body").on("click.scroll.data-api",this.selector,r),this.refresh(),this.process()}t.prototype={constructor:t,refresh:function(){this.targets=this.$body.find(this.selector).map(function(){var t=e(this).attr("href");return/^#\w/.test(t)&&e(t).length?t:null}),this.offsets=e.map(this.targets,function(t){return e(t).position().top})},process:function(){var e=this.$scrollElement.scrollTop()+this.options.offset,t=this.offsets,n=this.targets,r=this.activeTarget,i;for(i=t.length;i--;)r!=n[i]&&e>=t[i]&&(!t[i+1]||e<=t[i+1])&&this.activate(n[i])},activate:function(e){var t;this.activeTarget=e,this.$body.find(this.selector).parent(".active").removeClass("active"),t=this.$body.find(this.selector+'[href="'+e+'"]').parent("li").addClass("active"),t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active")}},e.fn.scrollspy=function(n){return this.each(function(){var r=e(this),i=r.data("scrollspy"),s=typeof n=="object"&&n;i||r.data("scrollspy",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.scrollspy.Constructor=t,e.fn.scrollspy.defaults={offset:10},e(function(){e('[data-spy="scroll"]').each(function(){var t=e(this);t.scrollspy(t.data())})})}(e),!function(e){"use strict";var t=function(t){this.element=e(t)};t.prototype={constructor:t,show:function(){var t=this.element,n=t.closest("ul:not(.dropdown-menu)"),r=t.attr("data-target"),i,s;r||(r=t.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,""));if(t.parent("li").hasClass("active"))return;i=n.find(".active a").last()[0],t.trigger({type:"show",relatedTarget:i}),s=e(r),this.activate(t.parent("li"),n),this.activate(s,s.parent(),function(){t.trigger({type:"shown",relatedTarget:i})})},activate:function(t,n,r){function o(){i.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),t.addClass("active"),s?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active"),r&&r()}var i=n.find("> .active"),s=r&&e.support.transition&&i.hasClass("fade");s?i.one(e.support.transition.end,o):o(),i.removeClass("in")}},e.fn.tab=function(n){return this.each(function(){var r=e(this),i=r.data("tab");i||r.data("tab",i=new t(this)),typeof n=="string"&&i[n]()})},e.fn.tab.Constructor=t,e(function(){e("body").on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(t){t.preventDefault(),e(this).tab("show")})})}(e),!function(e){"use strict";var t=function(e,t){this.init("tooltip",e,t)};t.prototype={constructor:t,init:function(t,n,r){var i,s;this.type=t,this.$element=e(n),this.options=this.getOptions(r),this.enabled=!0,this.options.trigger=="click"?this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this)):this.options.trigger!="manual"&&(i=this.options.trigger=="hover"?"mouseenter":"focus",s=this.options.trigger=="hover"?"mouseleave":"blur",this.$element.on(i+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(s+"."+this.type,this.options.selector,e.proxy(this.leave,this))),this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(t){return t=e.extend({},e.fn[this.type].defaults,t,this.$element.data()),t.delay&&typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),t},enter:function(t){var n=e(this.$element)[this.type](this._options).data(this.type);!n.options.delay||!n.options.delay.show?n.show():(n.hoverState="in",setTimeout(function(){n.hoverState=="in"&&n.show()},n.options.delay.show))},leave:function(t){var n=e(this.$element)[this.type](this._options).data(this.type);!n.options.delay||!n.options.delay.hide?n.hide():(n.hoverState="out",setTimeout(function(){n.hoverState=="out"&&n.hide()},n.options.delay.hide))},show:function(){var t,n,r,i,s,o,u;if(this.hasContent()&&this.enabled){t=this.tip();if(t.hasClass("in"))return;this.setContent(),this.options.animation&&t.addClass("fade"),o=typeof this.options.placement=="function"?this.options.placement.call(this,t[0],this.$element[0]):this.options.placement,n=/in/.test(o),t.remove().css({top:0,left:0,display:"block"}).appendTo(n?this.$element:document.body),this.$element.trigger("shown",t),r=this.getPosition(n),i=t[0].offsetWidth,s=t[0].offsetHeight;switch(n?o.split(" ")[1]:o){case"bottom":u={top:r.top+r.height,left:r.left+r.width/2-i/2};break;case"top":u={top:r.top-s,left:r.left+r.width/2-i/2};break;case"left":u={top:r.top+r.height/2-s/2,left:r.left-i};break;case"right":u={top:r.top+r.height/2-s/2,left:r.left+r.width}}t.css(u).addClass(o).addClass("in"),this.options.hoverself&&(t.on("mouseenter."+this.type,this.options.selector,e.proxy(this.enter,this)),t.on("mouseleave."+this.type,this.options.selector,e.proxy(this.leave,this)))}},setContent:function(){var e=this.tip();e.find(".tooltip-inner").html(this.getTitle()),e.removeClass("fade in top bottom left right")},hide:function(){function r(){var t=setTimeout(function(){n.off(e.support.transition.end).remove()},500);n.one(e.support.transition.end,function(){clearTimeout(t),n.remove()})}var t=this,n=this.tip();if(!n.hasClass("in"))return;n.removeClass("in"),this.$element.trigger("hidden",n),e.support.transition&&this.$tip.hasClass("fade")?r():n.remove(),this.options.hoverself&&n.off("."+this.type).removeData(this.type)},fixTitle:function(){var e=this.$element;(e.attr("title")||typeof e.attr("data-original-title")!="string")&&e.attr("data-original-title",e.attr("title")||"").removeAttr("title")},hasContent:function(){return this.getTitle()},getPosition:function(t){var n=this.$element.width(),r=this.$element.parent().width(),i=n>r?r:n;return e.extend({},t?{top:0,left:0}:this.$element.offset(),{width:i,height:this.$element[0].offsetHeight})},getTitle:function(){var e,t=this.$element,n=this.options;return e=t.attr("data-original-title")||(typeof n.title=="function"?n.title.call(t[0]):n.title),e=(e||"").toString().replace(/(^\s*|\s*$)/,""),e},tip:function(){return this.$tip=this.$tip||e(this.options.template)},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[this.tip().hasClass("in")?"hide":"show"]()},destroy:function(){this.hide(),this.disable(),this.$element.off("."+this.type).removeData(this.type)}},e.fn.tooltip=function(n){return this.each(function(){var r=e(this),i=r.data("tooltip"),s=typeof n=="object"&&n;i||r.data("tooltip",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.tooltip.Constructor=t,e.fn.tooltip.defaults={animation:!0,delay:0,hoverself:!1,selector:!1,placement:"top",trigger:"hover",title:"",template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>'}}(e),!function(e){"use strict";var t=function(e,t){this.init("popover",e,t)};t.prototype=e.extend({},e.fn.tooltip.Constructor.prototype,{constructor:t,setContent:function(){var t=this.tip(),n=this.getTitle(),r=this.getContent();n&&t.find(".popover-title")[e.type(n)=="object"?"append":"html"](n),t.find(".popover-content > *")[e.type(r)=="object"?"append":"html"](r),t.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var e,t=this.$element,n=this.options;return e=t.attr("data-content")||(typeof n.content=="function"?n.content.call(t[0]):n.content),e=e.toString().replace(/(^\s*|\s*$)/,""),e},tip:function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip}}),e.fn.popover=function(n){return this.each(function(){var r=e(this),i=r.data("popover"),s=typeof n=="object"&&n;i||r.data("popover",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.popover.Constructor=t,e.fn.popover.defaults=e.extend({},e.fn.tooltip.defaults,{placement:"right",content:"",template:'<div class="popover"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title"></h3><div class="popover-content"><p></p></div></div></div>'})}(e),!function(e){"use strict";var t='[data-dismiss="alert"]',n=function(n){e(n).on("click",t,this.close)};n.prototype={constructor:n,close:function(t){function s(){i.trigger("closed").remove()}var n=e(this),r=n.attr("data-target"),i;r||(r=n.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,"")),i=e(r),i.trigger("close"),t&&t.preventDefault(),i.length||(i=n.hasClass("alert")?n:n.parent()),i.trigger("close").removeClass("in"),e.support.transition&&i.hasClass("fade")?i.on(e.support.transition.end,s):s()}},e.fn.alert=function(t){return this.each(function(){var r=e(this),i=r.data("alert");i||r.data("alert",i=new n(this)),typeof t=="string"&&i[t].call(r)})},e.fn.alert.Constructor=n,e(function(){e("body").on("click.alert.data-api",t,n.prototype.close)})}(e),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.button.defaults,n)};t.prototype={constructor:t,setState:function(e){var t="disabled",n=this.$element,r=n.data(),i=n.is("input")?"val":"html";e+="Text",r.resetText||n.data("resetText",n[i]()),n[i](r[e]||this.options[e]),setTimeout(function(){e=="loadingText"?n.addClass(t).attr(t,t):n.removeClass(t).removeAttr(t)},0)},toggle:function(){var e=this.$element.parent('[data-toggle="buttons-radio"]');e&&e.find(".active").removeClass("active"),this.$element.toggleClass("active")}},e.fn.button=function(n){return this.each(function(){var r=e(this),i=r.data("button"),s=typeof n=="object"&&n;i||r.data("button",i=new t(this,s)),n=="toggle"?i.toggle():n&&i.setState(n)})},e.fn.button.defaults={loadingText:"loading..."},e.fn.button.Constructor=t,e(function(){e("body").on("click.button.data-api","[data-toggle^=button]",function(t){var n=e(t.target);n.hasClass("btn")||(n=n.closest(".btn")),n.button("toggle")})})}(e),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.collapse.defaults,n),this.options.parent&&(this.$parent=e(this.options.parent)),this.options.toggle&&this.toggle()};t.prototype={constructor:t,dimension:function(){var e=this.$element.hasClass("width");return e?"width":"height"},show:function(){var t=this.dimension(),n=e.camelCase(["scroll",t].join("-")),r=this.$parent&&this.$parent.find(".in"),i;r&&r.length&&(i=r.data("collapse"),r.collapse("hide"),i||r.data("collapse",null)),this.$element[t](0),this.transition("addClass","show","shown"),this.$element[t](this.$element[0][n])},hide:function(){var e=this.dimension();this.reset(this.$element[e]()),this.transition("removeClass","hide","hidden"),this.$element[e](0)},reset:function(e){var t=this.dimension();return this.$element.removeClass("collapse")[t](e||"auto")[0].offsetWidth,this.$element[e?"addClass":"removeClass"]("collapse"),this},transition:function(t,n,r){var i=this,s=function(){n=="show"&&i.reset(),i.$element.trigger(r)};this.$element.trigger(n)[t]("in"),e.support.transition&&this.$element.hasClass("collapse")?this.$element.one(e.support.transition.end,s):s()},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]()}},e.fn.collapse=function(n){return this.each(function(){var r=e(this),i=r.data("collapse"),s=typeof n=="object"&&n;i||r.data("collapse",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.collapse.defaults={toggle:!0},e.fn.collapse.Constructor=t,e(function(){e("body").on("click.collapse.data-api","[data-toggle=collapse]",function(t){var n=e(this),r,i=n.attr("data-target")||t.preventDefault()||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,""),s=e(i).data("collapse")?"toggle":n.data();e(i).collapse(s)})})}(e),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.carousel.defaults,n),this.options.slide&&this.slide(this.options.slide),this.options.pause=="hover"&&this.$element.on("mouseenter",e.proxy(this.pause,this)).on("mouseleave",e.proxy(this.cycle,this))};t.prototype={cycle:function(){return this.interval=setInterval(e.proxy(this.next,this),this.options.interval),this},to:function(t){var n=this.$element.find(".active"),r=n.parent().children(),i=r.index(n),s=this;if(t>r.length-1||t<0)return;return this.sliding?this.$element.one("slid",function(){s.to(t)}):i==t?this.pause().cycle():this.slide(t>i?"next":"prev",e(r[t]))},pause:function(){return clearInterval(this.interval),this.interval=null,this},next:function(){if(this.sliding)return;return this.slide("next")},prev:function(){if(this.sliding)return;return this.slide("prev")},slide:function(t,n){var r=this.$element.find(".active"),i=n||r[t](),s=this.interval,o=t=="next"?"left":"right",u=t=="next"?"first":"last",a=this;this.sliding=!0,s&&this.pause(),i=i.length?i:this.$element.find(".item")[u]();if(i.hasClass("active"))return;return!e.support.transition&&this.$element.hasClass("slide")?(this.$element.trigger("slide"),r.removeClass("active"),i.addClass("active"),this.sliding=!1,this.$element.trigger("slid")):(i.addClass(t),i[0].offsetWidth,r.addClass(o),i.addClass(o),this.$element.trigger("slide"),this.$element.one(e.support.transition.end,function(){i.removeClass([t,o].join(" ")).addClass("active"),r.removeClass(["active",o].join(" ")),a.sliding=!1,setTimeout(function(){a.$element.trigger("slid")},0)})),s&&this.cycle(),this}},e.fn.carousel=function(n){return this.each(function(){var r=e(this),i=r.data("carousel"),s=typeof n=="object"&&n;i||r.data("carousel",i=new t(this,s)),typeof n=="number"?i.to(n):typeof n=="string"||(n=s.slide)?i[n]():i.cycle()})},e.fn.carousel.defaults={interval:5e3,pause:"hover"},e.fn.carousel.Constructor=t,e(function(){e("body").on("click.carousel.data-api","[data-slide]",function(t){var n=e(this),r,i=e(n.attr("data-target")||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,"")),s=!i.data("modal")&&e.extend({},i.data(),n.data());i.carousel(s),t.preventDefault()})})}(e),!function(e){var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.typeahead.defaults,n),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.highlighter=this.options.highlighter||this.highlighter,this.updater=this.options.updater||this.updater,this.handler=this.options.handler||this.handler,this.source=this.options.source,this.$menu=e(this.options.menu),this.shown=!1,this.listen()};t.prototype={constructor:t,select:function(){var e=this.$menu.find(".active").data("data-value");return this.handler?this.handler(e):this.$element.val(this.updater(e)).change(),this.hide()},updater:function(e){return e},show:function(){var t=e.extend({},this.$element.position(),{height:this.$element[0].offsetHeight});return this.$menu.insertAfter(this.$element).css({top:t.top+t.height,left:t.left}).show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(t){var n;return this.query=this.$element.val(),!this.query||this.query.length<this.options.minLength?this.shown?this.hide():this:(n=e.isFunction(this.source)?this.source(this.query,e.proxy(this.process,this)):this.source,n?this.process(n):this)},process:function(t){var n=this;return t=e.grep(t,function(e){return n.matcher(e)}),t=this.sorter(t),t.length?this.render(t.slice(0,this.options.items)).show():this.shown?this.hide():this},matcher:function(e){return~e.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(e){var t=[],n=[],r=[],i;while(i=e.shift())i.toLowerCase().indexOf(this.query.toLowerCase())?~i.indexOf(this.query)?n.push(i):r.push(i):t.push(i);return t.concat(n,r)},highlighter:function(e){var t=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return e.replace(new RegExp("("+t+")","ig"),function(e,t){return"<strong>"+t+"</strong>"})},render:function(t){var n=this;return t=e(t).map(function(t,r){var i=e(n.options.item).data("data-value",r);return i.find("a").html(n.highlighter(r,t)),t%2===0&&i.css({backgroundColor:"#f8f8f8"}),i[0]}),t.first().addClass("active"),this.$menu.html(t),this},next:function(t){var n=this.$menu.find(".active").removeClass("active"),r=n.next();r.length||(r=e(this.$menu.find("li")[0])),r.addClass("active")},prev:function(e){var t=this.$menu.find(".active").removeClass("active"),n=t.prev();n.length||(n=this.$menu.find("li").last()),n.addClass("active")},listen:function(){this.$element.on("focus",e.proxy(this.focus,this)).on("blur",e.proxy(this.blur,this)).on("keypress",e.proxy(this.keypress,this)).on("keyup",e.proxy(this.keyup,this)),this.eventSupported("keydown")&&this.$element.on("keydown",e.proxy(this.keydown,this)),this.$menu.on("click",e.proxy(this.click,this)).on("mouseenter","li",e.proxy(this.mouseenter,this)).on("mouseleave","li",e.proxy(this.mouseleave,this))},eventSupported:function(e){var t=e in this.$element;return t||(this.$element.setAttribute(e,"return;"),t=typeof this.$element[e]=="function"),t},move:function(e){if(!this.shown)return;switch(e.keyCode){case 9:case 13:case 27:e.preventDefault();break;case 38:e.preventDefault(),this.prev();break;case 40:e.preventDefault(),this.next()}e.stopPropagation()},keydown:function(t){this.suppressKeyPressRepeat=~e.inArray(t.keyCode,[40,38,9,13,27]),this.move(t)},keypress:function(e){if(this.suppressKeyPressRepeat)return;this.move(e)},keyup:function(e){switch(e.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}e.stopPropagation(),e.preventDefault()},focus:function(e){this.focused=!0},blur:function(e){this.focused=!1,!this.mousedover&&this.shown&&this.hide()},click:function(e){e.stopPropagation(),e.preventDefault(),this.select(),this.$element.focus()},mouseenter:function(t){this.mousedover=!0,this.$menu.find(".active").removeClass("active"),e(t.currentTarget).addClass("active")},mouseleave:function(e){this.mousedover=!1,!this.focused&&this.shown&&this.hide()}};var n=e.fn.typeahead;e.fn.typeahead=function(n){return this.each(function(){var r=e(this),i=r.data("typeahead"),s=typeof n=="object"&&n;i||r.data("typeahead",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1},e.fn.typeahead.Constructor=t,e.fn.typeahead.noConflict=function(){return e.fn.typeahead=n,this},e(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(t){var n=e(this);if(n.data("typeahead"))return;n.typeahead(n.data())})}(e)}),tadpoles.define("services/typeahead",["require","ko","lodash","jquery","bootstrap"],function(e){var t=e("ko"),n=e("lodash"),r=e("jquery");return e("bootstrap"),t.bindingHandlers.typeahead={init:function(e,i){var s=t.utils.unwrapObservable(i());if(s){var o=n.isArray(s)?{source:s}:s;r(e).typeahead(o)}}},{}}),tadpoles.define("services/dirtyObserver",["require","ko","lodash"],function(e){var t=e("ko"),n=e("lodash");t.createDirtyObserver=function(e){function o(){i=!0,r(!1),i=!1}var r=t.observable(!1),i=!1,s=t.computed(function(){return r()||n.each(e,function(e){e()}),r()}).extend({notify:"always"});return s.subscribe(function(){!r()&&!i&&r(!0)}),o(),{dirty:r,reset:o}},t.dirtyFlag=function(e){var n=t.observable(!1),r=t.computed(function(){return n()||t.toJS(e),n()});return r.subscribe(function(){n()||n(!0)}),r}}),tadpoles.define("model/daily_report/activityEditModal",["require","ko","jquery","lodash","services/uuid","model/activityEntry","model/curriculum/activity","model/daily_report/entryEditModal","model/globalFilter","services/groups","services/curricula","services/children","model/product","model/remote","selfish","services/typeahead","services/dirtyObserver","services/fileUpload"],function(e){function b(e){return String(e).replace(/[&<>"'\/]/g,function(e){return g[e]})}var t=e("ko"),n=e("jquery"),r=e("lodash"),i=e("services/uuid"),s=e("model/activityEntry"),o=e("model/curriculum/activity"),u=e("model/daily_report/entryEditModal"),a=e("model/globalFilter"),f=e("services/groups"),l=e("services/curricula"),c=e("services/children"),h=e("model/product"),p=e("model/remote"),d=e("selfish");e("services/typeahead"),e("services/dirtyObserver"),e("services/fileUpload");var v=["individual","small group","large group","child-directed","teacher-directed","am","pm","circle time","center time","outside","transition","theme"],m={None:"none",LessonPlan:"lp",GroupLessonActivity:"gla",LessonActivity:"la",AdHocActivity:"aha",Curriculum:"c"},g={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},y=d.Base.extend({className:"Tag",initialize:function(e,t,n){this.type=e,this.key=t,this.display=n}}),w=u.extend({className:"ActivityEditModal",initialize:function(){var e=this;this.mode=t.observable(m.None),this.selectedGoals=t.observableArray([]),this.curriculum=t.observable(),this.domains=t.pureComputed(function(){var t=[],n=e.curriculum();if(!n)return t;t=r.map(n.domains,function(e){return{id:e.id,name:e.name||e.id,st:e.st}});var i=e.originalValue();return i&&i.activities&&(i.c_domains?t=r(i.c_domains).map(function(e){return l.getInstance().getDomainById(e)}).compact().concat(t).uniq("id").value():t=r(i.activities).map(function(e){return l.getInstance().getDomainByCurriculumAndName(n.id,e.toLowerCase())}).compact().concat(t).uniq("id").value()),t}),this.selectedDomains=t.observableArray([]),this.options=t.observableArray(v),this.curriculumGoals=t.pureComputed(function(){function n(t){var n=[];if(e.curriculum()){var i=l.getInstance().getDomainById(t);i&&(n=r.filter(i.outcomes,"id"))}return n}var t=[];return r.each(e.selectedDomains(),function(e){t=r.union(t,n(e))}),t.length===0&&(t.push({id:"none",name:"None"}),e.selectedGoals.push("none")),e.selectedGoals.remove(function(e){return!r.detect(t,function(t){return t.id===e})}),t}),this.selectedOptions=t.observableArray([]),this.name=t.observable(),this.description=t.observable(),this.goals=t.observable(),this.materials=t.observable(),this.instructions=t.observable(),this.tags=t.observableArray([]),this.tagSearchText=t.observable(),this.taggedChildren=t.observable(),this.tagtypeahead=t.pureComputed(function(){return e.tagTypeAheadFunc()}),u.initialize.call(this,{template:"view/modals/daily_report/activityEdit",typeName:"activity"}),this.hasTypeahead(h.hasFeatureLevel(h.Features.UNITS_OF_LEARNING,h.Levels.UNITS_OF_LEARNING_LEVEL_DEV)||h.hasFeature(h.Features.PLANNING_SEARCH)),this.dirtyObserver=t.createDirtyObserver([this.selectedDomains,this.selectedGoals,this.selectedOptions,this.description,this.materials,this.instructions,this.goals,this.fileName,this.tags])},open:function(e,n){var i=this;this.taggedChildren=t.pureComputed(function(){return r.filter(c.getInstance().activeChildrenForSelectedGroup(),function(e){return r(r(i.tags()).pluck(function(e){return e.key}).compact().value()).indexOf(e.key)>-1})}),u.open.call(this,e,n)},getWidth:function(){return this.isLesson()?"940":"685"},selectDomain:function(e){var t=this.selectedDomains.remove(e.id).length===0;t&&this.selectedDomains.push(e.id)},domainSelected:function(e){return r.contains(this.selectedDomains(),e)},selectGoal:function(e){var t=e.id;if(t==="none")return;this.selectedGoals.remove(t).length===0&&this.selectedGoals.push(t)},goalSelected:function(e){return r.contains(this.selectedGoals(),e)},selectOption:function(e){e=e.toLowerCase(),this.selectedOptions.remove(e).length===0&&this.selectedOptions.push(e)},optionSelected:function(e){return e=e.toLowerCase(),r.contains(this.selectedOptions(),e)},domainUsed:function(e){if(this.mode()===m.Curriculum)return!1;var t=this.report();return t?r.contains(t.domainsPlanned(),e.name.toLowerCase())||r.contains(t.domainIdsPlanned(),e.id):!1},createEntry:function(e){var t=this,o=r(this.selectedDomains()).map(function(e){return r.find(t.domains(),function(t){return t.id===e})}).compact().value();e.activities=r(o).map(function(e){return e.name.toLowerCase()}).value(),e.note=this.description()?n.trim(this.description()):null,e.c_domains=r.pluck(o,"id");var u=r(this.selectedGoals()).reject(function(e){return e.toLowerCase()==="none"}).value();return e.c_goals=r.map(u,function(e){return{id:e,rating:null}}),e.c_goal_labels=r.map(u,function(e){var n=r.find(t.curriculumGoals(),function(t){return t.id===e});return n?n.name:null}),this.isLesson()&&(e.goals=this.goals(),e.materials=this.materials(),e.instructions=this.instructions(),e.options=r.clone(this.selectedOptions())),e.members=r(this.tags()).map(function(e){return e.key}).value(),e.name=this.name(),t.hasAttachedFile()&&(e.dataAttachmentId=i.short()),s.create(e)},onClear:function(){this.curriculum(null),this.selectedDomains([]),this.selectedOptions([]),this.description(null),this.selectedGoals([]),this.goals(null),this.materials(null),this.instructions(null),this.mode(m.None),this.name(null),this.files([]),this.tags([]),this.tagSearchText(null)},isLesson:function(){return u.isLesson.call(this)},setModeFromReportAndEntry:function(e,t){this.isLesson()?this.mode(m.LessonPlan):t&&t.fromLesson?e.subject_type!=="individual"?this.mode(m.GroupLessonActivity):this.mode(m.LessonActivity):this.mode(m.AdHocActivity)},determineGroup:function(){var e=null;if(this.report().subject_type==="individual"){var t=c.getInstance().getChild(this.report().subject_key);e=f.getInstance().getGroup(t.homeroom_key())}else a.groupSelected()&&(e=a.group());return e},populate:function(){var e=this,t=this.originalValue();if(!e.curriculum()){var n=this.determineGroup();n?l.getInstance().getCurriculumForGroupDeferred(n).done(function(n){e.curriculum(n),n&&t&&t.activities&&t.activities.length>0&&(!t.c_domains||t.c_domains.length===0)&&e.selectedDomains(r(t.activities).map(function(e){return l.getInstance().getDomainByCurriculumAndName(n.id,e.toLowerCase())}).compact().pluck("id").value())}):e.curriculum({id:"",name:"",domains:[]}),this.setModeFromReportAndEntry(this.report(),t)}else this.mode(m.curriculum);t&&(t.c_domains&&t.c_domains.length>0&&this.selectedDomains(r.clone(t.c_domains)),t.c_goals&&t.c_goals.length>0&&this.selectedGoals(r.pluck(t.c_goals,"id")),this.description(t.note),this.isLesson()&&(this.goals(t.goals),this.materials(t.materials),this.instructions(t.instructions),this.selectedOptions(r.clone(t.options)||[])),this.name(t.name),this.canTagChildren()&&this.tags(r(t.members).map(function(e){return y.create("dependent",e,e)}).value()))},isPopulated:function(){return this.selectedDomains().length>0||r(this.selectedGoals()).reject(function(e){return e.toLowerCase()==="none"}).value().length>0||this.description()&&n.trim(this.description()).length>0||this.materials()&&n.trim(this.materials()).length>0||this.instructions()&&n.trim(this.instructions()).length>0||this.selectedOptions().length>0},canTagChildren:function(){return!h.getFeature(h.Features.DISABLE_TAG_CHILDREN_IN_LESSON_PLANS)&&!this.unit&&this.report()&&this.report().subject_type!=="individual"},getTypeAheadFunc:function(){var e=this;if(!h.hasFeatureLevel(h.Features.UNITS_OF_LEARNING,h.Levels.UNITS_OF_LEARNING_LEVEL_DEV)&&!h.hasFeature(h.Features.PLANNING_SEARCH))return[];var n=p.create({path:"/remote/v1/activity/search",method:"get",error:function(e){console.log("error searching activities: "+JSON.stringify(e))}});return{source:function(i,s){if(!h.hasFeature(h.Features.PLANNING_SEARCH)){s(e.curriculum()?r(e.curriculum().activities()).compact().map(function(e){return o.create(e)}).value():[]);return}var u=e.determineGroup(),a=r(e.selectedDomains()).map(function(t){return r.find(e.domains(),function(e){return e.id===t})}).compact().pluck("name").value();n.makeRequest({data:{query:t.toJSON({text:i,stage:u?u.child_type():null,domains:a})},success:function(e){s(r.map(e.activities,function(e){return o.create(e)}))}})},matcher:function(e){if(!h.hasFeature(h.Features.PLANNING_SEARCH)){var t=e.name||"";return~t.toLowerCase().indexOf(this.query.toLowerCase())}return!0},sorter:function(e){return e},highlighter:function(e){var t='<div style="white-space:pre-wrap;padding:4px;">';t+="<div>";var n=e.getPrimary();n&&(t+='<span style="font-size:14px;font-weight:bold;text-transform:capitalize">'+b(n)+"</span>"),e.description&&(t+="<span>",n&&(t+=" - "),t+=b(e.description),t+="</span>"),t+="</div>";var r=e.options&&e.options.length>0;if(e.materials||r)t+='<div style="margin-left:20px;line-height:1">';e.materials&&(t+="<div>",t+='<span style="font-size:10px;">Materials</span>',t+='<span style="font-size:10px;"> - '+b(e.materials)+"</span>",t+="</div>"),r&&(t+="<div>",t+='<span style="font-size:10px;">Options</span>',t+='<span style="font-size:10px;"> - '+b(e.options.join(", "))+"</span>",t+="</div>");if(e.materials||r)t+="</div>";return t+="</div>",t},handler:function(t){t&&(e.name(t.name),e.selectedGoals(r.clone(t.goals)||[]),e.selectedDomains(r.clone(t.domains)||[]),e.description(t.description),e.isLesson()&&(e.goals(t.notes),e.materials(t.materials),e.instructions(t.instructions),e.selectedOptions(r.clone(t.options)||[])))}}},tagTypeAheadFunc:function(){var e=this;return{source:function(n,i){var s=r(c.getInstance().activeChildrenForSelectedGroup()).filter(function(t){return r(e.tags()).pluck(function(e){return e.key}).compact().value().indexOf(t.key)==-1}).pluck(function(e){return t.toJSON({type:"dependant",key:e.key,display:e.fullName(),imageUrl:e.smallImageUrl()})}).compact().value();i(s)},matcher:function(e){var t=n.parseJSON(e);return~t.display.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(e){var t=[],r=[],i=[],s;while(s=e.shift()){var o=n.parseJSON(s);o.display.toLowerCase().indexOf(this.query.toLowerCase())?~o.display.indexOf(this.query)?r.push(s):i.push(s):t.push(s)}return t.concat(r,i)},highlighter:function(e){var t=n.parseJSON(e),r=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),i=t.display.replace(new RegExp("("+r+")","ig"),function(e,t){return"<strong>"+t+"</strong>"}),s='<div class="typeahead">';return s+='<div style="display:inline-block;width:60px;height:60px"><img src='+t.imageUrl+' style="width:60px"/></div>',s+='<div style="display:inline-block;margin-left:20px;margin-top:20px"><span>'+i+"</span></div>",s+="</div>",s},handler:function(t){var r=n.parseJSON(t);e.tagSearchText(""),n("#inputTag").val(""),e.addTag(r.type,r.key,r.display)}}},addTag:function(e,t,n){this.tags.push(y.create(e,t,n))},removeTag:function(e){this.tags.remove(function(t){return t.key===e})}});return w.MODES=m,w}),tadpoles.define("model/daily_report/noteEditModal",["require","ko","lodash","jquery","model/noteEntry","model/daily_report/entryEditModal","utilities","services/uuid","model/daily_report/aggregatedParentNoteEntry","services/dirtyObserver"],function(e){var t=e("ko"),n=e("lodash"),r=e("jquery"),i=e("model/noteEntry"),s=e("model/daily_report/entryEditModal"),o=e("utilities"),u=e("services/uuid"),a=e("model/daily_report/aggregatedParentNoteEntry");e("services/dirtyObserver");var f=[{name:"Yes",value:"Yes"},{name:"No",value:"No"}],l={todaysContact:{id:"contact",text:"today's contact:"},pickupTime:{id:"pick_up",text:"today's pick up time:"},wasMedicated:{id:"meds_given",text:"was your child given medication?"},needsMedication:{id:"meds_received",text:"will they be receiving medication?"}},c=s.extend({className:"NoteEditModal",initialize:function(e){var n=this;s.initialize.call(this,{template:"view/modals/daily_report/noteEdit",typeName:"note"}),this.child=o.childSelection,this.pleaseBrings=t.observableArray([]),this.selectedPleaseBrings=t.observableArray([]),this.todaysContact=t.observable(""),this.originalTodaysContact=null,this.feeling=t.observable(),this.feelings=t.observable(),this.pickupTime=t.observable(),this.originalPickupTime=null,this.wasMedicatedLastValue=null,this.needsMedicationLastValue=null,this.wasMedicated=t.observable(),this.wasMedicated.extend({notify:"always"}),this.wasMedicated.subscribe(function(e){e&&e===n.wasMedicatedLastValue&&(e=null,n.wasMedicated(e)),n.wasMedicatedLastValue=e}),this.originalWasMedicated=null,this.needsMedication=t.observable(),this.needsMedication.extend({notify:"always"}),this.needsMedication.subscribe(function(e){e&&e===n.needsMedicationLastValue&&(e=null,n.needsMedication(e)),n.needsMedicationLastValue=e}),this.originalNeedsMedication=null,this.originalNote=null,this.note=t.observable(),this.originalMedsNote=null,this.meds_note=t.observable(),this.dirtyObserver=t.createDirtyObserver([this.selectedPleaseBrings,this.feeling,this.note,this.meds_note,this.todaysContact,this.pickupTime,this.wasMedicated,this.needsMedication])},setNow:function(){var e=new Date;e.setSeconds(0),e.setMilliseconds(0),this.pickupTime(Math.floor(e.getTime()/1e3))},selectPleaseBring:function(e){this.selectedPleaseBrings.remove(e).length===0&&this.selectedPleaseBrings.push(e)},pleaseBringSelected:function(e){return n.contains(this.selectedPleaseBrings(),e)},newEntry:function(e){return i.create(n.extend({id:u.short(),owner:this.report().getSelfOwner(),capture_time:Math.floor((new Date).getTime()/1e3),client_update_timestamp:(new Date).getTime(),stage:this.report().stage,parent:!0},e))},updateEntry:function(e,t,r,i){var s=null;return e?t?s=n.extend(t,{note:i.text+" "+e,answer:e,client_update_timestamp:(new Date).getTime()}):s=this.newEntry({answer_type:r,note:i.text+" "+e,note_type:"question",question:i.text,question_id:i.id,answer:e}):t&&(t.deleted=!0,t.client_update_timestamp=(new Date).getTime(),s=t),s},createEntry:function(e){e.please_bring=this.selectedPleaseBrings(),e.feeling=this.feeling(),e.note=this.note();if(o.isParent()){var t=[],n=this.updateEntry(this.todaysContact(),this.originalTodaysContact,"FreeForm",l.todaysContact);n&&t.push(n);var r=this.pickupTime();if(r){var s=new Date(r*1e3);r=s.format("shortTime")}return n=this.updateEntry(r,this.originalPickupTime,"Time",l.pickupTime),n&&t.push(n),n=this.updateEntry(this.wasMedicated(),this.originalWasMedicated,"YesNo",l.wasMedicated),n&&t.push(n),n=this.updateEntry(this.needsMedication(),this.originalNeedsMedication,"YesNo",l.needsMedication),n&&t.push(n),this.note()?this.originalNote?(this.originalNote.note=this.note(),this.originalNote.client_update_timestamp=(new Date).getTime(),t.push(this.originalNote)):t.push(this.newEntry({note:this.note()})):this.originalNote&&(this.originalNote.deleted=!0,t.push(this.originalNote)),this.meds_note()?this.originalMedsNote?(this.originalMedsNote.note=this.meds_note(),this.originalMedsNote.client_update_timestamp=(new Date).getTime(),t.push(this.originalMedsNote)):t.push(this.newEntry({note:this.meds_note(),note_type:"meds_note"})):this.originalMedsNote&&(this.originalMedsNote.deleted=!0,t.push(this.originalMedsNote)),a.create(t)}return i.create(e)},onClear:function(){this.selectedPleaseBrings([]),this.feeling(null),this.note(null),this.meds_note(null),this.needsMedication(null),this.wasMedicated(null),this.todaysContact(""),this.pickupTime(null)},populate:function(){var e=this,t=this.originalValue();t&&(o.isParent()?(this.child=o.childSelection,n.each(t.entries,function(t){t.note_type?t.note_type=="meds_note"&&(e.meds_note(t.note),e.originalMedsNote=t):(e.note(t.note),e.originalNote=t);if(t.question===l.todaysContact.text)e.originalTodaysContact=t,n.each(e.child.guardians(),function(n){t.answer===e.createGuardianContactValue(n)&&(n.isSelected(!0),e.todaysContact(t.answer))});else if(t.question===l.pickupTime.text){e.originalPickupTime=t;var r=new Date;r.withTime(t.answer),e.pickupTime(r.getTime()/1e3)}else t.question===l.wasMedicated.text?(e.originalWasMedicated=t,e.wasMedicated(t.answer)):t.question===l.needsMedication.text&&(e.originalNeedsMedication=t,e.needsMedication(t.answer))})):(this.selectedPleaseBrings(t.please_bring),this.feeling(t.feeling),this.note(t.note)))},isPopulated:function(){return this.note()&&r.trim(this.note()).length>0||this.meds_note()&&r.trim(this.meds_note()).length>0||this.todaysContact()||this.wasMedicated()||this.needsMedication()||this.pickupTime()},open:function(e,t){var n=this;s.open.call(this,e,t)},selectGuardian:function(e){var t=this;e.toggleSelection(),e.isSelected()?(t.todaysContact(t.createGuardianContactValue(e)),n.each(t.child.guardians(),function(t){t.key!==e.key&&t.isSelected(!1)})):(t.todaysContact(""),e.isActionsEnabled(!1))},createGuardianContactValue:function(e){var t=e.mobile_number()||e.work_number()||e.home_number();return e.displayName()+(t?", "+t:"")}});return c.YesNo=f,o.makeSingleton(c)}),tadpoles.define("model/daily_report/napEditModal",["require","ko","lodash","model/napEntry","model/daily_report/entryEditModal","utilities","services/uuid","services/dirtyObserver"],function(e){var t=e("ko"),n=e("lodash"),r=e("model/napEntry"),i=e("model/daily_report/entryEditModal"),s=e("utilities"),o=e("services/uuid");e("services/dirtyObserver");var u=i.extend({className:"NapEditModal",initialize:function(e){var n=this;i.initialize.call(this,{template:"view/modals/daily_report/napEdit",typeName:s.isParent()?"nap/sleep":"nap"}),this.startTime=t.observable(),this.endTime=t.observable(),this.note=t.observable(),this.sleep_type=t.observable(),this.dirtyObserver=t.createDirtyObserver([this.startTime,this.endTime,this.note,this.sleep_type]),this.canSaveAndAddNew(!1),this.sleep_type.subscribe(function(e){e==="overnight"&&n.startTime(null)})},setSleepType:function(e){this.sleep_type(e)},createEntry:function(e){return e.note=this.note(),e.sleep_type=this.sleep_type(),this.sleep_type()==="overnight"?e.end_time=this.endTime():(e.start_time=this.startTime(),e.end_time=this.endTime()),e.id=this.originalValue()?this.originalValue().id():o.short(),e.parent=s.isParent(),r.create(e)},onClear:function(){this.startTime(null),this.endTime(null),this.note(null),this.sleep_type(null)},populate:function(){var e=this.originalValue();e?(this.sleep_type(e.sleep_type||"nap"),this.startTime(e.start_time),this.endTime(e.end_time),this.note(e.note)):s.isParent()?this.sleep_type("overnight"):this.sleep_type("nap")},setStartToNow:function(){var e=new Date;e.setSeconds(0),e.setMilliseconds(0),this.startTime(Math.floor(e.getTime()/1e3))},setEndToNow:function(){var e=new Date;e.setSeconds(0),e.setMilliseconds(0),this.endTime(Math.floor(e.getTime()/1e3))},isPopulated:function(){return this.sleep_type()&&(this.startTime()||this.endTime())}});return s.makeSingleton(u)}),function(e){typeof tadpoles.define=="function"&&tadpoles.define.amd?tadpoles.define("timePicker",["jquery","lodash"],e):e(jQuery)}(function(e,t){function u(e){e.minTime&&(e.minTime=x(e.minTime)),e.maxTime&&(e.maxTime=x(e.maxTime)),e.durationTime&&typeof e.durationTime!="function"&&(e.durationTime=x(e.durationTime));if(e.disableTimeRanges.length>0){for(var t in e.disableTimeRanges)e.disableTimeRanges[t]=[x(e.disableTimeRanges[t][0]),x(e.disableTimeRanges[t][1])];e.disableTimeRanges=e.disableTimeRanges.sort(function(e,t){return e[0]-t[0]})}return e.date&&(e.date=new Date(e.date),e.date.setHours(0,0,0,0)),e}function a(t){var n=t.data("timepicker-settings"),i=t.data("timepicker-list");i&&i.length&&(i.remove(),t.data("timepicker-list",!1)),i=e("<ul />",{"class":"ui-timepicker-list"});var s=e("<div />",{"class":"ui-timepicker-wrapper",tabindex:-1});s.css({display:"none",position:"absolute"}).append(i),n.className&&s.addClass(n.className),(n.minTime!==null||n.durationTime!==null)&&n.showDuration&&s.addClass("ui-timepicker-with-duration");var u=n.minTime;typeof n.durationTime=="function"?u=x(n.durationTime()):n.durationTime!==null&&(u=n.durationTime);var a=n.minTime!==null?n.minTime:0,f=n.maxTime!==null?n.maxTime:a+r-1;f<=a&&(f+=r);var l=n.disableTimeRanges,c=0,h=l.length;for(var d=a;d<=f;d+=n.step*60){var v=d%r,m=e("<li />");m.data("time",v),m.text(S(v,n.timeFormat));if((n.minTime!==null||n.durationTime!==null)&&n.showDuration){var g=e("<span />");g.addClass("ui-timepicker-duration"),g.text(" ("+E(d-u)+")"),m.append(g)}c<h&&(v>=l[c][0]&&v<l[c][1]?m.addClass("ui-timepicker-disabled"):v>=l[c][1]&&(c+=1)),i.append(m)}s.data("timepicker-input",t),t.data("timepicker-list",s);var y=n.appendTo;typeof y=="string"?y=e(y):typeof y=="function"&&(y=y(t)),y.append(s),p(t,i),i.on("click","li",function(n){t.off("focus.timepicker"),t.on("focus.timepicker-ie-hack",function(){t.off("focus.timepicker-ie-hack"),t.on("focus.timepicker",o.show)}),t[0].focus(),i.find("li").removeClass("ui-timepicker-selected"),e(this).addClass("ui-timepicker-selected"),w(t)&&s.hide()})}function f(){return new Date(1970,1,1,0,0,0)}function l(t){"ontouchstart"in document?e("body").on("touchstart.ui-timepicker",c):(e("body").on("mousedown.ui-timepicker",c),t.closeOnWindowScroll&&e(window).on("scroll.ui-timepicker",c))}function c(t){var n=e(t.target),r=n.closest(".ui-timepicker-input");r.length===0&&n.closest(".ui-timepicker-wrapper").length===0&&(o.hide(),e("body").unbind(".ui-timepicker"),e(window).unbind(".ui-timepicker"))}function h(t,n,r){if(!r&&r!==0)return!1;var i=t.data("timepicker-settings"),s=!1,o=i.step*30;return n.find("li").each(function(t,n){var i=e(n),u=i.data("time")-r;if(Math.abs(u)<o||u==o)return s=i,!1}),s}function p(e,t){t.find("li").removeClass("ui-timepicker-selected");var n=x(v(e));if(!n)return;var r=h(e,t,n);if(r){var i=r.offset().top-t.offset().top;(i+r.outerHeight()>t.outerHeight()||i<0)&&t.scrollTop(t.scrollTop()+r.position().top-r.outerHeight()),r.addClass("ui-timepicker-selected")}}function d(){var t=e(this);if(this.value===""){m(t,null),t.trigger("change").trigger("changeTime");return}var n=x(this.value);if(n===null){m(t,null),t.trigger("timeFormatError");return}var r=t.data("timepicker-settings");r.minTime!==null&&n<r.minTime?t.trigger("timeRangeError"):r.maxTime!==null&&n>r.maxTime&&t.trigger("timeRangeError"),e.each(r.disableTimeRanges,function(){if(n>=this[0]&&n<this[1])return t.trigger("timeRangeError"),!1});if(r.forceRoundTime){var i=n%(r.step*60);i>=r.step*30?n+=r.step*60-i:n-=i}var s=S(n,r.timeFormat);m(t,s),t.trigger("change").trigger("changeTime")}function v(e){return e.is("input")?e.val():e.data("ui-timepicker-value")}function m(e,t){e.is("input")?e.val(t):e.data("ui-timepicker-value",t)}function g(t){var n=e(this),r=n.data("timepicker-list");if(!r||!r.is(":visible")){if(t.keyCode!=40)return y(t,n);n.focus()}switch(t.keyCode){case 13:return w(n)&&o.hide.apply(this),t.preventDefault(),!1;case 38:var i=r.find(".ui-timepicker-selected");return i.length?i.is(":first-child")||(i.removeClass("ui-timepicker-selected"),i.prev().addClass("ui-timepicker-selected"),i.prev().position().top<i.outerHeight()&&r.scrollTop(r.scrollTop()-i.outerHeight())):(r.find("li").each(function(t,n){if(e(n).position().top>0)return i=e(n),!1}),i.addClass("ui-timepicker-selected")),!1;case 40:return i=r.find(".ui-timepicker-selected"),i.length===0?(r.find("li").each(function(t,n){if(e(n).position().top>0)return i=e(n),!1}),i.addClass("ui-timepicker-selected")):i.is(":last-child")||(i.removeClass("ui-timepicker-selected"),i.next().addClass("ui-timepicker-selected"),i.next().position().top+2*i.outerHeight()>r.outerHeight()&&r.scrollTop(r.scrollTop()+i.outerHeight())),!1;case 27:r.find("li").removeClass("ui-timepicker-selected"),r.hide();break;case 9:o.hide();break;default:return y(t,n)}}function y(e,t){return!t.data("timepicker-settings").disableTextInput||e.ctrlKey||e.altKey||e.metaKey||e.keyCode!=2&&(e.keyCode<46||e.keyCode>90)}function b(t){var n=e(this),r=n.data("timepicker-list");if(!r||!r.is(":visible"))return!0;switch(t.keyCode){case 96:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 65:case 77:case 80:case 186:case 8:case 46:p(n,r);break;default:return}}function w(e){var t=e.data("timepicker-settings"),n=e.data("timepicker-list"),r=null,i=n.find(".ui-timepicker-selected");if(i.hasClass("ui-timepicker-disabled"))return!1;i.length?r=i.data("time"):v(e)&&(r=x(v(e)),p(e,n));if(r!==null){var s=S(r,t.timeFormat);m(e,s)}return e.trigger("change").trigger("changeTime"),!0}function E(e){var t=Math.round(e/60),n;if(Math.abs(t)<60)n=[t,s.mins];else if(t==60)n=["1",s.hr];else{var r=(t/60).toFixed(1);s.decimal!="."&&(r=r.replace(".",s.decimal)),n=[r,s.hrs]}return n.join(" ")}function S(e,t){if(e===null)return;var r=new Date(n.valueOf()+e*1e3),i="",s,o;for(var u=0;u<t.length;u++){o=t.charAt(u);switch(o){case"a":i+=r.getHours()>11?"pm":"am";break;case"A":i+=r.getHours()>11?"PM":"AM";break;case"g":s=r.getHours()%12,i+=s===0?"12":s;break;case"G":i+=r.getHours();break;case"h":s=r.getHours()%12,s!==0&&s<10&&(s="0"+s),i+=s===0?"12":s;break;case"H":s=r.getHours(),i+=s>9?s:"0"+s;break;case"i":var a=r.getMinutes();i+=a>9?a:"0"+a;break;case"s":e=r.getSeconds(),i+=e>9?e:"0"+e;break;default:i+=o}}return i}function x(e){if(e==="")return null;if(!e||e+0==e)return e;typeof e=="object"&&(e=e.getHours()+":"+T(e.getMinutes())+":"+T(e.getSeconds())),e=e.toLowerCase();var t=new Date(0),n;e.indexOf(":")===-1?(n=e.match(/^([0-9]):?([0-5][0-9])?:?([0-5][0-9])?\s*([pa]?)m?$/),n||(n=e.match(/^([0-2][0-9]):?([0-5][0-9])?:?([0-5][0-9])?\s*([pa]?)m?$/))):n=e.match(/^(\d{1,2})(?::([0-5][0-9]))?(?::([0-5][0-9]))?\s*([pa]?)m?$/);if(!n)return null;var r=parseInt(n[1]*1,10),i;n[4]?r==12?i=n[4]=="p"?12:0:i=r+(n[4]=="p"?12:0):i=r;var s=n[2]*1||0,o=n[3]*1||0;return i*3600+s*60+o}function T(e){return("0"+e).slice(-2)}var n=f(),r=86400,i={className:null,minTime:null,maxTime:null,durationTime:null,step:30,showDuration:!1,timeFormat:"g:ia",scrollDefaultNow:!1,scrollDefaultTime:!1,selectOnBlur:!1,disableTouchKeyboard:!0,forceRoundTime:!1,appendTo:"body",disableTimeRanges:[],closeOnWindowScroll:!1,disableTextInput:!1,date:null},s={decimal:".",mins:"mins",hr:"hr",hrs:"hrs"},o={init:function(t){return this.each(function(){var n=e(this);if(n[0].tagName=="SELECT"){var r={type:"text",value:n.val()},a=n[0].attributes;for(var f=0;f<a.length;f++)r[a[f].nodeName]=a[f].nodeValue;var l=e("<input />",r);n.replaceWith(l),n=l}var c=e.extend({},i);t&&(c=e.extend(c,t)),c.lang&&(s=e.extend(s,c.lang)),c=u(c),n.data("timepicker-settings",c),n.prop("autocomplete","off"),n.on("click.timepicker focus.timepicker",o.show),n.on("blur.timepicker",d),n.on("keydown.timepicker",g),n.on("keyup.timepicker",b),n.addClass("ui-timepicker-input"),d.call(n.get(0))})},show:function(t){var n=e(this),r=n.data("timepicker-settings");"ontouchstart"in document&&r.disableTouchKeyboard&&n.blur();var i=n.data("timepicker-list");if(n.prop("readonly"))return;if(!i||i.length===0||typeof r.durationTime=="function")a(n),i=n.data("timepicker-list");if(i.is(":visible"))return;o.hide(),i.show(),n.offset().top+n.outerHeight(!0)+i.outerHeight()>e(window).height()+e(window).scrollTop()?i.offset({left:n.offset().left+parseInt(i.css("marginLeft").replace("px",""),10),top:n.offset().top-i.outerHeight()+parseInt(i.css("marginTop").replace("px",""),10)}):i.offset({left:n.offset().left+parseInt(i.css("marginLeft").replace("px",""),10),top:n.offset().top+n.outerHeight()+parseInt(i.css("marginTop").replace("px",""),10)});var s=i.find(".ui-timepicker-selected");s.length||(v(n)?s=h(n,i,x(v(n))):r.scrollDefaultNow?s=h(n,i,x(new Date)):r.scrollDefaultTime!==!1&&(s=h(n,i,x(r.scrollDefaultTime))));if(s&&s.length){var u=i.scrollTop()+s.position().top-s.outerHeight();i.scrollTop(u)}else i.scrollTop(0);l(r),n.trigger("showTimepicker")},hide:function(t){e(".ui-timepicker-wrapper:visible").each(function(){var t=e(this),n=t.data("timepicker-input"),r=n.data("timepicker-settings");r&&r.selectOnBlur&&w(n),t.hide(),n.trigger("hideTimepicker")})},option:function(t,n){var r=this,i=r.data("timepicker-settings"),s=r.data("timepicker-list");if(typeof t=="object")i=e.extend(i,t);else if(typeof t=="string"&&typeof n!="undefined")i[t]=n;else if(typeof t=="string")return i[t];return i=u(i),r.data("timepicker-settings",i),s&&(s.remove(),r.data("timepicker-list",!1)),r},getSecondsFromMidnight:function(){return x(v(this))},getTime:function(){var e=this,n=e.data("timepicker-settings"),r=n.date||new Date;r.setHours(0,0,0,0);var i=v(e);return t.isNull(i)||i===""?null:new Date(r.valueOf()+x(i)*1e3)},setTime:function(e){var t=this,n=t.data("timepicker-settings");e&&!n.date&&(n.date=new Date(e),n.date.setHours(0,0,0,0));var r=S(x(e),t.data("timepicker-settings").timeFormat);m(t,r)},remove:function(){var e=this;if(!e.hasClass("ui-timepicker-input"))return;e.removeAttr("autocomplete","off"),e.removeClass("ui-timepicker-input"),e.removeData("timepicker-settings"),e.off(".timepicker"),e.data("timepicker-list")&&e.data("timepicker-list").remove(),e.removeData("timepicker-list")}};e.fn.timepicker=function(t){if(o[t])return o[t].apply(this,Array.prototype.slice.call(arguments,1));if(typeof t=="object"||!t)return o.init.apply(this,arguments);e.error("Method "+t+" does not exist on jQuery.timepicker")}}),tadpoles.define("services/timePicker",["require","timePicker","jquery","ko"],function(e){e("timePicker");var t=e("jquery"),n=e("ko");return n.bindingHandlers.timePicker={init:function(e,r){var i=n.utils.unwrapObservable(r())||{};t(e).timepicker(i),n.utils.domNodeDisposal.addDisposeCallback(e,function(){t(e).timepicker("remove")}),i.observable&&(t(e).on("changeTime",function(){var n=t(e).timepicker("getTime");i.observable(n?Math.floor(n.getTime()/1e3):null)}),t(e).on("timeFormatError",function(){var n=i.observable(),r=n?new Date(n*1e3):null;t(e).timepicker("setTime",r)}))},update:function(e,r){var i=n.utils.unwrapObservable(r()),s=t(e).timepicker("getTime"),o=s?t(e).timepicker("getTime").getTime():null;if(i.observable){var u=i.observable();if(u!==o){var a=u?new Date(u*1e3):null;t(e).timepicker("setTime",a)}}}},{}}),tadpoles.define("model/daily_report/mealEditModal",["require","ko","lodash","model/mealEntry","model/daily_report/aggregatedMealEntry","model/daily_report/entryEditModal","selfish","services/uuid","services/timePicker","emit","utilities","services/dirtyObserver"],function(e){var t=e("ko"),n=e("lodash"),r=e("model/mealEntry"),i=e("model/daily_report/aggregatedMealEntry"),s=e("model/daily_report/entryEditModal"),o=e("selfish"),u=e("services/uuid"),a=e("services/timePicker"),f=e("emit"),l=e("utilities");e("services/dirtyObserver");var c={BOTTLE:"bottle",BREASTFEEDING:"breastfeeding",FOOD:"food"},h=["Breakfast","AM Snack","Lunch","PM Snack","Late Snack","Dinner"],p=["all","most","some","none"],d=[{name:"0",value:0},{name:"",value:.5},{name:"1",value:1},{name:"1",value:1.5},{name:"2",value:2},{name:"2",value:2.5},{name:"3",value:3},{name:"3",value:3.5},{name:"4",value:4},{name:"4",value:4.5},{name:"5",value:5},{name:"5",value:5.5},{name:"6",value:6},{name:"6",value:6.5},{name:"7",value:7},{name:"7",value:7.5},{name:"8",value:8},{name:"8",value:8.5},{name:"9",value:9},{name:"9",value:9.5},{name:"10",value:10}],v=["formula","breastmilk","milk","other"],m=o.Base.extend({className:"FoodRow",initialize:function(e){e=e||{},this.entry=e,this.id=t.observable(e.id?e.id():u.short()),this.food=t.observable(e.foods),this.amount=t.observable(e.amount),this.dirtyObserver=t.createDirtyObserver([this.id,this.food,this.amount]),this.meal_type=t.observable(e.meal_type),this.dirtyObserver.dirty.subscribe(function(e){e&&f.emit("food-row-dirty")})},isEmpty:function(){return!this.food()&&!this.amount()},isUnchanged:function(){return this.entry&&this.food()===this.entry.foods&&this.amount()===this.entry.amount},hasExisting:function(){return this.entry&&this.entry.id&&this.entry.id()}}),g=s.extend({className:"MealEditModal",initialize:function(){var e=this;s.initialize.call(this,{template:"view/modals/daily_report/mealEdit",typeName:"meal"}),this.mealType=t.observable(c.BOTTLE),this.mealName=t.observable(),this.mealTime=t.observable(),this.bottleAmount=t.observable(),this.bottleAmountOffered=t.observable(),this.bottleContents=t.observable(),this.foods=t.observableArray([]),this.note=t.observable(),this.bottleEntry=t.observable(),this.breastfeedingEntry=t.observable(),this.deletedEntries=t.observableArray([]),this.reminder_period=0,this.actor=null,this.maxOrd=0,this.mealType.subscribe(function(t){if(t===c.BOTTLE){e.clearFoods();var n=e.breastfeedingEntry();n&&(e.deletedEntries.push(n),e.breastfeedingEntry(null))}else if(t===c.BREASTFEEDING){e.clearFoods(),e.bottleAmount(null),e.bottleAmountOffered(null),e.bottleContents(null);var r=e.bottleEntry();r&&(e.deletedEntries.push(r),e.bottleEntry(null))}else{e.bottleAmount(null),e.bottleAmountOffered(null),e.bottleContents(null);var r=e.bottleEntry();r&&(e.deletedEntries.push(r),e.bottleEntry(null));var n=e.breastfeedingEntry();n&&(e.deletedEntries.push(n),e.breastfeedingEntry(null))}}),this.isInfant=t.pureComputed(function(){var t=null;return e.originalValue()&&(t=e.originalValue().stage),!t&&e.report()&&(t=e.report().stage),t==="infant"}),this.dirtyObserver=t.createDirtyObserver([this.note,this.mealType,this.mealTime,this.mealName,this.bottleAmount,this.bottleAmountOffered,this.bottleContents,this.foods,this.bottleEntry,this.breastfeedingEntry,this.deletedEntries]),f.on("food-row-dirty",function(){e.dirtyObserver.dirty(!0)})},setNow:function(){var e=new Date;e.setSeconds(0),e.setMilliseconds(0),this.mealTime(Math.floor(e.getTime()/1e3))},addFoodRow:function(){this.foods.push(m.create())},deleteFoodRow:function(e){this.foods.remove(function(t){return t.id()===e.id()}),e.entry&&this.deletedEntries.push(e.entry),this.foods().length===0&&this.foods([m.create()])},clearFoods:function(){var e=this;n.each(this.foods(),function(t){t.hasExisting()&&e.deletedEntries.push(t.entry)}),this.foods([m.create()])},createEntry:function(e){e.action_time=this.mealTime(),e.meal_type=this.mealType(),e.meal_name=this.mealName()||null,e.note=this.note()||null,e.actor=this.actor,e.reminder_period=this.reminder_period,e.parent=l.isParent();var t=this.maxOrd+1,s=[];if(this.mealType()===c.FOOD||this.mealType()==="fooddrop")s=n(this.foods()).sortBy(function(e){return e.isEmpty()?e.entry?"2":"3":"1"}).reject(function(e){return!e.entry&&e.isEmpty()}).map(function(i,s){var o=n.clone(e);return o.id=i.id(),o.amount=i.amount()||null,o.foods=i.food()||null,i.isUnchanged()&&(o.owner=i.entry.owner),i.hasExisting()?o.ord=i.entry.ord:(o.ord=t,t+=1),s>0&&(o.note=null),i.isEmpty()&&(o.deleted=!0),r.create(o)}).value(),s.length>0&&s[0].deleted&&!e.deleted&&(s[0].deleted=!1),s.length===0&&(this.mealName()||this.mealTime()||this.note())&&s.push(r.create(e));else if(this.mealType()===c.BOTTLE){var o=n.clone(e);o.amount=this.bottleAmount(),o.amount_offered=this.bottleAmountOffered(),o.contents=this.bottleContents(),this.bottleEntry()&&(o.id=this.bottleEntry().id()),s.push(r.create(o))}else if(this.mealType()===c.BREASTFEEDING){var o=n.clone(e);this.breastfeedingEntry()&&(o.id=this.breastfeedingEntry().id()),s.push(r.create(o))}return n.each(this.deletedEntries(),function(t){var i=n.clone(e);i.id=t.id(),i.deleted=!0,s.push(r.create(i))}),i.create(s)},onClear:function(){this.note(null),this.mealType(c.BOTTLE),this.mealTime(null),this.mealName(null),this.bottleAmount(null),this.bottleAmountOffered(null),this.bottleContents(null),this.foods([m.create()]),this.bottleEntry(null),this.breastfeedingEntry(null),this.deletedEntries([]),this.reminder_period=0,this.actor=null,this.maxOrd=0},populate:function(){var e=this.originalValue();this.mealType(this.isInfant()?c.BOTTLE:c.FOOD),e?(this.mealType(e.meal_type),e.id?(this.mealName(e.meal_name),this.mealTime(e.action_time),this.reminder_period=e.reminder_period,this.actor=e.actor,this.mealType()===c.FOOD||this.mealType()==="fooddrop"?this.foods(n.map(e.entries,function(e){return m.create(e)})):this.mealType()===c.BOTTLE?(this.bottleEntry(e.entries[0]),this.bottleAmount(this.bottleEntry().amount),this.bottleAmountOffered(this.bottleEntry().amountOffered),this.bottleContents(this.bottleEntry().contents)):this.mealType()===c.BREASTFEEDING&&this.breastfeedingEntry(e.entries[0]),this.note(e.note),this.maxOrd=n.reduce(e.entries,function(e,t){return Math.max(e,t.ord)},0)):this.originalValue(null)):this.foods([m.create()])},isPopulated:function(){return!0}});return g.MealTypes=c,g.MealNames=h,g.MealAmounts=p,g.BottleAmounts=d,g.BottleContents=v,l.makeSingleton(g)}),tadpoles.define("model/daily_report/bathroomEditModal",["require","ko","lodash","model/bathroomEntry","model/daily_report/entryEditModal","utilities","services/uuid","services/dirtyObserver"],function(e){var t=e("ko"),n=e("lodash"),r=e("model/bathroomEntry"),i=e("model/daily_report/entryEditModal"),s=e("utilities"),o=e("services/uuid");e("services/dirtyObserver");var u=["wet","dry","bm","diaper cream"],a=["pee","bm","tried","accident"],f=i.extend({className:"NapEditModal",initialize:function(e){var n=this;i.initialize.call(this,{template:"view/modals/daily_report/bathroomEdit",typeName:"bathroom"}),this.bathroom_type=t.observable(),this.actionTime=t.observable(),this.note=t.observable(),this.details=t.observableArray([]),this.dirtyObserver=t.createDirtyObserver([this.actionTime,this.note,this.details]),this.canSaveAndAddNew(!1)},createEntry:function(e){return e.bathroom_type=this.bathroom_type(),e.action_time=this.actionTime(),e.note=this.note(),e.events=this.details(),e.id=this.originalValue()?this.originalValue().id():o.short(),e.parent=s.isParent(),r.create(e)},detailSelected:function(e){return this.details.indexOf(e)>-1},toggleDetail:function(e){this.details.indexOf(e)>-1?this.details.remove(e):this.details.push(e)},onClear:function(){this.bathroom_type(null),this.actionTime(null),this.note(null),this.details([])},populate:function(){var e=this.originalValue();e?(this.bathroom_type(e.bathroom_type),e.id?(this.actionTime(e.action_time),this.note(e.note),this.details(e.events)):this.originalValue(null)):this.bathroom_type("diaper"),this.typeName(this.bathroom_type())},setNow:function(){var e=new Date;e.setSeconds(0),e.setMilliseconds(0),this.actionTime(Math.floor(e.getTime()/1e3))},isPopulated:function(){return this.actionTime()}});return f.DiaperDetails=u,f.PottyDetails=a,s.makeSingleton(f)}),tadpoles.define("model/daily_report/themeEditModal",["require","ko","lodash","jquery","model/daily_report/themeEntry","model/daily_report/entryEditModal","utilities","services/dirtyObserver"],function(e){var t=e("ko"),n=e("lodash"),r=e("jquery"),i=e("model/daily_report/themeEntry"),s=e("model/daily_report/entryEditModal"),o=e("utilities");e("services/dirtyObserver");var u=s.extend({className:"ThemeEditModal",initialize:function(e){var n=this;s.initialize.call(this,{template:"view/modals/daily_report/themeEdit",typeName:"theme"}),this.scope=t.observable(),this.name=t.observable(),this.note=t.observable(),this.dirtyObserver=t.createDirtyObserver([this.scope,this.name,this.note]),this.canSaveAndAddNew(!1)},createEntry:function(e){return e.scope=this.scope(),e.name=this.name(),e.note=this.note(),e.id=this.originalValue()?this.originalValue().id():this.report().subject_key+":"+this.report().date+":week:theme",i.create(e)},onClear:function(){this.scope(null),this.name(null),this.note(null)},populate:function(){var e=this.originalValue();e?(this.scope(e.scope),this.name(e.name),this.note(e.note)):this.scope("week")},isPopulated:function(){return this.name()&&r.trim(this.name()).length>0}});return o.makeSingleton(u)}),tadpoles.define("model/serverDailyReportAuditEntry",["require","lodash","model/auditEntry","model/dailyReportEntry","model/mealEntry","model/bathroomEntry","model/medsEntry","model/activityEntry","model/noteEntry","model/napEntry","model/actionHistory"],function(e){function c(e){return t.filter(t.map(e,function(e){var t=null;if(e.type_name==="food"||e.type==="food")t=i.create(e);else if(e.type_name==="bathroom"||e.type==="bathroom")t=s.create(e);else if(e.type_name==="medication"||e.type==="medication")t=o.create(e);else if(e.type_name==="activity"||e.type==="activity")t=u.create(e);else if(e.type_name==="note"||e.type==="note")t=a.create(e);else if(e.type_name==="nap"||e.type==="nap")t=f.create(e);return t}),function(e){return e})}function h(e){var n="";return t.each(e,function(e,t){n+=t>0?"\n":"",n+=e.link_id?"PHOTO ACTIVITY":e.type_name.toUpperCase(),n+=(e.deleted||e.edited?" (":"")+(e.deleted?"del":"")+(e.deleted?", ":"")+(e.edited?"edited":"")+(e.deleted||e.edited?")":""),n+=": id: "+e.id(),n+=e.link_id?", links to:"+e.link_id:"",n+=", cut: "+(new Date(e.client_update_timestamp)).format("shortTime"),n+=e.action_time?", action_time: "+(new Date(e.action_time)).format("shortTime"):"";var r=e.getPrimary(),i=e.getNote();n+=", content: "+r+(i&&r?" - ":"")+i+" "}),n}function p(e){var n="";return t.each(e.entries(),function(t,r){n+=(r>0?"\n":"")+(new Date(t.action_timestamp)).format("m/d h:MM:ss TT")+" "+e.getEntryPrefix(t)+t.actor+e.getEntryPostfix(t)}),n}var t=e("lodash"),n=e("model/auditEntry"),r=e("model/dailyReportEntry"),i=e("model/mealEntry"),s=e("model/bathroomEntry"),o=e("model/medsEntry"),u=e("model/activityEntry"),a=e("model/noteEntry"),f=e("model/napEntry"),l=e("model/actionHistory"),d=n.extend({className:"ServerDailyReportAuditEntry",initialize:function(e){n.initialize.call(this,e);var r,i,s,o;for(r=0;r<this.added.length;r+=1)i=this.added[r],i.name==="entries"?(i.changed=h(c(i.changed)),i.isObject=!1):i.name==="action_history"&&(i.changed=p(l.create(i.changed)),i.isObject=!1);for(r=0;r<this.changed.length;r+=1){i=this.changed[r];if(i.name==="entries"){var u={};t.each(i.old,function(e){u[e.id]=e}),t.each(i.changed,function(e,n){var r=u[e.id];r&&t.isEqual(r,e)&&(i.changed[n]=null,delete u[e.id])}),i.changed=t.compact(i.changed),i.old=h(c(t.values(u))),i.changed=h(c(i.changed)),i.isObject=!1;break}i.name==="action_history"&&(t.each(i.changed,function(e,n){var r=i.old[n];r&&t.isEqual(r,e)&&(i.old[n]=null,i.changed[n]=null)}),i.old=t.compact(i.old),i.changed=t.compact(i.changed),i.old=p(l.create(i.old)),i.changed=p(l.create(i.changed)),i.isObject=!1)}}});return d}),tadpoles.define("model/custom/bhWitW",["require","lodash","ko","selfish","services/modal","utilities","model/printable","model/globalFilter","services/employees"],function(e){var t=e("lodash"),n=e("ko"),r=e("selfish"),i=e("services/modal"),s=null,o=e("utilities"),u=e("model/printable"),a=e("model/globalFilter"),f=r.Base.extend(u,{className:"WhatInTheWorld",initialize:function(e){var t=this;u.initialize.call(t,"witw-printable"),t.activities=n.observableArray([]),t.snapshots=n.observableArray([]),t.goals=n.observableArray([]),t.date=n.observable(),t.name=n.observable(),t.teachers=n.observableArray([])},show:function(){s.getInstance({template:"view/custom/bh-witw",model:this,width:1024}).open(this)},load:function(e){var t=this;t.activities(e.activities),t.snapshots(e.snapshots),t.goals(e.goals),t.date(e.date),t.name(e.name),t.teachers(e.teachers),t.show()},getStaffNames:function(){var n=this,r=e("services/employees"),i=r.getInstance().filteredEmployees(),s=[];return t.each(t.filter(i,function(e){return t.contains(n.teachers(),e.key)}),function(e){s.push(e.fullName())}),s.join(", ")},getStaffCount:function(){return a.group().staff().length},getSecondarySnapshot:function(e){if(e){var n=t.findLast(this.snapshots(),{removed_link_id:e});if(n)return n}return null}});return s=o.makeSingleton(i),o.makeSingleton(f)}),tadpoles.define("model/serverDailyReport",["require","lodash","jquery","ko","selfish","model/disposable","model/actionTile","model/mealEntry","model/daily_report/mealDistributionEntry","model/daily_report/aggregatedMealEntry","model/daily_report/aggregatedParentNoteEntry","model/bathroomEntry","model/medsEntry","model/activityEntry","model/noteEntry","model/napEntry","model/daily_report/themeEntry","services/children","utilities","model/globalFilter","model/actionHistory","model/printable","model/daily_report/activityEditModal","model/daily_report/noteEditModal","model/daily_report/napEditModal","model/daily_report/mealEditModal","model/daily_report/bathroomEditModal","model/daily_report/themeEditModal","model/user","emit","model/remote","model/audit","model/serverDailyReportAuditEntry","services/alerts","services/curricula","model/custom/bhWitW"],function(e){var t=e("lodash"),n=e("jquery"),r=e("ko"),i=e("selfish"),s=e("model/disposable"),o=e("model/actionTile"),u=e("model/mealEntry"),a=e("model/daily_report/mealDistributionEntry"),f=e("model/daily_report/aggregatedMealEntry"),l=e("model/daily_report/aggregatedParentNoteEntry"),c=e("model/bathroomEntry"),h=e("model/medsEntry"),p=e("model/activityEntry"),d=e("model/noteEntry"),v=e("model/napEntry"),m=e("model/daily_report/themeEntry"),g=e("services/children"),y=e("utilities"),b=e("model/globalFilter"),w=e("model/actionHistory"),E=null,S=e("model/printable"),x=y.makeSingleton(e("model/daily_report/activityEditModal")),T=e("model/daily_report/noteEditModal"),N=e("model/daily_report/napEditModal"),C=e("model/daily_report/mealEditModal"),k=e("model/daily_report/bathroomEditModal"),L=e("model/daily_report/themeEditModal"),A=e("model/user"),O=e("emit"),M=e("model/remote"),_=e("model/audit"),D=e("model/serverDailyReportAuditEntry"),P=e("services/alerts"),H=e("services/curricula"),B=null,j=e("model/custom/bhWitW"),F=i.Base.extend(S,o,M,s,{className:"ServerDailyReport",initialize:function(e,i){var g=this;s.initialize.call(this),S.initialize.call(g,"dr-printable"),o.initialize.call(this),M.initialize.call(this,{path:"/remote/v1/daily_report",method:"post"}),g.type_name="daily_report",g.key=e.key;if(!i)if(e.report_key){g.report_key=e.report_key;var b=e.report_key.split(":");g.subject_key=b[0],g.date=b[1]}else g.subject_key=e.subject_key,g.date=e.date,g.report_key=e.subject_key+":"+e.date;if(g.date){var E=g.date.match(/(\d+)/g);g.realDate=new Date(E[0],E[1]-1,E[2])}g.location_key=e.location_key,g.start_timestamp=e.start_timestamp,g.subject_type=e.subject_type,g.batch=e.batch,g.creator_key=e.creator_key,g.timezone=e.timezone,g.audited=e.audit,g.locked=r.observable(),g.filter=r.observable(),g.canonical=r.observable(!1),g.stage=e.stage,g.published=r.observable(e.published),g.hasUnviewedData=r.observable(e.unviewed_data),g.approvalState=r.observable(e.approval_state||(e.approved===!0?"approved":"")),g.approved=r.pureComputed(function(){return g.approvalState()==="approved"}),g.rejected=r.pureComputed(function(){return g.approvalState()==="rejected"}),g.unapproved=r.pureComputed(function(){return g.approvalState()==="submitted"||g.approvalState()===""}),g.delivery_state=r.observable(e.delivery_state),g.action_history=r.observable(w.create(e.action_history)),g.isEditable=r.observable(y.isParent()?e.locked:g.date&&g.date===(new Date).format("isoDate")),g.guardians=r.observableArray([]),g.teachers=r.observableArray(e.teachers||[]),g.entries=r.observableArray(t(e.entries).map(function(e){var t=null;if(e.type_name==="food"||e.type==="food")t=u.create(e,g.report_key);else if(e.type_name==="mdist")t=a.create(e,g.report_key);else if(e.type_name==="bathroom"||e.type==="bathroom")t=c.create(e,g.report_key);else if(e.type_name==="medication"||e.type==="medication")t=h.create(e,g.report_key);else if(e.type_name==="activity"||e.type==="activity")t=p.create(e,g.report_key);else if(e.type_name==="note"||e.type==="note")t=d.create(e,g.report_key);else if(e.type_name==="nap"||e.type==="nap")t=v.create(e,g.report_key);else if(e.type_name==="theme"||e.type==="theme")t=m.create(e,g.report_key);return t}).compact().sortBy(function(e){return e.parent?-1:e.action_time||e.end_time||e.start_time||e.capture_time}).value()),g.aggregatedActivities=r.pureComputed(function(){if(g.filter()==="dropoff")return[];var e=t.filter(g.entries(),function(e){return!e.deleted&&e.type_name==="activity"}),n=t.indexBy(e,function(e){return e.id()});return t.each(e,function(e){if(e.link_id){var t=n[e.link_id];if(!t)return;e.attachment()&&(t.linked_photo_entry=e,t.attachment(e.attachment()))}}),e}),g.numVisibleEntries=r.pureComputed(function(){return t.reject(g.entries(),function(e){return e&&e.deleted}).length}),g.mealDistributions=r.pureComputed(function(){return g.filter()==="dropoff"?[]:t(g.entries()).filter(function(e){return!e.deleted&&e.type_name==="mdist"}).sortBy(function(e){if(e.meal_name){var t=e.meal_name.toLowerCase();return t==="breakfast"?"b-a":t==="am snack"?"b-b":t==="lunch"?"b-c":t==="pm snack"?"b-d":t==="late snack"?"b-e":t==="dinner"?"b-f":"b-g"}return(e.parent?"a":"c")+"-"+(e.action_time||e.capture_time||e.id())}).value()}),g.meals=r.pureComputed(function(){return i?t.filter(g.entries(),function(e){return!e.deleted&&e.type_name==="food"&&!e.attachment()&&e.meal_type!=="fooddrop"}):t(g.entries()).filter(function(e){var t=!e.deleted&&(e.type_name==="food"||e.type_name==="mdist")&&e.meal_type!=="fooddrop";return t&&g.isAllowedForFilter(e)}).groupBy(function(e){return e.meal_type!=="food"&&e.meal_type!=="fooddrop"||!e.parent?e.meal_type==="food"?e.meal_name||e.action_time||e.capture_time||e.id():e.capture_time||e.id():e.meal_type+":parent"}).map(function(e){return f.create(e)}).sortBy(function(e){if(e.meal_name){var t=e.meal_name.toLowerCase();return t==="breakfast"?"b-a":t==="am snack"?"b-b":t==="lunch"?"b-c":t==="pm snack"?"b-d":t==="late snack"?"b-e":t==="dinner"?"b-f":"b-g"}return(e.parent?"a":"c")+"-"+(e.action_time||e.capture_time||e.id())}).value()}),g.food_drops=r.pureComputed(function(){return i?t.filter(g.entries(),function(e){return!e.deleted&&e.type_name==="food"&&!e.attachment()&&e.meal_type==="fooddrop"}):t(g.entries()).filter(function(e){return!e.deleted&&e.meal_type==="fooddrop"}).groupBy(function(e){return e.meal_type+":parent"}).map(function(e){return f.create(e)}).sortBy(function(e){return(e.parent?"a":"c")+"-"+(e.action_time||e.capture_time||e.id())}).value()}),g.activities=r.pureComputed(function(){if(g.filter()==="dropoff")return[];var e=t.filter(g.aggregatedActivities(),function(e){return!e.attachment()||e.linked_photo_entry});return e=y.sortBySortValue(e,function(e){var r=""+e.action_time||e.capture_time,i=e.c_domains.length>0?t.first(e.c_domains):null;if(!i)return r;var s=H.getInstance().getDomainById(i);if(!s)return r;var o=s.sort;return t.isNull(o)||t.isUndefined(o)||n.trim(o)===""?s.name:o},"name"),e}),g.domainsPlanned=r.pureComputed(function(){return t(g.activities()).pluck("activities").flatten().uniq().value()}),g.domainIdsPlanned=r.pureComputed(function(){return t(g.activities()).pluck("c_domains").flatten().uniq().value()}),g.snapshots=r.pureComputed(function(){return g.filter()==="dropoff"?[]:t.filter(g.aggregatedActivities(),function(e){if(!e.attachment()||e.linked_photo_entry)return!1;if(e.link_id){var n=t.find(g.entries(),function(t){return t.id()===e.link_id&&!t.deleted});if(n)return!1}return!0})}),g.notes=r.pureComputed(function(){return t(g.entries()).filter(function(e){var t=!e.deleted&&e.type_name==="note"&&e.note;return t&&g.isAllowedForFilter(e)}).groupBy(function(e){return e.parent?"parent":"non-parent"}).map(function(e,t){return t==="parent"?l.create(e):e}).flatten().compact().value()}),g.naps=r.pureComputed(function(){return t.filter(g.entries(),function(e){var t=!e.deleted&&e.type_name==="nap";return t&&g.isAllowedForFilter(e)})}),g.bathrooms=r.pureComputed(function(){return t.filter(g.entries(),function(e){var t=!e.deleted&&e.type_name==="bathroom"&&e.bathroom_type!=="diaper";return t&&g.isAllowedForFilter(e)})}),g.diapers=r.pureComputed(function(){return t.filter(g.entries(),function(e){var t=!e.deleted&&e.type_name==="bathroom"&&e.bathroom_type==="diaper";return t&&g.isAllowedForFilter(e)})}),g.meds=r.pureComputed(function(){return t.filter(g.entries(),function(e){var t=!e.deleted&&e.type_name==="medication";return t&&g.isAllowedForFilter(e)})}),g.themes=r.pureComputed(function(){return g.filter()==="dropoff"?[]:t(g.entries()).filter(function(e){return!e.deleted&&e.type_name==="theme"}).sortBy("client_update_timestamp").reverse().value()}),g.weeklyThemes=r.pureComputed(function(){return g.filter()==="dropoff"?[]:t(g.themes()).filter(function(e){return e.scope==="week"}).value()}),g.pleaseBrings=r.pureComputed(function(){if(g.filter()==="dropoff")return[];var e=[];return t.each(g.entries(),function(n){!n.deleted&&n.type_name==="note"&&(e=t.union(e,n.please_bring))}),e}),g.feelings=r.pureComputed(function(){if(g.filter()==="dropoff")return[];var e=[];return t.each(g.entries(),function(t){!t.deleted&&t.type_name==="note"&&t.feeling&&e.push(t.feeling)}),e}),g.statusText=r.pureComputed(function(){var e=g.delivery_state();return g.hasUnviewedData()?e="unviewed":e==="unsent"?e="":e==="soft-bounced"?e="bounced":e==="person-blocked"&&(e="blocked"),e}),this.applyStage()},dispose:function(){var n=this;n.approved.dispose(),n.rejected.dispose(),n.unapproved.dispose(),n.aggregatedActivities.dispose(),n.numVisibleEntries.dispose(),n.mealDistributions.dispose(),n.meals.dispose(),n.food_drops.dispose(),n.activities.dispose(),n.domainsPlanned.dispose(),n.domainIdsPlanned.dispose(),n.snapshots.dispose(),n.notes.dispose(),n.naps.dispose(),n.bathrooms.dispose(),n.diapers.dispose(),n.meds.dispose(),n.themes.dispose(),n.weeklyThemes.dispose(),n.pleaseBrings.dispose(),n.feelings.dispose(),n.statusText.dispose(),t.each(n.entries(),function(e){e.dispose()}),o.dispose.call(this),M.dispose.call(this),s.dispose.call(this)},isAllowedForFilter:function(e){return this.filter()!=="dropoff"||e.parent},isIndividualReport:function(){return this.subject_type==="individual"},isGroupReport:function(){return this.subject_type==="group"},isLessonPlan:function(){return this.type_name==="lesson_plan"},applyStage:function(){if(this.stage||!this.subject_key)return;E=y.lazyLoadModule(E,"services/groups");var e=null,t=this.getSelectedChild();this.isIndividualReport()?t&&(e=E.getInstance().getGroup(t.homeroom_key())):this.subject_type==="group"&&(e=E.getInstance().getGroup(this.subject_key)),e?this.stage=e.child_type():t&&"child_type"in t&&(this.stage=t.child_type())},getSelfOwner:function(){return this.subject_key},upsertEntry:function(e){var n=this,r=e.entries||[e];t.each(r,function(e){n.entries.remove(function(t){return t.id()===e.id()}),n.entries.push(e)}),O.emit("report-modified",this)},getClassKeyForEntry:function(e){var t=null;return this.isGroupReport()?t=this.subject_key:this.isEntryFromClassReport(e)&&(t=e.owner),t},isMemberOfTaggedActivity:function(e){return e.type_name==="activity"?!e.members||e.members.length===0||t.contains(e.members,this.subject_key):!0},isIndividualEntry:function(e){return this.isIndividualReport()&&e.owner===this.subject_key},isEntryFromClassReport:function(e){return this.isGroupReport()||this.isIndividualReport()&&e.owner!==this.subject_key&&e.owner!==this.location_key},isEntryForHomeroom:function(e,t){return e&&e===t.homeroom_key()},isUnscheduledEntryFromHomeroomBeforeChildWasIn:function(e,t,n,r,i){return e.action_time?!1:this.isEntryFromClassReport(e)?this.isEntryForHomeroom(t,i)?e.type_name!=="activity"?!1:n.wasTimeBeforeIn(r*1e3):!1:!1},doesEntryApply:function(e){if(!this.isIndividualReport())return!0;var t=g.getInstance().getChild(this.subject_key),n=t.checkpoint();if(!this.isMemberOfTaggedActivity(e))return!1;if(this.isIndividualEntry(e))return!0;if(!t.wasInToday())return!1;var r=this.getClassKeyForEntry(e),i=e.capture_time||Math.floor(e.client_update_timestamp/1e3),s=e.action_time||e.start_time;if(e.fromLesson&&!s)return this.isEntryForHomeroom(r,t);if(this.isUnscheduledEntryFromHomeroomBeforeChildWasIn(e,r,n,i,t))return!0;var o=s||i;return o?n.wasInClassroomAtTimeWithoutDate(o*1e3,r):!1},applyBatch:function(e){if(!this.batch)return;var n=this;t.each(e,function(e){var r=!1,i=e.entries();t.each(n.entries(),function(s){var o=s.clone();o.owner=n.getSelfOwner();var u=t.findIndex(i,function(e){return e.id()===o.id()}),a=u>=0?i[u]:null,f=a&&a.owner===o.owner;if(!e.doesEntryApply(o)){f&&(i.splice(u,1),r=!0);return}if(!a||f)a?f&&(i[u]=o):i.push(o),r=!0}),r&&e.entries(i)})},getSelectedChild:function(){return y.isParent()?y.childSelection:g.getInstance().getChild(this.subject_key)},getName:function(){var e="";if(!this.batch){var t=this.getSelectedChild();t&&(e=t.firstName())}else if(this.subject_type==="location")e=b.location().name;else{E=y.lazyLoadModule(E,"services/groups");var n=E.getInstance().getGroup(this.subject_key);n&&(e=n.name)}return e},getFeelingsText:function(){var e="";return this.feelings().length>0&&(e=this.feelings().length===1?this.feelings()[0]:t.reduce(t.initial(this.feelings()),function(e,t){return e+t+", "},e)+"and "+t.last(this.feelings())),e},getPopoverParams:function(){var e=!1;return A.CurrentUser.isCsr()&&(e={title:"Key",content:'<div style="word-wrap:break-word;"><h4>Key:</h4> <span data-bind="text: key"></span><h4>Key Name:</h4> <span data-bind="text: report_key"></span><h4>Subject Key:</h4> <span data-bind="text: subject_key"></span><h4>Date Key:</h4> <span data-bind="text: date"></span></div>',placement:"left",trigger:"click",bindContent:!0}),e},audit:function(){_.getInstance().load(this.key,D)},toUpload:function(e){var n=e?e.toUpload():[];return{type_name:this.type_name,location_key:this.location_key,subject_key:this.subject_key,subject_type:this.subject_type,start_timestamp:this.start_timestamp,date:this.date,batch:this.batch,client_update_timestamp:e&&e.client_update_timestamp?e.client_update_timestamp:(new Date).getTime(),published:this.published(),stage:this.stage,timezone:this.timezone,approved:this.approved(),approval_state:this.approvalState(),entries:t.isArray(n)?n:[n],unviewed_data:this.hasUnviewedData()}},editActivity:function(e){x.getInstance().open(this,e)},editNote:function(e){var t=T.getInstance();return t.open(this,e),t},editNap:function(e){N.getInstance().open(this,e)},editMeal:function(e){var t=C.getInstance();return t.open(this,e),t},editFoodDrop:function(e){C.getInstance().open(this,e||{meal_type:"fooddrop"})},editDiaper:function(e){k.getInstance().open(this,e||{bathroom_type:"diaper"})},editPotty:function(e){k.getInstance().open(this,e||{bathroom_type:"potty"})},editTheme:function(e){var n=y.parseDate(this.date),r=new Date(n);r.setDate(n.getDate()-n.getDay()),B=y.lazyLoadModule(B,"services/lessonPlans");var i=B.findLesson(this.subject_key,r.format("isoDate"),"week"),s=e&&i?t.find(i.entries(),function(t){return t.id()===e.id()}):null;L.getInstance().open(i,s)},canEditTheme:function(){return this.isEditable()&&this.isLessonPlan()},publish:function(){var e=this;P.showYesNo({title:"Send daily report now?",message:'Daily reports will automatically send when the child is checked out.  If you would prefer to send it early, select "Send Report".  Any modifications made after sending will be sent to parents in an additional email after 30 minutes',yes:function(){e.published(!0);var t=e.toUpload();t.published=!0,e.makeRequest({data:{force_publish:!0,daily_report:r.toJSON(t)},error:function(){P.showAlert("Oops!","Something went wrong on our end, please try again")},success:function(){e.published(!0)}})}})},republish:function(){var e=this,t=M.create({path:"/remote/v1/daily_report/resend",method:"post",error:function(){P.showAlert("Oops!","Something went wrong on our end, please try again")},success:function(){e.delivery_state("resent"),O.emit("report-modified",e)}});t.makeRequest({data:{key:e.key}})},isUnopened:function(){var e=this.delivery_state();return e==="no email"||e==="sent"||e==="delivered"||e==="rejected"||e==="blocked"||e==="soft-bounced"},canResend:function(){return this.published()},canPublish:function(){return!this.published()&&this.entries()&&this.entries().length>0},canEditEntryType:function(e){return this.isEditable()?e==="activity"&&!y.isParent()||e==="note"||e==="food":!1},unblockEmailsAndResend:function(e){var t=M.create({path:"/remote/v1/daily_report/unblock_and_resend",method:"post",error:function(){P.showAlert("Oops!","Something went wrong on our end, please try again")},success:function(){P.showAlert("Success!","The email addresses have been unblocked and the report has been resent!","success")}}),n={emails:e,key:this.key};t.makeRequest({data:{data:r.toJSON(n)}})},updateReport:function(){var e=this,t={daily_report:r.toJSON(e.toUpload(null))};t.location=b.location().key;var n=M.create({path:"/remote/v1/daily_report",method:"post",error:function(){P.showAlert("Oops!","Something went wrong on our end, please try again")},success:function(){O.emit("report-modified",e)}});n.makeRequest({data:t})},printCustom:function(){j.getInstance().load({activities:this.activities(),snapshots:this.snapshots(),goals:this.goals,date:this.realDate,name:this.getName()(),teachers:this.teachers()})}});return F}),tadpoles.define("model/dailyReport",["require","lodash","model/event","services/modal","model/user","model/serverDailyReport"],function(e){var t=e("lodash"),n=e("model/event"),r=e("services/modal"),i=e("model/user"),s=e("model/serverDailyReport"),o=null,u=n.extend(s,{className:"DailyReport",initialize:function(e){var t=this;s.initialize.call(t,e,!0),n.initialize.call(t,e),this.isEditable(!1),this.printableElementId="dr-modal-printable"},showDetails:function(){o||(o=r.create({template:"view/modals/dailyReport",model:u.create({})})),o.open(this)},getPopoverParams:function(){return!1},getModalPopoverParams:function(){var e=!1;return i.CurrentUser.isCsr()&&(e={title:"Keys",content:'<div style="word-wrap:break-word;"><h5>Event Key:</h5> <span data-bind="text: key"></span><h5>Subject Key:</h5> <span data-bind="text: member"></span></div>',placement:"bottom",trigger:"click",bindContent:!0}),e}});return u}),tadpoles.define("services/eventLoader",["require","lodash","ko","services/config","selfish","model/eventType","model/event","model/remote","model/dailyReport"],function(e){function l(){return(new Date).getTime()/1e3-Math.random()*4*60*60}function c(e,t,n,r,i,s,o,u,a,f,l,c,h){return{key:e,type:t,create_time:n,event_time:n,comment:r,new_attachments:i,members_display:s,entries:o,scope:u,member:a,members:[a],labels:f,in_outbox:l,visibility:c,action:h}}var t=e("lodash"),n=e("ko"),r=e("services/config"),i=e("selfish"),s=e("model/eventType"),o=e("model/event"),u=e("model/remote"),a=e("model/dailyReport"),f=function(){},h=i.Base.extend(u,{className:"EventLoader",initialize:function(e){var t=this;e=e||{},e.path="/remote/v1/events",e.method="get",e.error=e.error||function(){return!0},e.complete=e.complete||function(){return!0},e.useCursor=!0,t.loadAll=n.observable(e.loadAll||!1),u.initialize.call(this,e)},newEvent:function(e){var t=null;return e.type=e.type?e.type.toLowerCase():"note",e.type===s.DailyReport?t=a.create(e):t=o.create(e),t},loadNext:function(e){var n=this,i=e.success||n.success,s=e.error||n.error;e.error=function(t){n.loadAll()&&t==="invalid_cursor"?(e.success=i,e.error=s,n.loadEvents(e)):s()},e.success=function(o){var u=t.map(o.events,function(e){return n.newEvent(e)});i(u),n.loadAll()&&u.length!==0&&!r.isDemo&&(e.success=i,e.error=s,n.loadNext(e))},r.isDemo?this.loadEventsLocal(e):this.makeRequest(e)},loadEvents:function(e){e=e||{},this.clearCursor(),this.loadNext(e)},loadEventsLocal:function(e){function r(e,t){this.mime_type=e,this.key=t}var n={JPEG:"image/jpeg"},i=e.success||f,o=e.error||f,u=e.complete||f,a=[];a.push(c("demokey1",s.Note,l(),"Welcome to Tadpoles!",[],["Tadpoles"],null,"group")),a.push(c("demokey5",s.Activity,l(),"Having fun!",[new r(n.JPEG,"demo1")],["Maya Diaz"],null,"dependant","demokey2",["social"],!0,["p"])),a.push(c("demokey12",s.DailyReport,l(),"Comment",[],["Elly Hall"],[{type:"nap",start_time:1319468433,end_time:1319471148,note:"Slept like an angel"},{details:"Mac and Cheese",classification:"Lunch",note:"Really ate well today",quantity:"Some",type:"food"},{type:"bathroom",start_time:1319480039,classification:"Pee",note:""},{type:"medication",start_time:1319482842,quantity:"25",measure:"mg",note:"Allergy medication"},{type:"food",classification:"PM Snack",quantity:"Half",details:"Crackers",note:""},{type:"note",details:"pull-ups, wipes, clothes",note:""},{type:"note",note:"Did a really great job sharing with the other kids today!"},{type:"activity",note:"Wheeeeeeeeee!",attachment:{mime_type:n.JPEG,key:"demo4"}}],"dependant","demokey6")),a.push(c("demokey6",s.Activity,l(),"Tea party!",[new r(n.JPEG,"demo2")],["Cameryn Bailey"],null,"dependant","demokey4",["art"],!1,["p"])),a.push(c("demokey61",s.Activity,l(),"Hi!",[new r(n.JPEG,"demokid1")],["Cameryn Bailey"],null,"dependant","demokey4",["circle time"])),a.push(c("demokey3",s.Note,l(),"Remember to wear your costumes for our halloween party tomorrow!",[],["Toddlers"],null,"group")),a.push(c("demokey8",s.Activity,l(),"Wheeeeeeeeee!",[new r(n.JPEG,"demo4")],["Elly Hall"],null,"dependant","demokey6",["physical"])),a.push(c("demokey9",s.Activity,l(),"I love you mom!",[new r(n.JPEG,"demo5")],["Michael Martin"],null,"dependant","demokey7",["emotional"])),a.push(c("demokey7",s.Activity,l(),"Future architect",[new r(n.JPEG,"demo3")],["Grayson Moore"],null,"dependant","demokey4",["cognitive"])),a.push(c("demokey81",s.Activity,l(),"Wheeeeeeeeee!",[new r(n.JPEG,"demo4")],["Cameryn Bailey"],null,"dependant","demokey4",["social"])),a.push(c("demokey91",s.Activity,l(),"I love you mom!",[new r(n.JPEG,"demo5")],["Cameryn Bailey"],null,"dependant","demokey4",["social"])),a.push(c("demokey2",s.Note,l(),"Please bring more diapers and wipes",[],["Grayson Moore"],null,"dependant","demokey3")),a.push(c("demokey17",s.Note,l(),"Family drop-off notes have been entered on Emma Nelson's daily report",[],["Toddlers"],null,"group")),a.push(c("demokey4",s.DailyReport,l(),"Comment",[],["Alexis Clark"],[{type:"food",classification:"PM Snack",quantity:"None",note:"She wasn't hungry today"},{type:"bathroom",start_time:1319480039,classification:"Tried",note:""},{type:"note",details:"clothes",note:""},{type:"activity",note:"Look at me go!",attachment:{mime_type:n.JPEG,key:"demo6"}}],"dependant","demokey8")),a.push(c("demokey10",s.Activity,l(),"Look at me go!",[new r(n.JPEG,"demo6")],["Alexis Clark"],null,"dependant","demokey8",["physical"],!0,["p"],"AddToDaily")),a.push(c("demokey101",s.Activity,l(),"I can balance!",[new r(n.JPEG,"demo6")],["Alexis Clark"],null,"dependant","demokey8",["physical"],!0)),a.push(c("demokey11",s.Activity,l(),"Snack time!",[new r(n.JPEG,"demo7")],["Sophia Jackson"],null,"dependant","demokey9",["social"],!0,["p"])),a.push(c("demokey13",s.Activity,l(),"Made a friend!",[new r(n.JPEG,"demo8")],["Jacob Anders"],null,"dependant","demokey1",["social"],!1,["p"],"AddToDaily")),a.push(c("demokey15",s.Note,l(),"Tommorow is 'purple' day",[],["Infants"],null,"group")),a.push(c("demokey14",s.Activity,l(),"Painting a picture for mommy!",[new r(n.JPEG,"demo9")],["Emma Nelson"],null,"dependant","demokey5",["art"]));var h=c("demokey16",s.Activity,l(),"Made a friend!",[new r(n.JPEG,"demo8")],["Jacob Anders","Alexis Clark"],null,"dependant","demokey1",["art"],!0,["p"],"AddToDaily");h.members.push("demokey8"),a.push(h);var p=this.requestData()||{};p.member_key&&(a=t.filter(a,function(e){return e.member===p.member_key})),p.type&&(a=t.filter(a,function(e){return p.type.toLowerCase().indexOf(e.type.toLowerCase())!==-1})),p.event_time&&(a=t.filter(a,function(e){return p.event_time>e.event_time})),i({events:a}),u()}});return h}),tadpoles.define("services/scheduledEventLoader",["require","selfish","model/remote","services/config","ko","model/event","lodash"],function(e){var t=e("selfish"),n=e("model/remote"),r=e("services/config"),i=e("ko"),s=e("model/event"),o=e("lodash"),u=t.Base.extend({className:"ScheduledEventLoader",initialize:function(e){e=e||{},e.path="/remote/v1/events/scheduled",e.method="get",e.error=e.error||function(){return!0},e.complete=e.complete||function(){return!0},this.loader=n.create({path:"/remote/v1/events/scheduled",method:"get",success:function(t){var n=o.map(t.events,function(e){return e.type=e.type?e.type.toLowerCase():"note",s.create(e)});e.success(n)},error:e.error,complete:e.complete})},loadEvents:function(e){r.isDemo||this.loader.makeRequest({})}});return u}),tadpoles.define("services/centerOnLoad",["require","lodash","jquery","ko"],function(e){function i(e,t,r){var i=n(window).width(),s=n(window).height(),o=r,u=t;if(r>i||t>s){var a=!1,f=r/t,l=Math.floor(s*f),c=Math.floor(i*(1/f));r>i?a=c<s:t>s&&(a=l>i),o=a?i:l,u=a?c:s}n(e).css({position:"absolute",height:u+"px",width:o+"px",left:"50%",top:"-"+Math.floor(u/2)+"px",marginLeft:"-"+Math.floor(o/2)+"px"})}function s(e,t){n("<img/>").one("load",function(){var t=this.height,r=this.width;n(e).empty(),n(window).off("resize.centerOnLoad"),n(e).append(n(this));var s=n(this);n(window).on("resize.centerOnLoad",function(){i(s,t,r)}),i(s,t,r),n(e).show()}).attr("src",t).each(function(){this.complete&&n(this).trigger("load")})}var t=e("lodash"),n=e("jquery"),r=e("ko");return r.bindingHandlers.centerWithImageOnLoad={init:function(e,t){var i=r.utils.unwrapObservable(t())||{};n(e).css({display:"none",textAlign:"center",position:"absolute",top:"50%",left:"0px",width:"100%",height:"1px",overflow:"visible"}),s(e,i)},update:function(e,t){var n=r.utils.unwrapObservable(t())||{};s(e,n)}},{}}),tadpoles.define("model/gallery",["require","selfish","utilities","lodash","ko","jquery","services/centerOnLoad"],function(e){var t=e("selfish"),n=e("utilities"),r=e("lodash"),i=e("ko"),s=e("jquery");e("services/centerOnLoad");var o=4,u=t.Base.extend({className:"Gallery",initialize:function(e){var t=this;t.theArgs=e,this.observations=i.observable(),this.currentObservation=i.observable(),this.timeout=null,this.visible=i.observable(!1)},open:function(e){this.observations(e),this.run(),this.visible(!0)},close:function(){this.stop(),this.clear(),this.visible(!1)},update:function(){this.currentObservation(r(this.observations()()).filter(function(e){return e.hasImage()}).sample()),this.timeout=setTimeout(this.update,o*1e3)},run:function(){this.stop(),this.update()},stop:function(){this.timeout&&clearTimeout(this.timeout)},clear:function(){this.observations([]),this.currentObservation(null)}});return n.makeSingleton(u)}),tadpoles.define("services/events",["require","ko","lodash","services/eventLoader","services/scheduledEventLoader","model/dailyReport","model/globalFilter","utilities","emit","services/alerts","model/gallery","services/analytics","model/detailViewPanel","services/disposer","selfish","services/config"],function(e){var t=e("ko"),n=e("lodash"),r=e("services/eventLoader"),i=e("services/scheduledEventLoader"),s=e("model/dailyReport"),o=e("model/globalFilter"),u=e("utilities"),a=e("emit"),f=e("services/alerts"),l=e("model/gallery"),c=e("services/analytics"),h=e("model/detailViewPanel"),p=e("services/disposer"),d=e("selfish"),v=e("services/config"),m=d.Base.extend(r,i,{className:"Events",initialize:function(){var e=this;e.loaded=t.observable(!1),r.initialize.call(this,{loadAll:!0,error:function(){e.loaded(!1)},success:function(t){t=e.currentEvents().concat(n.filter(t,function(e){return!e.inOutbox()&&!s.isPrototypeOf(e)})),e.currentEvents(n.uniq(t,"key"))}}),i.initialize.call(this,{success:function(t){e.scheduledEvents(t)}}),e.currentEvents=t.observableArray([]),e.scheduledEvents=t.observableArray([]),e.events=t.pureComputed(function(){return e.currentEvents().concat(e.scheduledEvents())}),e.currentEvents.subscribe(function(e){a.emit("events-update",{events:e,source:"events"})}),e.hasEvents=t.pureComputed(function(){return e.currentEvents().length>0}),e.observationsForGroup=function(n){var r=e.currentEvents();if(u.isNull(n))return[];var i=n.isLocation(),s=o.name().toLowerCase(),a=t.utils.arrayFilter(r,function(t){return t.type!=="note"&&(i||n.key===t.group())&&t.memberNames().toString().toLowerCase().indexOf(s)!==-1});return a},e.observationsForSelection=t.pureComputed(function(){return e.observationsForGroup(o.group())}),e.galleryPhotos=t.pureComputed(function(){var n=o.group(),r=e.currentEvents();if(u.isNull(n))return[];var i=n.isLocation(),s=o.name().toLowerCase(),a=t.utils.arrayFilter(r,function(t){return t.canShowInGallery()&&(i||n.key===t.group())&&t.titleLower().indexOf(s)!==-1});return a}),e.unGroupedNotesForSelection=t.pureComputed(function(){var n=o.group(),r=e.events();if(u.isNull(n)&&v.isProviderApp)return[];var i=v.isProviderApp?n.isLocation():!0,s=v.isProviderApp?o.name().toLowerCase():"";return t.utils.arrayFilter(r,function(t){return t.type==="note"&&(i||n.key===t.group())&&t.titleLower().indexOf(s)!==-1})}),e.notesForSelection=t.pureComputed(function(){return n.filter(e.unGroupedNotesForSelection(),function(e){return e.grouped_event_id?e.grouped_event_id&&e.grouped_event_is_primary:!0})}),a.on("observation-deleted",function(t){var n=e.currentEvents.remove(function(e){return e.key===t});p.dispose(n)}),a.on("observation-updated",function(t){e.loadEvents()}),a.on("new-event",function(t){e.addEvent(t)}),a.on("childrenLoaded",function(){h.getInstance().observationsActive()&&e.loadEvents()}),a.on("detailViewActive",function(t){(t.name==="observations"||t.name==="communications")&&e.loadEvents()}),o.date.subscribe(function(){e.reset(),(h.getInstance().observationsActive()||h.getInstance().communicationsActive())&&e.loadEvents()})},addEvent:function(e){if(s.isPrototypeOf(e))return;if(e.inOutbox())return;var t=e.event_time?(new Date(e.event_time*1e3)).format("isoDate"):"";if(t!==o.date().format("isoDate"))return;var r=n.find(this.events(),function(t){return t.key===e.key});r||(e.isScheduled()?this.scheduledEvents.unshift(e):this.currentEvents.unshift(e))},requestData:function(){var e={num_events:300,date:o.date().format("isoDate"),location:o.location().key};return e},reset:function(){this.loaded(!1),p.dispose(this.currentEvents()),p.dispose(this.scheduledEvents()),this.currentEvents([]),this.scheduledEvents([])},loadEvents:function(){if(this.loaded())return;this.loaded(!0),r.loadEvents.call(this),i.loadEvents.call(this)},hasPhotos:function(){var e=this.galleryPhotos(),t=n.size(e);return t>0},showGallery:function(){if(!this.hasPhotos()){f.showAlert("No photos","Please take some photos or change the filters to show photos");return}l.getInstance().open(this.galleryPhotos),c.trackEvent("Dashboard","PhotoGallery")}}),g=m.create();return g}),tadpoles.define("model/modal/editCheckpointForm",["require","ko","lodash","jquery","model/form","selfish","services/alerts","model/globalFilter","services/uuid","emit","utilities","model/user"],function(e){var t=e("ko"),n=e("lodash"),r=e("jquery"),i=e("model/form"),s=e("selfish"),o=e("services/alerts"),u=e("model/globalFilter"),a=e("services/uuid"),f=e("emit"),l=null,c=e("utilities"),h=e("model/user"),p=s.Base.extend({className:"CheckpointRow",initialize:function(n,r,i,s){var o=this;this.checkpoint=n,this.id=t.observable(a.short()),this.action=t.observable();var u=r?r:n?n.action:null;u==="excused"?this.action("other"):this.action(u),this.note=t.observable(n?n.note:null),this.inTime=t.observable(n&&n.inTime()?Math.floor(n.inTime().getTime()/1e3):i),this.outTime=t.observable(n&&n.outTime()?Math.floor(n.outTime().getTime()/1e3):i),this.excused=t.observable(n?n.excused?"excused":"unexcused":"excused"),this.sickOnly=s||!1,this.validateTimesOnUpdate=t.computed(function(){if(!o.inTime()){o.outTime(null);return}if(o.inTime()&&o.isAbsence()){o.outTime(o.inTime());return}if(o.outTime()&&o.inTime()>=o.outTime()){o.outTime(null);return}})},isAbsence:function(){return this.action()==="sick"||this.action()==="vacation"||this.action()==="other"},absenceTypeOptions:function(){return this.sickOnly?["sick"]:["sick","vacation","other"]},excusedOptions:function(){return["excused","unexcused"]},isValid:function(){return this.isAbsence()||this.inTime()||this.outTime()}}),d=i.extend({className:"EditCheckpointForm",initialize:function(){var r=this;r.trackableKey=t.observable(),r.originalCheckpoints=t.observableArray([]),r.checkpoints=t.observableArray([]),r.sortedCheckpoints=t.pureComputed(function(){return n(r.checkpoints()).sortBy(function(e){return e.inTime()}).value()}),r.allowMultiple=t.observable(),r.sickOnly=t.observable(),r.canAdd=t.pureComputed(function(){return r.allowMultiple()&&r.sortedCheckpoints().length<3}),r.canAddInOutTimes=t.pureComputed(function(){return r.canAdd()&&!r.sickOnly()&&r.lastCheckpointValid()}),r.canAddAbsence=t.pureComputed(function(){return r.canAdd()&&!r.lastCheckpointIsAbsence()}),r.canDelete=t.pureComputed(function(){return r.allowMultiple()}),r.date=t.observable(),i.initialize.call(r,{title:"edit attendance",formTemplate:"view/modals/editCheckpoint",formModel:r,path:"/remote/v1/checkpoint/update",submitText:"submit",success:function(e){l=c.lazyLoadModule(l,"model/checkpoint"),f.emit("checkpoints-edited",{trackableKey:r.trackableKey(),date:r.date(),checkpoints:n(e.checkpoints).map(function(e){return l.create(e)}).value()}),r.close()}})},lastCheckpointValid:function(){var t=this.sortedCheckpoints().length;return t>0&&this.sortedCheckpoints()[t-1].isValid()},lastCheckpointIsAbsence:function(){var t=this.sortedCheckpoints().length;return t>0&&this.sortedCheckpoints()[t-1].isAbsence()},addCheckpoint:function(){this.lastCheckpointValid()&&this.checkpoints.push(p.create())},addAbsenceCheckpoint:function(){this.lastCheckpointValid()||this.deleteCheckpoint(!1,this.sortedCheckpoints()[this.sortedCheckpoints().length-1]);var t=this.getDefaultAbsenceTime();if(this.sortedCheckpoints().length>0){var n=this.sortedCheckpoints()[this.sortedCheckpoints().length-1];n.outTime()?t=this.sortedCheckpoints()[this.sortedCheckpoints().length-1].outTime():t>n.inTime()&&(t=n.inTime())}this.checkpoints.push(p.create(null,"sick",t,this.sickOnly()))},getDefaultAbsenceTime:function(){var t=this.date();return t.setHours(6,0,0,0),Math.floor(t.getTime()/1e3)},deleteCheckpoint:function(t,n){this.checkpoints.remove(function(e){return e.id()===n.id()}),t&&this.sortedCheckpoints().length===0&&this.checkpoints([p.create()])},payload:function(){var t=this,r=this.originalCheckpoints(),i=this.sortedCheckpoints(),s=null,o=n(i).filter(function(e){return e.isValid()}).map(function(e){var n={note:e.note(),member:t.trackableKey(),client_update_timestamp:(new Date).getTime()};return e.isAbsence()?(n.action=e.action()==="other"?"excused":e.action(),e.inTime()?n.in_time=e.inTime():s?n.in_time=s:n.in_time=Math.floor(t.date().getTime()/1e3),n.out_time=n.in_time,n.excused=e.excused()==="excused"):(n.action=e.outTime()?"out":"in",n.in_time=e.inTime(),n.out_time=e.outTime()),s=n.out_time,e.checkpoint&&(n.key=e.checkpoint.key),n}).value();return o=o.concat(n(r).map(function(e){return!o||n(o).pluck("key").compact().value().indexOf(e.key)===-1?{key:e.key,deleted:!0,member:t.trackableKey(),client_update_timestamp:(new Date).getTime()}:null}).compact().value()),{location:u.location().key,device_time:(new Date).getTime(),checkpoints:o}},open:function(t,r,s,o,u){var a=this;this.trackableKey(r),this.date(s||new Date),this.originalCheckpoints(t),this.sickOnly(u),this.title("edit attendance for "+this.date().format("tinyDate"));var f=n(t).map(function(e){return p.create(e,null,null,a.sickOnly())}).value();f.length===0&&(this.sickOnly()?f.push(p.create(null,"sick",this.getDefaultAbsenceTime(),this.sickOnly())):f.push(p.create())),this.checkpoints(f),this.allowMultiple(o),i.open.call(this)},close:function(){this.trackableKey(null),this.originalCheckpoints([]),this.checkpoints([]),i.close.call(this)},valid:function(){var t=n(this.sortedCheckpoints()).map(function(e){return[e.inTime(),e.outTime()]}).flatten().reduce(function(e,t){return e<0?e:n.isNull(e)&&!n.isNull(t)?-1:!n.isNull(t)&&t<e?-1:t},0);return t===-1?(o.showAlert("Something is not quite right!","The times must not not be overlapping and must be continuous"),!1):!0},audit:function(t){r("#"+this.id+"-pop").popover("hide"),t.audit()},getPopoverParams:function(){var t=!1;return h.CurrentUser.isCsr()&&(t={title:"Checkpoint Keys",content:'<div style="word-wrap: break-word;" data-bind="foreach:originalCheckpoints()"><h4 data-bind="text: \'Key \' + ($index()+1) + \':\'"></h4><span data-bind="text:$data.key"></span><button class="btn btn-danger btn-mini" style="margin-left:5px;"data-bind="click:function() { $parent.audit($data); }, visible: $data.key">Audit</button></br></div>',placement:"bottom",trigger:"click",bindContent:!0}),t}});return c.makeSingleton(d)}),tadpoles.define("model/checkpoint",["require","ko","lodash","selfish","services/children","services/employees","services/groups","model/modal/editCheckpointForm","model/globalFilter","utilities","model/audit","model/disposable"],function(e){function v(e,t,n){var r=new Date(t),i=null;n&&(i=new Date(n));var s=new Date(e);return r?r.getHours()*60+r.getMinutes()>s.getHours()*60+s.getMinutes()?!1:i?i.getHours()*60+i.getMinutes()<s.getHours()*60+s.getMinutes()?!1:!0:!0:!1}var t=e("ko"),n=e("lodash"),r=e("selfish"),i=e("services/children"),s=e("services/employees"),o=e("services/groups"),u=e("model/modal/editCheckpointForm"),a=e("model/globalFilter"),f=null,l=e("utilities"),c=e("model/audit"),h=e("model/disposable"),p={Child:"child",Employee:"employee"},d={Tiny:"tiny",Default:"default"},m=r.Base.extend(h,{className:"Checkpoint",initialize:function(r){var i=this;h.initialize.call(this),i.key=r.key,i.location=r.location,i.group=r.group,i.action=r.action,i.actionTime=r.action_time*1e3,i.inTime=t.observable(r.in_time?new Date(r.in_time):null),i.outTime=t.observable(r.out_time?new Date(r.out_time):null),i.accidentalCheckoutTime=t.observable(r.accidental_checkout_time?new Date(r.accidental_checkout_time):null),i.hours=t.pureComputed(function(){return i.inTime()&&i.outTime()?Math.round((i.outTime().getTime()-i.inTime().getTime())/36e5*10)/10:null}),i.seconds=t.pureComputed(function(){return i.inTime()&&i.outTime()?Math.round((i.outTime().getTime()-i.inTime().getTime())/1e3):null}),i.child_key=r.member,i.displayInTime=t.pureComputed(function(){return i.inTime()?i.inTime().format("shortTime"):null}),i.displayInTimeOnly=t.pureComputed(function(){return i.inTime()?i.inTime().format("tinyTime"):null}),i.inMeridian=t.pureComputed(function(){return i.inTime()?i.inTime().format("tt"):null}),i.displayOutTime=t.pureComputed(function(){return i.outTime()?i.outTime().format("shortTime"):null}),i.displayOutTimeOnly=t.pureComputed(function(){return i.outTime()?i.outTime().format("tinyTime"):null}),i.outMeridian=t.pureComputed(function(){return i.outTime()?i.outTime().format("tt"):null}),i.displayAccidentalCheckoutTime=t.pureComputed(function(){return i.accidentalCheckoutTime()?i.accidentalCheckoutTime().format("shortTime"):null}),i.hadBreakfast=t.pureComputed(function(){return n.contains(i.mealHistory(),"Breakfast")}),i.hadLunch=t.pureComputed(function(){return n.contains(i.mealHistory(),"Lunch")}),i.hadDinner=t.pureComputed(function(){return n.contains(i.mealHistory(),"Dinner")}),i.hadAMSnack=t.pureComputed(function(){return n.contains(i.mealHistory(),"AM Snack")}),i.hadPMSnack=t.pureComputed(function(){return n.contains(i.mealHistory(),"PM Snack")}),i.hadLateSnack=t.pureComputed(function(){return n.contains(i.mealHistory(),"Late Snack")}),i.note=r.note,i.endDate=r.end_local_date?new Date(r.end_local_date*1e3):null,i.displayEndDate=i.endDate?i.endDate.format("tinyDate"):null,i.visit_history=r.visit_history||[],i.name_to_face_checks=r.n2f_checks||[],i.inGuardianName=r.in_guardian_name,i.outGuardianName=r.out_guardian_name,i.outGuardian=r.out_guardian,i.childDisplayName=t.observable("..."),i.person_type=r.person_type,i.cut=r.cut,i.deleted=r.deleted,i.mealHistory=t.observableArray([]),i.excused=r.excused,i.origin=r.origin,i.updatePerson()},dispose:function(){var t=this;t.hours.dispose(),t.seconds.dispose(),t.displayInTime.dispose(),t.displayInTimeOnly.dispose(),t.inMeridian.dispose(),t.displayOutTime.dispose(),t.displayOutTimeOnly.dispose(),t.outMeridian.dispose(),t.displayAccidentalCheckoutTime.dispose(),h.dispose.call(this)},updatePerson:function(){if(this.childDisplayName()==="..."){var t=this.getPerson();this.childDisplayName(t?t.displayName():"...")}},getPerson:function(){var t=null;return this.person_type===p.Child?t=i.getInstance().getChild(this.child_key):this.person_type===p.Employee&&(t=s.getInstance().getEmployee(this.child_key)),t},determineTypeAndGetPerson:function(){var t=null,n=i.getInstance().getChild(this.child_key);if(n)this.person_type=p.Child,t=n;else{var r=s.getInstance().getEmployee(this.child_key);r&&(this.person_type=p.Employee,t=r)}return t},isSick:function(){return this.action==="sick"&&this.occurredToday()},wasSick:function(){return this.action==="sick"},isVacation:function(){return this.action==="vacation"&&new Date<this.endDate},wasVacation:function(){return this.action==="vacation"},occurredToday:function(){return(new Date(this.actionTime)).format("isoDate")===(new Date).format("isoDate")},isOtherAbsence:function(){return this.action==="excused"&&this.occurredToday()},wasOtherAbsence:function(){return this.action==="excused"},wasAbsent:function(){return this.wasSick()||this.wasOtherAbsence()||this.wasVacation()},isFromChild:function(){return this.person_type===p.Child},isFromEmployee:function(){return this.person_type===p.Employee},didVisit:function(){return this.visit_history&&this.visit_history.length>0},isTooQuickToActuallyBeIn:function(){return this.inTime()&&this.outTime()&&Math.abs(this.outTime().getTime()-this.inTime().getTime())<12e5},getPopoverParams:function(){return{content:"<div data-bind=\"template: { name: 'view/popovers/checkpointPopover' }\"></div>",placement:"left",delay:200,hoverself:!0,trigger:"hover",bindContent:!0,template:'<div class="popover"><div class="arrow"></div><div class="popover-inner"><div class="popover-content"><p></p></div></div></div>'}},parentDropOff:function(){return this.inGuardianName?"Dropped off by "+this.inGuardianName:null},parentPickup:function(){return this.outGuardianName?"Picked up by "+this.outGuardianName:null},absentNote:function(){var t="";return this.wasSick()?t="Sick"+(this.note?": "+this.note:""):this.wasOtherAbsence()?t="Absent"+(this.note?": "+this.note:""):this.wasVacation()&&(t="On vacation"+(this.displayEndDate?" through "+this.displayEndDate:"")),this.excused||(t+=" - Unexcused"),t},activityHistory:function(t){var r=this,i=[];i.push(this.parentDropOff());if(this.visit_history.length===0){var s=o.getInstance().getGroup(this.group),u=s?s.name():"Unknown";t===d.Tiny&&(u=u.substring(0,10)),r.person_type==="employee"?(i.push("Clocked in at "+r.displayInTime()),s&&(t===d.Tiny?i.push(u+"  "+r.displayInTime()):i.push("Signed in to "+s.name()+" at "+r.displayInTime()))):t===d.Tiny?i.push(u+"  "+r.displayInTime()):i.push("Started in "+u+" at "+r.displayInTime())}return n.each(this.visit_history,function(e,n){var s=o.getInstance().getGroup(e.from_class_key||e.class_key),u=s?s.name():"Unknown",a=o.getInstance().getGroup(e.to_class_key),f=a?a.name():"";t===d.Tiny&&(u=u.substring(0,15),f=f.substring(0,15)),n===0&&(r.person_type==="employee"?(i.push("Clocked in at "+r.displayInTime()),s&&(t===d.Tiny?i.push(s.name()+"  "+r.displayInTime()):i.push("Signed in to "+s.name()+" at "+r.displayInTime()))):t===d.Tiny?i.push(u+"  "+r.displayInTime()):i.push("Started in "+u+" at "+r.displayInTime()));var l=(new Date(e.transition_time)).format("shortTime"),c=e.transition_type==="m"?"Moved to":"Visited";r.person_type==="employee"?a?t===d.Tiny?i.push("In "+f+" "+l):i.push("Signed in to "+f+" at "+l):s&&(t===d.Tiny?i.push("Out "+u+" "+l):i.push("Signed out of "+u+" at "+l)):t===d.Tiny?i.push(f+"  "+l):i.push(c+" "+f+" at "+l)}),r.outTime()&&i.push("Out at "+r.displayOutTime()),i.push(this.parentPickup()),n.compact(i)},getMealHistory:function(){var t=this,n=t.inTime.peek()?t.inTime.peek():t.outTime.peek()?t.outTime.peek():a.date.peek();return f=l.lazyLoadModule(f,"services/dailyReports"),f.getMealDistributionsDeferred(t.child_key,n.format("isoDate")).done(function(e){if(!e)return;t.mealHistory(e)}),!0},hasNtfHistory:function(){return n.filter(this.name_to_face_checks,function(e){return!e.exception}).length>0},ntfHistory:function(){return n.map(this.name_to_face_checks,function(e){var t=o.getInstance().getGroup(e.class_key),n=t?t.name()+" ":"",r=(new Date(Math.floor(e.ts*1e3))).format("shortTime"),i=e.actor;return e.exception?r+" Missed Check":r+(n?" in "+n:"")+(i?" by "+i:"")})},getNoteDisplay:function(){var t=this,r=null;return this.inGuardianName&&(r="Dropped off by "+this.inGuardianName),this.wasSick()?r="Sick"+(this.note?": "+this.note:""):this.wasOtherAbsence()?r="Absent"+(this.note?": "+this.note:""):this.wasVacation()?r="On vacation"+(this.displayEndDate?" through "+this.displayEndDate:""):this.didVisit()&&this.person_type==="child"?(r=r?r+"<br/>":"",n.each(this.visit_history,function(e,n){if(n===0){var i=o.getInstance().getGroup(e.from_class_key||e.class_key),s=i?i.name():"Unknown";r+="Started in "+s+" at "+t.displayInTime()}var u=o.getInstance().getGroup(e.to_class_key),a=u?u.name()+" ":"",f=(new Date(e.transition_time)).format("shortTime"),l=e.transition_type==="m"?"Moved to":"Visited";r+="<br/>"+l+" "+a+"at "+f})):this.didVisit()&&this.person_type==="employee"&&(r=r?r+"<br/>":"",n.each(this.visit_history,function(e,n){var i=o.getInstance().getGroup(e.from_class_key),s=o.getInstance().getGroup(e.to_class_key),u=(new Date(e.transition_time)).format("shortTime");n===0&&(r+="Clocked in at "+t.displayInTime(),i&&(r+="<br/>Signed in to "+i.name()+" at "+t.displayInTime())),s?r+="<br/>Signed in to "+s.name()+" at "+u:i&&(r+="<br/>Signed out of "+i.name()+" at "+u)}),this.outTime()&&this.inTime()&&(r+="<br/>Clocked out at "+this.displayOutTime())),this.outGuardianName&&(r=r?r+"<br/>":"",r+="Picked up by "+this.outGuardianName),this.note&&!(this.isSick()||this.isVacation()||this.isOtherAbsence())&&(r=(r?r+"<br/>":"")+"Note: "+this.note),n.each(this.name_to_face_checks,function(e){var t=o.getInstance().getGroup(e.class_key),n=t?t.name()+" ":"",i=(new Date(Math.floor(e.ts*1e3))).format("shortTime");r=r?r:"",r+="<br/>Seen at "+i+(n?" in "+n:"")}),r},wasInForMillis:function(t){if(!this.inTime())return!1;if(this.inTime().getTime()>=t)return!1;if(!this.outTime())return!0;var n=this.outTime();return n.getTime()<t?!1:!0},hadVisitedClass:function(t){var r=!1;return this.group==t&&(r=!0),n.each(this.visit_history,function(e){if(e.from_class_key==t||e.to_class_key==t)r=!0}),r},wasInClassroomAtTimeWithoutDate:function(t,r){var i=!1,s=this.inTime().getTime(),o=this.group,u=null;return n.each(this.visit_history,function(e){o=e.from_class_key,u=(new Date(e.transition_time)).getTime(),v(t,s,u)&&(!r||o==r)&&(i=!0),s=u,o=e.to_class_key}),u=this.outTime()?this.outTime().getTime():null,v(t,s,u)&&(!r||o==r)&&(i=!0),i},wasInByTimeWithoutDate:function(t){var n=this.inTime(),r=this.outTime();return v(t,n.getTime(),r.getTime())},wasTimeBeforeIn:function(t){return!t||t<this.inTime().getTime()},edit:function(){u.getInstance().open([this],this.child_key,this.inTime()||this.outTime(),!1,!1)},audit:function(){c.getInstance().load(this.key)}});return m.editMultiple=function(t,n,r,i){u.getInstance().open(t,n,r,!0,i)},m.PersonType=p,m}),tadpoles.define("services/message",["require","utilities","services/connection","services/events","emit","services/children","services/employees","model/checkpoint","jquery","services/config"],function(e){function c(e,n){var r;return t.isNull(e)?!0:t.isNull(e.cut)?!0:(r=e.cut<=n.cut,r)}function h(e){var t=e.member.key,n=s.getInstance().getChild(t)||o.getInstance().getEmployee(t),r=u.create(e.checkpoint);i.emit("checkpoint-received",r);if(!n)return;if(c(n.checkpoint(),r)){var a=n.checkpoint();n.checkpoint(r),a&&a.dispose(),i.emit("attendanceChanged",{location:n.location(),group:n.group(),key:n.key,checkpoint:r})}}function p(e){var t=e.kind,n=e.key,r=e.name,i=e.value_key||e.value;if(r==="key")return;if(t==="Dependant"){var u=s.getInstance().getChild(n);u&&u.updateProperty(r,i)}else if(t==="Employee"){var a=o.getInstance().getEmployee(n);a&&a.updateProperty(r,i)}}function d(e){var t=e.action,n=e.uid;i.emit("session-"+t,{uid:n})}function v(e){var t=e.kind;t==="Dependant"?i.emit("child-update-received",e.object):t==="Employee"?i.emit("employee-update-received",e):t==="Class"&&i.emit("class-update-received",e)}function m(e){i.emit("object-change",e)}function g(e){i.emit("new-event",r.newEvent(e))}function y(e){i.emit("daily-report-message",e)}function b(){console.log("Message: onConnect"),i.emit("message-connect")}function w(){console.log("Message: onConnectError")}function E(e){var t=JSON.parse(e.data),n=t.type;n==="checkpoint"?h(t.body):n==="session"?d(t.body):n==="object"?v(t.body):n==="object_change"?m(t.body):n==="property"?p(t.body):n==="event"?g(t.body):n==="daily_report"?y(t.body):n==="jumbo"&&a.ajax({url:"/remote/v1/channel/notification?token="+t.token,dataType:"json"}).then(function(e){E(e)})}function S(){console.log("Message: onClose"),i.emit("message-close")}var t=e("utilities"),n=e("services/connection"),r=e("services/events"),i=e("emit"),s=e("services/children"),o=e("services/employees"),u=e("model/checkpoint"),a=e("jquery"),f=e("services/config"),l;return{listenForMessagesForLocation:function(e,r){if(f.isDemo){b();return}l=r,t.isNull(e)?n.disconnect():(n.testRestrictions(),n.connectWithTopic({topic:e.key,onSuccess:b,onError:w,onMessage:E,onClose:S}))}}}),tadpoles.define("services/activeChildren",["require","services/config","emit","model/remote","model/globalFilter"],function(e){var t=e("services/config"),n=e("emit"),r=e("model/remote"),i=e("model/globalFilter"),s=r.extend({className:"ActiveChildren",initialize:function(){var e=this;r.initialize.call(this,{path:"/remote/v1/people",useCursor:!0,success:function(t,n){e.dependants=e.dependants.concat(t),e.reminders=e.reminders.concat(n)},error:function(){n.emit("loadFailed",{loadDataType:"activeChildren"})}}),e.dependants=[],e.reminders=[]},clearState:function(){this.dependants=[],this.reminders=[],this.clearCursor()},load:function(){this.clearState();if(t.isDemo)return;this.loadNext({location:i.location()})},loadNext:function(e){var r=this,i=e.success||r.success,s=e.error||r.error;e.error=function(t){t==="invalid_cursor"?(e.success=i,e.error=s,r.loadEvents(e)):s()},e.success=function(o){i(o.dependants,o.reminders),o.dependants.length!==0&&!t.isDemo?(e.success=i,e.error=s,r.loadNext(e)):(n.emit("activeChildrenLoaded",{location:e.location,dependants:r.dependants}),n.emit("remindersLoaded",{location:e.location,reminderType:"child",reminders:r.reminders}),r.clearState())},e.data={location:e.location.key,active_children_only:!0},this.makeRequest(e)}});return s.create()}),tadpoles.define("services/remoteEmployees",["require","emit","services/config","model/remote"],function(e){var t=e("emit"),n=e("services/config"),r=e("model/remote"),i=r.extend({className:"RemoteEmployees",initialize:function(){r.initialize.call(this,{path:"/remote/v1/people",error:null,complete:function(){}})},loadDemo:function(e){var n=new Date,r=n.toISOString(),i={employees:[{first_name:"Teach",last_name:"Wonders",email:"teach.wonders@frogsquared.com",image_attachment:"demodad1",special_note:"",en:"Afternoon",roles:["Employee"],group:{key:"demoInfants"},homeroom_key:"demoInfants",location:e.key,last_checkpoint:{action:"in",group:"demoInfants",in_time:r},birth_date:"2/5/2012",sb:23,status:"active",labels:["lead"],key:"demoEmployeeKey1"},{first_name:"Teach",last_name:"Amazing",email:"teach.amazing@frogsquared.com",image_attachment:"demomom1",special_note:"",en:"Morning",roles:["Employee"],group:{key:"demoToddlers"},homeroom_key:"demoToddlers",location:e.key,last_checkpoint:{action:"in",group:"demoToddlers",in_time:r},birth_date:"2/5/2012",sb:23,status:"active",labels:["lead"],key:"demoEmployeeKey2"}],reminders:[]};i.location=e,t.emit("employeesLoaded",i)},load:function(e){if(n.isDemo){this.loadDemo(e);return}var r={location:e.key,employees_only:!0};this.makeRequest({data:r,success:function(n){n.location=e,t.emit("employeesLoaded",n)},error:function(){t.emit("loadFailed",{loadDataType:"employees"})}})}});return i.create()}),tadpoles.define("services/inactiveChildren",["require","lodash","emit","model/remote","services/config"],function(e){var t=e("lodash"),n=e("emit"),r=e("model/remote"),i=e("services/config"),s=r.extend({className:"InactiveChildren",initialize:function(){r.initialize.call(this,{path:"/remote/v1/people",error:null,complete:function(){}})},load:function(e){if(i.isDemo)return;var t={location:e.key,inactive_children_only:!0};this.makeRequest({data:t,success:function(t){t.location=e,n.emit("inactiveChildrenLoaded",t)}})},delayedLoad:function(e){var n=this;t.delay(function(){n.load(e)},2e3)}}),o=s.create();return n.on("childrenLoaded",function(e){var t=e.location;o.load(t)}),o}),tadpoles.define("services/checkpointStore",["require","ko","jquery","lodash","services/config","services/alerts","services/children","services/employees","model/checkpoint","emit","model/remote","services/disposer"],function(e){function p(){f.emit("checkpointsLoaded",{}),f.emit("checkpointRequestComplete",{})}function d(e){var t="/remote/v1/checkpoints?state=client&location="+e.key+"&location_counter="+h();n.ajax(t,{type:"get",contentType:"application/x-www-form-urlencoded",success:function(e){var t=e.checkpoints;h(e.location_counter),r.each(t,function(e){var t=a.create(e),n=!1,r=o.getInstance().getChild(t.child_key);r&&(r.checkpoint()&&c.fastDispose(r.checkpoint()),n=!0,r.checkpoint(t));var i=u.getInstance().getEmployee(t.child_key);i&&(i.checkpoint()&&c.fastDispose(i.checkpoint()),n=!0,i.checkpoint(t)),n||c.fastDispose(t)}),f.emit("checkpointsLoaded",{}),f.emit("checkpointRequestComplete",{})},statusCode:{401:function(){f.emit("sessionExpired",{})}},error:function(e){f.emit("checkpointRequestComplete",{}),s.showAlert("Uh oh!","Unable to load checkpoints")}})}function v(){h("")}function g(e){return r.filter(e,function(e){return e.isFromChild()})}function y(e,t,n){function o(){alert("Unable to load attendance.  Please try again later")}var i=4,s,u=r.after(i,function(){var e=r.map(s,function(e){var t=g(e.checkpoints());return t}),t=r.flatten(e);n(t)}),a=r.range(i);s=r.map(a,function(n){var r=new Date(e.getTime());r.setDate(r.getDate()-7*n);var i=m.create({onComplete:u,onError:o});return i.loadForDate(t,r.format("isoDate")),i})}var t=e("ko"),n=e("jquery"),r=e("lodash"),i=e("services/config"),s=e("services/alerts"),o=e("services/children"),u=e("services/employees"),a=e("model/checkpoint"),f=e("emit"),l=e("model/remote"),c=e("services/disposer"),h=t.observable(""),m=l.extend({className:"AttendanceStore",initialize:function(e){e=e||{};var n=this;n.demoCheckpoints=null,n.checkpoints=t.observableArray([]),n.onComplete=e.onComplete,l.initialize.call(n,{path:"/remote/v1/attendance/detail",method:"get",success:function(e){c.dispose(n.checkpoints()),n.checkpoints(r.map(e.checkpoints,function(e){return a.create(e)})),n.onComplete&&n.onComplete()},error:function(){s.showAlert("Oops!","Something went wrong on our end, please try again")}})},clear:function(){c.dispose(this.checkpoints()),this.checkpoints([]),l.clear.call(this)},reset:function(){this.clear()},loadForDate:function(e,t){this.processing(!0),this.clear();var n={location:e,group:"",date:t};i.isDemo?this.requestDemoData(n):this.makeRequest({data:n})},requestDemoData:function(e){function t(){var e=new Date;return e.setHours(8),e.setMinutes(Math.floor(Math.random()*17)),e.getTime()}if(!this.demoCheckpoints){var n=t(),i=t();this.demoCheckpoints=[a.create({key:"emp1",location:"demoLocationKey",group:"demoInfants",member:"demoEmployeeKey1",action:"in",in_time:t(),out_time:null,note:null,person_type:"employee"}),a.create({key:"emp2",location:"demoLocationKey",group:"demoToddlers",member:"demoEmployeeKey2",action:"in",in_time:t(),out_time:null,note:null,person_type:"employee"}),a.create({key:"1",location:"demoLocationKey",group:"demoInfants",member:"demokey1",action:"in",in_time:t(),out_time:null,note:null,person_type:"child"}),a.create({key:"2",location:"demoLocationKey",group:"demoInfants",member:"demokey2",action:"in",in_time:t(),out_time:null,note:null,person_type:"child"}),a.create({key:"3",location:"demoLocationKey",group:"demoInfants",member:"demokey4",action:"in",in_time:t(),out_time:null,note:null,person_type:"child"}),a.create({key:"4",location:"demoLocationKey",group:"demoToddlers",member:"demokey7",action:"in",in_time:t(),out_time:null,note:null,person_type:"child"}),a.create({key:"5",location:"demoLocationKey",group:"demoToddlers",member:"demokey9",action:"in",in_time:t(),out_time:null,note:null,person_type:"child"}),a.create({key:"5",location:"demoLocationKey",group:"demoToddlers",member:"demokey6",action:"vacation",in_time:n,out_time:n,note:null,person_type:"child"}),a.create({key:"6",location:"demoLocationKey",group:"demoInfants",member:"demokey3",action:"sick",in_time:i,out_time:i,note:"stomach flu",person_type:"child"})]}var s=(new Date).format("isoDate");this.checkpoints(r.filter(this.demoCheckpoints,function(){return e.date===s}))}}),b={locationCounter:h,load:i.isDemo?p:d,reset:v,AttendanceStore:m,loadHistoricalAttendance:y};return f.on("childrenLoaded",function(e){b.load(e.location)}),b}),tadpoles.define("services/parameterStore",["require","lodash","emit","model/remote","services/config"],function(e){function s(e,n){var r="demokey"+(e.length+1);return t.defaults(n,{key:r,family:r,location_name:"Weewons",has_image:n.image_attachment}),e.push(n),n}function o(e,n){e.guardians=e.guardians||[],n=t.clone(n),t.defaults(n,{key:e.key+"g"+e.guardians.length,type:"primary",has_image:n.image_attachment,mobile_number:n.type!=="medical"?"(267) 719-3764":null,work_number:"(267) 719-3764",home_number:n.type!=="medical"?"(267) 719-3764":null,email:n.type!=="medical"?"tadpoles@tadpoles.com":null,group:{key:e.key}}),e.guardians.push(n)}var t=e("lodash"),n=e("emit"),r=e("model/remote"),i=e("services/config"),u=r.extend({load:function(e,t){if(!i.isDemo)return;this.loadLocal(e)},loadLocal:function(e){var t=new Date,r=t.toISOString(),i=Math.floor(t.getTime()/1e3),u="demoLocationKey",a=[{key:"demoInfants",name:"Turtles",child_type:"infant",curriculum_id:"infant"},{key:"demoToddlers",name:"Cubs",child_type:"toddler",curriculum_id:"toddler"},{key:"demoPreschool",name:"Tigers",child_type:"preschool",curriculum_id:"preschool"},{key:"demoSchool",name:"Bears",child_type:"school",curriculum_id:"school"},{key:"demoSchool2",name:"Giraffes",child_type:"school",curriculum_id:"school"}],f=[],l={first_name:"Dr. Smith",type:"medical"},c=s(f,{first_name:"Jacob",last_name:"Anders",en:"Morning",image_attachment:"demokid3",note:"Milk allergy",special_note:"Call Mom on reaction",group:a[0],homeroom_key:a[0].key,last_checkpoint:{action:"in",action_time:i,in_time:r},birth_date:"2/3/2010",sb:15,status:"active",labels:["allergy"]});o(c,{image_attachment:"demodad1",first_name:"Sam",last_name:"Anders"}),o(c,{image_attachment:"demomom1",first_name:"Kelly",last_name:"Anders"}),o(c,l),c=s(f,{first_name:"Maya",last_name:"Diaz",image_attachment:"demo1",note:"Nut allergy",special_note:"Special Note 1",en:"Afternoon",group:a[0],homeroom_key:a[0].key,last_checkpoint:{action:"in",action_time:i,in_time:r},birth_date:"2/5/2012",sb:23,status:"active",labels:["allergy"]}),o(c,{first_name:"John",last_name:"Diaz"}),o(c,l),c=s(f,{first_name:"Grayson",last_name:"Moore",en:"Afternoon",image_attachment:"demokid2",note:"Uses nebulizer",special_note:"Special Note 1",group:a[0],homeroom_key:a[0].key,last_checkpoint:{action:"sick",action_time:i},birth_date:"5/10/2011",sb:24,status:"active",labels:["allergy"]}),o(c,{first_name:"Melissa",last_name:"Moore"}),o(c,l),c=s(f,{first_name:"Cameryn",last_name:"Bailey",image_attachment:"demokid1",note:"Learning letters",special_note:"Special Note 1",group:a[0],homeroom_key:a[0].key,last_checkpoint:{action:"in",action_time:i,in_time:r},birth_date:"8/15/2010",sb:14,status:"active"}),o(c,{first_name:"Samantha",last_name:"Bailey"}),o(c,l),c=s(f,{first_name:"Emma",last_name:"Nelson",image_attachment:"demo9",note:"Developing Social Skills",special_note:"Special Note 1",group:a[1],homeroom_key:a[1].key,last_checkpoint:{action:"out"},birth_date:"4/20/2010",sb:15,status:"active"}),o(c,{first_name:"Amy",last_name:"Nelson"}),o(c,l),c=s(f,{first_name:"Elly",last_name:"Hall",image_attachment:"demokid4",note:"Call Mom",special_note:"Special Note 1",group:a[1],homeroom_key:a[1].key,last_checkpoint:{action:"vacation",action_time:i},birth_date:"1/24/2009",sb:16,status:"active"}),o(c,{first_name:"James",last_name:"Hall"}),o(c,l),c=s(f,{first_name:"Michael",last_name:"Martin",image_attachment:"demo5",note:"",special_note:"Special Note 1",group:a[1],homeroom_key:a[1].key,last_checkpoint:{action:"in",action_time:i,in_time:r},birth_date:"12/28/2010",sb:13,status:"active"}),o(c,{first_name:"Kristen",last_name:"Martin"}),o(c,l),c=s(f,{first_name:"Alexis",last_name:"Clark",image_attachment:"demokid5",note:"Egg allergy",special_note:"Special Note 1",group:a[1],homeroom_key:a[1].key,last_checkpoint:{action:"out",action_time:i},birth_date:"03/13/2009",sb:11,status:"active",labels:["allergy"]}),o(c,{first_name:"Alyssa",last_name:"Clark"}),o(c,l),c=s(f,{first_name:"Sophia",last_name:"Jackson",image_attachment:"demo7",note:"Likes to read",special_note:"Special Note 1",group:a[1],homeroom_key:a[1].key,last_checkpoint:{action:"in",action_time:i,in_time:r},birth_date:"07/14/2010",sb:14,status:"active"}),o(c,{first_name:"Maryann",last_name:"Jackson"}),o(c,l);var h={location:e,groups:a,reminders:[{message:"Go live with your childcare center by logging in and registering!"},{message:"Jacob is due for a medical update."}],user:{key:"demoPerson1",display_name:"Demo User",role:"AccountAdmin"},dependants:f};n.emit("activeChildrenLoaded",h),n.emit("parameterRequestComplete")}});return u.create()}),tadpoles.define("model/signup",["ko","services/modal","model/requestResults"],function(e,t,n){var r=t.extend({className:"Signup",initialize:function(e){e=e||{};var n=this;t.initialize.call(n,{template:e.template,model:n,width:e.width})}});return r.create({template:"view/modals/signup",width:500})}),tadpoles.define("chart/dataTable",["require","lodash","selfish","utilities"],function(e){var t=e("lodash"),n=e("selfish"),r=e("utilities"),i=n.Base.extend({className:"DataTable",initialize:function(){},createBuckets:function(e,n,r){var i=e-e%r,s=n-n%r+r,o=t.range(i,s,r);return o},initializeArray:function(e,t){var n=[],r;for(r=0;r<e;r+=1)n[r]=t;return n},convertTimesToStrings:function(e){var n=t.map(e,function(e){return[(new Date(e[0])).format("shortTime"),e[1]]});return n},flattenElements:function(e){var n=t.map(e,function(e){return t.flatten(e)});return n},convertClassKeysToNames:function(e,n){var r=t.map(e,function(e){if(e==="all")return"All";var t=n[e];return t?t.name():"School"});return r},appendSeriesLabels:function(e,n,r){return r.unshift(t.flatten([n,e])),r}});return Math.nrand=function(){var e,t,n;do e=2*this.random()-1,t=2*this.random()-1,n=e*e+t*t;while(n>=1||n===0);var r=this.sqrt(-2*Math.log(n)/n);return e*r},r.makeSingleton(i)}),tadpoles.define("chart/attendance",["require","google","lodash","services/analytics","ko","services/modal","jstz","model/checkpoint","chart/dataTable","utilities","services/checkpointStore","model/globalFilter"],function(e){function g(){var e=225,t=0;try{t=window.innerHeight}catch(n){}if(t===0)try{t=window.screen.height}catch(n){}return t===0&&(t=1024),t-e}function y(e){if(!e||e.length===0)return;var t=(new Date).getTime();return r.each(e,function(e){e.inTime()&&e.inTime().getTime()<t&&(t=e.inTime().getTime())}),t}function b(e){if(!e||e.length===0)return;var t=0;return r.each(e,function(e){e.inTime()&&e.inTime().getTime()>t&&(t=e.inTime().getTime()),e.outTime()&&e.outTime().getTime()>t&&(t=e.outTime().getTime())}),t}function w(e,t,n){e||(e=(new Date).getTime());var r=new Date(e);return r.setHours(t),r.setSeconds(0),r.setMinutes(n),r.setMilliseconds(0),r.getTime()}function E(e){return w(e,6,0)}function S(e){return w(e,20,0)}function x(e,t){var n=y(e)-t,r=b(e)+t,i=E(n),s=S(n),o=l.getInstance().createBuckets(i,s,t);return o}function T(e,t){var n=(new Date).getTime()+t,i=r.map(e,function(e){var t=e[1];if(e[0]>n){var r=t?t.length:0;t=l.getInstance().initializeArray(r,null)}return[e[0],t]});return i}function N(e){if(c.isNull(e)||e<1)e=1;return e}function C(e,t,n){var i=l.getInstance().initializeArray(t.length,0);return r.each(e,function(e){r.each(t,function(t,r){e.wasInClassroomAtTimeWithoutDate(t,n.key)&&(i[r]+=1)})}),i}function k(e,t){var n=r.zip(e,t),i=r.map(n,function(e){var t=e[0],n=e[1];return n==0&&t>0?-1:n==0&&t==0?0:Math.round(t/n*10)/10});return i}function L(e,t){return e=N(e),r.map(t,function(t){return Math.round(10*t/e)/10})}function A(e,t,n,r,i){return C(t,r,i)}function O(e,t,n,r,i){var s=C(t,r,i),o=C(n,r,i),u=k(s,o);return u}function M(e,t,n,r,i,s){return L(e,C(n,i,s))}function _(e,t){var n=r.zip(e,t),i=r.map(n,function(e){return e[1]-e[0]});return i}function D(e,t,n){var i=C(e,t,n),s=n.requiredRatio(),o=r.map(i,function(e){return s*e});return o}function P(e,t,n,r,i){var s=C(t,r,i),o=D(n,r,i),u=_(s,o);return u}function H(e,t){var n={};return r.each(t,function(t,i){var s=[];r.each(e,function(e){e.hadVisitedClass(i)&&s.push(e)}),s.length>0&&(n[i]=s)}),n}function B(e,t,n,i){var s=c.transpose(e),o=r.zip(t,s);n&&(o=T(o,i));var u=l.getInstance().convertTimesToStrings(o),a=l.getInstance().flattenElements(u);return a}function j(e){return r.filter(e,function(e){return e.isFromChild()})}function F(e){return r.filter(e,function(e){return e.isFromEmployee()})}function I(e,t){var n=r.keys(e),i=l.getInstance().convertClassKeysToNames(n,t);return i}function q(e,t){return[t([],[],[],e,"None")]}function R(e,t,n,i){var s=r.map(e,function(e,r){var s=j(e),o=F(e);return i(e,s,o,t,n[r])});return s}function U(e,t,n,r){var i=9e5,s,o,u=x(e,i);if(e.length==0)s=["None"],o=q(u,r);else{var a=H(e,t);s=I(a,t),o=R(a,u,t,r)}var f=B(o,u,n,i),c=l.getInstance().appendSeriesLabels(s,"Time",f);return c}function z(e,t,n,i){var s=9e5,o=x(e,s),u=j(e),a=F(e),f={kids:u,staff:a},c=r.map(f,function(e,t){return i([],e,[],o,t)}),h=B(c,o,n,s);return l.getInstance().appendSeriesLabels(["kids","staff"],"Time",h),h}function W(e){var i=e.checkpoints,s=e.groupsByKey,o,u=e.logScale||!1,a=e.height||g()-20,f=e.width||v-20,l=e.shouldNullFuture||!1,c="none",h,p,d,y=e.title||"",b=e.domId||"attendance_chart_div",w=e.exportId||"toolbar_div",E=e.filename||"",S=document.getElementById(b);if(!t){S.style.visibility="hidden";return}S.style.visibility="visible",e.chartType===V.Counts&&(h=A,o=!0,p=U,d=p(i,s,l,h)),e.chartType===V.InRatio&&(h=O,o=!1,p=U,d=p(i,s,l,h));var x={animation:{duration:2e3},title:y,backgroundColor:"white",chartArea:{width:"85%",height:"76%"},height:a,width:f,legend:{position:"none"},titlePosition:"in",axisTitlesPosition:"out",hAxis:{textPosition:"out",textStyle:{color:"black"},showTextEvery:8,maxAlternation:0},vAxis:{textPosition:"out",gridlines:{count:4},logScale:u},focusTarget:"category",curveType:c,isStacked:o};e.chartType===V.TrailingAverage&&(h=r.curry(M)(m),o=!0,p=U,d=p(i,s,l,h),c="function",a=Math.round(g()/2)-5,f/=2,x={animation:{duration:2e3},title:y,backgroundColor:"white",chartArea:{width:"100%",height:"100%"},height:a,width:f,legend:{position:"none"},titlePosition:"in",axisTitlesPosition:"none",hAxis:{textPosition:"none",textStyle:{color:"black"},showTextEvery:8,maxAlternation:0},vAxis:{textPosition:"out",gridlines:{count:4},logScale:u},focusTarget:"category",curveType:c,isStacked:o,tooltip:{showColorCode:!0,ignoreBounds:!0,isHtml:!0,textStyle:{fontSize:10}}});var T=n.visualization.arrayToDataTable(d);if(S){var N=e.chartType===V.InRatio?new n.visualization.AreaChart(S):new n.visualization.AreaChart(S),C=function(){var e=N.getContainer(),t=e.querySelector("div.google-visualization-tooltip");t&&(t.offsetLeft<=t.clientWidth&&(t.style.left=t.offsetLeft+t.clientWidth+60+"px"),t.style.top=0)};n.visualization.events.addListener(N,"onmouseover",C),n.visualization.events.addListener(N,"select",C),N.draw(T,x),X(d,E,w,y)}}function X(e,t,n,r){var i=p.date().format("isoDate"),s=document.getElementById(n),o=e.join("\r\n"),u=[t,"-",r?r+"-":"",i,".csv"].join("").replace(/\s+/g,"-"),a=r?"Export "+r:"Export to CSV",f='<a href="data:application/octet-stream,'+encodeURIComponent(o)+'" download="'+encodeURIComponent(u)+'">'+'<button class="pull-left btn btn-mini btn-success" style="margin-top:8px;margin-left:4px;">'+a+"</button> </a>";s.innerHTML=f}function K(e,t){var n=Math.nrand()*e,r,i;return n>0?(r=Math.floor(n/60+t),i=Math.round(n%60)):(r=Math.ceil(n/60+t)-1,i=60+Math.round(n%60)),w(null,r,i)}function Q(){return K(55,8.5)}function G(){return K(70,16.4)}function Y(e,t,n){var i=Q(),s=G();return r.defaults({member_key:t,in_time:i,out_time:s},n)}function Z(e){var t=Math.random()*5+9,n=r.range(t),i=a.determine(),s={action:"out",location:"l1",group:e,source:"local",cut:(new Date).getTime(),tz:i.name(),person_type:"child"},o=r.map(n,function(t){return Y(e,t,s)});return r.map(o,function(e){return f.create(e)})}function et(){return["Dinomites","Sunbeams","Little Ones","Munchkins","Sunflowers","Teetertots","Giraffes","Rhinos","Leopards","Tigers"]}function tt(){function e(e){this.groupName=e}e.prototype.name=function(){return this.groupName};var t=et(),n=r.map(t,function(t){return new e(t)}),i=r.object(t,n);return i}function nt(e){function s(){W({checkpoints:n,groupsByKey:i,height:e.height,width:e.width,chartType:V.Counts,shouldNullFuture:!1})}var n=r.flatten(r.map(et(),Z)),i=tt();t?s():d=s}var t=!1,n=e("google"),r=e("lodash"),i=e("services/analytics"),s=e("ko"),o,u=e("services/modal"),a=e("jstz"),f=e("model/checkpoint"),l=e("chart/dataTable"),c=e("utilities"),h=e("services/checkpointStore"),p=e("model/globalFilter"),d=null,v=1e3,m=4;n.load("visualization","1",{packages:["corechart"],callback:function(){t=!0,d&&(d(),d=null)}});var V={Counts:1,InRatio:2,TrailingAverage:3},$=new Array(7);$[0]="Sunday",$[1]="Monday",$[2]="Tuesday",$[3]="Wednesday",$[4]="Thursday",$[5]="Friday",$[6]="Saturday";var J=u.extend({className:"AttendanceChartModal",initialize:function(e){var t=this;t.activeType=s.observable(V.Counts),t.countsTypeActive=s.pureComputed(function(){return t.activeType()===V.Counts}),t.inRatioTypeActive=s.pureComputed(function(){return t.activeType()===V.InRatio}),t.averageTypeActive=s.pureComputed(function(){return t.activeType()===V.TrailingAverage}),t.title=s.pureComputed(function(){if(t.countsTypeActive())return"15 minute counts";if(t.inRatioTypeActive())return"Ratios";if(t.averageTypeActive())return"Average classroom counts"}),t.subTitle=s.pureComputed(function(){if(t.countsTypeActive())return"Number of children in each classroom";if(t.inRatioTypeActive())return"Student to teacher ratio for each classroom every 15 minutes.  -1 indicates no teacher.";if(t.averageTypeActive())return"From the last 4 weeks.  (e.g. Last 4 Mondays, Last 4 Tuesdays...)"}),t.checkpointSubscription=null,u.initialize.call(t,e)},close:function(){this.checkpointSubscription&&this.checkpointSubscription.dispose(),u.close.call(this)},draw:function(e){e=e||{};var t=e.checkpoints;if(!this.checkpointsFunc&&!t)return;W({checkpoints:t||this.checkpointsFunc(),groupsByKey:this.groupsByKey,chartType:this.activeType(),shouldNullFuture:!0,domId:e.domId,exportId:e.exportId,title:e.title,filename:this.title()})},show:function(e,t){this.open(),this.todaysCheckpointFunc=e,this.checkpointsFunc=e;var n=this;this.todaysCheckpointFunc.subscribe(function(){n.shouldRedrawOnChanges()&&n.draw()}),this.groupsByKey=t,this.draw()},shouldRedrawOnChanges:function(){return this.countsTypeActive()||this.inRatioTypeActive()},useTodaysChecktpoints:function(){this.checkpointsFunc=this.todaysCheckpointFunc},chooseTypeCounts:function(){this.activeType(V.Counts),this.useTodaysChecktpoints(),this.draw()},chooseTypeInRatio:function(){this.activeType(V.InRatio),this.useTodaysChecktpoints(),this.draw()},chooseTypeAverage:function(){var e=this;this.activeType(V.TrailingAverage);var t=p.location().key,n=new Date,i=r.range(7);r.each(i,function(r){var i=new Date;i.setDate(n.getDate()-r);var s=i.getDay();if(s==0||s===6)return;var o="attendance_chart_"+s,u="toolbar_div_"+s,a=$[s];h.loadHistoricalAttendance(i,t,function(t){e.draw({checkpoints:t,domId:o,title:a,exportId:u})})})}});return o=J.create({template:"view/modals/attendanceChart",width:v+20}),{show:function(e,t){o.show(e,t);try{i.trackEvent("Graph","15MinuteCounts")}catch(n){}},drawSampleCounts:nt}}),tadpoles.define("report/attendanceDataType",["require"],function(e){return DataType={Times:1,Hours:2,Transitions:3,NamesToFaces:4,Planning:5,MealDistribution:6}}),tadpoles.define("model/weeklyAttendance",["require","ko","lodash","selfish","services/config","services/alerts","model/remote","model/globalFilter","services/groups","model/checkpoint","model/product","services/children","emit","report/attendanceDataType","model/attendancePersons"],function(e){function m(e,t){return Math.floor(Math.random()*(t-e+1))+e}function g(e){var t=e.match(/(\d+)/g);return new Date(t[0],t[1]-1,t[2])}var t=e("ko"),n=e("lodash"),r=e("selfish"),i=e("services/config"),s=e("services/alerts"),o=e("model/remote"),u=e("model/globalFilter"),a=e("services/groups"),f=e("model/checkpoint"),l=e("model/product"),c=e("services/children"),h=e("emit"),p=e("report/attendanceDataType"),d=e("model/attendancePersons"),v=null,y=r.Base.extend({className:"DayAttendance",initialize:function(e,r,i,s){var o=this;o.trackableKey=e.trackable_key,o.date=g(e.date),o.personType=r,o.status=t.observable(e.status),o.note=t.observable(e.note),o.checkpoints=t.observable(),o.checkpoints.subscribe(function(e){n.each(e,function(e){e.getMealHistory()})}),o.checkpoints(n.map(e.checkpoints,function(e){return f.create(e)})),o.dayHomeroomKey=e.homeroom_key,o.scheduled=e.scheduled,o.planned_absence=e.absence,o.reportGroupKey=i,o.haveCompleteStats=s,o.wasOut=t.pureComputed(function(){return o.status()=="vacation"||o.status()=="sick"||o.status()=="other"}),o.wasOutAllDay=t.pureComputed(function(){return o.wasOut()&&n(o.checkpoints()).every(function(e){return e.wasAbsent()})}),o.seconds=t.pureComputed(function(){var e=n(o.checkpoints()).reduce(function(e,t){return e+t.seconds()},0);return o.wasOutAllDay()?0:e}),o.hours=t.pureComputed(function(){return Math.round(o.seconds()/3600*10)/10}),o.transitions=t.pureComputed(function(){var e=[];return n(o.checkpoints()).each(function(t){if(!t.wasAbsent()){var r=t.activityHistory("tiny");n(r).each(function(t){e.push(t)})}}),e}),o.namesToFaces=t.pureComputed(function(){var e=[];return n(o.checkpoints()).each(function(t){if(!t.wasAbsent()){var r=t.ntfHistory();n(r).each(function(t){e.push(t)})}}),e}),o.hadBreakfast=t.pureComputed(function(){return n.find(o.checkpoints(),function(e){return e.hadBreakfast()})}),o.hadLunch=t.pureComputed(function(){return n.find(o.checkpoints(),function(e){return e.hadLunch()})}),o.hadDinner=t.pureComputed(function(){return n.find(o.checkpoints(),function(e){return e.hadDinner()})}),o.hadAMSnack=t.pureComputed(function(){return n.find(o.checkpoints(),function(e){return e.hadAMSnack()})}),o.hadPMSnack=t.pureComputed(function(){return n.find(o.checkpoints(),function(e){return e.hadPMSnack()})}),o.hadLateSnack=t.pureComputed(function(){return n.find(o.checkpoints(),function(e){return e.hadLateSnack()})}),o.hadSnack=t.pureComputed(function(){return o.hadAMSnack()||o.hadPMSnack()||o.hadLateSnack()})},hasMultipleNonAbsence:function(){var e=n(this.checkpoints()).reduce(function(e,t){return t.wasAbsent()?e:e+1},0);return e>1},display:function(){return this.personType===d.Sick?this.note():this.status()},isSickReport:function(){return this.personType===d.Sick},isFirstNonAbsence:function(e){var t=n(this.checkpoints()).findIndex(function(e){return!e.wasAbsent()});return e==t},edit:function(){this.isEditable()&&f.editMultiple(this.checkpoints(),this.trackableKey,this.date,this.isSickReport())},isEditable:function(){return this.date.getTime()<=(new Date).setHours(0,0,0,0)&&(!this.haveCompleteStats||this.personType!=d.Students||this.dayHomeroomKey==this.reportGroupKey)},defaultBackgroundColor:function(){return this.scheduled?"#959595":this.checkpoints().length>0?"rgb(240, 150, 150)":"rgb(207, 207, 207)"},absenceBackgroundColor:function(e){return e?"rgb(100, 190, 220)":"rgb(171, 149, 180)"},planningBackgroundColor:function(){return this.scheduled&&this.planned_absence?"rgb(171, 149, 180)":this.defaultBackgroundColor()},inCellBackgroundColor:function(){return this.wasOut()&&this.checkpoints().length>0&&this.checkpoints()[0].wasAbsent()?this.absenceBackgroundColor(this.checkpoints()[0].wasSick()):this.defaultBackgroundColor()},outCellBackgroundColor:function(){return this.wasOut()&&this.checkpoints().length>0&&this.checkpoints()[this.checkpoints().length-1].wasAbsent()?this.absenceBackgroundColor(this.checkpoints()[this.checkpoints().length-1].wasSick()):this.defaultBackgroundColor()},hoursOrTransitionsCellBackgroundColor:function(){return this.wasOut()?this.absenceBackgroundColor(this.status()=="sick"):this.defaultBackgroundColor()}}),b=40,w=r.Base.extend({className:"StudentWeeklyAttendance",initialize:function(e,r,i,s,o){var u=this;u.monthlyReport=t.observable(o),u.trackableKey=e.trackable_key,u.firstName=e.first_name,u.lastName=e.last_name,u.birthDate=e.birthDate?"DOB "+e.birthDate.format("shortDate"):"",u.childKey=e.childKey,u.dailyAttendance=n.map(e.attendance,function(e){return y.create(e,r,i,s)}),u.attendance=t.pureComputed(function(){return u.monthlyReport()?u.dailyAttendance:u.dailyAttendance.slice(0,5)}),u.hours=t.pureComputed(function(){var e=n(u.attendance()).reduce(function(e,t){return e+t.seconds()},0);return Math.round(e/3600*10)/10}),u.regularHours=t.pureComputed(function(){return r!=="students"&&u.hours()>b?b:u.hours()}),u.overtimeHours=t.pureComputed(function(){return u.hours()>b?u.hours()-b:0}),u.totalBreakfastDistributions=t.pureComputed(function(){return n(u.attendance()).reduce(function(e,t){return e+(t.hadBreakfast()?1:0)},0)}),u.totalLunchDistributions=t.pureComputed(function(){return n(u.attendance()).reduce(function(e,t){return e+(t.hadLunch()?1:0)},0)}),u.totalDinnerDistributions=t.pureComputed(function(){return n(u.attendance()).reduce(function(e,t){return e+(t.hadDinner()?1:0)},0)}),u.totalAMSnackDistributions=t.pureComputed(function(){return n(u.attendance()).reduce(function(e,t){return e+(t.hadAMSnack()?1:0)},0)}),u.totalPMSnackDistributions=t.pureComputed(function(){return n(u.attendance()).reduce(function(e,t){return e+(t.hadPMSnack()?1:0)},0)}),u.totalLateSnackDistributions=t.pureComputed(function(){return n(u.attendance()).reduce(function(e,t){return e+(t.hadLateSnack()?1:0)},0)}),u.totalMealDistributions=t.pureComputed(function(){return n(u.attendance()).reduce(function(e,t){return e+n(t.checkpoints()).reduce(function(e,t){return e+t.mealHistory().length},0)},0)}),h.on("active-attendance-report",function(e){e!==p.MealDistribution&&u.monthlyReport(!1)})}}),E=o.extend({className:"WeeklyAttendance",initialize:function(e){e=e||{};var r=this;r.monthlyReport=t.observable(!1),r.studentsAttendance=t.observableArray([]),r.dates=t.observableArray(),r.numScheduledIn=t.observableArray([0,0,0,0,0]),r.totalBreakfastDistributions=t.pureComputed(function(){return n(r.studentsAttendance()).reduce(function(e,t){return e+t.totalBreakfastDistributions()},0)}),r.totalLunchDistributions=t.pureComputed(function(){return n(r.studentsAttendance()).reduce(function(e,t){return e+t.totalLunchDistributions()},0)}),r.totalDinnerDistributions=t.pureComputed(function(){return n(r.studentsAttendance()).reduce(function(e,t){return e+t.totalDinnerDistributions()},0)}),r.totalAMSnackDistributions=t.pureComputed(function(){return n(r.studentsAttendance()).reduce(function(e,t){return e+t.totalAMSnackDistributions()},0)}),r.totalPMSnackDistributions=t.pureComputed(function(){return n(r.studentsAttendance()).reduce(function(e,t){return e+t.totalPMSnackDistributions()},0)}),r.totalLateSnackDistributions=t.pureComputed(function(){return n(r.studentsAttendance()).reduce(function(e,t){return e+t.totalLateSnackDistributions()},0)}),r.totalSnackDistributions=t.pureComputed(function(){return r.totalAMSnackDistributions()+r.totalPMSnackDistributions()+r.totalLateSnackDistributions()}),r.totalMealDistributions=t.pureComputed(function(){return n(r.studentsAttendance()).reduce(function(e,t){return e+t.totalMealDistributions()},0)}),h.on("active-attendance-report",function(e){r.monthlyReport(e===p.MealDistribution)}),o.initialize.call(r,{path:"/remote/v1/attendance/weekly",method:"post",success:function(e){r.dates(n.map(e.dates,function(e){return g(e)})),r.numScheduledIn(e.num_scheduled_in),r.haveCompleteStats=e.have_complete_stats;var t=c.getInstance();r.studentsAttendance(n.map(e.students_attendance,function(n){if(e.person_type==="students"){var i=t.getChild(n.trackable_key);i&&(n.birthDate=l.dobOnStudentAttendanceReport()?i.birthDate():"",n.childKey=i.key)}return w.create(n,e.person_type,r.group,r.haveCompleteStats,r.monthlyReport())})),r.processing(!1)},error:function(){r.processing(!1),s.showAlert("Oops!","Something went wrong on our end, please try again")}}),h.on("checkpoints-edited",function(e){var t=n.find(r.studentsAttendance(),{trackableKey:e.trackableKey});if(!t)return;var i=n.find(t.attendance(),{date:e.date});if(!i)return;i.checkpoints(n.reject(e.checkpoints,"deleted"));var s=n(i.checkpoints()).find(function(e){return e.wasAbsent()});if(s){i.status(s.action==="excused"?"other":s.action);var o=n(i.checkpoints()).reduce(function(e,t){var n=e;return t.note&&(e?n+=", "+t.note:n=t.note),n},null);i.note(o)}else i.status(null),i.note(null)})},clear:function(){this.studentsAttendance([]),this.dates([]),o.clear.call(this)},reset:function(){this.clear()},load:function(e,n,r){this.group=e,this.processing(!0),this.clear();var s=u.location().key,o={location:s,group:e,date:n,person_type:r,monthly:this.monthlyReport()};i.isDemo?this.requestDemoData(o):this.makeRequest({data:{attendance:t.toJSON(o)}})},getDatesForWeek:function(e){var t=g(e);t.setDate(t.getDate()-t.getDay()),t.setDate(t.getDate()+1);var n=[];for(;;){n.push(new Date(t)),t.setDate(t.getDate()+1);if(t.getDay()===6)break}return n},createDemoCheckpointsForPersonAndDay:function(e,t,n){var r=252e5,i=324e5,s=414e5,o=441e5,u=459e5,a=486e5,f=576e5,l=648e5,c=m(r,i),h=m(s,o),p=m(u,a),v=m(f,l),g=new Date(t.valueOf()+c),y=new Date(t.valueOf()+h),b=new Date(t.valueOf()+p),w=new Date(t.valueOf()+v),E=new Date;if(t>E)return[];if(t.format("isoDate")===E.format("isoDate"))if(n===d.Students){if(w>E)return[{action:"in",member:e,action_time:Math.floor(g.getTime()/1e3),in_time:g.toISOString()}]}else{if(y>E)return[{action:"in",member:e,action_time:Math.floor(g.getTime()/1e3),in_time:g.toISOString()}];if(w>E)return[{action:"out",member:e,action_time:Math.floor(y.getTime()/1e3),in_time:g.toISOString(),out_time:y.toISOString()},{action:"in",member:e,action_time:Math.floor(b.getTime()/1e3),in_time:b.toISOString()}]}return n===d.Staff?[{action:"out",member:e,action_time:Math.floor(y.getTime()/1e3),in_time:g.toISOString(),out_time:y.toISOString()},{action:"out",member:e,action_time:Math.floor(w.getTime()/1e3),in_time:b.toISOString(),out_time:w.toISOString()}]:[{action:"out",member:e,action_time:Math.floor(w.getTime()/1e3),in_time:g.toISOString(),out_time:w.toISOString()}]},createDemoWeekAttendanceForPerson:function(e,t,r,i){var s=this,o=this.getDatesForWeek(t),u=["croup","fever","vomiting","cold symptoms","earache"];return n(o).map(function(t){var n=t.format("isoDate")<(new Date).format("isoDate")&&m(0,5)===2?"sick":"normal";return{trackable_key:e,status:n,note:n==="sick"?u[m(0,u.length-1)]:"",date:t.format("isoDate"),checkpoints:i||n==="sick"?[]:s.createDemoCheckpointsForPersonAndDay(e,t,r)}}).value()},requestDemoData:function(e){var t=[],n=[],r;if(e.person_type===d.All||e.person_type===d.Staff)t.push(w.create({trackable_key:"demoEmployeeKey1",first_name:"Teach",last_name:"Wonders",attendance:this.createDemoWeekAttendanceForPerson("demoEmployeeKey1",e.date,d.Staff)},d.Staff)),t.push(w.create({trackable_key:"demoEmployeeKey2",first_name:"Teach",last_name:"Amazing",attendance:this.createDemoWeekAttendanceForPerson("demoEmployeeKey2",e.date,d.Staff)},d.Staff));if(e.person_type===d.All||e.person_type===d.Students||e.person_type===d.Sick)n=[w.create({trackable_key:"demoKey1",first_name:"Jacob",last_name:"Anders",attendance:this.createDemoWeekAttendanceForPerson("demoKey1",e.date,d.Students,e.person_type===d.Sick)},e.person_type),w.create({first_name:"Elly",last_name:"Hall",attendance:this.createDemoWeekAttendanceForPerson("demoKey6",e.date,d.Students,e.person_type===d.Sick)},e.person_type),w.create({first_name:"Sophia",last_name:"Jackson",attendance:this.createDemoWeekAttendanceForPerson("demoKey9",e.date,d.Students,e.person_type===d.Sick)},e.person_type),w.create({first_name:"Michael",last_name:"Martin",attendance:this.createDemoWeekAttendanceForPerson("demoKey7",e.date,d.Students,e.person_type===d.Sick)},e.person_type),w.create({first_name:"Grayson",last_name:"Moore",attendance:this.createDemoWeekAttendanceForPerson("demoKey3",e.date,d.Students,e.person_type===d.Sick)},e.person_type),w.create({first_name:"Emma",last_name:"Nelson",attendance:this.createDemoWeekAttendanceForPerson("demoKey5",e.date,d.Students,e.person_type===d.Sick)},e.person_type)];r=t.concat(n),this.studentsAttendance(r),this.dates(this.getDatesForWeek((new Date).format("isoDate")))}});return E}),tadpoles.define("report/attendance",["require","lodash","services/analytics","ko","services/config","services/modal","jstz","model/weeklyAttendance","services/groups","model/personTypeable","model/printable","utilities","model/globalFilter","emit","model/product","report/attendanceDataType","model/attendancePersons"],function(e){function g(e){var t=-e.getDay(),n=new Date(e.getFullYear(),e.getMonth(),e.getDate());return n.setDate(e.getDate()+t),n}var t=e("lodash"),n=e("services/analytics"),r=e("ko"),i=e("services/config"),s=e("services/modal");e("jstz");var o=e("model/weeklyAttendance"),u=e("services/groups"),a=e("model/personTypeable"),f=e("model/printable"),l=e("utilities"),c=e("model/globalFilter"),h=e("emit"),p=e("model/product"),d=e("report/attendanceDataType"),v=e("model/attendancePersons"),m={Weekly:1,Monthly:2},y=o.create(),b=s.extend(a,f,{className:"AttendanceReportModal",initialize:function(e){var n=this;f.initialize.call(n,"attendance-printable"),a.initialize.call(n),n.activePersons(v.Staff),n.activeType=r.observable(m.Weekly),n.dataType=r.observable(d.Times),n.weeklyTypeActive=r.pureComputed(function(){return n.activeType()===m.Weekly}),n.monthlyTypeActive=r.pureComputed(function(){return n.activeType()===m.Monthly}),n.timesActive=r.pureComputed(function(){return n.dataType()===d.Times}),n.hoursActive=r.pureComputed(function(){return n.dataType()===d.Hours}),n.transitionsActive=r.pureComputed(function(){return n.dataType()===d.Transitions}),n.namesToFacesActive=r.pureComputed(function(){return n.dataType()===d.NamesToFaces}),n.planningActive=r.pureComputed(function(){return n.dataType()===d.Planning}),n.mealDistributionActive=r.pureComputed(function(){return n.dataType()===d.MealDistribution}),n.studentWeeklyAttendance=r.observable(y),n.classrooms=r.pureComputed(function(){return u.getInstance().groupsForCurrentLocation()}),n.selectedClassroom=r.observable(),n.date=r.observable(g(new Date)),n.dateForDisplay=r.pureComputed(function(){return n.date()?n.date().format("tinyDate"):""}),n.dates=r.pureComputed(function(){var e=y.dates();if(!e||e.length<2)return;e=t.zip(e,y.numScheduledIn());var r=e.length>5&&n.mealDistributionActive(),i=g(e[0][0]);e.unshift([i,"-1"]);var s=p.getStartOfWeek();return r||(e=e.slice(0,6)),t(e).filter(function(e){return e[0]}).map(function(e,t){var n=t===0?"#FBB450":e[0].getDay()===s&&r?"#959595":"#A9A9A9",i=e[0].getDay()===e[0].getDay()!==s&&r?"#f3f3f3":"white",o=e[0].format("ddd").toLowerCase(),u=r?t===0?e[0].format("mmm").toLowerCase():o[0]:t===0?"week":o,a=e[0].format("tinyDate"),f=r?t===0?e[0].format("yyyy"):e[0].getDate()+"":a;return{name:u,date:f,bg:n,color:i,numScheduledIn:e[1]}}).value()}),n.isMonthly=r.pureComputed(function(){return n.dates()&&n.dates().length>5&&n.mealDistributionActive()}),n.datepickerMaxDate=r.pureComputed(function(){return n.planningActive()?null:0}),n.datepickerOptions=r.pureComputed(function(){var e=n.planningActive()?null:0;return"{ maxDate : "+e+", selectWeek: false }"}),n.selectedClassroom.subscribe(this.draw),n.date.subscribe(this.draw),n.activePersons.subscribe(function(e){e!==v.Students&&n.dataType()===d.MealDistribution&&n.dataType(d.Hours),n.draw()}),n.dataTypeLastValue=r.observable(n.dataType()),n.dataType.subscribe(function(e){if(e===n.dataTypeLastValue())return;var t=n.dataTypeLastValue();n.dataTypeLastValue(e);if(e===d.Planning||t===d.Planning)n.date(new Date),n.draw();h.emit("active-attendance-report",e)}),n.processing=y.processing,n.titleText=r.pureComputed(function(){return i.locations.length>1?"for "+c.location().name+" - "+n.selectedClassroom().name():"for "+n.selectedClassroom().name()}),n.exportRequestHref=r.pureComputed(function(){var e=n.date();if(!e)return"";var t=n.selectedClassroom();if(!t)return"";var r=e.format("isoDate");return"/remote/v1/attendance/meal_distributions/"+t.key+"/"+r}),s.initialize.call(n,e)},close:function(){s.close.call(this)},draw:function(){var e,t=this.selectedClassroom();if(!t&&this.studentsActive())return;t&&this.studentsActive()&&(e=t.key);var n=this.date();if(!n)return;var r=n.format("isoDate");y.load(e,r,this.activePersons())},show:function(){this.open(),this.date(this.date());var e=this;if(i.isDemo){var t=e.classrooms()[0];e.selectedClassroom(t)}},chooseTypeWeekly:function(){this.activeType(m.Weekly),this.draw()},chooseTypeMonthly:function(){this.activeType(m.Monthly),this.draw()},chooseTimes:function(){this.dataType(d.Times)},chooseHours:function(){this.dataType(d.Hours)},chooseTransitions:function(){this.dataType(d.Transitions)},chooseNamesToFaces:function(){this.dataType(d.NamesToFaces)},choosePlanning:function(){this.dataType(d.Planning)},chooseMealDistribution:function(){this.dataType(d.MealDistribution),this.draw()}}),w=l.makeSingleton(b,{template:"view/modals/attendanceReport",width:918});return{show:function(){w.getInstance().show();try{n.trackEvent("Report","Attendance")}catch(e){}}}}),tadpoles.define("model/attendanceDetails",["require","ko","lodash","services/config","model/globalFilter","model/checkpoint","emit","model/detailViewPanel","services/checkpointStore","services/disposer","chart/attendance","report/attendance"],function(e){var t=e("ko"),n=e("lodash"),r=e("services/config"),i=e("model/globalFilter"),s=e("model/checkpoint"),o=e("emit"),u=e("model/detailViewPanel"),a=e("services/checkpointStore").AttendanceStore,f=e("services/disposer"),l=a.extend({className:"AttendanceDetails",initialize:function(e){e=e||{};var f=this;a.initialize(f),f.groups=e.groups,f.filteredCheckpoints=t.pureComputed(function(){return n.filter(f.checkpoints(),function(e){return e.location!==i.location().key||i.groupSelected()&&e.group!==i.group().key?!1:e.childDisplayName().toLowerCase().indexOf(i.name().toLowerCase())===-1?!1:u.getInstance().staffActive()&&e.person_type!==s.PersonType.Employee?!1:u.getInstance().studentsActive()&&e.person_type!==s.PersonType.Child?!1:!0})}),o.on("checkpoint-received",function(e){f.processCheckpointNotification(e)}),o.on("locationChangeComplete",function(){n.each(f.checkpoints(),function(e){e.updatePerson()})}),o.on("employeeLoadComplete",function(){n.each(f.checkpoints(),function(e){e.updatePerson()})}),o.on("attendanceChanged",function(e){if(!r.isDemo)return;f.processDemoCheckpoint(e)}),o.on("checkpoints-edited",function(e){n.each(e.checkpoints,function(e){f.processCheckpointNotification(e)})}),i.date.subscribe(f.load),i.location.subscribe(f.load)},processDemoCheckpoint:function(e){function t(t){return e.checkpoint.action==="out"&&t.child_key===e.key&&t.inTime()&&!t.outTime()}var r=this.checkpoints.remove(t);if(r.length>0){this.demoCheckpoints=n.reject(this.demoCheckpoints,t);var i=r[0];i.outTime(new Date),this.checkpoints.unshift(i),this.demoCheckpoints.unshift(i)}else{var o=s.create({key:(new Date).getTime(),location:e.location||"",group:e.group,member:e.key,action:e.checkpoint.action,in_time:e.checkpoint.action==="in"?new Date(e.checkpoint.cut):null,out_time:e.checkpoint.action==="out"?new Date(e.checkpoint.cut):null,note:null});this.checkpoints.unshift(o),this.demoCheckpoints.unshift(o)}},processCheckpointNotification:function(e,t){var n=this;if(e.location!==i.location().key)return;if(e.inTime()&&e.inTime().format("isoDate")!==i.date().format("isoDate"))return;var r=n.checkpoints.remove(function(t){return t.key===e.key});f.fastDispose(r),n.checkpoints.unshift(e)},load:function(){console.log("loading attendance details");var e=i.location().key,t=i.date().format("isoDate");this.loadForDate(e,t)},exportData:function(){if(r.isDemo){o.emit("liveFeatureOnly",{});return}var e=i.location().key,t=i.groupSelected()?i.group().key:"",n=i.date().format("isoDate");window.location.href="/remote/v1/attendance/detail?output=csv&location="+e+"&group="+t+"&date="+n},graphAttendance:function(){var t=e("chart/attendance");return t.show(this.checkpoints,this.groups.groupsByKey())},reportAttendance:function(){var t=e("report/attendance");return t.show(this.groups.groupsByKey())}});return l}),tadpoles.define("model/branding",["require","ko","jquery","model/remote","services/alerts","services/uuid","services/modal","model/product","services/fileUpload"],function(e){var t=e("ko"),n=e("jquery"),r=e("model/remote"),i=e("services/alerts"),s=e("services/uuid"),o=e("services/modal"),u=e("model/product");e("services/fileUpload");var a=o.create({template:"view/modals/editAccountBranding",width:"640px",model:null}),f=r.extend({className:"Branding",initialize:function(e){var n=this;r.initialize.call(n,{path:"/remote/v1/brandimage",method:"post",error:function(e,t){n.showSpin(!1);var r=t?t:"Something went wrong on our end, please try again";i.showAlert("Oops!",r)},success:function(e){n.showSpin(!1),n.reset(),n.brandLogoLinkUrl(e.brand_logo_link_url),n.brandLogoImageUrl(e.brand_logo_image_url)}}),n.brandLogoLinkUrl=t.observable(u.brand_logo_link_url),n.brandLogoImageUrl=t.observable(u.brand_logo_image_url),n.showSpin=t.observable(!1)},reset:function(){},getPopoverParams:function(){return{content:'<img data-bind="attr:{src:brandLogoImageUrl()}" style="width: 310px">',title:"brand logo",placement:"in right",trigger:"hover",bindContent:!0,template:'<div class="popover"><div class="arrow"></div><div class="popover-inner" style="width: 338px"><h3 class="popover-title"></h3><div class="popover-content"><p></p></div></div></div>'}},valid:function(){return this.hasAttachedFile()&&this.brandLogoLinkUrl()},sendMessage:function(){var e={logoUrl:this.brandLogoLinkUrl(),uuid:s.v4()};this.makeRequest({data:{branding:t.toJSON(e)}})},edit:function(){a.open(this)},submit:function(e){var t=this;i.showYesNo({message:"This image will be used as the logo for all email communications. Continue?",yes:function(){t.showSpin(!0),t.sendMessage()}})}});return f}),tadpoles.define("sleep",["require","emit"],function(e){var t=6e4,n=e("emit"),r=(new Date).getTime(),i;return i=setInterval(function(){var e=(new Date).getTime();e>r+t+45e3&&n.emit("sleep:resumed"),r=e},t),{cancel:function(){clearInterval(i)}}}),tadpoles.define("model/outbox",["require","ko","lodash","selfish","emit","services/eventLoader","model/globalFilter","model/remote","services/alerts","model/product","services/disposer"],function(e){var t=e("ko"),n=e("lodash"),r=e("selfish"),i=e("emit"),s=e("services/eventLoader"),o=e("model/globalFilter"),u=e("model/remote"),a=e("services/alerts"),f=e("model/product"),l=e("services/disposer"),c=[{name:"5 min delay",value:5},{name:"15 min delay",value:15},{name:"30 min delay",value:30},{name:"1 hour delay",value:60},{name:"4 hour delay",value:240},{name:"Preview All",value:-1}],h=r.Base.extend(s,{className:"Outbox",initialize:function(e){e=e||{};var r=this;r.events=t.observableArray([]),r.events.subscribe(function(e){i.emit("events-update",{events:e,source:"outbox"})}),r.approvedEvents={},r.eventsForClass=function(e){if(!e)return[];var n=r.events(),i=e.isLocation(),s=o.name().toLowerCase(),u=t.utils.arrayFilter(n,function(n){return(i||e.key===n.group())&&n.memberNames().toString().toLowerCase().indexOf(s)!==-1});return u},r.eventsForCurrentClass=t.pureComputed(function(){var e=o.group();return r.eventsForClass(e)}),r.outboxPeriod=t.observable(5),r.outboxPeriodDisplay=t.pureComputed(function(){var e=r.outboxPeriod(),t=n.find(c,function(t){return t.value===e});return t.name}),r.periodOptions=t.observable(c),s.initialize.call(r,{loadAll:!0,success:function(e){var t=n(e).filter(function(e){return e.inOutbox()}).concat(r.events()).sortBy(function(e){return e.event_time}).value();r.events(t),r.approvedEvents={}}}),i.on("observation-deleted",this.removeEvent),i.on("new-event",function(e){var t=n.find(r.events(),function(t){return t.key===e.key});if(t&&!e.inOutbox()){r.removeEvent(e.key),r.approvedEvents[e.key]=!0;return}!t&&!r.approvedEvents[e.key]&&e.inOutbox()&&r.events.push(e)}),o.location.subscribe(function(e){e&&r.outboxPeriod(o.location().outbox_period||5)})},loadEvents:function(){l.dispose(this.events()),this.events([]),s.loadEvents.call(this)},removeEvent:function(e){var t=this.events.remove(function(t){return t.key===e});l.dispose(t)},requestData:function(){var e={num_events:300,outbox:!0,location:o.location().key};return e},sendAll:function(){var e=this;a.showYesNo({message:"Approve all now?",yes:function(){var t=e.eventsForCurrentClass().slice(0);n.each(t,function(e,t){n.delay(e.doApprove,Math.min(300*t,5e3))})}})},changeOutboxPeriod:function(e){var t=this,n=u.create({path:"/remote/v1/location",method:"post",success:function(){t.outboxPeriod(e.value)},error:function(e){a.showAlert("Oops!","We were unable to save that last change.  If you have a second, check your connectivity and try again.")}});n.makeRequest({data:{location:o.location().key,property:"outbox_period",value:e.value}})}});return h.create()}),tadpoles.define("services/dailyReports",["require","lodash","jquery","ko","services/config","model/remote","model/serverDailyReport","model/globalFilter","services/children","emit","model/product","jstz","services/uuid","model/detailViewPanel","services/profilers","services/disposer"],function(e){function g(e){var n=a.getInstance().children();return e.subject_type==="group"&&(n=t.filter(n,function(t){return t.group()===e.subject_key||t.homeroom_key()===e.subject_key})),l.hasFeatureLevel(l.Features.DAILY_REPORT_BATCH_SCOPE,l.Levels.BATCH_FEATURE_LEVEL_IN_TODAY)||(n=t.filter(n,function(e){return e.isIn()})),t.map(n,function(t){return t.key+":"+e.date})}var t=e("lodash"),n=e("jquery"),r=e("ko"),i=e("services/config"),s=e("model/remote"),o=e("model/serverDailyReport"),u=e("model/globalFilter"),a=e("services/children"),f=e("emit"),l=e("model/product"),c=e("jstz"),h=e("services/uuid"),p=e("model/detailViewPanel"),d=e("services/profilers"),v=e("services/disposer"),m=c.determine(),y=s.extend({className:"DailyReports",initialize:function(e){var n=this;e=e||{},e.path=e.path||(i.isParentApp?"/remote/v1/daily_report/parent":"/remote/v1/daily_report/query"),e.method=i.isParentApp?"get":"post",e.useCursor=!1,n.loaded=r.observable(!1),n.report=r.observable(),n.reports=r.observableArray(),n.dropoffDate=r.observable(),n.dropoff=r.observable(),n.dropoffDate.subscribe(function(){var e=n.dropoff();if(!e)return;n.selectDropoff(e.subject_key)}),n.reportsByKey=r.pureComputed(function(){var e={};return t.each(n.reports(),function(t){e[t.report_key]=t}),e}),n.parentReportCount=r.pureComputed(function(){return u.date().format("isoDate")!==(new Date).format("isoDate")?0:t.reduce(n.reports(),function(e,t){return t.hasUnviewedData()?e+1:e},0)}),e.error=function(){return n.loaded(!1),!0},e.complete=function(){return f.emit("daily-reports-loaded",{}),!0},e.success=function(e){var r=d.getProfiler("dr");r.stop("request"),r.start("load"),v.dispose(n.reports()),n.reports(t.map(e.reports,function(e){return o.create(e)}));if(n.report()){var i=t.find(n.reports(),{report_key:n.report().report_key});n.report(i)}n.updateStudents(n.reports()),r.stop("load")},s.initialize.call(this,e),f.on("daily-report-message",function(e){if(e.type_name!=="daily_report")return;if(e.date!==u.date().format("isoDate"))return;var t=o.create(e);t.canonical(!0),console.log("upserting remote"),n.upsertReport(t)}),f.on("object-change:ServerDailyReport",function(e){var t=o.create(e);t.canonical(!0),n.upsertReport(t)}),f.on("report-modified",function(e){if(e.type_name!=="daily_report")return;n.upsertReport(e)}),f.on("childrenLoaded",function(){n.loadAll()||n.updateStudents(n.reports())}),f.on("detailViewActive:daily reports",function(){n.loadAll()}),u.group.subscribe(function(e){if(!e||!e.key)return;n.selectReport(e.key==="all"?u.location().key:e.key,e.key==="all"?"location":"group")}),u.date.subscribe(function(){n.reset(),((new Date).format("isoDate")===u.date().format("isoDate")||p.getInstance().dailyReportsActive())&&n.loadAll()})},upsertReport:function(e){var n=this;if(e.disposed){console.log("cannot override with disposed");return}var r=t.findIndex(this.reports(),{report_key:e.report_key});if(r>=0){var i=this.reports()[r];if(i.key&&!e.key||i.canonical()&&!e.canonical()){console.log("cannot override remote with local");return}console.log("replacing existing"),i!==e&&v.fastDispose(i),this.reports.valueWillMutate(),this.reports()[r]=e,this.reports.valueHasMutated()}else console.log("adding"),this.reports.push(e);this.report()&&this.report().report_key===e.report_key&&this.report(e);if(e.batch){var s=g(e),u=t.map(s,function(t){var r=n.reportsByKey()[t];return r||(r=o.create({report_key:t,location_key:e.location_key,subject_type:"individual",start_timestamp:Math.round((new Date).getTime()/1e3),batch:!1,client_update_timestamp:0,published:!1,timezone:m.name(),entries:[]}),n.reports.push(r)),r});e.applyBatch(u)}this.updateStudents([e])},loadDailyReportsLocal:function(e){var t={JPEG:"image/jpeg"};this.success({reports:[{date:e.date,subject_key:"demokey4",location_key:"demoLocationKey",subject_type:"individual",start_timestamp:Math.round((new Date).getTime()/1e3),batch:!1,client_update_timestamp:0,published:!0,delivery_state:"opened",stage:"toddler",entries:[{id:h.short(),type_name:"nap",start_time:1319468433,end_time:1319471148,note:"Slept like an angel"},{id:h.short(),foods:"Mac and Cheese",meal_name:"Lunch",note:"Really ate well today",amount:"Some",type_name:"food"},{id:h.short(),type_name:"bathroom",action_time:1319480039,events:["Pee"]},{id:h.short(),type_name:"medication",action_time:1319482842,amount:"25",measure:"mg",note:"Allergy medication"},{id:h.short(),type_name:"food",meal_name:"PM Snack",amount:"Half",foods:"Crackers",note:""},{id:h.short(),type_name:"note",please_bring:["pull-ups","wipes","clothes"]},{id:h.short(),type_name:"note",note:"Did a really great job sharing with the other kids today!"},{id:h.short(),type_name:"activity",note:"Wheeeeeeeeee!",attachment:{mime_type:t.JPEG,key:"demo4"}}]},{date:e.date,subject_key:"demokey2",location_key:"demoLocationKey",subject_type:"individual",start_timestamp:Math.round((new Date).getTime()/1e3),batch:!1,client_update_timestamp:0,published:!0,delivery_state:"sent",stage:"preschool",entries:[{id:h.short(),type_name:"nap",start_time:1319468433,end_time:1319471148},{id:h.short(),foods:"Mac and Cheese",meal_name:"Lunch",amount:"Some",type_name:"food"},{id:h.short(),type_name:"bathroom",action_time:1319480039,events:["Tried"]},{id:h.short(),type_name:"food",meal_name:"PM Snack",amount:"All",foods:"Crackers",note:""},{id:h.short(),type_name:"note",please_bring:["clothes"]},{id:h.short(),type_name:"note",feeling:"excited"},{id:h.short(),type_name:"activity",activities:["Language"],note:"Today we learned how to say hello in French and Spanish"}]},{date:e.date,subject_key:"demokey5",location_key:"demoLocationKey",subject_type:"individual",start_timestamp:Math.round((new Date).getTime()/1e3),batch:!1,client_update_timestamp:0,published:!1,stage:"preschool",unviewed_data:!0,entries:[{id:h.short(),type_name:"nap",start_time:1319468433,end_time:1319471148,parent:!0}]}]})},reset:function(){this.loaded(!1),v.dispose(this.reports()),this.reports([]),this.report(null)},loadAll:function(){if(this.loaded())return!1;this.loaded(!0),t.each(a.getInstance().children(),function(e){e.reportStatus(null)});var e=new Date,n=new Date(e.getFullYear(),e.getMonth(),e.getDate()),r=new Date(n);r.setDate(r.getDate()+1);var s=i.isParentApp?{num_days:2}:{date:u.date().format("isoDate"),location_key:u.location().key,report_type:"daily"};if(i.isDemo)this.loadDailyReportsLocal(s);else{var o=d.getProfiler("dr");o.start("request"),this.makeRequest({data:s})}return!0},getReport:function(e){return this.reportsByKey()[e]},getMealDistributionsDeferred:function(e,t){var r=this,i=new n.Deferred,o=s.create({path:"/remote/v1/daily_report/query_meal_dist",method:"post",success:function(e){i.resolve(e.meal_distributions?e.meal_distributions[0]:[])},error:function(e){i.resolve([])}});return o.makeRequest({data:{date:t,location_key:u.location().key,subject_keys:JSON.stringify([e])}}),i.promise()},updateStudents:function(e){t.each(e,function(e){if(e.subject_type==="individual"&&e.date===u.date().format("isoDate")){var t=a.getInstance().getChild(e.subject_key);t&&t.reportStatus(e.statusText())}})},selectDropoff:function(e){var t=e+":"+this.dropoffDate().format("isoDate"),n=this.reportsByKey()[t];n||(n=o.create({report_key:t,subject_type:"individual",start_timestamp:Math.round((new Date).getTime()/1e3),batch:!1,client_update_timestamp:0,published:!1,timezone:m.name(),entries:[]}),this.reports.push(n)),n.applyStage(),this.dropoff(n),f.emit("dropoff-selected",{})},selectReport:function(e,t){var n=u.date().format("isoDate"),r=e+":"+n,s=this.reportsByKey()[r],a=u&&u.location()?u.location().key:null;s||(s=o.create({report_key:r,location_key:a,subject_type:t==="child"?"individual":t==="group"?"group":"location",start_timestamp:Math.round((new Date).getTime()/1e3),batch:t!=="child",client_update_timestamp:0,published:!1,timezone:m.name(),entries:[]}),this.reports.push(s)),s.applyStage(),this.report(s),i.isProviderApp&&this.report().hasUnviewedData()&&(this.report().hasUnviewedData(!1),s.updateReport()),f.emit("report-selected",{})},updateDropoffDate:function(){var e=new Date,t=new Date(e.getFullYear(),e.getMonth(),e.getDate()),n=new Date(t);n.setDate(n.getDate()+1);var r=this.dropoffDate(),s=e.getHours()>=18?n:t;if(!r||r.getDate()!==s.getDate())this.dropoffDate(s),i.isParentApp&&this.loadAll()}});return y.create()}),tadpoles.define("model/modal/copyLessonPlanForm",["require","ko","model/form","utilities","services/groups","selfish","model/wrapped","model/selectable","services/alerts","model/globalFilter","lodash"],function(e){var t=e("ko"),n=e("model/form"),r=e("utilities"),i=e("services/groups"),s=e("selfish"),o=e("model/wrapped"),u=e("model/selectable"),a=e("services/alerts"),f=e("model/globalFilter"),l=e("lodash"),c=s.Base.extend(o,u,{className:"SelectableClassroom",initialize:function(e){o.initialize.call(this,e),u.initialize.call(this,e)}}),h=n.extend({className:"CopyLessonPlanForm",initialize:function(){var e=this;e.lessonPlan=t.observable(),e.copyWeek=t.observable(!1),e.sourceIsWeek=t.pureComputed(function(){return e.lessonPlan()&&e.lessonPlan().isWeek()}),e.selectWeek=t.pureComputed(function(){return e.sourceIsWeek()||e.copyWeek()}),e.classrooms=t.observableArray([]),e.date=t.observable(),e.classrooms=t.observableArray([]),e.selectedClassrooms=t.pureComputed(function(){return l(e.classrooms()).filter(function(e){return e.selected()}).value()}),n.initialize.call(e,{title:"copy lesson plan",formTemplate:"view/modals/copyLessonPlan",formModel:e,path:"/remote/v1/lesson_plan/copy",width:540,submitText:"copy",success:function(){e.close()}})},payload:function(){return{data:{key:this.lessonPlan().key,src_date:this.lessonPlan().date,src_subject:this.lessonPlan().subject_key,scope:this.selectWeek()?"week":"day",date:this.date().format("isoDate"),classroom_keys:l(this.selectedClassrooms()).map(function(e){return e.wrapped().key}).value()}}},open:function(e){this.lessonPlan(e);var t=e.isLocation()?f.location():i.getInstance().getGroup(e.subject_key),r=i.getInstance().groupsInSameStage(t);this.classrooms(l(r).map(function(e){return c.create({wrapped:e})}).value()),this.classrooms()[0].selected(!0),n.open.call(this)},close:function(){this.lessonPlan(null),this.date(null),this.classrooms([]),n.close.call(this)},valid:function(){return this.date()?this.selectedClassrooms().length===0?(a.showAlert("Missing Info","You need to choose one or more target classrooms for this lesson plan to be copied to","warning"),!1):!this.selectWeek()&&this.date().getDay()===0&&!this.lessonPlan().isWeek()?(a.showAlert("Invalid Date","Please choose a weekday as your target date","warning"),!1):!0:(a.showAlert("Missing Info","You need to provide a target date for the lesson plan","warning"),!1)}});return r.makeSingleton(h)}),tadpoles.define("model/lessonPlan",["require","lodash","services/config","model/serverDailyReport","services/groups","ko","model/remote","services/alerts","model/user","model/modal/copyLessonPlanForm","emit"],function(e){var t=e("lodash"),n=e("services/config"),r=e("model/serverDailyReport"),i=e("services/groups"),s=e("ko"),o=e("model/remote"),u=e("services/alerts"),a=e("model/user"),f=e("model/modal/copyLessonPlanForm"),l=e("emit"),c=r.extend({className:"LessonPlan",initialize:function(e){var t=this;r.initialize.call(t,e),t.printableElementId="lesson-printable",t.type_name="lesson_plan",t.report_key=e.subject_key+":"+e.date+":"+e.subject_type,t.isEditable(t.date&&t.date>=(new Date).format("isoDate")&&(!t.isLocation()||!t.isWeek())),t.copyDate=s.observable(),t.approvalNote=s.observable(e.approval_note),t.backgroundColor=s.pureComputed(function(){return t.isWeek()?"#FBB450":t.rejected()?"#DA4F49":t.approved()?"#5bb75b":t.approvalState()=="submitted"?"#49afcd":t.numVisibleEntries()>0?"#49afcd":"darkgray"})},dispose:function(){this.backgroundColor.dispose(),r.dispose.call(this)},isGroupReport:function(){return(this.subject_type==="day"||this.subject_type==="week")&&!this.isLocation},copyTo:function(){f.getInstance().open(this)},applyStage:function(){if(this.stage)return;var e=i.getInstance().getGroup(this.subject_key);e&&(this.stage=e.child_type())},getSelfOwner:function(){return this.report_key},isWeek:function(){return this.subject_type==="week"},isLocation:function(){return this.subject_key===this.location_key},canEditEntryType:function(e){return this.isLocation()&&e==="activity"?!1:r.canEditEntryType.call(this,e)},canApprove:function(){return this.key&&(n.isDemo||a.CurrentUser.isAdmin())&&this.isEditable()&&!this.isWeek()&&(!this.approved()||this.approvalState()!="approved")},canSubmit:function(){return this.key&&(n.isDemo||!a.CurrentUser.isAdmin())&&this.isEditable()&&!this.isWeek()&&!this.approved()&&this.approvalState()=="rejected"},canReject:function(){return this.key&&(n.isDemo||a.CurrentUser.isAdmin())&&this.isEditable()&&!this.isWeek()&&(this.approved()||this.approvalState()!="rejected")},changeApproval:function(e){var t=this.approvalState(),r=this;this.approvalState(e);if(n.isDemo)return;var i=o.create({path:"/remote/v1/lesson_plan/approve",method:"post",error:function(){r.approvalState(t),u.showAlert("Oops!","Something went wrong on our end, please try again")},success:function(){l.emit("report-modified",r)}}),a={key:r.key,status:this.approvalState(),note:this.approvalNote()};i.makeRequest({data:{data:s.toJSON(a)}})},approve:function(){this.changeApproval("approved")},reject:function(){this.changeApproval("rejected")},resubmit:function(){this.changeApproval("submitted")}});return c}),tadpoles.define("monthPicker",["jquery"],function(e){(function(e){var t={init:function(t){return this.each(function(){var n=e(this),r=n.data("monthpicker"),i=t&&t.year?t.year:(new Date).getFullYear(),s=e.extend({pattern:"mm/yyyy",selectedMonth:null,selectedMonthName:"",selectedYear:i,startYear:i-10,finalYear:i+10,monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],id:"monthpicker_"+(Math.random()*Math.random()).toString().replace(".",""),openOnFocus:!0,disabledMonths:[]},t);s.dateSeparator=s.pattern.replace(/(mmm|mm|m|yyyy|yy|y)/ig,""),r||(e(this).data("monthpicker",{target:n,settings:s}),s.openOnFocus===!0&&n.on("focus",function(){n.monthpicker("show")}),n.monthpicker("parseInputValue",s),n.monthpicker("mountWidget",s),n.on("monthpicker-click-month",function(e,t,r){n.monthpicker("setValue",s),n.monthpicker("hide")}),n.addClass("mtz-monthpicker-widgetcontainer"),e(document).unbind("mousedown.mtzmonthpicker").on("mousedown.mtzmonthpicker",function(t){(!t.target.className||t.target.className.toString().indexOf("mtz-monthpicker")<0)&&e(this).monthpicker("hideAll")}))})},show:function(){e(this).monthpicker("hideAll");var t=e("#"+this.data("monthpicker").settings.id);t.css("top",this.offset().top+this.outerHeight()),e(window).width()>t.width()+this.offset().left?t.css("left",this.offset().left):t.css("left",this.offset().left-t.width()),t.show(),t.find("select").focus(),this.trigger("monthpicker-show")},hide:function(){var t=e("#"+this.data("monthpicker").settings.id);t.is(":visible")&&(t.hide(),this.trigger("monthpicker-hide"))},hideAll:function(){e(".mtz-monthpicker-widgetcontainer").each(function(){typeof e(this).data("monthpicker")!="undefined"&&e(this).monthpicker("hide")})},setValue:function(e){var t=e.selectedMonth,n=e.selectedYear;e.pattern.indexOf("mmm")>=0?t=e.selectedMonthName:e.pattern.indexOf("mm")>=0&&e.selectedMonth<10&&(t="0"+e.selectedMonth),e.pattern.indexOf("yyyy")<0&&(n=n.toString().substr(2,2)),e.pattern.indexOf("y")>e.pattern.indexOf(e.dateSeparator)?this.val(t+e.dateSeparator+n):this.val(n+e.dateSeparator+t),this.change()},disableMonths:function(t){var n=this.data("monthpicker").settings,r=e("#"+n.id);n.disabledMonths=t,r.find(".mtz-monthpicker-month").each(function(){var n=parseInt(e(this).data("month"),10);e.inArray(n,t)>=0?e(this).addClass("ui-state-disabled"):e(this).removeClass("ui-state-disabled")})},mountWidget:function(t){var n=this,r=e('<div id="'+t.id+'" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all" />'),i=e('<div class="ui-datepicker-header ui-widget-header ui-helper-clearfix ui-corner-all mtz-monthpicker" />'),s=e('<select class="mtz-monthpicker mtz-monthpicker-year" />'),o=e('<table class="mtz-monthpicker" />'),u=e('<tbody class="mtz-monthpicker" />'),a=e('<tr class="mtz-monthpicker" />'),f="",l=t.selectedYear,c=null,h=e(this).data("selected-year"),p=e(this).data("start-year"),d=e(this).data("final-year");h&&(t.selectedYear=h),p&&(t.startYear=p),d&&(t.finalYear=d),r.css({position:"absolute",zIndex:999999,whiteSpace:"nowrap",width:"250px",overflow:"hidden",textAlign:"center",display:"none",top:n.offset().top+n.outerHeight(),left:n.offset().left}),s.on("change",function(){var r=e(this).parent().parent().find("td[data-month]");r.removeClass("ui-state-active"),e(this).val()==t.selectedYear&&r.filter("td[data-month="+t.selectedMonth+"]").addClass("ui-state-active"),n.trigger("monthpicker-change-year",e(this).val())});for(var v=t.startYear;v<=t.finalYear;v++){var c=e('<option class="mtz-monthpicker" />').attr("value",v).append(v);t.selectedYear==v&&c.attr("selected","selected"),s.append(c)}i.append(s).appendTo(r);for(var v=1;v<=12;v++)f=e('<td class="ui-state-default mtz-monthpicker mtz-monthpicker-month" style="padding:5px;cursor:default;" />').attr("data-month",v),t.selectedMonth==v&&f.addClass("ui-state-active"),f.append(t.monthNames[v-1]),a.append(f).appendTo(u),v%3===0&&(a=e('<tr class="mtz-monthpicker" />'));u.find(".mtz-monthpicker-month").on("click",function(){var r=parseInt(e(this).data("month"));e.inArray(r,t.disabledMonths)<0&&(t.selectedYear=e(this).closest(".ui-datepicker").find(".mtz-monthpicker-year").first().val(),t.selectedMonth=e(this).data("month"),t.selectedMonthName=e(this).text(),n.trigger("monthpicker-click-month",e(this).data("month")),e(this).closest("table").find(".ui-state-active").removeClass("ui-state-active"),e(this).addClass("ui-state-active"))}),o.append(u).appendTo(r),r.appendTo("body")},destroy:function(){return this.each(function(){e(this).removeClass("mtz-monthpicker-widgetcontainer").unbind("focus").removeData("monthpicker")})},getDate:function(){var e=this.data("monthpicker").settings;return e.selectedMonth&&e.selectedYear?new Date(e.selectedYear,e.selectedMonth-1):null},setDate:function(t){var n=this.data("monthpicker").settings;n.selectedMonth=t.getMonth()+1,n.selectedYear=t.getFullYear(),e(this).monthpicker("setValue",n)},parseInputValue:function(e){if(this.val()&&e.dateSeparator){var t=this.val().toString().split(e.dateSeparator);e.pattern.indexOf("m")===0?(e.selectedMonth=t[0],e.selectedYear=t[1]):(e.selectedMonth=t[1],e.selectedYear=t[0])}}};e.fn.monthpicker=function(n){if(t[n])return t[n].apply(this,Array.prototype.slice.call(arguments,1));if(typeof n=="object"||!n)return t.init.apply(this,arguments);e.error("Method "+n+" does not exist on jQuery.mtz.monthpicker")}})(e)}),tadpoles.define("services/monthPicker",["require","lodash","jquery","ko","monthPicker"],function(e){var t=e("lodash"),n=e("jquery"),r=e("ko");return e("monthPicker"),r.bindingHandlers.monthPicker={init:function(e,i){var s=r.utils.unwrapObservable(i())||{};t.defaults(s,{startYear:(new Date).getFullYear()-2,finalYear:(new Date).getFullYear()+1}),n(e).monthpicker(s),n(e).on("click",function(){n(e).monthpicker("show")}),r.utils.domNodeDisposal.addDisposeCallback(e,function(){n(e).monthpicker("destroy")}),s.observable&&n(e).on("monthpicker-click-month",function(){s.observable(n(e).monthpicker("getDate"))})},update:function(e,i){var s=r.utils.unwrapObservable(i()),o=n(e).monthpicker("getDate");if(s.observable){var u=s.observable();t.isEqual(u,o)||n(e).monthpicker("setDate",u)}}},{}}),tadpoles.define("report/weeklyLessonPlan",["require","lodash","jquery","services/analytics","ko","services/modal","services/groups","selfish","model/printable","utilities","model/product","services/curricula"],function(e){function p(e){var n=c.getWeekDays();n.splice(0,0,0);var r=t.map(n,function(t){var n=t-e.getDay(),r=new Date(e.getFullYear(),e.getMonth(),e.getDate());return r.setDate(e.getDate()+n),r});return r}function d(e){return t.map(e,function(e){return e.format("tinyDate")})}function v(e){return t.map(e,function(e){return e.format("ddd").toLowerCase()})}var t=e("lodash"),n=e("jquery"),r=e("services/analytics"),i=e("ko"),s,o=e("services/modal"),u=e("services/groups"),a=e("selfish"),f=e("model/printable"),l=e("utilities"),c=e("model/product"),h=e("services/curricula"),m=a.Base.extend({className:"SubjectArea",initialize:function(e,t){this.plans=i.observableArray([,,,,,]),this.name=i.observable(e),this.domain=i.observable(t),this.printableName=i.observable(this.convertToPrintableName(e))},addActivity:function(e,t){this.plans.splice(e,1,t)},convertToPrintableName:function(e){return e.replace("/"," / ")}}),g=a.Base.extend({className:"LessonDetails",initialize:function(e,r){var s=this,o={},u=0;this.subjectAreas=i.observableArray(),this.curriculum=i.observable(r),this.weeklyTheme=i.observable(),t.each(e,function(e){var n=e.weeklyThemes();n.length>0&&s.weeklyTheme(n[0].name),t.each(e.activities(),function(e){var t=e.activities;if(!t||t.length==0)return;var n=e.activities[0],r=e.c_domains&&e.c_domains.length>0?e.c_domains[0]:null,i=o[n];if(!i){var a=r?h.getInstance().getDomainById(r):h.getInstance().getDomainByCurriculumAndName(s.curriculum(),n);i=m.create(n,a),o[n]=i}i.addActivity(u,e.note)}),u++});var a=l.sortBySortValue(t.values(o),function(e){var r=e.domain();if(!r)return null;var i=r.sort;return t.isNull(i)||t.isUndefined(i)||n.trim(i)==""?r.name:i},function(e){return e.name()});s.subjectAreas(a)}}),y=o.extend(f,{className:"LessonModal",initialize:function(e){var t=this;f.initialize.call(t,"weeklylesson-printable"),t.lessonDetails=i.observable(),t.dates=i.observableArray([]),t.days=i.observableArray([]),t.classrooms=i.pureComputed(function(){var e=u.getInstance().groupsForCurrentLocation();return e}),t.selectedClassroom=i.observable(),t.curriculum=i.observable(),t.date=i.observable(),t.dateForDisplay=i.pureComputed(function(){return t.date()?t.date().format("tinyDate"):""}),t.selectedClassroom.subscribe(function(){t.draw(),t.curriculum(t.selectedClassroom()?h.getInstance().getCurriculumForGroup(t.selectedClassroom()):null)}),t.date.subscribe(this.draw),o.initialize.call(t,e)},close:function(){this.selectedClassroom(null),o.close.call(this)},draw:function(){var e=p(this.date());this.dates(d(e)),this.days(v(e))},show:function(){this.open()},changeLessons:function(e){var t=new Date;t.setISO8601(e[0].date),this.date(t),this.selectedClassroom(u.getInstance().getGroup(e[0].subject_key)),this.lessonDetails(g.create(e,this.curriculum()))}});return s=l.makeSingleton(y,{template:"view/modals/weeklyLessonPlan",width:918}),{show:function(e){var t=s.getInstance();t.changeLessons(e),t.show();try{r.trackEvent("Report","LessonPlan")}catch(n){}}}}),tadpoles.define("services/lessonPlans",["require","lodash","ko","services/config","model/remote","model/lessonPlan","model/globalFilter","emit","services/uuid","jstz","model/detailViewPanel","model/product","services/disposer","services/monthPicker","report/weeklyLessonPlan"],function(e){function d(e){var t=e.match(/(\d+)/g);return new Date(t[0],t[1]-1,t[2])}function v(e,n,r){var i=[],r=5,s=n||new Date,o=h.getStartOfWeek(),u=h.getWeekend(),a=new Date(s.getFullYear(),s.getMonth(),s.getDate());while(t.contains(u,a.getDay()))a.setDate(a.getDate()+1);var f=new Date(s.getFullYear(),s.getMonth()+1,0);while(t.contains(u,a.getDay()))f.setDate(f.getDate()-1);a.getDay()===o&&f.getDate()-a.getDate()<26&&(r=4);var l=new Date(a);l.setDate(a.getDate()-l.getDay()),a=new Date(l);var c=0;for(;;){if(c===0||a.getDay()===0)i.push({report_key:e+":"+l.format("isoDate")+":"+"week",subject_key:e,date:l.format("isoDate"),subject_type:"week"}),c+=1;t.contains(u,a.getDay())||i.push({report_key:e+":"+a.format("isoDate")+":"+"day",subject_key:e,date:a.format("isoDate"),subject_type:"day"}),a.setDate(a.getDate()+1);if(a.getDay()===0){if(c===r)break;l=new Date(a)}}return i}function m(e,n,r){var i=d(n),s=[],o=new Date,u=new Date(o.getFullYear(),o.getMonth(),o.getDate()),a=new Date(i),f=h.getWeekend();for(;;){(!r||u<a)&&!t.contains(f,a.getDay())&&s.push(e+":"+a.format("isoDate")+":"+"day"),a.setDate(a.getDate()+1);if(a>i&&a.getDay()===0)break}return s}var t=e("lodash"),n=e("ko"),r=e("services/config"),i=e("model/remote"),s=e("model/lessonPlan"),o=e("model/globalFilter"),u=e("emit"),a=e("services/uuid"),f=e("jstz"),l=e("model/detailViewPanel"),c=f.determine(),h=e("model/product"),p=e("services/disposer");e("services/monthPicker");var g=i.extend({className:"LessonPlans",initialize:function(e){var r=this;e=e||{},e.path="/remote/v1/daily_report/query",e.method="post",e.error=function(){return!0},e.complete=function(){return!0},e.useCursor=!1,r.lesson=n.observable(),r.lessons=n.observableArray(),r.group=o.group;var a=new Date,f=new Date(a.getFullYear(),a.getMonth(),1);r.selectedDate=n.observable(f),i.initialize.call(this,e),r.group.subscribe(function(e){t.delay(function(){e?r.loadLessonsForClass():r.lesson(null)},l.getInstance().lessonsActive()?10:2e3)}),r.selectedDate.subscribe(function(){r.loadLessonsForClass()}),u.on("daily-report-message",function(e){if(e.type_name!=="lesson_plan")return;var t=o.locationSelected()?o.location().key:null,n=o.groupSelected()?o.group().key:null;if(e.subject_key!==n&&e.subject_key!==t)return;var i=s.create(e);i.canonical(!0),console.log("upserting remote"),r.upsertLesson(i)}),u.on("object-change:LessonPlan",function(e){var t=s.create(e);t.canonical(!0),r.upsertLesson(t)}),u.on("report-modified",function(e){if(e.type_name!=="lesson_plan")return;r.upsertLesson(e)})},dailyLessonsForWeek:function(e,n,r){var i=this.lessons(),s=m(e,n,r),o=t.filter(i,function(e){return t.contains(s,e.report_key)});return o},viewWeekly:function(t){var n=t.date,r=t.subject_key,i=this.dailyLessonsForWeek(r,n),s=e("report/weeklyLessonPlan");return s.show(i)},upsertLesson:function(e){if(e.disposed){console.log("cannot override with disposed");return}var n=t.findIndex(this.lessons(),{date:e.date,subject_type:e.subject_type});if(n>=0){var r=this.lessons()[n];if(r.key&&!e.key||r.canonical()&&!e.canonical())return;console.log("replacing existing"),r!==e&&p.fastDispose(r),this.lessons.valueWillMutate(),this.lessons()[n]=e,this.lessons.valueHasMutated()}else this.lessons.push(e);this.lesson()&&this.lesson().date===e.date&&this.lesson(e);if(e.batch){var i=this.dailyLessonsForWeek(e.subject_key,e.date,!0);e.applyBatch(i)}},findLesson:function(e,n,r){return t.find(this.lessons(),{subject_key:e,date:n,subject_type:r})},loadLessonsForClass:function(){var e=this,i=this.lesson()?this.lesson().date:null;this.lesson(null),p.fastDispose(e.lessons()),e.lessons([]);var u=this.selectedDate(),a=this.group()?this.group().key==="all"?o.location().key:this.group().key:null,f={data:{date:u?u.format("isoDate"):(new Date).format("isoDate"),location_key:o.location().key,lesson_keys:n.toJSON(t.pluck(v(a,u),"report_key")),report_type:"lesson"},success:function(n){var r={};t.each(n.lesson_plans,function(t){var n=s.create(t);r[n.report_key]=n,i===n.date&&e.lesson(n)}),e.lessons(t.map(v(a,u),function(e){var t=r[e.report_key];return t||(t=s.create({subject_key:e.subject_key,date:e.date,subject_type:e.subject_type,batch:e.subject_type==="week",location_key:o.location().key,start_timestamp:Math.round((new Date).getTime()/1e3),client_update_timestamp:0,published:!1,timezone:c.name(),entries:[]})),t}))}};r.isDemo?this.loadLocal(f,a):this.loadRemote(f)},loadRemote:function(e){this.makeRequest(e)},loadLocal:function(e,n){var r=-1,i=["science","reading","animals","technology","fruits"],s=["dummy","Pretzels","Ritz Crackers","Mandarin Oranges","Graham Crackers","Grapes"],o=["dummy","Turkey Sandwiches, Yogurt, Milk","Mac and Cheese, Apple Slices, Milk","PB&J's, Carrots, Milk","Chicken Nuggets, Ants on a Log, Milk","Pizza, Fruit Cup, Milk"],u=["dummy","Raisins","Trail Mix","Cheese Sticks","Toast","Popcorn"],f=[[],[{activities:["Language"],note:"We learned how to say hello in Spanish, French and German."},{activities:["Physical"],note:"We practiced balance by walking on balance beams and standing on one foot."}],[{activities:["Science"],note:"We did an experiment to see what objects floated on water, and what objects sank.  For each object, the kids gave their hypothesis, and then we tested it to see if they were correct."},{activities:["Music"],note:"We sang songs and played musical instruments such as tambourines, drums, and recorders"}],[{activities:["Art"],note:"We colored in different mediums.  We used pencils, markers, and finger paints"},{activities:["Cognitive"],note:"We put together jigsaw puzzles.  We also worked on learning more complicated shape words such as parallelogram, rhombus, and trapezoid."}],[{activities:["Math"],note:"We practiced counting to 20.  We also practiced estimation by briefly glancing at collections of objects hidden under a paper plate, and saying how many we thought we saw."},{activities:["Social"],note:"We practiced working together by pairing off and then building a block towers."}],[{activities:["Language"],note:"We practiced rhyming words, and figuring out the first letter of words."},{activities:["Music"],note:"We had a dance party. Everyone made up their own special dance moves, and taught the rest of the class."}]],l=a.short(),c=null,h=t.map(v(n),function(e){e.subject_type==="week"&&(r+=1,l=a.short(),c=e.subject_key+":"+e.date+":"+e.subject_type);var n=d(e.date),h=i[r],p={key:a.short(),date:e.date,subject_key:e.subject_key,location_key:"demoLocationKey",subject_type:e.subject_type,start_timestamp:Math.round((new Date).getTime()/1e3),batch:e.subject_type==="week",client_update_timestamp:0,published:!1,stage:"toddler"};return r<3&&(p.subject_type==="week"?p.entries=[{id:l,type_name:"note",note:"The theme of this week is "+h,owner:c}]:(p.entries=[{id:l,type_name:"note",note:"The theme of this week is "+h,owner:c},{id:a.short(),type_name:"food",meal_name:"AM Snack",foods:s[n.getDay()]},{id:a.short(),foods:o[n.getDay()],meal_name:"Lunch",type_name:"food"},{id:a.short(),type_name:"food",meal_name:"PM Snack",foods:u[n.getDay()]}],t.each(f[n.getDay()],function(e){p.entries.push({id:a.short(),type_name:"activity",activities:e.activities,note:e.note})}))),p});e.success({lesson_plans:h})}});return g.create()}),tadpoles.define("model/modal/editReplyToForm",["require","ko","lodash","model/form","model/globalFilter"],function(e){var t=e("ko"),n=e("lodash"),r=e("model/form"),i=e("model/globalFilter"),s=r.extend({className:"EditReplyToForm",initialize:function(e){e=e||{};var n=this;r.initialize.call(n,{title:"parent reply to",formTemplate:"view/modals/editReplyTo",formModel:n,submitText:"submit",path:"/remote/v1/location",success:function(e){i.location().default_reply_email=n.defaultReplyEmail(),n.close()}}),n.defaultReplyEmail=t.observable()},payload:function(){return{location:i.location().key,property:"default_reply_email",value:this.defaultReplyEmail()}},open:function(e){this.defaultReplyEmail(i.location().default_reply_email),r.open.call(this)},close:function(){this.defaultReplyEmail(null),r.close.call(this)}});return s}),tadpoles.define("model/modal/editAutoCheckoutTimeForm",["require","ko","lodash","model/form","model/globalFilter"],function(e){var t=e("ko"),n=e("lodash"),r=e("model/form"),i=e("model/globalFilter"),s=r.extend({className:"EditAutoCheckoutTimeForm",initialize:function(e){e=e||{};var n=this;r.initialize.call(n,{title:"auto checkout",formTemplate:"view/modals/editAutoCheckout",formModel:n,submitText:"submit",path:"/remote/v1/location",success:function(e){i.location().student_auto_checkout_time=n.student_auto_checkout_time(),n.close()}}),n.student_auto_checkout_time=t.observable()},payload:function(){return{location:i.location().key,property:"student_reply_email",value:this.student_auto_checkout_time()}},open:function(e){this.student_auto_checkout_time(i.location().student_auto_checkout_time),r.open.call(this)},close:function(){this.student_auto_checkout_time(null),r.close.call(this)}});return s}),tadpoles.define("services/domains",["require","ko","selfish","utilities"],function(e){var t=e("ko"),n=e("selfish"),r=e("utilities"),i=n.Base.extend({className:"Domains",initialize:function(){var e=this},getGenericDomainForDomain:function(e){return e=e.toLowerCase(),e==="cognitive development"||e==="blocks/math"?"cognitive":e==="language arts"||e=="reading"||e=="language development"?"language":e==="sensory stimulation"||e=="science/sensory"?"sensory":e==="creative art"||e==="dramatic play"?"art":e==="motor skills"||e==="movement/dance"?"movement":e==="music/movement"?"music":e}});return r.makeSingleton(i)}),tadpoles.define("model/selections",["require","emit","ko","lodash","selfish"],function(e){var t=e("emit"),n=e("ko"),r=e("lodash"),i=e("selfish"),s=i.Base.extend({className:"Selections",initialize:function(e){var r=this;r.maxSelections=e.maxSelections||1,r.tileType=e.tileType||"",r.selections=n.observableArray([]),r.hasSelection=n.pureComputed(function(){return r.selections().length>0}),r.numSelections=n.pureComputed(function(){return r.selections().length}),t.on(r.selectionTopic(),r.selected),t.on(r.deselectionTopic(),r.deselected)},selected:function(e){var t=this.selections();if(t.length===this.maxSelections){var n=t.pop();n.toggleSelection()}t.unshift(e),this.selections(t)},deselected:function(e){this.selections.remove(e)},clearSelections:function(){r.each(this.selections(),function(e){e.deselect()}),this.selections([])},selectionTopic:function(){return"selected:"+this.tileType},deselectionTopic:function(){return"deselected:"+this.tileType},shutdown:function(){t.removeAllListeners(this.selectionTopic()),t.removeAllListeners(this.deselectionTopic()),self.clearSelections()}});return s}),tadpoles.define("model/assessment/rating",["require","selfish","ko","lodash"],function(e){var t=e("selfish"),n=e("ko"),r=e("lodash"),i=t.Base.extend({className:"Rating",initialize:function(e){var t=this;t.key=e.key,t.goalId=e.goal_id,t.date=n.observable(e.date),t.rating=n.observable(e.rating),t.history=n.observable(t.parseHistory(e.history)),t.color=n.pureComputed(function(){return t.getColorForRating(t.rating())})},parseHistory:function(e){return e=e&&e.length>15?e.slice(0,15):e,r.map(e,function(e){return{date:(new Date(e.substring(0,10))).f("NNN d, yy"),rating:parseInt(e.substring(10))}})},getColorForRating:function(e){var t="transparent";return e===0?t="#CCC":e===1?t="#DA4F49":e===2?t="#9b77c4":e===3?t="#529eff":e===4&&(t="#a5d001"),t},payload:function(){return{goal_id:this.goalId,date:this.date(),client_update_timestamp:(new Date).getTime(),rating:this.rating()}},getPopoverParams:function(){return this.history().length>0?{title:"student progress",content:"<div data-bind=\"template: { name: 'view/popovers/ratingHistory' }\"></div>",placement:"right",trigger:"hover",bindContent:!0}:{}}});return i}),tadpoles.define("model/hoverEvents",["require","selfish","emit"],function(e){var t=e("selfish"),n=e("emit"),r=t.Base.extend({className:"HoverEvents",initialize:function(e){var t=e||{},n=this;n.prefix=t.prefix},onEnter:function(){n.emit((this.prefix||"")+"entered",this)},onLeave:function(){n.emit((this.prefix||"")+"left",this)}});return r}),tadpoles.define("model/assessment/evidence",["require","ko","lodash","model/mediaTile","model/actionTile","model/hoverEvents"],function(e){var t=e("ko"),n=e("lodash"),r=e("model/mediaTile"),i=e("model/actionTile"),s=e("model/hoverEvents"),o=r.extend(i,s,{className:"Evidence",initialize:function(e){var n=this;r.initialize.call(this,e),i.initialize.call(this,e),s.initialize.call(this,{prefix:"evidence"}),n.key=e.key,n.id=t.observable(n.key),n.type=e.type,n.sourceId=e.source_id,n.goalIds=e.goal_ids,n.domainIds=e.domain_ids,n.domainLabels=e.domain_labels,n.description=e.description,n.attachment(e.attachment),n.mediaTitle(e.description),n.galleryGroup("evidence"),n.date=e.date;if(n.date){var o=n.date.match(/(\d+)/g);n.realDate=new Date(o[0],o[1]-1,o[2])}},fromEvent:function(e){return o.create({key:e.key,type:"e",goal_ids:e.goals,description:e.comment(),attachment:e.attachment,date:e.date.format("isoDate")})}});return o}),tadpoles.define("model/assessment/note",["require","selfish","ko","lodash"],function(e){var t=e("selfish"),n=e("ko"),r=e("lodash"),i=t.Base.extend({className:"Note",initialize:function(e){var t=this;t.key=e.key,t.domain_id=e.domain_id,t.note=n.observable(e.note),t.date=n.observable(e.date)},payload:function(){return{note:this.note(),domain_id:this.domain_id,date:this.date(),client_update_timestamp:(new Date).getTime()}}});return i}),tadpoles.define("model/assessment/editNoteModal",["require","ko","jquery","lodash","services/modal","utilities","services/uuid","model/remote","model/globalFilter","services/alerts","model/curriculum/curriculum","model/assessment/note","emit"],function(e){var t=e("ko"),n=e("jquery"),r=e("lodash"),i=e("services/modal"),s=e("utilities"),o=e("services/uuid"),u=e("model/remote"),a=e("model/globalFilter"),f=e("services/alerts"),l=e("model/curriculum/curriculum"),c=e("model/assessment/note"),h=e("emit"),p=i.extend(u,{className:"EditNoteModal",initialize:function(e){e=e||{};var n=this;this.assessment=t.observable(),this.originalNote=t.observable(),this.note=t.observable(),this.date=t.observable(),this.dirty=t.observable(!1),this.focusTrigger=t.observable(!1),i.initialize.call(this,{template:"view/modals/assessment/editNoteModal",model:this}),u.initialize.call(this,{path:"/remote/v1/assessment",method:"post",success:function(){n.originalNote().note(n.note()),n.originalNote().date(n.date()),n.close()}}),this.dirtyObserver=t.createDirtyObserver([this.note])},isDirty:function(){return this.dirtyObserver.dirty()},init:function(){this.dirtyObserver.reset()},open:function(e,t){this.assessment(e),this.originalNote(t),this.note(t.note()),this.date((e.lastDate||new Date).format("isoDate")),this.init(),i.open.call(this),this.focus()},upload:function(e){var r=this,i=c.create({domain_id:this.originalNote().domain_id,date:e?this.originalNote().date():this.date(),note:n.trim(this.note())}),s={assessment:t.toJSON(this.assessment().payload()),note:t.toJSON(i.payload())};this.makeRequest({data:s})},remove:function(){var e=this,t="Delete this note?",n="This action cannot be undone. Delete anyway?";f.showYesNo({title:t,message:n,yes:function(){e.note(""),e.date(null),e.upload(!0)},no:function(){}})},save:function(){this.upload()},confirmAndClose:function(){if(!this.isDirty()){this.close();return}var e=this,t="Discard any changes?",n="Any changes you have made will be lost.";f.showYesNo({title:t,message:n,yes:function(){e.close()},no:function(){}})},saveAndClose:function(){this.isDirty()?this.save():this.close()},close:function(){this.note(null),this.date(null),this.assessment(null),this.originalNote(null),this.focusTrigger(!1),i.close.call(this)},isPopulated:function(){return this.note()&&n.trim(this.note()).length>0},focus:function(){var e=this;r.delay(function(){e.focusTrigger(!0)},500)},valid:function(){return!0}});return s.makeSingleton(p)}),tadpoles.define("model/assessment/assessment",["require","selfish","ko","lodash","services/config","model/assessment/rating","services/alerts","model/remote","services/curricula","model/assessment/evidence","model/printable","model/assessment/note","model/assessment/editNoteModal"],function(e){var t=e("selfish"),n=e("ko"),r=e("lodash"),i=e("services/config"),s=e("model/assessment/rating"),o=e("services/alerts"),u=e("model/remote"),a=e("services/curricula"),f=e("model/assessment/evidence"),l=e("model/printable"),c=e("model/assessment/note"),h=e("model/assessment/editNoteModal");if(i.isDemo)var p={};var d=t.Base.extend(l,{className:"Assessment",initialize:function(e){var t=this;l.initialize.call(t,"assess-printable"),t.key=e.key,t.subject_key=n.observable(e.subject_key),t.curriculum_id=n.observable(e.curriculum_id),t.ratingsById={},t.notesByDomainId={},t.evidence=n.observableArray([]),t.evidenceByDomain=n.pureComputed(function(){var e={};return r.each(t.evidence(),function(t){r.each(t.domainIds,function(n){var r=e[n];r||(r=[],e[n]=r),r.push(t)})}),e}),t.lastDate=new Date;var o=a.getInstance().getCurriculumById(t.curriculum_id());o&&r.each(o.domains,function(e){r.each(e.outcomes,function(e){t.ratingsById[e.id]=s.create({goal_id:e.id,rating:0,date:null})}),t.notesByDomainId[e.id]=c.create({domain_id:e.id,note:"",date:null})}),t.notesByDomainId.__assess__=c.create({domain_id:"__assess__",note:"",date:null}),r.each(e.ratings,function(e){t.ratingsById[e.goal_id]=s.create(e)});if(i.isDemo){var u=p[t.subject_key()];r.each(u,function(e){t.ratingsById[e.goalId]=e})}r.each(e.notes,function(e){t.notesByDomainId[e.domain_id]=c.create(e)}),t.evidence(r.map(e.evidence,function(e){return f.create(e)})),t.includePhotosForPrinting=n.observable(!1)},printWithoutPhotos:function(){this.includePhotosForPrinting(!1),this.print()},printWithPhotos:function(){this.includePhotosForPrinting(!0),this.print()},payload:function(){return{subject_key:this.subject_key(),curriculum_id:this.curriculum_id()}},uploadRating:function(e,t){var r=this,a=r.ratingsById[e],f=a.rating(),l=a.date(),c=new Date;this.lastDate&&this.lastDate.getMonth()>=c.getMonth()&&this.lastDate.getFullYear()>=c.getFullYear()&&(this.lastDate=c);var h=s.create({goal_id:e,date:(this.lastDate||c).format("isoDate"),rating:t});i.isDemo&&(p[r.subject_key()]=p[r.subject_key()]||{},p[r.subject_key()][e]=h),a.rating(h.rating()),a.date(h.date());var d=u.create({path:"/remote/v1/assessment",method:"post",success:function(){},error:function(){a.rating(f),a.date(l),o.showAlert("Oops!","Something went wrong on our end, please try again")}}),v={assessment:n.toJSON(this.payload()),rating:n.toJSON(h.payload())};d.makeRequest({data:v})},editNote:function(e){h.getInstance().open(this,e)}});return d}),tadpoles.define("model/modal/portfolioEventEditModal",["require","ko","lodash","services/uuid","model/modal/editModal","services/curricula","emit","services/alerts","model/remote","services/dirtyObserver"],function(e){function l(e){return String(e).replace(/[&<>"'\/]/g,function(e){return f[e]})}var t=e("ko"),n=e("lodash"),r=e("services/uuid"),i=e("model/modal/editModal"),s=e("services/curricula"),o=e("emit"),u=e("services/alerts"),a=e("model/remote");e("services/dirtyObserver");var f={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},c=i.extend({className:"PortfolioEventEditModal",initialize:function(){var e=this;this.curriculum=t.observable(),this.evidence=t.observable(),this.domains=t.pureComputed(function(){var t=[],r=e.curriculum();return r?(t=n.map(r.domains,function(e){return{id:e.id,name:e.name||e.id,st:e.st}}),t):t}),this.selectedDomains=t.observableArray([]),this.goals=t.observable(),this.selectedGoals=t.observableArray([]),this.curriculumGoals=t.pureComputed(function(){function r(t){var r=[];if(e.curriculum()){var i=s.getInstance().getDomainById(t);i&&(r=n.filter(i.outcomes,"id"))}return r}var t=[];return n.each(e.selectedDomains(),function(e){t=n.union(t,r(e.id))}),t.length===0&&(t.push({id:"none",name:"None"}),e.selectedGoals.push({id:"none",name:"None",rating:0})),e.selectedGoals.remove(function(e){return!n.detect(t,function(t){return t.id===e.id})}),t}),this.description=t.observable(),i.initialize.call(this,{template:"view/modals/portfolioEventEdit",typeName:"event"}),this.dirtyObserver=t.createDirtyObserver([this.selectedDomains,this.description,this.selectedGoals])},open:function(e,t,n){this.width("940"),this.curriculum(t),this.evidence(n),i.open.call(this,e)},selectDomain:function(e){var t=this.selectedDomains.remove(function(t){return t.id===e.id}).length===0;t&&this.selectedDomains.push({id:e.id,name:e.name})},domainSelected:function(e){return n.contains(n.pluck(this.selectedDomains(),"id"),e)},selectGoal:function(e){var t=e.id;if(t==="none")return;var n=this.selectedGoals.remove(function(e){return e.id===t}).length===0;n&&this.selectedGoals.push({id:t,name:e.name,rating:0})},goalSelected:function(e){return n.contains(n.pluck(this.selectedGoals(),"id"),e)},onClear:function(){this.selectedDomains([]),this.description(null),this.selectedGoals([]),this.goals(null)},populate:function(){var e=this,t=this.originalValue();if(t){if(t.c_domains()&&t.c_domains().length>0)for(var r=0;r<t.c_domains().length;r++)this.selectedDomains.push({id:n.clone(t.c_domains()[r]),name:n.clone(t.labels[r])});if(t.goals&&t.goals.length>0)for(var r=0;r<t.goals.length;r++)this.selectedGoals.push({id:n.clone(t.goals[r]),name:n.clone(t.goalLabels[r]),rating:0});this.description(t.comment())}},isPopulated:function(){return!0},getUploadPath:function(){return"/remote/v1/event/update"},getBlobUploadPath:function(){return this.getUploadPath()},getUploadData:function(){var e=n(this.selectedGoals()).reject(function(e){return e.id.toLowerCase()==="none"}).value();return{event:t.toJSON({key:this.originalValue().key,comment:this.description(),c_domains:this.selectedDomains?n.pluck(this.selectedDomains(),"id"):[],labels:this.selectedDomains?n.pluck(this.selectedDomains(),"name"):[],c_goals:n.pluck(e,"id"),c_goal_labels:n.pluck(e,"name"),c_goal_ratings:n.pluck(e,"rating")})}},onSave:function(){o.emit("observation-updated",this.originalValue())},remove:function(){var e=this;u.showYesNo({message:"Are you sure you want to delete this observation?",yes:function(){var t=a.create({path:"/remote/v1/event/delete",method:"post",success:function(t){o.emit("observation-deleted",e.originalValue().key),e.afterSave(!0)},error:function(){u.showAlert("Oops!","Something went wrong on our end, please try again")}});t.makeRequest({data:{key:e.originalValue().key}})}})}});return c}),tadpoles.define("model/observations",["require","ko","jquery","lodash","selfish","emit","services/modal","services/eventLoader","services/domains","model/selections","model/printable","utilities","services/groups","model/remote","model/assessment/assessment","model/assessment/evidence","model/assessment/note","model/product","model/month","services/alerts","model/selectable","model/modal/editPeriodModal","model/curriculaPeriods","services/disposer","model/modal/portfolioEventEditModal"],function(e){var t=e("ko"),n=e("jquery"),r=e("lodash"),i=e("selfish"),s=e("emit"),o=e("services/modal"),u=e("services/eventLoader"),a=e("services/domains"),f=e("model/selections"),l=e("model/printable"),c=e("utilities"),h=e("services/groups"),p=e("model/remote"),d=e("model/assessment/assessment"),v=e("model/assessment/evidence"),m=e("model/assessment/note"),g=e("model/product"),y=e("model/month"),b=e("services/alerts"),w=e("model/selectable"),E=e("model/modal/editPeriodModal"),S=e("model/curriculaPeriods"),x=e("services/disposer"),T=c.makeSingleton(e("model/modal/portfolioEventEditModal")),N={OBSERVATIONS:"observations",INCIDENTS:"incidents",DAILY_REPORTS:"daily reports",NOTES:"notes",ASSESSMENT:"assessment"},C=E.create({}),k=i.Base.extend(l,o,{className:"PortfolioPrinter",initialize:function(e){var n=this;this.printId=t.observable((new Date).getTime()),this.selections=t.observable(e.selections),this.showNotes=t.observable(e.showNotes),this.numCols=t.pureComputed(function(){var e=n.selections().length;return e==1?1:e<5?2:e<10?3:e<17?4:5}),l.initialize.call(this,this.printId()),o.initialize.call(this,{template:"view/modals/portfolioPrint",width:690})},doPrinting:function(){this.openOffScreen();var e=this;r.delay(function(){e.print(),e.close()},400)}}),L=i.Base.extend(u,o,f,S,{className:"Observations",initialize:function(e){e=e||{};var n=this;o.initialize.call(n,{template:e.template,model:n,width:e.width}),S.initialize.call(n,{}),f.initialize.call(n,{tileType:"event",maxSelections:12}),n.child=t.observable(e.child),n.observationDomains=t.observableArray(),n.curriculum=t.observable({}),n.assessment=t.observable(),n.assessmentLocked=t.observable(!1),n.periods=t.pureComputed(function(){var e=n.child();if(!e)return[];if(n.customCurriculaPeriodsActive())return n.curriculaPeriodSelectables({group:"obs-month",selectedIndex:0});var t=e.schedule().enrollment_date();return t||(t=new Date,t.setFullYear(t.getFullYear()-3)),[y.create({all:!0,group:"obs-month"})].concat(y.createMonths(t.getTime(),(new Date).getTime(),"obs-month"))}),n.selectedPeriodStartDateDisplay=t.pureComputed(function(){if(!n.selectedPeriod())return;return n.selectedPeriod().startDate().format("mmm d")}),n.selectedPeriodEndDateDisplay=t.pureComputed(function(){if(!n.selectedPeriod())return;return n.selectedPeriod().endDate().yesterday().format("mmm d")}),s.on("obs-month-selected",function(e){if(e.key==="add"){C.open(n);return}n.selectedPeriod(e.key!=="all"?e:null),r.each(n.periods(),function(t){t.key!==e.key&&t.deselect()})}),n.editPeriod=function(){C.open(n,n.selectedPeriod())},n.activeType=t.observable(),n.assessmentActive=t.pureComputed(function(){return n.activeType()===N.ASSESSMENT}),n.observationsActive=t.pureComputed(function(){return n.activeType()===N.OBSERVATIONS}),n.incidentsActive=t.pureComputed(function(){return n.activeType()===N.INCIDENTS}),n.dailyReportsActive=t.pureComputed(function(){return n.activeType()===N.DAILY_REPORTS}),n.notesActive=t.pureComputed(function(){return n.activeType()===N.NOTES}),n.filterType=t.pureComputed(function(){var e=null,t=n.activeType();return t===N.OBSERVATIONS||t===N.ASSESSMENT?e="Activity":t===N.INCIDENTS?e="Incident":t===N.DAILY_REPORTS?e="DailyReport":t===N.NOTES&&(e="Note"),e}),n.assessmentLoader=p.create({path:"/remote/v1/assessment/query",method:"post"}),n.observations=t.observableArray([]),n.hasSelection=t.pureComputed(function(){return n.selections().length>0}),n.evidenceByDomain=t.pureComputed(function(){var e=n.assessment();if(!e)return{};var t={};return r.each(n.curriculum.peek().domains,function(e){var i=r.map(n.observationsForDomain(e.name),function(e){return v.fromEvent(e)}),s=n.assessment().evidenceByDomain[e.id]||[];t[e.id]=s.concat(i)}),t}),n.notesByDomain=t.pureComputed(function(){var e=n.assessment();if(!e)return{};var t={};return r.each(n.curriculum.peek().domains,function(e){var r=n.assessment().notesByDomainId[e.id]||[];r||(r=m.create({note:"",domain_id:e.id})),t[e.id]=r}),t}),n.highlightedOutcomesById=t.observable({}),s.on("observation-deleted",function(e){var t=n.observations.remove(function(t){return t.key===e});x.dispose(t)}),s.on("observation-updated",function(e){n.observations([]),r.delay(n.loadEvents)}),s.on("evidenceentered",function(e){var t={};r.each(e.goalIds,function(e){t[e]=!0}),n.highlightedOutcomesById(t)}),s.on("evidenceleft",function(e){n.highlightedOutcomesById({})}),u.initialize.call(n,{loadAll:!0,success:function(e){var t=r.filter(e,function(e){return!e.inOutbox()});r.each(t,function(e){e.showTitleAsDate(e.type!=="dailyreport"),e.showTitle(e.type!=="dailyreport"),e.galleryGroup("modal"),e.portfolioView(!0)}),n.observations(n.observations().concat(t)),n.observationDomains(r(n.observations()).pluck("labels").flatten().uniq().sortBy(function(e){return e.toLowerCase()}).value())}}),n.selectedPeriod.subscribe(function(e){n.loadAll(e?!0:!1);if(e){var t=(new Date).getTime(),r=e.startDate().getTime(),i=e.endDate().getTime();n.assessmentLocked(!(t>=r&&t<i))}else n.assessmentLocked(!1);if(!n.child())return;n.assessmentActive()&&n.loadAssessment(),n.clear(),x.dispose(n.observations()),n.observations([]),n.loadEvents()});var i;n.activeType.subscribe(function(e){i=e},this,"beforeChange"),n.activeType.subscribe(function(e){e===N.ASSESSMENT&&n.loadAssessment();if(!(e!==N.ASSESSMENT&&e!==N.OBSERVATIONS||i!==N.ASSESSMENT&&i!==N.OBSERVATIONS))return;n.clear(),x.dispose(n.observations()),n.observations([]),n.loadEvents()}),n.reset()},open:function(e){var t=this;this.child(e);var n=this.child().curriculum_id();if(!n||n==""){var i=h.getInstance().getGroup(e.homeroom_key());n=i.curriculumId()}t.loadCurricula(function(e){t.periods()[0].select();var r=e.getCurriculumById(n);t.curriculum(r),g.hasFeature(g.Features.CUSTOM_CURRICULUM)&&(t.activeType(N.ASSESSMENT),t.loadAssessment())}),o.open.call(this),r.delay(this.loadEvents)},close:function(){this.child(null),this.reset(),o.close.call(this)},printPhotosOnly:function(){k.create({selections:this.selections(),showNotes:!1}).doPrinting()},printWithNotes:function(){k.create({selections:this.selections(),showNotes:!0}).doPrinting()},remove:function(){r.each(this.selections(),function(e){e.remove(),e.toggleSelection()})},edit:function(){var e=this;this.selections()&&this.selections().length==1&&T.getInstance().open(this.selections()[0],e.curriculum())},editEvidence:function(e){var t=this,n=r.find(t.modals(),{template:"view/modals/observations"});if(n){var i=r.find(n.observations(),{key:e.key});i&&T.getInstance().open(i,n.curriculum())}},download:function(){r.each(this.selections(),function(e){e.downloadWithOthers()})},showDetails:function(){var e=r(this.selections()).reverse().map(function(e){return e.getElement()}).value();n.fancybox.open(e,c.generateFancyDefaults())},resend:function(){var e=this;b.showYesNo({message:"Resend these observations?",yes:function(){r.each(e.selections(),function(e){e.doResend()})}})},addTags:function(){},clear:function(){this.clearSelections(),this.results.clear()},reset:function(){this.clear(),x.dispose(this.observations()),this.observations([]),this.selectedPeriod(null),this.activeType(N.OBSERVATIONS)},loadEvents:function(){if(!this.child())return;u.loadEvents.call(this)},loadAssessment:function(){if(!this.curriculum())return;var e=this;this.assessment(null);var t={subject_key:e.child().key,curriculum_id:e.curriculum().id};this.selectedPeriod()&&(t.start_date=this.selectedPeriod().startDate().format("isoDate"),t.end_date=this.selectedPeriod().endDate().format("isoDate")),this.assessmentLoader.makeRequest({data:t,success:function(n){var r=n.assessment?d.create(n.assessment):d.create(t);e.selectedPeriod()&&(r.lastDate=e.selectedPeriod().getLastDayOfPeriod()),e.assessment(r)}})},requestData:function(){var e=null;return this.selectedPeriod()?e={direction:"range",earliest_event_time:Math.floor(this.selectedPeriod().startDate().getTime()/1e3),latest_event_time:Math.floor(this.selectedPeriod().endDate().getTime()/1e3)}:e={create_time:Math.floor((new Date).getTime()/1e3),direction:"older"},e.member_key=this.child().key,e.num_events=300,e.type=this.filterType(),e},filterForDomain:function(e,t){var n=r.map(e.labels,function(e){return a.getInstance().getGenericDomainForDomain(e)}),i=a.getInstance().getGenericDomainForDomain(t);return r.contains(n,i)},observationsForDomain:function(e){var t=this;return r.filter(this.observations(),function(n){return t.filterForDomain(n,e)})},noteForDomain:function(e){return this.assessment()?this.assessment().notesByDomainId[e]:null},evidenceForDomain:function(e){return this.evidenceByDomain()[e]||[]},ratingForOutcome:function(e){return this.assessment()?this.assessment().ratingsById[e]:null},ratingPopupForOutcome:function(e){var t=this.ratingForOutcome(e);return t?t.getPopoverParams():{}},setRating:function(e,t){this.assessment().uploadRating(e,t)},hasObservationsForDomain:function(e){return this.observationsForDomain(e).length>0},untaggedObservations:function(){return r.filter(this.observations(),function(e){return!e.labels||e.labels.length===0||e.labels[0]=="fun photo"})},unlockAndApply:function(e){var t=this,n=[];arguments.length>1&&(n=r.rest(arguments)),this.assessmentLocked()?b.showYesNo({message:"Unlock the assessment for "+t.selectedPeriod().name()+" "+t.selectedPeriod().caption()+" for edit?",yes:function(){t.assessmentLocked(!1),e.apply(t,n)}}):e.apply(this,n)}});return L.EventTypes=N,L}),tadpoles.define("chart/enrollment",["require","ko","jquery","selfish","utilities","services/children","google"],function(e){var t=e("ko"),n=e("jquery"),r=e("selfish"),i=e("utilities"),s=e("services/children"),o=!1,u=e("google");u.load("visualization","1",{packages:["corechart"],callback:function(){o=!0}});var a=r.Base.extend({className:"EnrollmentChart",initialize:function(){var e=null},calculateCounts:function(){return i.countSchedules(s.getInstance().activeEnrolledChildrenForSelectedGroup())},drawChart:function(t){if(!o)return;var r=this.calculateCounts(),i=u.visualization.arrayToDataTable([["Day","All day","Morning","Afternoon","Before/After School"],["M",r.mondayF,r.mondayA,r.mondayP,r.mondayBA],["T",r.tuesdayF,r.tuesdayA,r.tuesdayP,r.tuesdayBA],["W",r.wednesdayF,r.wednesdayA,r.wednesdayP,r.wednesdayBA],["T",r.thursdayF,r.thursdayA,r.thursdayP,r.thursdayBA],["F",r.fridayF,r.fridayA,r.fridayP,r.fridayBA]]),s={title:"Daily Enrollment",backgroundColor:"white",chartArea:{width:"83%",height:"92%"},height:250,width:260,legend:{position:"none"},isStacked:!0,titlePosition:"none",axisTitlesPosition:"in",hAxis:{textPosition:"in",textStyle:{color:"black"}},vAxis:{textPosition:"out",gridlines:{count:4}}},a=n("#chart_div",t)[0];this.clearChart(),this.chart=new u.visualization.ColumnChart(a),this.chart.draw(i,s)},clearChart:function(){this.chart&&(this.chart.clearChart(),this.chart=null)},popoverData:function(){var t=this;return{content:'<div id="chart_div" style="height: 250px;"></div>',placement:"in left",animation:!0,trigger:"hover",delay:{show:100,hide:100},onShow:t.drawChart,onHide:t.clearChart}}});return a.create()}),tadpoles.define("model/stats",["require","ko","selfish","chart/enrollment","services/children"],function(e){var t=e("ko"),n=e("selfish"),r=e("chart/enrollment"),i=e("services/children"),s=n.Base.extend({className:"Stats",initialize:function(){var e=this;e.enrollmentCount=t.pureComputed(function(){return i.getInstance().activeEnrolledChildrenForSelectedGroup().length}),e.enrollmentChart=r}});return s.create()}),tadpoles.define("chart/graphs",["require","google","lodash","ko","emit","jstz","chart/dataTable","model/measurable","model/globalFilter","model/detailViewPanel","selfish","services/groups","model/actionTile","services/metrics"],function(e){function y(){var e=225,t=0;try{t=window.innerHeight}catch(n){}if(t===0)try{t=window.screen.height}catch(n){}return t===0&&(t=800),t-e}function b(){return d<10?1:7}function w(e){var t=new Date,r=t.getTime(),i=n.range(e,0,-1);return n.map(i,function(e){return new Date(r-e*24*60*60*1e3)})}function E(e){return w(d)[e]}function S(e){return n.map(e,function(e){return e.toISO8601()})}function x(e){var t=n.uniq(n.flatten(n.map(e,function(e){return e.metricDates()})));return t.sort(),t}function T(e,t){if(!e||e.length==0)return;var r=S(w(d)),i=n.map(r,function(r){var i=n.map(e,function(e){return e.metricValue(t,r)});return n.flatten([o.dateToDay({dateString:r}),i])}),u=n.map(e,function(e){return e.name()});return s.getInstance().appendSeriesLabels(u,"day",i),i}function N(e){if(!e)return;var t=S(w(d)),r=n.map(t,function(t){var r=n.map(e,function(e){return l.getInstance().allGroup.metricValue(e,t)});return n.flatten([o.dateToDay({dateString:t}),r])});return s.getInstance().appendSeriesLabels(M(e),"day",r),r}function C(e){var t=e.selectedDate;u.date(t),a.getInstance().chooseObservations()}function k(e){var t=e.selectedDate;u.date(t),a.getInstance().chooseDailyReports()}function L(e){}function A(e){return n.map(e,function(e){return e.darkColor()})}function O(e){return n.map(e,function(e){return e===o.METRIC_PARENT_ACCESS_EMAIL?"#8888F8":e===o.METRIC_PARENT_ACCESS_WEB?"purple":e===o.METRIC_PARENT_ACCESS_MOBILE_APP?"orange":"dark gray"})}function M(e){return n.map(e,function(e){if(e===o.METRIC_PARENT_ACCESS_EMAIL)return"Email";if(e===o.METRIC_PARENT_ACCESS_WEB)return"Web";if(e===o.METRIC_PARENT_ACCESS_MOBILE_APP)return"Mobile"})}var t=e("google"),n=e("lodash"),r=e("ko"),i=e("emit");e("jstz");var s=e("chart/dataTable"),o=e("model/measurable"),u=e("model/globalFilter"),a=e("model/detailViewPanel"),f=e("selfish"),l=e("services/groups"),c=e("model/actionTile"),h=e("services/metrics"),p=-1,d=-1,v=!1,m=250,g=900,_=f.Base.extend(c,{className:"Graph",initialize:function(e){var t=this;c.initialize.call(this),t.classes=e.classes,t.metricName=e.metricName,t.divId=e.divId,t.title=e.title,t.onSelect=e.onSelect,t.chart=null,t.getClassesForMetrics=r.pureComputed(function(){var e;return u.isClassSelected()?e=[l.getInstance().allGroup,u.group()]:e=l.getInstance().allForCurrentLocationWithChildren(),e})},graphHeight:function(){var e=this.getClassesForMetrics();return e.length<12?m:m+25*(e.length-12)},shouldStack:function(){return!u.isClassSelected()},doDraw:function(e){var r=this,i=e.isStacked,s=e.logScale||!1,o=e.height||y()-20,u=e.width||580,a=e.data,f=e.div,l=e.title||"",c=e.onSelect,h=e.onHover,p=e.onMouseOver,d=e.onMouseOut,v=e.colors;if(!a||a.length===0)return;var m=t.visualization.arrayToDataTable(a),g={animation:{duration:2e3},title:l,titleTextStyle:{color:"gray",fontSize:14,bold:!1},backgroundColor:"#f3f3f3",chartArea:{width:"86%",height:"72%"},legend:{position:"none"},lineWidth:1,height:o,width:u,titlePosition:"in",axisTitlesPosition:"out",hAxis:{textPosition:"out",textStyle:{color:"gray"},showTextEvery:b(),maxAlternation:2,slantedText:!1},vAxis:{textPosition:"out",gridlines:{count:4},logScale:s,textStyle:{color:"gray"},minValue:0},focusTarget:"category",curveType:"none",isStacked:i,tooltip:{showColorCode:!0}};v&&(g.colors=v);var w=document.getElementById(f);w?(r.chart&&r.chart.clearChart(),r.chart=new t.visualization.AreaChart(w),r.chart.draw(m,g),c&&t.visualization.events.addListener(r.chart,"select",function(){var e=r.chart.getSelection(),t=e[0];if(t){var n=E(t.row);c({selectedDate:n,row:t.row})}}),h&&t.visualization.events.addListener(r.chart,"onmouseover",n.throttle(function(e){var t=e.row,n=E(t);h({selectedDate:n,row:t})},200)),d&&t.visualization.events.addListener(r.chart,"onmouseout",d),p&&t.visualization.events.addListener(r.chart,"onmouseover",p)):console.log("No div!")},draw:function(){if(this.metricName==="parent_access"){this.drawParentAccess();return}var e=this.getClassesForMetrics(),t=T(e,this.metricName);this.doDraw({colors:A(e),data:t,div:this.divId,height:this.graphHeight(),width:g/2-10,title:this.title,isStacked:this.shouldStack(),onSelect:this.onSelect})},drawParentAccess:function(){var e=[o.METRIC_PARENT_ACCESS_EMAIL,o.METRIC_PARENT_ACCESS_WEB,o.METRIC_PARENT_ACCESS_MOBILE_APP],t=N(e);this.doDraw({colors:O(e),data:t,div:this.divId,height:this.graphHeight(),width:g/2-10,title:this.title,isStacked:!1,onSelect:this.onSelect})}}),D=f.Base.extend({className:"Graphs",initialize:function(){var e=this,r=_.create({metricName:o.METRIC_TOTAL_PHOTOS,divId:"total_photos_chart_div",title:"Total number of photos sent",onSelect:C}),s=_.create({metricName:o.METRIC_KIDS_WITH_PHOTOS,divId:"kids_with_photos_chart_div",title:"Number of families that received a photo",onSelect:C}),u=_.create({metricName:o.METRIC_FACEBOOK_SHARES,divId:"fb_shares_chart_div",title:"Number of photos shared to Facebook",onSelect:C}),a=_.create({metricName:o.METRIC_FACEBOOK_VIEWS,divId:"fb_views_chart_div",title:"Number of views from Facebook by your parents' friends",onSelect:C}),f=_.create({metricName:o.METRIC_STUDENTS_NO_MEDIA_DAILY_REPORTS,divId:"dailies_no_media_chart_div",title:"Number of daily reports without a photo",onSelect:k}),l=_.create({metricName:o.METRIC_PAPER_SAVED,divId:"paper_saved_chart_div",title:"Sheets of paper saved",onSelect:k}),c=_.create({metricName:"parent_access",divId:"parent_access_chart_div",title:"Parent Use",onSelect:L});e.graphs=[s,r,u,a,f,l,c],e.drawWhenReady=n.after(3,e.drawMetrics),t.load("visualization","1",{packages:["corechart"],callback:e.drawWhenReady}),i.on("class-filter-changed",e.onClassroomFilterChanged),i.on("metrics-loaded",e.onMetricsLoaded),i.on("parameterRequestComplete",e.drawWhenReady),i.on("groups-for-current-location-w-children-updated",e.onClassroomFilterChanged)},allowDrawAtAnyTime:function(){v=!0,this.drawWhenReady=this.drawMetrics},drawIfReady:function(){v&&this.drawMetrics()},drawMetrics:function(){this.allowDrawAtAnyTime();if(!h.metricsEnabled())return;n.each(this.graphs,function(e){e.draw()})},onMetricsLoaded:function(t){p=t.days,d=30,this.drawWhenReady()},onClassroomFilterChanged:function(){this.drawIfReady()}});return D.create()}),tadpoles.define("model/device",["require","ko","lodash","selfish"],function(e){var t=e("ko"),n=e("lodash"),r=e("selfish"),i=r.Base.extend({className:"Device",initialize:function(e){var t=this;t.model=e.model,t.className=e.class_name,t.appVersion=e.app_version,t.osVersion=e.os_version,t.lastUsed=e.last_used?new Date(e.last_used):null,t.lastUsedDisplay=t.lastUsed?t.lastUsed.humaneDate(null,!0,!0):"",t.isOutOfDate=t.model.toLowerCase().indexOf("ipod touch 4")>-1?t.appVersion!==t.LATEST_CLASSIC_VERSION:t.appVersion!==t.LATEST_VERSION,t.trainingStart=e.training_start?new Date(e.training_start):null,t.trainingStartDisplay=t.trainingStart?"Yes":""},LATEST_VERSION:"6.10.28",LATEST_CLASSIC_VERSION:"4.0.14"});return i}),tadpoles.define("model/modal/devices",["require","ko","lodash","services/modal","utilities","model/remote","services/alerts","model/globalFilter","model/device"],function(e){var t=e("ko"),n=e("lodash"),r=e("services/modal"),i=e("utilities"),s=e("model/remote"),o=e("services/alerts"),u=e("model/globalFilter"),a=e("model/device"),f=r.extend(s,{className:"DevicesModal",initialize:function(e){e=e||{};var i=this;i.devices=t.observableArray([]),i.sortProperty=t.observable("className"),i.sortAscending=t.observable(!0),r.initialize.call(i,{template:"view/modals/devices",maxHeight:"425"}),s.initialize.call(i,{path:"/admin/location/devices",method:"post",success:function(e){i.devices(n.map(e.devices,function(e){return a.create(e)})),i.sortByProperty()},error:function(e,t){o.showAlert("Uh oh!",t,"error")}})},open:function(e){this.loadDevices(e),r.open.call(this)},close:function(){this.devices([]),r.close.call(this)},loadDevices:function(){this.makeRequest({data:{location_key:u.location().key}})},sortByProperty:function(e,t){var r=e||this.sortProperty(),i=r!==this.sortProperty()?!0:t?!this.sortAscending():this.sortAscending(),s=n.sortBy(this.devices(),function(e){return e[r]});i||(s=s.reverse()),this.sortAscending(i),this.sortProperty(r),this.devices(s)},latestVersion:function(){return a.LATEST_VERSION}});return i.makeSingleton(f)}),tadpoles.define("services/object",["require","emit","model/remote"],function(e){function r(e){var r=e.key,i=e.action,s=e.kind,o=n.create({path:"/remote/v1/object",method:"get",error:function(){t.emit("sync-failed",{})},success:function(e){var n="object-change:"+s,r=e.object;t.emit(n,r)}});o.makeRequest({data:{key:r}})}var t=e("emit"),n=e("model/remote");t.on("object-change",r)}),tadpoles.define("model/curriculum/curriculumEditModal",["require","ko","jquery","lodash","model/modal/editModal","services/uuid","model/curriculum/curriculum","emit"],function(e){var t=e("ko"),n=e("jquery"),r=e("lodash"),i=e("model/modal/editModal"),s=e("services/uuid"),o=e("model/curriculum/curriculum"),u=e("emit"),a=i.extend({className:"CurriculumEditModal",initialize:function(e){e=e||{};var n=this;this.curriculum=t.observable(),this.newCurriculum=t.observable(),this.domain=t.observable(),this.curriculumName=t.observable(),i.initialize.call(this,{template:e.template||"view/modals/curriculum/curriculumEdit",typeName:e.typeName||"curriculum",title:e.title||"curriculum"}),this.isNew=t.pureComputed(function(){return n.typeName()==="curriculum"?!n.curriculum():!n.originalValue()}),this.dirtyObserver=t.createDirtyObserver([this.curriculumName])},open:function(e,t,n){this.curriculum(e),this.domain(t),i.open.call(this,n)},populate:function(){this.curriculumName(this.curriculum()?this.curriculum().name:null)},isPopulated:function(){return this.curriculumName()&&n.trim(this.curriculumName()).length>0},onSave:function(){this.typeName()==="curriculum"?(u.emit("upsert-curriculum",this.newCurriculum()),this.curriculum()||u.emit("curriculum-added",this.newCurriculum())):(this.curriculum().upsertEntry(this.newValue()),!this.originalValue()&&this.typeName()==="domain"&&u.emit("domain-added",this.newValue()))},onClose:function(){this.curriculum(null),this.domain(null)},onClear:function(){this.curriculumName(null),this.newCurriculum(null)},getUploadPath:function(){return"/remote/v1/curriculum/upsert"},getCurriculum:function(e){return this.typeName()!=="curriculum"?this.curriculum():o.create({id:this.curriculum()?this.curriculum().id:s.short(),name:this.curriculumName(),client_update_timestamp:(new Date).getTime(),deleted:e})},createEntry:function(e){return null},getNewValue:function(e){var t=this.getCurriculum(e);return this.newCurriculum(t),this.createEntry({id:this.originalValue()?this.originalValue().id:this.typeName()==="goal"?s.v4():s.short(),capture_time:this.originalValue()?this.originalValue().capture_time:Math.floor((new Date).getTime()/1e3),client_update_timestamp:(new Date).getTime(),deleted:e})},getUploadData:function(){return{curriculum:t.toJSON(this.newCurriculum().toUpload(this.newValue()))}},getDeleteMessage:function(){return this.typeName()==="curriculum"?"This action cannot be undone. The "+this.curriculum().name+" curriculum and all of its subjects, activities and goals will no longer be available.  Delete anyway?":this.typeName()==="domain"?"This action cannot be undone. The "+this.originalValue().name+" subject or activity and all of its goals will no longer be available.  Delete anyway?":"This action cannot be undone. Delete anyway?"}});return a}),tadpoles.define("model/curriculum/domainEditModal",["require","ko","lodash","jquery","model/curriculum/domainEntry","model/curriculum/curriculumEditModal","utilities","services/dirtyObserver"],function(e){var t=e("ko"),n=e("lodash"),r=e("jquery"),i=e("model/curriculum/domainEntry"),s=e("model/curriculum/curriculumEditModal"),o=e("utilities");e("services/dirtyObserver");var u=s.extend({className:"DomainEditModal",initialize:function(e){var n=this;s.initialize.call(this,{template:"view/modals/curriculum/domainEdit",typeName:"domain",title:"subject or activity"}),this.name=t.observable(),this.sort=t.observable(),this.dirtyObserver=t.createDirtyObserver([this.name,this.sort])},createEntry:function(e){return e.name=this.name(),e.sort=this.sort(),i.create(e)},onClear:function(){this.name(null),this.sort(null),s.onClear.call(this)},populate:function(){var e=this.originalValue();e&&(this.name(e.name),this.sort(e.sort))},isPopulated:function(){return this.name()&&r.trim(this.name()).length>0}});return o.makeSingleton(u)}),tadpoles.define("model/curriculum/outcomeEditModal",["require","ko","lodash","jquery","model/curriculum/outcomeEntry","model/curriculum/curriculumEditModal","utilities","services/dirtyObserver"],function(e){var t=e("ko"),n=e("lodash"),r=e("jquery"),i=e("model/curriculum/outcomeEntry"),s=e("model/curriculum/curriculumEditModal"),o=e("utilities");e("services/dirtyObserver");var u=s.extend({className:"OutcomeEditModal",initialize:function(e){var n=this;s.initialize.call(this,{template:"view/modals/curriculum/outcomeEdit",typeName:"goal",title:"developmental goal"}),this.name=t.observable(),this.externalId=t.observable(),this.hierarchyOne=t.observable(),this.hierarchyTwo=t.observable(),this.hierarchyThree=t.observable(),this.dirtyObserver=t.createDirtyObserver([this.name,this.externalId,this.hierarchyOne,this.hierarchyTwo,this.hierarchyThree])},createEntry:function(e){return e.domain_id=this.domain().id,e.name=this.name(),e.e_id=this.externalId(),e.hierarchy=[],this.hierarchyOne()&&e.hierarchy.push(this.hierarchyOne()),this.hierarchyTwo()&&e.hierarchy.push(this.hierarchyTwo()),this.hierarchyThree()&&e.hierarchy.push(this.hierarchyThree()),i.create(e)},onClear:function(){this.name(null),this.externalId(null),this.hierarchyOne(null),this.hierarchyTwo(null),this.hierarchyThree(null),s.onClear.call(this)},populate:function(){var e=this.originalValue();e&&(this.name(e.name),this.externalId(e.externalId),e.hierarchy&&e.hierarchy.length>0&&this.hierarchyOne(e.hierarchy[0]),e.hierarchy&&e.hierarchy.length>1&&this.hierarchyTwo(e.hierarchy[1]),e.hierarchy&&e.hierarchy.length>2&&this.hierarchyThree(e.hierarchy[2]))},isPopulated:function(){return this.name()&&r.trim(this.name()).length>0}});return o.makeSingleton(u)}),tadpoles.define("model/curriculum/unitEditModal",["require","ko","jquery","lodash","model/modal/editModal","services/uuid","emit","model/curriculum/unit","utilities"],function(e){var t=e("ko"),n=e("jquery"),r=e("lodash"),i=e("model/modal/editModal"),s=e("services/uuid"),o=e("emit"),u=e("model/curriculum/unit"),a=e("utilities"),f={ALWAYS:{name:"Always",id:"always"},WEEK:{name:"Week",id:"week"},DAY:{name:"Day",id:"day"}},l=i.extend({className:"UnitEditModal",initialize:function(e){e=e||{};var n=this;this.curriculum=t.observable(),this.parentUnit=t.observable(),this.name=t.observable(),this.scope=t.observable(f.ALWAYS.id),i.initialize.call(this,{template:"view/modals/curriculum/unitEdit",typeName:"unit",title:"unit of learning"}),this.dirtyObserver=t.createDirtyObserver([this.name])},open:function(e,t,n){this.curriculum(e),this.parentUnit(t),i.open.call(this,n)},isPopulated:function(){return this.name()&&n.trim(this.name()).length>0},populate:function(){this.name(this.originalValue()?this.originalValue().name:null)},onSave:function(){this.newValue().deleted?o.emit("unit-removed",this.newValue()):this.isNew()?o.emit("unit-added",this.newValue()):o.emit("unit-modified",this.newValue())},onClose:function(){this.curriculum(null),this.parentUnit(null)},onClear:function(){this.name(null)},getUploadPath:function(){return"/remote/v1/unit"},getNewValue:function(e){return u.create({id:this.originalValue()?this.originalValue().id:s.short(),curriculum_id:this.curriculum().id,parent_id:this.parentUnit()?this.parentUnit().id:null,numsort:this.originalValue()?this.originalValue().numsort:this.parentUnit().getNextSortVal(),name:this.name(),scope:this.scope(),client_update_timestamp:(new Date).getTime(),deleted:e})},getUploadData:function(){return{unit:t.toJSON(this.newValue().toUpload())}},scopes:f});return a.makeSingleton(l)}),tadpoles.define("model/curriculum/applyCurriculumForm",["require","ko","model/form","utilities","services/groups","selfish","model/wrapped","model/selectable","lodash","emit"],function(e){var t=e("ko"),n=e("model/form"),r=e("utilities"),i=e("services/groups"),s=e("selfish"),o=e("model/wrapped"),u=e("model/selectable"),a=e("lodash"),f=e("emit"),l=s.Base.extend(o,u,{className:"SelectableClassroom",initialize:function(e){o.initialize.call(this,e),u.initialize.call(this,e)}}),c=n.extend({className:"ApplyCurriculumForm",initialize:function(){var e=this;e.curriculumId=t.observable(),e.classrooms=t.observableArray([]),e.initiallySelectedClassrooms=t.observable(),e.selectedClassrooms=t.pureComputed(function(){return a(e.classrooms()).filter(function(e){return e.selected()}).value()}),e.payloadData=t.observable(),n.initialize.call(e,{title:"apply curriculum",formTemplate:"view/modals/curriculum/applyCurriculum",formModel:e,path:"/remote/v1/curriculum/apply",width:540,submitText:"apply",success:function(){a.each(e.payloadData(),function(e){var t=i.getInstance().getGroup(e.key);t&&t.curriculumId(e.curriculum_id)}),f.emit("curriculum-applied",{}),e.close()}})},payload:function(){var e=this,t=a(this.selectedClassrooms()).map(function(e){return e.wrapped().key}).value(),n=a(this.initiallySelectedClassrooms()).filter(function(e){return!a.contains(t,e)}).map(function(e){return{key:e,curriculum_id:null}}).value();return this.payloadData(a(t).map(function(t){return{key:t,curriculum_id:e.curriculumId()}}).concat(n).value()),{data:{classrooms:this.payloadData()}}},open:function(e){this.curriculumId(e);var t=i.getInstance().groupsForCurrentLocation(),r=[];this.classrooms(a(t).map(function(t){var n=l.create({wrapped:t});return n.wrapped().curriculumId()===e&&(n.selected(!0),r.push(t.key)),n}).value()),this.initiallySelectedClassrooms(r),n.open.call(this)},close:function(){this.curriculumId(null),this.classrooms([]),this.initiallySelectedClassrooms([]),this.payloadData(null),n.close.call(this)},valid:function(){return!0}});return r.makeSingleton(c)}),tadpoles.define("model/curriculum/unitActivityEditModal",["require","ko","lodash","model/daily_report/activityEditModal","model/curriculum/activity","utilities","services/uuid","services/typeahead"],function(e){var t=e("ko"),n=e("lodash"),r=e("model/daily_report/activityEditModal"),i=e("model/curriculum/activity"),s=e("utilities"),o=e("services/uuid");e("services/typeahead");var u=r.extend({className:"UnitActivityEditModal",initialize:function(){var e=this;this.unit=t.observable(),r.initialize.call(this)},open:function(e,t,n){this.unit(n),this.curriculum(t),r.open.call(this,null,e)},getWidth:function(){return"940"},domainUsed:function(e){return!1},onSave:function(){this.newValue().deleted?this.unit().removeActivity(this.newValue()):this.unit().addActivity(this.newValue())},onClose:function(){this.unit(null),r.onClose.call(this)},getNewValue:function(e){var t=this;return i.create({id:this.originalValue()?this.originalValue().id:o.short(),unit_id:this.unit().id,numsort:this.originalValue()?this.originalValue().numsort:this.unit().getNextActivitySortVal(),capture_time:this.originalValue()?this.originalValue().capture_time:Math.floor((new Date).getTime()/1e3),cut:(new Date).getTime(),name:this.name(),description:this.description(),domains:n.clone(this.selectedDomains()),goals:n(this.selectedGoals()).reject(function(e){return e.toLowerCase()==="none"}).value(),materials:this.materials(),instructions:this.instructions(),options:n.clone(this.selectedOptions()),notes:this.goals(),deleted:e})},getUploadPath:function(){return"/remote/v1/activity"},getUploadData:function(){return{activity:t.toJSON(this.newValue().toUpload())}},isLesson:function(){return!0},populate:function(){this.mode(this.MODES.Curriculum);var e=this.originalValue();if(!e)return;e.domains&&e.domains.length>0&&this.selectedDomains(n.clone(e.domains)),e.goals&&e.goals.length>0&&this.selectedGoals(n.clone(e.goals)),this.name(e.name),this.description(e.description),this.materials(e.materials),this.instructions(e.instructions),this.goals(e.notes),this.selectedOptions(n.clone(e.options)||[])},getTypeAheadFunc:function(){return[]}});return s.makeSingleton(u)}),tadpoles.define("model/curriculum/unitTree",["require","jquery","ko","lodash","selfish","model/curriculum/unit","model/remote","model/globalFilter","services/alerts","emit","sortable"],function(e){var t=e("jquery"),n=e("ko"),r=e("lodash"),i=e("selfish"),s=e("model/curriculum/unit"),o=e("model/remote"),u=e("model/globalFilter"),a=e("services/alerts"),f=e("emit");e("sortable");var l=12,c=20,h=i.Base.extend({className:"UnitTree",initialize:function(e){var t=this;t.item=null,t.newParent=null,t.newIndex=null,t.topUnit=n.observable(),t.unitsById={},t.units=n.observableArray()},buildUnitTree:function(e){var t=this,n=s.create({});n.top(!0),this.unitsById=r(e).indexBy("id").value(),r.each(e,function(e){if(!e.parentId){n.addChild(e);return}var r=t.unitsById[e.parentId];if(!r)return;r.addChild(e)}),n.sort(),this.topUnit(n),this.units(n.childList())},removeUnitFromTree:function(e){var t=this,n=this.unitsById[e.id];if(!n)return;n.parent().removeChild(n);var i=r(n.childList()).concat([n]).pluck("id").value();r.each(i,function(e){delete t.unitsById[e]}),this.units.remove(function(e){return r.contains(i,e.id)})},addUnitToTree:function(e,t){var n=this;this.unitsById[e.id]=e,r.each(e.childList(),function(e){n.unitsById[e.id]=e});var i=e.parentId?this.unitsById[e.parentId]:this.topUnit();i.addChild(e,t),i.expand();var s=i.top()?0:r.findIndex(this.units(),{id:e.parentId});if(s>=0){r.isNumber(t)&&t>=0?(i.top()||(s+=1),s+=r(i.children()).first(t).reduce(function(e,t){return e+t.childList().length},t)):s+=i.childList().length;var o=[s,0].concat(e).concat(e.childList()),u=this.units.peek();this.units.valueWillMutate(),Array.prototype.splice.apply(u,o),this.units.valueHasMutated()}},moveUnit:function(e,t,r,i){var s=this,l=e.parentId,c=e.numsort;this.removeUnitFromTree(e),e.parentId=r.id,e.numsort=r.getInsertSortVal(e.id,i),this.addUnitToTree(e,i);var h=o.create({path:"/remote/v1/unit",method:"post",success:function(){f.emit("unit-moved",{unit:e})},error:function(){e.parentId=l,e.numsort=c,s.removeUnitFromTree(e),s.addUnitToTree(e,t),a.showAlert("Oops!","Something went wrong on our end, please try again")}}),p={unit:n.toJSON(e.toUpload()),location:u.location().key};h.makeRequest({data:p})},updateUnit:function(e){var t=this.unitsById[e.id];if(t){var n=t.parent();e.parent(n),e.children(t.children()),e.indent=t.indent,e.visible(t.visible()),e.expanded(t.expanded()),n&&n.addChild(e)}this.unitsById[e.id]=e;var i=r.findIndex(this.units(),{id:e.id});i>=0&&(this.units.valueWillMutate(),this.units()[i]=e,this.units.valueHasMutated())},onMove:function(e,t,n){e.cancelDrop=!0},onStart:function(e,t){var r=n.utils.domData.get(t.item[0],"ko_sortItem");this.item=r,this.newParent=null,this.newIndex=null,this.startIndex=r.getCurrentIndex(),r.expanded()&&r.collapse()},onChange:function(e,t){},onSort:function(e,i){var s=i.position.left-i.originalPosition.left,o=t(".tree-placeholder"),u=n.utils.arrayIndexOf(i.item.parent().children().not(".ui-sortable-helper,:hidden"),o[0]),a=n.utils.domData.get(i.item[0],"ko_sortItem"),f=n.utils.domData.get(o[0].parentNode,"ko_sortList"),h=r(f).filter(function(e){return e.visible()&&a.id!==e.id}).value(),p=u>0?h[u-1]:null,d=u<h.length?h[u]:null,v=p?p.indent+1:0,m=null,g=0;p?m=p:d?m=d.parent():m=a.parent();if(v>0){var y=0;s>l&&(y=Math.max(Math.min(Math.floor((s-l)/c)-1,v),0)),v=y;while(m&&v<=m.indent)m=m.parent()}if(!d)g=r.reject(m.children(),{id:a.id}).length;else if(d)if(d.indent!=m.indent+1){var b=p;while(b.indent>m.indent+1)b=b.parent();g=r(m.children()).reject({id:a.id}).findIndex({id:b.id})+1}else g=r(m.children()).reject({id:a.id}).findIndex({id:d.id});this.newParent=m,this.newIndex=g;var w=l+(v+1)*c;o.css({marginLeft:w+"px"})},onStop:function(e,t){r.defer(this.moveUnit,this.item,this.startIndex,this.newParent,this.newIndex),this.item=null,this.newParent=null,this.newIndex=null}});return h}),tadpoles.define("model/curriculum/curriculaEditModal",["require","jquery","ko","lodash","services/modal","services/uuid","model/remote","utilities","model/curriculum/curriculumEditModal","model/curriculum/domainEditModal","model/curriculum/outcomeEditModal","model/curriculum/unitEditModal","model/curriculum/applyCurriculumForm","services/groups","emit","model/curriculum/unitActivityEditModal","model/curriculum/unitTree","model/product","services/children","sortable"],function(e){var t=e("jquery"),n=e("ko"),r=e("lodash"),i=e("services/modal"),s=e("services/uuid"),o=e("model/remote"),u=null,a=e("utilities"),f=a.makeSingleton(e("model/curriculum/curriculumEditModal")),l=e("model/curriculum/domainEditModal"),c=e("model/curriculum/outcomeEditModal"),h=e("model/curriculum/unitEditModal"),p=e("model/curriculum/applyCurriculumForm"),d=e("services/groups"),v=e("emit"),m=e("model/curriculum/unitActivityEditModal"),g=e("model/curriculum/unitTree"),y=e("model/product"),b=e("services/children");e("sortable");var w={SUBJECT_AND_GOALS:{name:"Subjects & Goals"},CURRICULUM:{name:"Units & Activities"}},E=i.extend(o,{className:"CurriculaEditModal",initialize:function(e){var t=this;this.activePanel=n.observable(w.SUBJECT_AND_GOALS),this.panelList=[w.SUBJECT_AND_GOALS],(y.hasFeatureLevel(y.Features.UNITS_OF_LEARNING,y.Levels.UNITS_OF_LEARNING_LEVEL_BETA)||y.hasFeatureLevel(y.Features.UNITS_OF_LEARNING,y.Levels.UNITS_OF_LEARNING_LEVEL_DEV))&&this.panelList.push(w.CURRICULUM),this.curricula=n.observable(),this.selectedCurriculum=n.observable(),this.selectedDomain=n.observable(),this.selectedUnit=n.observable(),this.navOpen=n.observable(!0),this.currentGoals=n.pureComputed(function(){var e=t.selectedDomain();return e?e.outcomes:null}),this.currentDomains=n.pureComputed(function(){t.selectedDomain(null);var e=t.selectedCurriculum();return e?e.domains:null}),this.unitTree=g.create({}),this.currentActivities=n.pureComputed(function(){var e=t.selectedUnit();return e?e.activities:null}),this.selectedCurriculum.subscribe(function(e){t.selectedUnit(null),t.selectedDomain(null),e&&(y.hasFeatureLevel(y.Features.UNITS_OF_LEARNING,y.Levels.UNITS_OF_LEARNING_LEVEL_BETA)||y.hasFeatureLevel(y.Features.UNITS_OF_LEARNING,y.Levels.UNITS_OF_LEARNING_LEVEL_DEV))?e.loadUnits():t.unitTree.buildUnitTree([])}),this.selectedUnit.subscribe(function(e){e&&e.loadActivities()}),v.on("units-loaded",function(e){t.selectedCurriculum()&&t.selectedCurriculum().id===e.curriculum_id&&t.unitTree.buildUnitTree(t.selectedCurriculum().units())}),this.appliedTrigger=n.observable(!1),this.appliedClassrooms=n.pureComputed(function(){if(!t.selectedCurriculum())return[];var e=d.getInstance().groupsForCurrentLocation();return r(e).filter(function(e){return e.curriculumId()===t.selectedCurriculum().id}).value()}),this.appliedStudents=n.pureComputed(function(){if(!t.selectedCurriculum())return[];var e=b.getInstance().children();return r(e).filter(function(e){return e.curriculum_id()===t.selectedCurriculum().id}).value()}),v.on("curriculum-applied",function(){t.appliedTrigger(!t.appliedTrigger())}),o.initialize.call(this,{path:"/remote/v1/curricula/upsert",method:"post",success:function(){}}),i.initialize.call(this,{template:"view/modals/curriculum/curriculaEdit",model:this,width:"920"}),v.on("curricula-modified",function(e){t.curricula(e?r(e.curricula).reject("deleted").value():null)}),v.on("curriculum-modified",function(e){var n=t.selectedCurriculum();if(n&&n.id===e.id&&!e.deleted){var i=t.selectedDomain(),s=i?r.find(e.domains,{id:i.id}):null;t.selectedCurriculum(e),t.selectedDomain(s)}else t.selectedCurriculum(null)}),v.on("curriculum-added",function(e){t.selectedCurriculum(e)}),v.on("domain-added",function(e){t.selectedDomain(e)}),v.on("unit-added",function(e){t.selectedUnit(e);if(!t.selectedCurriculum()||e.curriculumId!==t.selectedCurriculum().id)return;t.unitTree.addUnitToTree(e)}),v.on("unit-removed",function(e){t.selectedUnit()&&t.selectedUnit().id===e.id&&t.selectedUnit(null);if(!t.selectedCurriculum()||e.curriculumId!==t.selectedCurriculum().id)return;t.unitTree.removeUnitFromTree(e)}),v.on("unit-modified",function(e){if(!t.selectedCurriculum()||e.curriculumId!==t.selectedCurriculum().id)return;t.unitTree.updateUnit(e)})},open:function(){this.clearModal();var e=this;u=a.lazyLoadModule(u,"services/curricula"),u.getInstance().getCurriculaDeferred().done(function(t){e.curricula(t?r(t.curricula).reject("deleted").value():null)}),i.open.call(this)},close:function(){this.clearModal(),i.close.call(this)},clearModal:function(){this.clear(),this.curricula(null),this.selectedCurriculum(null),this.selectedDomain(null),this.selectedUnit(null)},editCurriculum:function(e){f.getInstance().open(e)},editDomain:function(e){l.getInstance().open(this.selectedCurriculum(),null,e)},editOutcome:function(e){c.getInstance().open(this.selectedCurriculum(),this.selectedDomain(),e)},editUnit:function(e,t){h.getInstance().open(this.selectedCurriculum(),e,t)},editActivity:function(e){m.getInstance().open(e,this.selectedCurriculum(),this.selectedUnit())},applyToClass:function(){p.getInstance().open(this.selectedCurriculum().id)},panels:w});return a.makeSingleton(E)}),tadpoles.define("services/graduatedChildren",["require","lodash","emit","model/remote","ko"],function(e){var t=e("lodash"),n=e("emit"),r=e("model/remote"),i=e("ko"),s,o=r.extend({className:"GraduatedChildren",initialize:function(){r.initialize.call(this,{path:"/remote/v1/people",error:null,complete:function(){}}),this.loaded=i.observable(!1)},load:t.once(function(e){var t=this;if(tadpoles.isDemo)return;var r={location:e.key,graduated_children_only:!0};this.makeRequest({data:r,success:function(r){t.loaded(!0),r.location=e,n.emit("graduatedChildrenLoaded",r)}})})}),s=o.create();return s}),tadpoles.define("model/rosterGroup",["require","ko","lodash","model/actionTile","model/person","services/children","model/globalFilter","services/graduatedChildren"],function(e){function a(e){switch(e){case i.Statuses.SUSPENDED:return"#888";case i.Statuses.INTERESTED:return"#8f56e4";case i.Statuses.TOURING:return"#5564da";case i.Statuses.VISITED:return"#2ea7c9";case i.Statuses.WAITING:return"#1dc074";case i.Statuses.SCHEDULED:return"#0fc819";case i.Statuses.ACTIVE:return"#5ad000";case i.Statuses.GRADUATED:return"#000000";case i.DerivedStatuses.DISENROLLING:return"#ffd82f"}}function f(e){switch(e){case i.Statuses.INACTIVE:return 0;case i.Statuses.INTERESTED:return 25;case i.Statuses.TOURING:return 16;case i.Statuses.VISITED:return 9;case i.Statuses.WAITING:return 7;case i.Statuses.SCHEDULED:return 10;case i.Statuses.ACTIVE:return 226;case i.DerivedStatuses.DISENROLLING:return 10;default:return 0}}var t=e("ko"),n=e("lodash"),r=e("model/actionTile"),i=e("model/person"),s=e("services/children"),o=e("model/globalFilter"),u=e("services/graduatedChildren"),l=r.extend(r,{initialize:function(e){var f=this;r.initialize.call(f),f.name=t.observable(e.name),f.value=t.observable(e.value),f.count=t.pureComputed(function(){var e=o.groupSelected()?o.group().children():s.getInstance().childrenForLocationAndLabel(),t=0;return n.each(e,function(e){e.status()===f.value()&&(t+=1)}),t}),f.selectedCount=t.pureComputed(function(){if(f.value()===i.Statuses.GRADUATED&&!u.loaded())return"-";var e=o.groupSelected()?o.group().children():s.getInstance().childrenForLocationAndLabel(),t=0;return n.each(e,function(e){e.statuses().indexOf(f.value())!=-1&&(t+=1)}),t}),f.color=t.pureComputed(function(){return a(f.value())})}});return l.colorForStatus=a,l}),tadpoles.define("model/modal/rosterCommunicationsModal",["require","services/modal","model/communication","model/globalFilter","lodash"],function(e){var t=e("services/modal"),n=e("model/communication"),r=e("model/globalFilter"),i=e("lodash"),s=n.extend(t,{className:"RosterCommunicationsModal",initialize:function(e){var r=this;r.rosterGroup=e,n.initialize.call(r,{staffCommunicationMode:!1,rosterSendMode:!0}),t.initialize.call(r,{width:635,template:"view/modals/communicationsModal"})},title:function(){return r.group().key==="all"?"":r.group().name()},open:function(){t.open.call(this)},close:function(){t.close.call(this)},onConfirmSubmit:function(){n.onConfirmSubmit.call(this),this.close()},getMembers:function(){var e=this,t=this.rosterSendMode()?r.group().childrenForRoster():Children.getInstance().children();return i(t).filter(function(t){return t.statuses().indexOf(e.rosterGroup)!=-1}).map(function(e){return e.key}).value()},getScope:function(){return"dependant"},isPipelineNote:function(){return!0},getRosterGroupName:function(){return this.rosterGroup},getRecipientText:function(){var e="",t=this.title();return t&&(e=" in the "+t+" classroom"),"parents of "+this.rosterGroup+" children"+e},valid:function(){return this.content()&&this.content().length>0}});return s}),tadpoles.define("model/roster",["require","ko","lodash","selfish","model/person","model/rosterGroup","model/group","model/globalFilter","model/status","model/user","services/graduatedChildren","model/modal/rosterCommunicationsModal"],function(e){var t=e("ko"),n=e("lodash"),r=e("selfish"),i=e("model/person"),s=e("model/rosterGroup"),o=e("model/group"),u=e("model/globalFilter"),a=e("model/status"),f=e("model/user"),l=e("services/graduatedChildren"),c=e("model/modal/rosterCommunicationsModal"),h=r.Base.extend(a,{initialize:function(){var e=this;e.groups=t.pureComputed(function(){return n(i.AllStatuses).reject(function(e){return e===i.Statuses.DELETED||e===i.Statuses.GRADUATED&&!f.CurrentUser.isCsr()}).map(function(e){return s.create({name:i.getDisplayableStatus(e).toLowerCase(),value:e})}).value()}),e.filter=o.statusFilter,e.groupKey=t.observable(u.groupSelected()?u.group().key:"all"),e.colorForSelectedStatus=t.pureComputed(function(){return s.colorForStatus(e.filter())})},selectGroup:function(e){e.value()==="graduated"&&l.load(u.location()),this.filter(e.value())},sendNote:function(){var e=c.create(this.filter());e.open()}});return h.create()}),tadpoles.define("model/modal/addTour",["require","ko","jquery","lodash","services/config","services/groups","model/group","services/children","model/child","model/guardian","model/form","services/alerts"],function(e){var t=e("ko"),n=e("jquery"),r=e("lodash"),i=e("services/config"),s=e("services/groups"),o=e("model/group"),u=e("services/children"),a=e("model/child"),f=e("model/guardian"),l=e("model/form"),c=e("services/alerts"),h=l.extend({className:"AddTour",initialize:function(e){var r=this;l.initialize.call(this,{title:"add lead",formTemplate:"view/modals/addTour",formModel:this,width:"610",path:"/remote/v1/dependant/create",success:function(e){var t;if(i.isDemo){var n=s.getInstance().getGroup(r.groupKey()),f=r.firstName()+(new Date).getTime();t={key:f,family:f,first_name:r.firstName(),last_name:r.lastName(),child_type:n.child_type,status:"active",group:n},t.guardians=[]}else t=e.dependant;o.statusFilter(t.status),t.location=r.locationKey(),u.getInstance().addChild(a.create(t)),r.close()}}),r.locationKey=t.observable(),r.groupKey=t.observable(),r.firstName=t.observable(),r.lastName=t.observable(),r.rawFullName=t.observable(),r.fullName=t.computed({read:function(){return r.rawFullName()},write:function(e){r.rawFullName(e),e=n.trim(e);var t=e.split(" ");r.firstName(t.length>0?n.trim(t[0]):null),r.lastName(t.length>1?n.trim(t[1]):null)},owner:r}),r.tourDate=t.observable(),r.parentFirstName=t.observable(),r.parentLastName=t.observable(),r.parentRawFullName=t.observable(),r.parentFullName=t.computed({read:function(){return r.parentRawFullName()},write:function(e){r.parentRawFullName(e),e=n.trim(e);var t=e.split(" ");r.parentFirstName(t.length>0?n.trim(t[0]):null),r.parentLastName(t.length>1?n.trim(t[1]):null)},owner:r}),r.parentEmail=t.observable(),r.parentPhone=t.observable()},payload:function(){var e={dependant:{first_name:n.trim(this.firstName()),last_name:n.trim(this.lastName()),tour_date:this.tourDate(),location:this.locationKey(),group:this.groupKey(),status:this.tourDate()?a.Statuses.TOURING:a.Statuses.INTERESTED}};return this.hasParentInfo()&&(e.dependant.guardians=[{first_name:n.trim(this.parentFirstName())||"Parent",last_name:n.trim(this.parentLastName()),type:"primary",email:n.trim(this.parentEmail()),home_number:n.trim(this.parentPhone())}]),e},clear:function(){this.fullName(""),this.tourDate(null),this.locationKey(null),this.groupKey(null),this.parentFullName(""),this.parentEmail(null),this.parentPhone(null)},valid:function(){return!n.trim(this.firstName())||!n.trim(this.lastName())?(c.showAlert("Missing Info","The child's full name is required","warning"),!1):this.groupKey()?n.trim(this.parentEmail())&&!this.isEmailValid(this.parentEmail())?(c.showAlert("Invalid Info","Invalid parent email address","warning"),!1):!0:(c.showAlert("Missing Info","You need to choose a classroom for the child","warning"),!1)},hasParentInfo:function(){return n.trim(this.parentFirstName())||n.trim(this.parentEmail())}});return h}),tadpoles.define("services/brand",["require","ko","lodash","utilities","selfish","model/product","model/globalFilter"],function(e){var t=e("ko"),n=e("lodash"),r=e("utilities"),i=e("selfish"),s=e("model/product"),o=e("model/globalFilter"),u={naps_color:"#0772A1",meals_color:"#00C322",bathroom_color:"#964241",meds_color:"#f00",activities_color:"#ff9312",snapshots_color:"#534d96"},a=i.Base.extend({className:"Brand",initialize:function(e){var n=this;n.brandId=t.pureComputed(function(){if(!s.hasFeature(s.Features.BRAND))return null;var e=null;return o.locationSelected()&&(e=o.location().brand),e||(e=s.getFeature(s.Features.BRAND).value),e}),n.stylesheetUrl=t.pureComputed(function(){return s.hasFeature(s.Features.BRANDED_STYLE)?n.brandId()?"/stylesheets/6/brand/"+n.brandId()+"/style.css":null:null}),n.brandedImages=s.hasFeature(s.Features.BRANDED_IMAGES)?s.hasFeature(s.Features.BRANDED_IMAGES).value||[]:[],n.brandedEmail=s.hasFeature(s.Features.BRANDED_EMAIL)?s.hasFeature(s.Features.BRANDED_EMAIL).value||{}:{}},getBrandImageUrl:function(e){return this.brandId()?n.contains(this.brandedImages,e)?"/images/8/brand/"+this.brandId()+"/"+e+".png":null:null},getBrandColor:function(e){return this.brandedEmail[e]||u[e]}});return r.makeSingleton(a)}),tadpoles.define("services/login",["require","lodash","selfish","model/globalFilter"],function(e){var t=e("lodash"),n=e("selfish"),r=e("model/globalFilter"),i=n.Base.extend({className:"Facebook",initialize:function(e){var t=this;t.loggedInToGoogle=!1,t.logoutRequested=!1},logout:function(e){this.logoutRequested=!0;var n=this.loggedInToGoogle?2e3:0;this.loggedInToGoogle&&gapi.auth.signOut(),t.delay(this.forwardToLogoutPage,n)},forwardToLogoutPage:function(){window.location="/logout?location="+(r.location()?r.location().key:"")}}),s=i.create({});return signinCallback=function(e){s.loggedInToGoogle=e.status.signed_in,s.logoutRequested&&e.error==="user_signed_out"&&s.forwardToLogoutPage()},s}),tadpoles.define("model/modal/importForm",["require","ko","lodash","model/form","model/globalFilter","utilities"],function(e){var t={validate:"validate",apply:"apply"},n=e("ko"),r=e("lodash"),i=e("model/form"),s=e("model/globalFilter"),o=e("utilities"),u={PROCARE:{name:"procare",file_type:"csv",mime_type:"text/csv",id:"procare"},SCHOOL_LEADER:{name:"school leader",file_type:"xls",mime_type:"application/vnd.ms-excel",id:"schoolleaders"}},a=i.extend({initialize:function(e){e=e||{};var r=this;i.initialize.call(r,{title:"import",formTemplate:"view/modals/import",formModel:r,path:"/remote/v1/import",fileUploadPath:"/remote/v1/import",submitText:"upload",success:function(e){r.mode()===t.validate?(r.newStudentCount(e.new),r.updateStudentCount(e.updated),r.removedStudentCount(e.deleted),r.unchangedStudentCount(e.unchanged),r.import_file_name=e.import_file_name,r.import_original_file_name=e.import_original_file_name,r.clearFiles(),r.mode(t.apply),r.submitText("import")):r.close()},error:function(e){r.import_file_name=null,r.import_original_file_name=null}}),this.mode=n.observable(t.validate),this.importType=n.observable(u.PROCARE),this.newStudentCount=n.observable(0),this.updateStudentCount=n.observable(0),this.removedStudentCount=n.observable(0),this.unchangedStudentCount=n.observable(0),this.showValidationResults=n.pureComputed(function(){return r.mode()===t.apply&&!r.hasErrors()})},selectImportType:function(e){var t=r.find(u,{name:e});if(!t)return;this.importType(t)},importTypeSelected:function(e){return this.importType().name===e},payload:function(){return{"import":{file_type:this.importType().id,location:s.location().key,test_import:!1,action:this.mode(),import_file_name:this.import_file_name,import_original_file_name:this.import_original_file_name}}},close:function(){this.mode(t.validate),this.submitText("upload"),this.import_file_name=null,this.import_original_file_name=null,this.clearFiles(),i.close.call(this)}});return a.ImportTypes=u,o.makeSingleton(a)}),tadpoles.define("model/roster_forecaster/pageSizeAndRange",["require"],function(e){return{pageSize:20,dateRange:28}}),tadpoles.define("model/roster_forecaster/paging",["require","selfish","ko","model/roster_forecaster/pageSizeAndRange"],function(e){var t=e("selfish"),n=e("ko"),r=e("model/roster_forecaster/pageSizeAndRange"),i=t.Base.extend({className:"Paging",initialize:function(e){var t=this;this.loaded=r.dateRange,this.offset=n.observable(0),this.dateOffset=n.pureComputed(function(){return t.offset()*(r.dateRange/2)})},incrementOffset:function(){this.offset(this.offset()+1)},decrementOffset:function(){this.offset(Math.max(0,this.offset()-1))},more:function(){this.incrementOffset();if(this.dateOffset()+r.dateRange/2>=this.loaded){var e=new Date(this.startDate);e.setDate(e.getDate()+this.loaded),this.build(e,r.dateRange/2),this.loaded+=r.dateRange/2}this.moveToOffset()},back:function(){this.decrementOffset(),this.moveToOffset()},showBack:function(){return this.offset()>0},moveToOffset:function(){},refresh:function(){this.reset(),this.build(null,this.loaded,!0),this.moveToOffset()}});return i}),tadpoles.define("model/roster_forecaster/scheduledSeatAssignment",["require","selfish"],function(e){var t=e("selfish"),n=t.Base.extend({className:"ScheduledSeatAssignment",initialize:function(e){var t=e.seat,n=e.schedule;this.seatNumber=e.seatNumber,this.scheduleMorning=0,this.scheduleDay=0,this.scheduleAfternoon=0,this.updateScheduleForEnrollement(n,t.enrollment())},scheduleForEnrollment:function(e){return e==="Morning"?this.scheduleMorning|this.scheduleDay:e==="Afternoon"?this.scheduleAfternoon|this.scheduleDay:this.scheduleDay||this.scheduleMorning|this.scheduleAfternoon},updateScheduleForEnrollement:function(e,t){var n=t==="Morning"?"scheduleMorning":t==="Afternoon"?"scheduleAfternoon":"scheduleDay";this[n]=this[n]|e},canShareSeatAssignment:function(e,t){return(t&this.scheduleForEnrollment(e))===0},update:function(e,t){this.updateScheduleForEnrollement(e,t)}});return n}),tadpoles.define("model/roster_forecaster/seatAssignment",["require","selfish","ko","lodash","model/roster_forecaster/scheduledSeatAssignment"],function(e){var t=e("selfish"),n=e("ko"),r=e("lodash"),i=e("model/roster_forecaster/scheduledSeatAssignment"),s=t.Base.extend({className:"SeatAssignment",initialize:function(e){this.seatAssignments=[],this.kidToAssignedSeat={}},availableSeatForKid:function(e){var t=e.child.schedule().toScheduleByte(),n=r.find(this.seatAssignments,function(n){return n.canShareSeatAssignment(e.enrollment(),t)});return n?n.update(t,e.enrollment()):(n=i.create({seat:e,schedule:t,seatNumber:this.seatAssignments.length+1}),this.seatAssignments.push(n)),n.seatNumber},assignSeatForKid:function(e){var t=this,n=this.kidToAssignedSeat[e.child.key];return n||(n=this.availableSeatForKid(e),t.kidToAssignedSeat[e.child.key]=n),e.assignSeat(n),n},unassignSeatForKid:function(e){var t=this.kidToAssignedSeat[e.child.key];delete this.kidToAssignedSeat[e.child.key];if(t){var n=this.seatAssignments[t-1];e.enrollment()===n.enrollment?n.enrollment=null:e.enrollment()==="Morning"?n.enrollment="Afternoon":e.enrollment()==="Afternoon"&&(n.enrollment="Morning");var r=e.child.schedule().toScheduleByte();n.schedule=n.schedule&~r&127}},assignSeats:function(e,t){var n=this,i=r.filter(e,function(e){return e.child});r(i).filter(function(e){return e.isGraduated(t)}).each(function(e){n.unassignSeatForKid(e)}),r(i).filter(function(e){return!e.isGraduated(t)}).each(function(e){n.assignSeatForKid(e)})},reset:function(){this.seatAssignments=[],this.kidToAssignedSeat={}}});return s}),tadpoles.define("model/roster_forecaster/rosterSeat",["require","selfish","ko"],function(e){var t=e("selfish"),n=e("ko"),r=t.Base.extend({className:"RosterSeat",initialize:function(e){var t=this;e=e||{},this.date=e.date,this.child=e.child,this.seatNumber=-1},isGraduated:function(e){return this.child.schedule().isGraduated(e||this.date)},enrollment:function(){return this.child?this.child.schedule().enrollment.peek():""},assignSeat:function(e){this.seatNumber=e}});return r.status={insufficientData:"insufficientData",outOfRange:"outOfRange",readyForMoveUp:"readyForMoveUp",ok:"ok",graduated:"graduated",available:"available"},r}),tadpoles.define("model/roster_forecaster/sharedRosterSeat",["require","selfish","model/roster_forecaster/rosterSeat"],function(e){var t=e("selfish"),n=e("model/roster_forecaster/rosterSeat"),r=t.Base.extend({className:"SharedRosterSeat",initialize:function(e){this.morningSeat=e.morningSeat,this.afternoonSeat=e.afternoonSeat,this.seatNumber=this.morningSeat?this.morningSeat.seatNumber:this.afternoonSeat.seatNumber},fillEmpty:function(){this.morningSeat?this.afternoonSeat=n.create():this.morningSeat=n.create()}});return r}),tadpoles.define("model/roster_forecaster/rosterClassForDate",["require","selfish","ko","lodash","model/roster_forecaster/rosterSeat","model/roster_forecaster/sharedRosterSeat","model/product"],function(e){var t=e("selfish"),n=e("ko"),r=e("lodash"),i=e("model/roster_forecaster/rosterSeat"),s=e("model/roster_forecaster/sharedRosterSeat"),o=e("model/product"),u=t.Base.extend({className:"RosterClassForDate",initialize:function(e){var t=this;this.date=e.date,this.enrolledSeatCount=n.observable(0),this.getSeats=n.computed(function(){var n=r(e.classroom.childrenAssignedToHomeroom()).filter(function(e){return e.schedule().isScheduled(t.date)&&e.schedule().isEnrolled(t.date)}).map(function(t){return i.create({child:t,date:e.date,minAgeMonths:e.classroom.minEnrollAgeInMonths(),maxAgeMonths:e.classroom.maxEnrollAgeInMonths()})}).value();return e.rosterClass.assignSeats(n,t.date),n=t.compactHalfDayAndGraduatedSeats(n),n=t.expandEmptySeats(n),t.enrolledSeatCount(n.length),n}).extend({rateLimit:5e3}),this.actualEnrollment=n.pureComputed(function(){return t.getSeats().length})},startOfWeek:function(){return this.date.getDay()===o.getStartOfWeek()},expandEmptySeats:function(e){var t=this,n=0;while(n<e.length)e[n].seatNumber>n+1?r.times(e[n].seatNumber-(n+1),function(){e.splice(n++,0,i.create({date:t.date}))}):n++;return e},compactHalfDayAndGraduatedSeats:function(e){var t=[],n={},i={};r(e).filter(function(e){return!e.isGraduated()}).each(function(e){var r=e.seatNumber.toString();if(e.enrollment()==="Afternoon"){var o=i[r];o?(o.afternoonSeat=e,delete i[r],t.push(o)):n[r]=s.create({afternoonSeat:e})}else if(e.enrollment()==="Morning"){var u=n[r];u?(u.morningSeat=e,delete n[r],t.push(u)):i[r]=s.create({morningSeat:e})}else t.push(e)}),r.each(n,function(e){e.fillEmpty(),t.push(e)}),r.each(i,function(e){e.fillEmpty(),t.push(e)});var o=r.sortBy(t,function(e){return e.seatNumber});return o}});return u}),tadpoles.define("model/roster_forecaster/rosterGridSeat",["require","selfish","ko","model/roster_forecaster/rosterSeat"],function(e){function i(e,t){return Math.max((e.getFullYear()-t.getFullYear())*12+e.getMonth()-t.getMonth(),0)}function s(e){return e&&(e.schedule().enrollment.peek()=="Morning"||e.schedule().enrollment.peek()=="Afternoon")}var t=e("selfish"),n=e("ko"),r=e("model/roster_forecaster/rosterSeat"),o=t.Base.extend({className:"RosterGridSeat",initialize:function(t){var r=this;this.minAgeMonths=n.pureComputed(function(){return t.classroom.minEnrollAgeInMonths()}),this.maxAgeMonths=n.pureComputed(function(){return t.classroom.maxEnrollAgeInMonths()}),this.child=n.observable(null),this.sharedChild=n.observable(null),this.date=n.observable(null),this.color=n.pureComputed(function(){return r.childColor(r.child())}),this.sharedColor=n.pureComputed(function(){return r.shared()?r.childColor(r.sharedChild()):r.color()}),this.shared=n.pureComputed(function(){return s(r.child())||s(r.sharedChild())}),this.displayName=n.pureComputed(function(){return r.childDisplayName(r.child())}),this.sharedDisplayName=n.pureComputed(function(){return r.childDisplayName(r.sharedChild())})},update:function(t,n,r){this.date(t),this.child(n&&!this.isGraduated(n)?n:null),this.sharedChild(r&&!this.isGraduated(r)?r:null)},click:function(){this.child()&&this.child().edit()},clickShared:function(){this.sharedChild()&&this.sharedChild().edit()},childStatus:function(e){if(!e||this.isGraduated(e))return r.status.available;if(this.graduatesToday(e))return r.status.graduated;if(this.valid(e)){var t=i(this.date(),e.birthDate());return t<this.minAgeMonths()||t>this.maxAgeMonths()?r.status.outOfRange:t+1>=this.maxAgeMonths()?r.status.readyForMoveUp:r.status.ok}return r.status.insufficientData},childColor:function(e){var t=this.childStatus(e);if(!e||t===r.status.available)return"rgba(219, 219, 219, 1.0)";if(t===r.status.ok)return"rgb(29, 192, 116)";if(t===r.status.readyForMoveUp)return"#faa732";if(t===r.status.outOfRange)return"rgb(143, 86, 228)";if(!this.valid(e))return"rgba(218, 79, 73, 1.0)"},isGraduated:function(e){return e.schedule().isGraduated(this.date())},graduatesToday:function(e){return e.schedule().graduation_date()&&e.schedule().graduation_date().getTime()===this.date().getTime()},valid:function(e){return e&&e.schedule().enrollment()&&e.birthDate()},childDisplayName:function(e){if(!e)return"";var t="";return e.firstName()&&e.firstName().length>0&&(t+=e.firstName()[0].toUpperCase()),e.lastName()&&e.lastName().length>0&&(t+=e.lastName()[0].toUpperCase()),t}});return o}),tadpoles.define("model/roster_forecaster/rosterGridClass",["require","selfish","ko","lodash","emit","model/globalFilter","model/roster_forecaster/paging","model/roster_forecaster/seatAssignment","model/roster_forecaster/rosterClassForDate","model/roster_forecaster/rosterGridSeat","model/product","model/roster_forecaster/pageSizeAndRange","model/roster_forecaster/sharedRosterSeat"],function(e){function p(e){var t=l.getStartOfWeek(),n=e.getDay();return n!==(t+5)%7&&n!==(t+6)%7}function d(e,t){return t+" "+e+(t>1||t===0?"s ":" ")}var t=e("selfish"),n=e("ko"),r=e("lodash"),i=e("emit"),s=e("model/globalFilter"),o=e("model/roster_forecaster/paging"),u=e("model/roster_forecaster/seatAssignment"),a=e("model/roster_forecaster/rosterClassForDate"),f=e("model/roster_forecaster/rosterGridSeat"),l=e("model/product"),c=e("model/roster_forecaster/pageSizeAndRange"),h=e("model/roster_forecaster/sharedRosterSeat"),v=t.Base.extend(o,u,{className:"RosterGridClass",initialize:function(e){o.initialize.call(this,e),u.initialize.call(this,e);var t=this;this.grid=[],this.classroom=e.classroom,this.startDate=e.startDate,this.maxSeatCount=n.observable(this.classroom.capacity()),this.maxSeatsAllocated=n.observable(0),this.expanded=n.observable(!1),this.rostersForDates=[],this.className=n.pureComputed(function(){return t.classroom.name()}),this.valid=n.pureComputed(function(){return t.classroom.capacity()&&t.classroom.minEnrollAgeInMonths()&&t.classroom.maxEnrollAgeInMonths()}),this.getDateHeader=n.pureComputed(function(){var e=t.offset()*(c.dateRange/2),n=new Date(t.startDate),r=[];return n.setDate(n.getDate()+e),r.push(n.format("mmm d")),n.setDate(n.getDate()+7),r.push(n.format("mmm d")),n.setDate(n.getDate()+7),r.push(n.format("mmm d")),n.setDate(n.getDate()+7),r.push(n.format("mmm d")),r}),this.getGrid=n.pureComputed(function(){if(t.valid()){if(!t.expanded()&&t.grid.length==0)return[];var e=Math.max(t.classroom.capacity(),t.maxSeatCount())*c.pageSize;e>t.grid.length&&r.times(e-t.grid.length,function(){t.grid.push(f.create({classroom:t.classroom}))})}return t.grid}),this.seatNumbers=n.pureComputed(function(){return r.range(1,t.maxSeatCount()+1)}),this.enrollmentAgeDisplay=n.pureComputed(function(){if(t.valid()){var e=Math.floor(t.classroom.minEnrollAgeInMonths()/12),n=t.classroom.minEnrollAgeInMonths()%12,r=Math.floor(t.classroom.maxEnrollAgeInMonths()/12),i=t.classroom.maxEnrollAgeInMonths()%12,s="";return!e&&!n?s=d("year",0)+"to ":e?n?s=d("year",e)+d("month",n)+"to ":s=d("year",e)+"to ":s=d("month",n)+"to ",r&&(s+=d("year",r)),i&&(s+=d("month",i)),"ages "+s}}),this.capacityDisplay=n.pureComputed(function(){return t.maxSeatsAllocated()!=t.classroom.capacity()?t.maxSeatsAllocated()+"/"+t.classroom.capacity()+" seats":t.classroom.capacity()+" seats"}),this.visible=n.pureComputed(function(){return s.group().key==="all"||s.group().key===t.classroom.key}),i.on("gridRefresh"+this.classroom.key,function(){t.refresh()})},build:function(t,n,i){t=t||this.startDate,n=n||c.dateRange;var s=[];r.times(n,function(e){var n=new Date(t);n.setDate(n.getDate()+e),p(n)&&s.push(n)}),this.addDateRange(s,i)},addDateRange:function(e,t){var n=this,i=0,s=0,o=r.map(e,function(e){var t=a.create({rosterClass:n,classroom:n.classroom,date:e});return t.getSeats().length>i&&(i=t.getSeats().length),t.enrolledSeatCount()>s&&(s=t.enrolledSeatCount()),t});i>this.maxSeatCount()&&this.maxSeatCount(i),s>this.maxSeatsAllocated()&&this.maxSeatsAllocated(s),t?this.rostersForDates=o:this.rostersForDates.push.apply(this.rostersForDates,o)},editClass:function(){this.classroom.requestEdit()},moveToOffset:function(){var e=this;if(!this.valid())return;var t=e.offset.peek()*(c.pageSize/2),n=this.getGrid();if(!n.length)return;var i=this.maxSeatCount.peek();r.times(c.pageSize,function(s){var o=e.rostersForDates[t+s],u=o.getSeats();r.times(i,function(e){var t=n[s+e*c.pageSize];if(e<u.length){var r=u[e];h.isPrototypeOf(r)?t.update(o.date,r.morningSeat.child,r.afternoonSeat.child):t.update(o.date,r.child)}else t.update(o.date)})})},reset:function(){u.reset.call(this)},toggleExpanded:function(){this.expanded(!this.expanded()),this.expanded()&&this.moveToOffset()}});return v}),tadpoles.define("model/roster_forecaster/rosterForecaster",["require","selfish","ko","services/groups","lodash","jquery","services/profilers","utilities","emit","model/roster_forecaster/rosterGridClass","model/product","model/user"],function(e){var t=e("selfish"),n=e("ko"),r=e("services/groups"),i=e("lodash"),s=e("jquery"),o=e("services/profilers"),u=e("utilities"),a=e("emit"),f=e("model/roster_forecaster/rosterGridClass"),l=e("model/product"),c=e("model/user"),h=t.Base.extend({className:"RosterForecaster",initialize:function(e){console.log("RosterForecaster.initialize");var t=this;e=e||{},this.forecastActive=n.observable(!1),this.childrenLoadedForLocation=n.observable(!1),this.startDate=e.startDate||this.startOfWeek(),this.classLookup={},this.dayHeader=[],i.times(5,function(e){var n=new Date(t.startDate);n.setDate(n.getDate()+e),t.dayHeader.push(n.format("ddd"))}),i.times(2,function(){t.dayHeader.push.apply(t.dayHeader,t.dayHeader)}),this.rosterGridClasses=n.pureComputed(function(){if(!t.childrenLoadedForLocation())return[];var e=i.isEmpty(t.classLookup),n=i(r.getInstance().allGroupsForCurrentLocation()).filter(function(e){return e.childrenAssignedToHomeroom().length}).map(function(e){var n=t.classLookup[e.key];return n||(n=f.create({classroom:e,startDate:t.startDate}),n.build(),t.classLookup[e.key]=n),n}).sort(function(e){return e.classroom.minEnrollAgeInMonths.peek()}).reverse().value();return e&&n.length&&(n[0].expanded(!0),n[0].moveToOffset()),n}).extend({rateLimit:5e3}),a.on("enrollmentChange",function(e){var n=i.find(t.rosterGridClasses(),function(t){return t.classroom.key===e.child.homeroom_key()});n&&n.refresh()}),a.on("class-filter-changed",function(e){var n=t.classLookup[e.key];n&&n.valid()&&!n.expanded()&&(n.expanded(!0),n.moveToOffset())}),a.on("childrenLoaded",function(){(c.CurrentUser.isCsr()||l.hasFeature(l.Features.ROSTER_FORECASTER))&&t.childrenLoadedForLocation(!0)})},startOfWeek:function(){var e=l.getStartOfWeek(),t=new Date;return t.getDay()>=e?t.setDate(t.getDate()-(t.getDay()-e)):t.setDate(t.getDate()-(e-t.getDay()-7)),t},setForecastActive:function(){var e=this;s("#forecastActive").addClass("active"),s("#leadActive").removeClass("active"),i.delay(function(){e.forecastActive(!0)},100)},setLeadsActive:function(){var e=this;s("#forecastActive").removeClass("active"),s("#leadActive").addClass("active"),i.delay(function(){e.forecastActive(!1)},100)},reset:function(){this.setLeadsActive(),this.classLookup={},this.childrenLoadedForLocation(!1)}});return u.makeSingleton(h)}),tadpoles.define("knockout/koTiles",["ko","jquery"],function(e,t){function n(e,n){var r=t(e).data("tileData");if(!r)return;if(!r.numCols)return;if(r.numCols===n.numCols&&r.parentWidth===n.parentWidth&&r.margin===n.margin&&r.textSizingRef===n.textSizingRef)return;t(e).data("tileData",n),r=n;var i=r.size||Math.floor(r.parentWidth/r.numCols),s=i-r.margin*2,o=0,u=r.textSizingRef;u&&(o=Math.floor(s/u*100)),t(e).children().each(function(){var e=t(this);e.css("width")!==s&&e.css({height:s,width:s}),o&&e.css("fontSize")!==o+"%"&&e.css({fontSize:o+"%"})})}e.bindingHandlers.tiles={makeTemplateValueAccessor:function(n,r){return function(){var i=e.utils.unwrapObservable(r());return{name:i.template,foreach:i.bricks,includeDestroyed:i.includeDestroyed,afterAdd:i.afterAdd,beforeRemove:i.beforeRemove,afterRender:function(e,r){var s=t(n).data("tileData");if(s){var o;for(o=0;o<e.length;o+=1){var u=t(e[o]);if(!u.is("li")&&!u.is("div"))return;s.margin&&u.css({margin:s.margin});var a=s.size||Math.floor(s.parentWidth/s.numCols),f=a-(s.numCols?s.margin*2:0),l=0,c=s.textSizingRef;c&&(l=Math.floor(f/c*100)),u.css({height:f,width:f}),l&&u.css({fontSize:l+"%"})}}i.afterRender&&i.afterRender(e,r)}}}},init:function(n,r,i,s,o){var u=e.utils.unwrapObservable(r()),a=u.numCols,f=u.groutWidth,l=u.tileSize,c=u.textSizingRef;t(n).addClass("thumbnails"),t(n).css({margin:0});var h=t(n).width(),p=f?Math.floor(f/2):0;return t(n).data("tileData",{numCols:a,parentWidth:h,size:l,margin:p,textSizingRef:c}),e.bindingHandlers.template.init(n,e.bindingHandlers.tiles.makeTemplateValueAccessor(n,r),i,s,o)},update:function(r,i,s,o,u){var a=e.utils.unwrapObservable(i()),f=a.numCols,l=a.groutWidth,c=a.tileSize,h=a.textSizingRef,p=t(r).width(),d=l?Math.floor(l/2):0,v={numCols:f,parentWidth:p,size:c,margin:d,textSizingRef:h};return n(r,v),e.bindingHandlers.template.update(r,e.bindingHandlers.tiles.makeTemplateValueAccessor(r,i),s,o,u)}}}),!function(e,t,n){function o(e,n){var r=t.createElement(e||"div"),i;for(i in n)r[i]=n[i];return r}function u(e){for(var t=1,n=arguments.length;t<n;t++)e.appendChild(arguments[t]);return e}function f(e,t,n,r){var o=["opacity",t,~~(e*100),n,r].join("-"),u=.01+n/r*100,f=Math.max(1-(1-e)/t*(100-u),e),l=s.substring(0,s.indexOf("Animation")).toLowerCase(),c=l&&"-"+l+"-"||"";return i[o]||(a.insertRule("@"+c+"keyframes "+o+"{"+"0%{opacity:"+f+"}"+u+"%{opacity:"+e+"}"+(u+.01)+"%{opacity:1}"+(u+t)%100+"%{opacity:"+e+"}"+"100%{opacity:"+f+"}"+"}",a.cssRules.length),i[o]=1),o}function l(e,t){var i=e.style,s,o;if(i[t]!==n)return t;t=t.charAt(0).toUpperCase()+t.slice(1);for(o=0;o<r.length;o++){s=r[o]+t;if(i[s]!==n)return s}}function c(e,t){for(var n in t)e.style[l(e,n)||n]=t[n];return e}function h(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)e[i]===n&&(e[i]=r[i])}return e}function p(e){var t={x:e.offsetLeft,y:e.offsetTop};while(e=e.offsetParent)t.x+=e.offsetLeft,t.y+=e.offsetTop;return t}function v(e){if(!this.spin)return new v(e);this.opts=h(e||{},v.defaults,d)}var r=["webkit","Moz","ms","O"],i={},s,a=function(){var e=o("style",{type:"text/css"});return u(t.getElementsByTagName("head")[0],e),e.sheet||e.styleSheet}(),d={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto",position:"relative"};v.defaults={},h(v.prototype,{spin:function(e){this.stop();var t=this,n=t.opts,r=t.el=c(o(0,{className:n.className}),{position:n.position,width:0,zIndex:n.zIndex}),i=n.radius+n.length+n.width,u,a;if(e){e.insertBefore(r,e.firstChild||null),a=p(e),u=p(r);var f=null;if(n.left==="auto"){var l=a.x-u.x+(e.offsetWidth>>1);f=l===0?"50%":l+"px"}else f=parseInt(n.left,10)+i+"px";var h=null;if(n.top==="auto"){var l=a.y-u.y+(e.offsetHeight>>1);h=l===0?"50%":l+"px"}else h=parseInt(n.top,10)+i+"px";c(r,{left:f,top:h})}r.setAttribute("aria-role","progressbar"),t.lines(r,t.opts);if(!s){var d=0,v=n.fps,m=v/n.speed,g=(1-n.opacity)/(m*n.trail/100),y=m/n.lines;function b(){d++;for(var e=n.lines;e;e--){var i=Math.max(1-(d+e*y)%m*g,n.opacity);t.opacity(r,n.lines-e,i,n)}t.timeout=t.el&&setTimeout(b,~~(1e3/v))}b()}return t},stop:function(){var e=this.el;return e&&(clearTimeout(this.timeout),e.parentNode&&e.parentNode.removeChild(e),this.el=n),this},lines:function(e,t){function i(e,r){return c(o(),{position:"absolute",width:t.length+t.width+"px",height:t.width+"px",background:e,boxShadow:r,transformOrigin:"left",transform:"rotate("+~~(360/t.lines*n+t.rotate)+"deg) translate("+t.radius+"px"+",0)",borderRadius:(t.corners*t.width>>1)+"px"})}var n=0,r;for(;n<t.lines;n++)r=c(o(),{position:"absolute",top:1+~(t.width/2)+"px",transform:t.hwaccel?"translate3d(0,0,0)":"",opacity:t.opacity,animation:s&&f(t.opacity,t.trail,n,t.lines)+" "+1/t.speed+"s linear infinite"}),t.shadow&&u(r,c(i("#000","0 0 4px #000"),{top:"2px"})),u(e,u(r,i(t.color,"0 0 1px rgba(0,0,0,.1)")));return e},opacity:function(e,t,n){t<e.childNodes.length&&(e.childNodes[t].style.opacity=n)}}),function(){function e(e,t){return o("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',t)}var t=c(o("group"),{behavior:"url(#default#VML)"});!l(t,"transform")&&t.adj?(a.addRule(".spin-vml","behavior:url(#default#VML)"),v.prototype.lines=function(t,n){function s(){return c(e("group",{coordsize:i+" "+i,coordorigin:-r+" "+ -r}),{width:i,height:i})}function l(t,i,o){u(a,u(c(s(),{rotation:360/n.lines*t+"deg",left:~~i}),u(c(e("roundrect",{arcsize:n.corners}),{width:r,height:n.width,left:n.radius,top:-n.width>>1,filter:o}),e("fill",{color:n.color,opacity:n.opacity}),e("stroke",{opacity:0}))))}var r=n.length+n.width,i=2*r,o=-(n.width+n.length)*2+"px",a=c(s(),{position:"absolute",top:o,left:o}),f;if(n.shadow)for(f=1;f<=n.lines;f++)l(f,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(f=1;f<=n.lines;f++)l(f);return u(t,a)},v.prototype.opacity=function(e,t,n,r){var i=e.firstChild;r=r.shadow&&r.lines||0,i&&t+r<i.childNodes.length&&(i=i.childNodes[t+r],i=i&&i.firstChild,i=i&&i.firstChild,i&&(i.opacity=n))}):s=l(t,"animation")}(),typeof tadpoles.define=="function"&&tadpoles.define.amd?tadpoles.define("spinner",[],function(){return v}):e.Spinner=v}(window,document),tadpoles.define("knockout/koSpin",["ko","lodash","jquery","spinner","compat"],function(e,t,n,r,i){function o(r,o){if(i.isIE8OrEarlier())return;var u=e.utils.unwrapObservable(o()),a=!0;t.isObject(u)?(t.defaults(u,s),a=u.trigger):(a=u,u=s),a?n(r).spin(u):n(r).spin(!1)}n.fn.spin=function(e){if(i.isIE8OrEarlier())return;return this.each(function(){var t=n(this),i=t.data();i.spinner&&(i.spinner.stop(),delete i.spinner),e!==!1&&(i.spinner=(new r(n.extend({color:t.css("color")},e))).spin(this))}),this};var s={lines:13,length:0,width:13,radius:25,rotate:0,color:"#FFF",speed:1.1,trail:96,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2e9,top:"auto",left:"auto"};e.bindingHandlers.spin={init:function(e,t,n){o(e,t,n)},update:function(e,t,n){o(e,t,n)}}}),tadpoles.define("providerApp",["require","services/config","services/app","ko","lodash","jquery","utilities","services/datePicker","services/propertySaving","services/alerts","model/form","model/group","model/quickAdd","model/schedule","services/message","services/events","services/metrics","services/activeChildren","services/remoteEmployees","services/inactiveChildren","services/checkpointStore","services/parameterStore","emit","model/signup","model/attendanceDetails","model/globalFilter","model/detailViewPanel","model/dailyReport","services/children","services/employees","services/guardians","services/groups","model/communication","model/branding","sleep","services/analytics","model/outbox","model/product","services/dailyReports","services/lessonPlans","services/touch","model/user","model/modal/editReplyToForm","model/modal/editAutoCheckoutTimeForm","model/observations","services/curricula","model/stats","chart/graphs","selfish","model/modal/devices","services/object","model/curriculum/curriculaEditModal","model/remote","model/roster","model/modal/addTour","services/brand","services/login","model/gallery","model/observationMetrics","model/planningMaster","model/modal/importForm","model/roster_forecaster/rosterForecaster","bootstrap","knockout/koTiles","knockout/koSpin"],function(e){var t=e("services/config"),n=e("services/app"),r=e("ko"),i=e("lodash"),s=e("jquery"),o=e("utilities");e("services/datePicker"),e("services/propertySaving");var u=e("services/alerts"),a=e("model/form"),f=e("model/group"),l=e("model/quickAdd"),c=e("model/schedule"),h=e("services/message"),p=e("services/events"),d=e("services/metrics"),v=e("services/activeChildren"),m=e("services/remoteEmployees"),g=e("services/inactiveChildren"),y=e("services/checkpointStore"),b=e("services/parameterStore"),w=e("emit"),E=e("model/signup"),S=e("model/attendanceDetails"),x=e("model/globalFilter"),T=e("model/detailViewPanel"),N=e("model/dailyReport"),C=e("services/children"),k=e("services/employees"),L=e("services/guardians"),A=e("services/groups"),O=e("model/communication"),M=e("model/branding"),_=e("sleep"),D=e("services/analytics"),P=e("model/outbox"),H=e("model/product"),B=e("services/dailyReports"),j=e("services/lessonPlans"),F=e("services/touch"),I=e("model/user"),q=e("model/modal/editReplyToForm"),R=e("model/modal/editAutoCheckoutTimeForm"),U=e("model/observations"),z=e("services/curricula"),W=e("model/stats"),X=e("chart/graphs"),V=e("selfish"),$=e("model/modal/devices"),J=e("services/object"),K=e("model/curriculum/curriculaEditModal"),Q=e("model/remote"),G=e("model/roster"),Y=e("model/modal/addTour"),Z=e("services/brand"),et=e("services/login"),tt=e("model/gallery"),nt=e("model/observationMetrics"),rt=e("model/planningMaster"),it=e("model/modal/importForm"),st=e("model/roster_forecaster/rosterForecaster");e("bootstrap"),e("knockout/koTiles"),e("knockout/koSpin");var ot={Attendance:1,Students:2,Events:3},ut=V.Base.extend(n,rt,{initialize:function(){function c(e){return!x.group()||x.group().key==="all"||e.group===x.group().key}function g(t){t.reminderType==="child"?e.childReminders(t.reminders):e.employeeReminders(t.reminders)}function D(){var e=x.group().childrenOutToday(),t="<thead><tr><th>student</th><th>reason</th><th>origin</th></tr></thead><tbody>";return t+=i.map(e,function(e){var t=e.checkpoint(),n=e.getStateForCheckpoint(t);return"<tr><td>"+e.displayName()+"</td><td>"+n+"</td><td>"+(t.origin?t.origin:"unknown")+"</td></tr>"}).join(""),t+="</tbody>",t}function V(){return i.map(e.reminders_for_selection(),function(e){return e.message}).join("<br/>")}var e=this;n.initialize.call(e),rt.initialize.call(e),e.observationMetrics=nt.getInstance(),e.maintenance=r.observable(!1),e.connected=r.observable(!0),e.realtimeUnavailable=r.observable(!1),e.realtime=r.pureComputed(function(){return e.connected()&&!e.realtimeUnavailable()}),e.displayMode=r.observable(ot.Events),e.isAttendanceMode=r.pureComputed(function(){return e.displayMode()===ot.Attendance}),e.isEventsMode=r.pureComputed(function(){return e.displayMode()===ot.Events}),e.isAttendanceEnabled=r.pureComputed(function(){var t=e.displayMode();return t===ot.Events||t===ot.Attendance}),e.isStudentsMode=r.pureComputed(function(){return e.displayMode()===ot.Students}),e.rosterForecaster=st.getInstance(),e.isSessionExpired=r.observable(!1),e.isLoading=r.observable(!1),e.isStarting=r.observable(!0),e.attendanceToggled=r.observable(),e.childTypes=r.observableArray(["infant","toddler","preschool","school","kids"]),e.displayableChildTypes=r.observableArray([{key:"infant",value:"infant"},{key:"toddler",value:"toddler"},{key:"preschool",value:"preschool"},{key:"school",value:"school"},{key:"kids",value:"any age"}]),e.guardianTypes=r.observableArray(["primary","guardian","medical","friend","authorized","emergency","other","individual","contact"]),e.children=C.getInstance().children,e.childReminders=r.observable([]),e.employeeReminders=r.observable([]),e.reminders=r.pureComputed(function(){return e.childReminders().concat(e.employeeReminders())}),e.location=r.pureComputed(function(){return x.location()}),e.locations=r.observableArray(t.locations),e.account=r.observable(t.account),e.quickAdd=l.create(),e.addTour=Y.create(),e.newClass=f.create(),e.newClassForm=a.create({title:"add class",formTemplate:"view/modals/addClassForm",formModel:e.newClass,path:"/remote/v1/class/create",success:function(n){var i;t.isDemo?(i=r.toJS(e.newClass),i.location_key=e.location().key,i.key=(new Date).getTime()):i=n.group;var s=f.create(i);A.getInstance().addGroup(s),e.requestGroupChange(s),e.newClassForm.close()}}),e.editReplyToForm=null,e.openEditReplyToForm=function(){e.editReplyToForm===null&&(e.editReplyToForm=q.create()),e.editReplyToForm.open()},e.editAutoCheckoutTimeForm=null,e.openEditAutoCheckoutTimeForm=function(){e.editAutoCheckoutTimeForm===null&&(e.editAutoCheckoutTimeForm=R.create())},e.isLocationSelected=r.pureComputed(function(){var t=e.location();return!o.isNull(t)}),e.hasAttendance=r.pureComputed(function(){return e.isLocationSelected()&&!o.isNull(y.locationCounter())}),e.isStatsVisible=r.pureComputed(function(){return e.isLocationSelected()}),e.labels=r.pureComputed(function(){var t=i.map(e.children(),function(e){return e.labels()}),n=i.flatten(t);return n.unshift("All"),i.uniq(n)}),e.reminders_for_selection=r.pureComputed(function(){return r.utils.arrayFilter(e.reminders(),c)}),e.addClass=function(){e.newClass.location_key(e.location().key),e.newClassForm.open()},e.toggleInactiveClasses=function(){A.getInstance().toggleInactiveClasses()},e.inactiveClassesShown=function(){return A.getInstance().showInactiveGroups()},e.requestQuickAdd=function(){e.quickAdd.locationKey(e.location().key),x.groupSelected()&&e.quickAdd.groupKey(x.group().key),e.quickAdd.open()},e.requestAddTour=function(){e.addTour.locationKey(e.location().key),x.groupSelected()&&e.addTour.groupKey(x.group().key),e.addTour.open()},e.removeChild=function(){},e.breadcrumb=r.pureComputed(function(){var t=e.location(),n=x.group(),r="";if(x.labelSelected()&&x.groupSelected())r=("in "+n.name()+" at "+t.name).toLowerCase();else if(x.labelSelected()||x.groupSelected())r=(" at "+t.name).toLowerCase();return r}),e.title=r.pureComputed(function(){var t=e.location(),n=x.group(),r=x.label(),i=e.account();return x.labelSelected()?r.toLowerCase():x.groupSelected()?n.name().toLowerCase():e.isLocationSelected()?t.name.toLowerCase():i.external_name.toLowerCase()});var E=0,N=i.debounce(function(){e.isLoading()&&!e.isSessionExpired()&&(console.log("Attempting refresh again"),e.isLoading(!1),i.delay(_,E*1e4))},3e4),_=i.throttle(function(){if(e.isLoading()||e.isSessionExpired())return;e.isLoading(!0);try{console.log("Refreshing!");var t=e.location.peek();o.afterEvents(["parameterRequestComplete"],function(){w.emit("locationChangeComplete"),console.log("Students: parameterRequestComplete"),e.isLoading(!1),e.connected(!0),e.isStarting(!1),E=0}),v.load(),b.load(t),m.load(t),P.loadEvents(),d.metricsEnabled()&&d.loadMetrics({location:t,groups:A.getInstance().groupsForLocationDisplay(),display:null}),E+=1}catch(n){console.log("Unable to refresh"),e.isLoading(!1),i.delay(_,15e3)}},1e3);w.on("loadFailed",function(e){console.log(e.loadDataType+" failed to load"),N()}),w.on("sessionExpired",function(){e.isSessionExpired(!0)}),w.on("maintenance",function(){e.maintenance()||_(),e.maintenance(!0)}),w.on("connection-failed",function(t){console.log("Students: connection-failed"),e.connected(!1),t&&t.permanent&&(e.realtimeUnavailable(!0),_())}),w.on("message-connect",function(){console.log("Students: message-connect"),e.maintenance(!1),e.connected(!0),_()}),w.on("message-close",function(){console.log("Students: message-close")}),w.on("message-gap",function(){console.log("Students: message-gap"),e.connected(!1),i.delay(_,5e3)}),w.on("sleep:resumed",function(){e.connected(!1),setTimeout(_,2e3)}),e.changeLocation=function(t){e.isLoading()||(e.connected(!0),e.isLoading(!1),e.maintenance(!1),e.isStarting(!0),e.rosterForecaster.reset(),A.getInstance().defaultGroup(),C.getInstance().reset(),k.getInstance().reset(),y.reset(),B.reset(),p.reset(),h.listenForMessagesForLocation(t,e))},w.on("remindersLoaded",g),e.requestLocationChange=function(n){if(t.isDemo){e.goLive();return}x.changeLocation(n)},e.requestGroupChange=function(e){x.group(e)},e.requestFilterChange=function(e){x.label(e)},e.refresh=function(){x.location(x.location())},e.showAttendance=function(){e.displayMode(ot.Attendance)},e.showAll=function(){e.displayMode(ot.Students)},e.showEvents=function(){e.displayMode(ot.Events)},e.isShowingAll=r.pureComputed(function(){return C.getInstance().activeChildrenForSelectedGroup().length>0&&e.displayMode()===ot.Students}),w.on("class-deleted",function(e){var t=x.group();t&&t.key===e.key&&A.getInstance().defaultGroup()}),e.studentSelected=function(e){e.isSelected(!e.isSelected())},e.canAddChild=function(){return x.group()&&x.group().isClass()},e.childrenOutToday=r.pureComputed(function(){return o.isNull(x.group())?[]:x.group().childrenOutToday()}),e.setupStats=function(){s("#todaysReminders").popover({content:V,placement:"in left",animation:!0,template:'<div class="popover"><div class="arrow"></div><div class="popover-inner" style="width: 338px"><h3 class="popover-title"></h3><div class="popover-content"><p></p></div></div></div>',delay:{show:100,hide:100}}),s("#todaysChildrenOut").popover({content:D,placement:"in left",animation:!0,template:'<div class="popover"><div class="arrow"></div><div class="popover-inner" style="width: 338px"><h3 class="popover-title"></h3><div class="popover-content"><table width="100%"></table></div></div></div>',delay:{show:100,hide:100}})},e.goLive=function(){u.showAlert("Hi there!",'This feature is only available after your account is created.  Please click the "Go Live!" button to get started.')},w.on("liveFeatureOnly",e.goLive),e.addCenter=function(){u.showAlert("More centers?","If you have multiple locations, reach out to us at talk.to.us@tadpoles.com to set them up!")},e.auditThing=function(t){s("#breadcrumb-pop").popover("hide"),t.audit()},e.getBreadcrumbPopover=function(){var e=!1;return I.CurrentUser.isCsr()&&(e={title:"Keys",content:'<div style="word-wrap: break-word;"><h4>Location Key:</h4><span data-bind="text:filter.location() ? filter.location().key : \'\'"></span><h4 style="margin-top:5px;">Location XID:</h4><span data-bind="text:filter.location() ? filter.location().xid : \'\'"></span><h4 style="margin-top:5px;">Location Timezone:</h4><span data-bind="text:filter.location() ? filter.location().timezone : \'\'"></span><br/><button class="btn btn-danger btn-mini" data-bind="click: function() { auditThing(filter.location()); }">Audit</button></br><h4 style="margin-top:10px;">Group Key:</h4><span data-bind="text:filter.group() ? filter.group().key : \'\'"></span><h4 style="margin-top:5px;">Group XID:</h4><span data-bind="text:filter.group() ? filter.group().xid : \'\'"></span><br/><button class="btn btn-danger btn-mini" data-bind="click: function() { auditThing(filter.group()); }">Audit</button></div>',placement:"bottom",trigger:"click",bindContent:!0}),e},e.showDevices=function(){if(!x.locationSelected())return;$.getInstance().open()},e.resyncSchool=function(){var e=Q.create({path:"/remote/v1/location/sync",method:"post",success:function(){u.showAlert("Resyncing!","This may take a few minutes...","success")},error:function(e){u.showAlert("Oops!",e.error)}});e.makeRequest({data:{location:x.location().key}})},e.dedup=function(){var e=Q.create({path:"/remote/v1/location/dedup",method:"post",success:function(e){var t="";e.feedback&&e.feedback.length>0?(t="Deduped: ",t+=i(e.feedback).reduce(function(e,t){var n=e.length>0?", ":"";return e+n+t})):t="No dups found!",u.showAlert("Success",t,"success")},error:function(e){u.showAlert("Oops!",e.error)}});e.makeRequest({data:{location:x.location().key}})},e.importData=function(){return it.getInstance().open()},e.canResyncSchool=function(){return e.product.hasFeature("fms-integration")},e.hasRosterForecaster=function(){return e.product.hasFeature(H.Features.ROSTER_FORECASTER)},e.isLocationPlanningMasterSlave=r.pureComputed(function(){var t=e.product.getFeature(H.Features.PLANNING_MASTER);return t&&t.value.location_key&&t.value.location_key!==x.location().key}),e.canEditCurriculum=r.pureComputed(function(){return(e.currentUser.isAdmin()||!e.product.hasFeature(H.Features.DISABLE_TEACHER_CURRICULUM_EDIT))&&!e.isLocationPlanningMasterSlave()}),e.totalChildCount=r.pureComputed(function(){return C.getInstance().children().length}),e.emphasizeAddChild=r.pureComputed(function(){return!e.isStarting()&&e.totalChildCount()<2}),e.currentUser=I.CurrentUser,e.childs=C.getInstance(),e.guardians=L.getInstance(),e.employees=k.getInstance(),e.events=p,e.outbox=P,e.product=H,e.groups=A.getInstance(),e.showGroupEdit=r.pureComputed(function(){return x.group()&&x.group().isClass()}),e.editCurrentGroup=function(){x.group().requestEdit()},e.lessons=j,e.reports=B,e.roster=G,e.metrics=d,e.graphs=X,e.brand=Z.getInstance(),e.detailViewPanel=T.getInstance(),e.attendanceDetails=S.create({groups:e.groups}),e.communications=O.create(),e.branding=M.create(),e.filter=x,e.observations=U,e.roleChoices=k.getInstance().roleChoices,e.curricula=z.getInstance(),e.atFacility=t.atFacility,e.gallery=tt.getInstance(),e.stats=W,e._=i,x.location.subscribe(e.changeLocation),x.defaultLocation(),e.isTouchEnabled=F.isTouchEnabled,e.shouldShowSpinny=r.pureComputed(function(){return e.isLoading()&&e.realtime()}),e.logout=function(){et.logout()}}});return ut.create()}),tadpoles.define("services/restrict",["require","jquery","services/config","emit","lodash"],function(e){function u(){o?console.log("IOS Restrictions Not In Place"):(console.log("IOS Restrictions In Place"),n.channel.isDummy=!0,r.emit("connection-failed",{permanent:!0}))}var t=e("jquery"),n=e("services/config"),r=e("emit"),i=e("lodash");if(window.location.hostname==="dev.tadpoles.com")return;try{if(!navigator.userAgent.match(/(iPad|iPhone|iPod)/g))return}catch(s){return}var o=!1;window.addEventListener("message",function(e){if(e.origin!=="https://dev.tadpoles.com")return;o=!0},!1);var a=t('<iframe id="restrict_iframe" src="https://dev.tadpoles.com/restrict" width="0" height="0" tabindex="-1" title="empty" style="display:none">');a.load(function(e){console.log("IOS Restriction Check Load Handler"),i.delay(u,3e3)}),a.appendTo("body")}),tadpoles.define("knockout-amd-helpers",["ko"],function(e){var t=tadpoles.require||window.require||window.curl,n=e.utils.unwrapObservable,r=function(e,t){var n,r=function(){return e.apply(this,t||[])};return r.prototype=e.prototype,n=new r,n.constructor=e,n},i=function(e){return e&&e.replace(/\/?$/,"/")},s=function(t){var n=e.virtualElements.firstChild(t);while(n){if(n.nodeType===1||n.nodeType===8)return!0;n=e.virtualElements.nextSibling(n)}return!1};e.bindingHandlers.module={init:function(o,u,a,f,l){var c,h,p=n(u()),d={},v=e.bindingHandlers.module.initializer,m=e.bindingHandlers.module.disposeMethod;return d.templateEngine=p&&p.templateEngine,d.templateProperty=e.bindingHandlers.module.templateProperty,d.afterRender=function(){var e=n(u());e&&typeof e.afterRender=="function"&&e.afterRender.apply(this,arguments)},s(o)||(d.name=function(){var e=n(u());return(e&&typeof e=="object"?n(e.template||e.name):e)||""}),d.data=e.observable(),d["if"]=d.data,e.applyBindingsToNode(o,{template:d},c=l.extend({$module:null})),h=function(){e.computed(function(){var e=d.data();e&&(typeof e[m]=="function"&&(e[m].call(e),e=null),d.data(null))}).dispose()},e.computed({read:function(){var s,o=n(u());o&&typeof o=="object"&&(v=o.initializer||v,m=o.disposeMethod||m,d.templateProperty=e.unwrap(o.templateProperty)||d.templateProperty,s=[].concat(n(o.data)),o=n(o.name)),h(),o&&t([i(e.bindingHandlers.module.baseDir)+o],function(e){typeof e=="function"?e=r(e,s):e&&e[v]&&(e=e[v].apply(e,s||[])||e),c.$module=e,d.data(e)})},disposeWhenNodeIsRemoved:o}),e.utils.domNodeDisposal.addDisposeCallback(o,h),{controlsDescendantBindings:!0}},baseDir:"",initializer:"initialize",disposeMethod:"dispose",templateProperty:""},e.virtualElements&&(e.virtualElements.allowedBindings.module=!0),function(e,t){var n=new e.nativeTemplateEngine,r={};n.defaultPath="templates",n.defaultSuffix=".tmpl.html",n.defaultRequireTextPluginName="text",e.templateSources.requireTemplate=function(t){this.key=t,this.template=e.observable(" "),this.requested=!1,this.retrieved=!1},e.templateSources.requireTemplate.prototype.text=function(e){!this.requested&&this.key&&(t([n.defaultRequireTextPluginName+"!"+i(n.defaultPath)+this.key+n.defaultSuffix],function(e){this.retrieved=!0,this.template(e)}.bind(this)),this.requested=!0),this.key||this.template("");if(arguments.length===0)return this.template()},n.makeTemplateSource=function(t,n){var i;if(typeof t=="string")return i=(n||document).getElementById(t),i&&i.tagName.toLowerCase()==="script"?new e.templateSources.domElement(i):(t in r||(r[t]=new e.templateSources.requireTemplate(t)),r[t]);if(t&&(t.nodeType===1||t.nodeType===8))return new e.templateSources.anonymousTemplate(t)},n.renderTemplate=function(t,r,i,s){var o,u=i&&i.afterRender,a=i&&i.templateProperty&&r.$module&&r.$module[i.templateProperty];return!a||typeof a!="function"&&typeof a!="string"?o=n.makeTemplateSource(t,s):o={text:function(){return typeof a=="function"?a.call(r.$module):a}},typeof u=="function"&&o instanceof e.templateSources.requireTemplate&&!o.retrieved&&!u.wrapped&&(i.afterRender=function(){o.retrieved&&u.apply(this,arguments)},i.afterRender.wrapped=!0),n.renderTemplateSource(o,r,i)},e.amdTemplateEngine=n,e.setTemplateEngine(n)}(e,t)}),tadpoles.define("text",["module"],function(e){var t=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],n=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,r=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,i=typeof location!="undefined"&&location.href,s=i&&location.protocol&&location.protocol.replace(/\:/,""),o=i&&location.hostname,u=i&&(location.port||undefined),a=[],f=e.config(),l,c;return l={version:"2.0.0",strip:function(e){if(e){e=e.replace(n,"");var t=e.match(r);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r")},createXhr:function(){var e,n,r;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(n=0;n<3;n++){r=t[n];try{e=new ActiveXObject(r)}catch(i){}if(e){t=[r];break}}return e},parseName:function(e){var t=!1,n=e.indexOf("."),r=e.substring(0,n),i=e.substring(n+1,e.length);return n=i.indexOf("!"),n!==-1&&(t=i.substring(n+1,i.length),t=t==="strip",i=i.substring(0,n)),{moduleName:r,ext:i,strip:t}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,t,n,r){var i=l.xdRegExp.exec(e),s,o,u;return i?(s=i[2],o=i[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===t)&&(!o||o===n)&&(!u&&!o||u===r)):!0},finishLoad:function(e,t,n,r){n=t?l.strip(n):n,f.isBuild&&(a[e]=n),r(n)},load:function(e,t,n,r){if(r.isBuild&&!r.inlineText){n();return}f.isBuild=r.isBuild;var a=l.parseName(e),c=a.moduleName+"."+a.ext,h=t.toUrl(c),p=f.useXhr||l.useXhr;!i||p(h,s,o,u)?l.get(h,function(t){l.finishLoad(e,a.strip,t,n)},function(e){n.error&&n.error(e)}):t([c],function(e){l.finishLoad(a.moduleName+"."+a.ext,a.strip,e,n)})},write:function(e,t,n,r){if(a.hasOwnProperty(t)){var i=l.jsEscape(a[t]);n.asModule(e+"!"+t,"define(function () { return '"+i+"';});\n")}},writeFile:function(e,t,n,r,i){var s=l.parseName(t),o=s.moduleName+"."+s.ext,u=n.toUrl(s.moduleName+"."+s.ext)+".js";l.load(o,n,function(t){var n=function(e){return r(u,e)};n.asModule=function(e,t){return r.asModule(e,u,t)},l.write(e,o,n,i)},i)}},typeof process!="undefined"&&process.versions&&!!process.versions.node?(c=require.nodeRequire("fs"),l.get=function(e,t){var n=c.readFileSync(e,"utf8");n.indexOf("")===0&&(n=n.substring(1)),t(n)}):l.createXhr()?l.get=function(e,t,n){var r=l.createXhr();r.open("GET",e,!0),f.onXhr&&f.onXhr(r,e),r.onreadystatechange=function(i){var s,o;r.readyState===4&&(s=r.status,s>399&&s<600?(o=new Error(e+" HTTP status: "+s),o.xhr=r,n(o)):t(r.responseText))},r.send(null)}:typeof Packages!="undefined"&&(l.get=function(e,t){var n="utf-8",r=new java.io.File(e),i=java.lang.System.getProperty("line.separator"),s=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(r),n)),o,u,a="";try{o=new java.lang.StringBuffer,u=s.readLine(),u&&u.length()&&u.charAt(0)===65279&&(u=u.substring(1)),o.append(u);while((u=s.readLine())!==null)o.append(i),o.append(u);a=String(o.toString())}finally{s.close()}t(a)}),l}),tadpoles.define("services/sessionWatcher",["require","selfish","emit","lodash","services/alerts","model/user","model/remote"],function(e){var t=e("selfish"),n=e("emit"),r=e("lodash"),i=e("services/alerts"),s=e("model/user"),o=e("model/remote"),u=t.Base.extend(o,{className:"SessionWatcher",initialize:function(e){var t=this;n.on("sessionExpired",r.debounce(this.logout,1e3)),n.on("session-logout",function(e){t.checkSession()}),o.initialize.call(this,{path:"/remote/v1/session",method:"get",success:function(e){var t=e.uid,r=s.CurrentUser;r&&r.uid()&&r.uid()!==t&&n.emit("sessionExpired")},error:function(e,t){n.emit("sessionExpired")}})},logout:function(){i.show({title:"Logged out",message:"Your session has expired.  Please log back in!",success:function(){document.location.href="/home_or_work"}})},checkSession:function(){this.makeRequest()}}),a=u.create();return a}),tadpoles.define("knockout/handlers",["require","ko","lodash","utilities","jquery","bootstrap"],function(e){function s(e,n){i(e).tooltip({title:n}),e.lastTooltipValue=n,t.utils.domNodeDisposal.addDisposeCallback(e,function(){i(e).tooltip("destroy")})}function o(e){return i(e).width()>i(e).parent().width()}function u(e){i(e).off("shown.tp"),i(e).off("hidden.tp"),i(e).popover("destroy")}function a(e,r,s){n.defaults(r,{placement:"in right",trigger:"hover",delay:{hide:100,show:100},template:'<div class="popover '+(r.style?"popover-style-"+r.style:"")+'"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title"></h3><div class="popover-content"><p></p></div></div></div>'}),i(e).popover(r),r.bindContent&&i(e).on("shown.tp",function(e,n){t.cleanNode(n),t.applyBindingsToDescendants(s,n)}),r.onShow&&i(e).on("shown.tp",function(e,t){r.onShow(t)}),r.onHide&&i(e).on("hidden.tp",function(e,t){r.onHide(t)}),t.utils.domNodeDisposal.addDisposeCallback(e,function(){u(e)})}var t=e("ko"),n=e("lodash"),r=e("utilities"),i=e("jquery");e("bootstrap"),t.bindingHandlers.fadeVisible={init:function(e,n){var r=n();i(e).toggle(t.utils.unwrapObservable(r))},update:function(e,n){var r=n();t.utils.unwrapObservable(r)?i(e).fadeIn():i(e).fadeOut("fast")}},t.bindingHandlers.tooltip={init:function(e,r){var i=t.utils.unwrapObservable(r()),u=i,a=null;n.isPlainObject(i)&&(u=i.value,a=i.trigger);if(!u)return;if(a==="truncate"&&!o(e))return;s(e,u)},update:function(e,r){var u=t.utils.unwrapObservable(r()),a=u,f=null;n.isPlainObject(u)&&(a=u.value,f=u.trigger),a||(i(e).tooltip("destroy"),e.lastTooltipValue=null);if(!a||a===e.lastTooltipValue)return;i(e).tooltip("destroy");if(f==="truncate"&&!o(e))return;s(e,a)}},t.bindingHandlers.popover={init:function(e,n,r,i,s){var o=t.utils.unwrapObservable(n());a(e,o,s)},update:function(e,n,r,i,s){var o=t.utils.unwrapObservable(n());u(e),a(e,o,s)}},t.bindingHandlers.sublime={init:function(e,t){videojs(i(e).get()[0],{},function(){})}},t.bindingHandlers.formattedDate={update:function(e,t,n,s){var o=t(),u;r.isNull(o)?u="":u=r.dateFormatter(o),i(e).text(u)}},t.bindingHandlers.dateFormat={update:function(e,s,o,u){var a=t.utils.unwrapObservable(s());n.defaults(a,{format:"default"});var f=r.isNull(a.date)?"":a.date.format(a.format);i(e).text(f)}},t.bindingHandlers.numeric={init:function(e,t){i(e).on("keydown",function(e){if(e.keyCode==46||e.keyCode==8||e.keyCode==9||e.keyCode==27||e.keyCode==13||e.keyCode==65&&e.ctrlKey===!0||e.keyCode==188||e.keyCode==190||e.keyCode==110||e.keyCode>=35&&e.keyCode<=39)return;(e.shiftKey||(e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105))&&e.preventDefault()})}}}),tadpoles.define("fancybox",["jquery"],function(e){(function(e,t,n,r){var i=n("html"),s=n(e),o=n(t),u=n.fancybox=function(){u.open.apply(this,arguments)},a=navigator.userAgent.match(/msie/i),f=null,l=t.createTouch!==r,c=function(e){return e&&e.hasOwnProperty&&e instanceof n},h=function(e){return e&&n.type(e)==="string"},p=function(e){return h(e)&&e.indexOf("%")>0},d=function(e){return e&&(!e.style.overflow||e.style.overflow!=="hidden")&&(e.clientWidth&&e.scrollWidth>e.clientWidth||e.clientHeight&&e.scrollHeight>e.clientHeight)},v=function(e,t){var n=parseInt(e,10)||0;return t&&p(e)&&(n=u.getViewport()[t]/100*n),Math.ceil(n)},m=function(e,t){return v(e,t)+"px"};n.extend(u,{version:"2.1.5",defaults:{padding:15,margin:20,width:800,height:600,minWidth:100,minHeight:100,maxWidth:9999,maxHeight:9999,pixelRatio:1,autoSize:!0,autoHeight:!1,autoWidth:!1,autoResize:!0,autoCenter:!l,fitToView:!0,aspectRatio:!1,topRatio:.5,leftRatio:.5,scrolling:"auto",wrapCSS:"",arrows:!0,closeBtn:!0,closeClick:!1,nextClick:!1,mouseWheel:!0,autoPlay:!1,playSpeed:3e3,preload:3,modal:!1,loop:!0,ajax:{dataType:"html",headers:{"X-fancyBox":!0}},iframe:{scrolling:"auto",preload:!0},swf:{wmode:"transparent",allowfullscreen:"true",allowscriptaccess:"always"},keys:{next:{13:"left",34:"up",39:"left",40:"up"},prev:{8:"right",33:"down",37:"right",38:"down"},close:[27],play:[32],toggle:[70]},direction:{next:"left",prev:"right"},scrollOutside:!0,index:0,type:null,href:null,content:null,title:null,tpl:{wrap:'<div class="fancybox-wrap" tabIndex="-1"><div class="fancybox-skin"><div class="fancybox-outer"><div class="fancybox-inner"></div></div></div></div>',image:'<img class="fancybox-image" src="{href}" alt="" />',iframe:'<iframe id="fancybox-frame{rnd}" name="fancybox-frame{rnd}" class="fancybox-iframe" frameborder="0" vspace="0" hspace="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen'+(a?' allowtransparency="true"':"")+"></iframe>",error:'<p class="fancybox-error">The requested content cannot be loaded.<br/>Please try again later.</p>',closeBtn:'<a title="Close" class="fancybox-item fancybox-close" href="javascript:;"></a>',next:'<a title="Next" class="fancybox-nav fancybox-next" href="javascript:;"><span></span></a>',prev:'<a title="Previous" class="fancybox-nav fancybox-prev" href="javascript:;"><span></span></a>'},openEffect:"fade",openSpeed:250,openEasing:"swing",openOpacity:!0,openMethod:"zoomIn",closeEffect:"fade",closeSpeed:250,closeEasing:"swing",closeOpacity:!0,closeMethod:"zoomOut",nextEffect:"elastic",nextSpeed:250,nextEasing:"swing",nextMethod:"changeIn",prevEffect:"elastic",prevSpeed:250,prevEasing:"swing",prevMethod:"changeOut",helpers:{overlay:!0,title:!0},onCancel:n.noop,beforeLoad:n.noop,afterLoad:n.noop,beforeShow:n.noop,afterShow:n.noop,beforeChange:n.noop,beforeClose:n.noop,afterClose:n.noop},group:{},opts:{},previous:null,coming:null,current:null,isActive:!1,isOpen:!1,isOpened:!1,wrap:null,skin:null,outer:null,inner:null,player:{timer:null,isActive:!1},ajaxLoad:null,imgPreload:null,transitions:{},helpers:{},open:function(e,t){if(!e)return;n.isPlainObject(t)||(t={});if(!1===u.close(!0))return;return n.isArray(e)||(e=c(e)?n(e).get():[e]),n.each(e,function(i,s){var o={},a,f,l,p,d,v,m;n.type(s)==="object"&&(s.nodeType&&(s=n(s)),c(s)?(o={type:s.data("fancybox-type")||s.attr("type"),href:s.data("fancybox-href")||s.attr("href"),title:s.data("fancybox-title")||s.attr("title"),isDom:!0,element:s},n.metadata&&n.extend(!0,o,s.metadata())):o=s),a=t.href||o.href||(h(s)?s:null),f=t.title!==r?t.title:o.title||"",l=t.content||o.content,p=l?"html":t.type||o.type,!p&&o.isDom&&(p=s.data("fancybox-type"),p||(d=s.prop("class").match(/fancybox\.(\w+)/),p=d?d[1]:null)),h(a)&&(p||(u.isImage(a)?p="image":u.isSWF(a)?p="swf":a.charAt(0)==="#"?p="inline":h(s)&&(p="html",l=s)),p==="ajax"&&(v=a.split(/\s+/,2),a=v.shift(),m=v.shift())),l||(p==="inline"?a?l=n(h(a)?a.replace(/.*(?=#[^\s]+$)/,""):a):o.isDom&&(l=s):p==="html"?l=a:!p&&!a&&o.isDom&&(p="inline",l=s)),n.extend(o,{href:a,type:p,content:l,title:f,selector:m}),e[i]=o}),u.opts=n.extend(!0,{},u.defaults,t),t.keys!==r&&(u.opts.keys=t.keys?n.extend({},u.defaults.keys,t.keys):!1),u.group=e,u._start(u.opts.index)},cancel:function(){var e=u.coming;if(!e||!1===u.trigger("onCancel"))return;u.hideLoading(),u.ajaxLoad&&u.ajaxLoad.abort(),u.ajaxLoad=null,u.imgPreload&&(u.imgPreload.onload=u.imgPreload.onerror=null),e.wrap&&e.wrap.stop(!0,!0).trigger("onReset").remove(),u.coming=null,u.current||u._afterZoomOut(e)},close:function(e){u.cancel();if(!1===u.trigger("beforeClose"))return;u.unbindEvents();if(!u.isActive)return;!u.isOpen||e===!0?(n(".fancybox-wrap").stop(!0).trigger("onReset").remove(),u._afterZoomOut()):(u.isOpen=u.isOpened=!1,u.isClosing=!0,n(".fancybox-item, .fancybox-nav").remove(),u.wrap.stop(!0,!0).removeClass("fancybox-opened"),u.transitions[u.current.closeMethod]())},play:function(e){var t=function(){clearTimeout(u.player.timer)},n=function(){t(),u.current&&u.player.isActive&&(u.player.timer=setTimeout(u.next,u.current.playSpeed))},r=function(){t(),o.unbind(".player"),u.player.isActive=!1,u.trigger("onPlayEnd")},i=function(){u.current&&(u.current.loop||u.current.index<u.group.length-1)&&(u.player.isActive=!0,o.bind({"onCancel.player beforeClose.player":r,"onUpdate.player":n,"beforeLoad.player":t}),n(),u.trigger("onPlayStart"))};e===!0||!u.player.isActive&&e!==!1?i():r()},next:function(e){var t=u.current;t&&(h(e)||(e=t.direction.next),u.jumpto(t.index+1,e,"next"))},prev:function(e){var t=u.current;t&&(h(e)||(e=t.direction.prev),u.jumpto(t.index-1,e,"prev"))},jumpto:function(e,t,n){var i=u.current;if(!i)return;e=v(e),u.direction=t||i.direction[e>=i.index?"next":"prev"],u.router=n||"jumpto",i.loop&&(e<0&&(e=i.group.length+e%i.group.length),e%=i.group.length),i.group[e]!==r&&(u.cancel(),u._start(e))},reposition:function(e,t){var r=u.current,i=r?r.wrap:null,s;i&&(s=u._getPosition(t),e&&e.type==="scroll"?(delete s.position,i.stop(!0,!0).animate(s,200)):(i.css(s),r.pos=n.extend({},r.dim,s)))},update:function(e){var t=e&&e.type,n=!t||t==="orientationchange";n&&(clearTimeout(f),f=null);if(!u.isOpen||f)return;f=setTimeout(function(){var r=u.current;if(!r||u.isClosing)return;u.wrap.removeClass("fancybox-tmp"),(n||t==="load"||t==="resize"&&r.autoResize)&&u._setDimension(),(t!=="scroll"||!r.canShrink)&&u.reposition(e),u.trigger("onUpdate"),f=null},n&&!l?0:300)},toggle:function(e){u.isOpen&&(u.current.fitToView=n.type(e)==="boolean"?e:!u.current.fitToView,l&&(u.wrap.removeAttr("style").addClass("fancybox-tmp"),u.trigger("onUpdate")),u.update())},hideLoading:function(){o.unbind(".loading"),n("#fancybox-loading").remove()},showLoading:function(){var e,t;u.hideLoading(),e=n('<div id="fancybox-loading"><div></div></div>').click(u.cancel).appendTo("body"),o.bind("keydown.loading",function(e){(e.which||e.keyCode)===27&&(e.preventDefault(),u.cancel())}),u.defaults.fixed||(t=u.getViewport(),e.css({position:"absolute",top:t.h*.5+t.y,left:t.w*.5+t.x}))},getViewport:function(){var t=u.current&&u.current.locked||!1,n={x:s.scrollLeft(),y:s.scrollTop()};return t?(n.w=t[0].clientWidth,n.h=t[0].clientHeight):(n.w=l&&e.innerWidth?e.innerWidth:s.width(),n.h=l&&e.innerHeight?e.innerHeight:s.height()),n},unbindEvents:function(){u.wrap&&c(u.wrap)&&u.wrap.unbind(".fb"),o.unbind(".fb"),s.unbind(".fb")},bindEvents:function(){var e=u.current,t;if(!e)return;s.bind("orientationchange.fb"+(l?"":" resize.fb")+(e.autoCenter&&!e.locked?" scroll.fb":""),u.update),t=e.keys,t&&o.bind("keydown.fb",function(i){var s=i.which||i.keyCode,o=i.target||i.srcElement;if(s===27&&u.coming)return!1;!i.ctrlKey&&!i.altKey&&!i.shiftKey&&!i.metaKey&&(!o||!o.type&&!n(o).is("[contenteditable]"))&&n.each(t,function(t,o){if(e.group.length>1&&o[s]!==r)return u[t](o[s]),i.preventDefault(),!1;if(n.inArray(s,o)>-1)return u[t](),i.preventDefault(),!1})}),n.fn.mousewheel&&e.mouseWheel&&u.wrap.bind("mousewheel.fb",function(t,r,i,s){var o=t.target||null,a=n(o),f=!1;while(a.length){if(f||a.is(".fancybox-skin")||a.is(".fancybox-wrap"))break;f=d(a[0]),a=n(a).parent()}r!==0&&!f&&u.group.length>1&&!e.canShrink&&(s>0||i>0?u.prev(s>0?"down":"left"):(s<0||i<0)&&u.next(s<0?"up":"right"),t.preventDefault())})},trigger:function(e,t){var r,i=t||u.coming||u.current;if(!i)return;n.isFunction(i[e])&&(r=i[e].apply(i,Array.prototype.slice.call(arguments,1)));if(r===!1)return!1;i.helpers&&n.each(i.helpers,function(t,r){r&&u.helpers[t]&&n.isFunction(u.helpers[t][e])&&u.helpers[t][e](n.extend(!0,{},u.helpers[t].defaults,r),i)}),o.trigger(e)},isImage:function(e){return h(e)&&e.match(/(^data:image\/.*,)|(\.(jp(e|g|eg)|gif|png|bmp|webp|svg)((\?|#).*)?$)/i)},isSWF:function(e){return h(e)&&e.match(/\.(swf)((\?|#).*)?$/i)},_start:function(e){var t={},r,i,s,o,a;e=v(e),r=u.group[e]||null;if(!r)return!1;t=n.extend(!0,{},u.opts,r),o=t.margin,a=t.padding,n.type(o)==="number"&&(t.margin=[o,o,o,o]),n.type(a)==="number"&&(t.padding=[a,a,a,a]),t.modal&&n.extend(!0,t,{closeBtn:!1,closeClick:!1,nextClick:!1,arrows:!1,mouseWheel:!1,keys:null,helpers:{overlay:{closeClick:!1}}}),t.autoSize&&(t.autoWidth=t.autoHeight=!0),t.width==="auto"&&(t.autoWidth=!0),t.height==="auto"&&(t.autoHeight=!0),t.group=u.group,t.index=e,u.coming=t;if(!1===u.trigger("beforeLoad")){u.coming=null;return}s=t.type,i=t.href;if(!s)return u.coming=null,u.current&&u.router&&u.router!=="jumpto"?(u.current.index=e,u[u.router](u.direction)):!1;u.isActive=!0;if(s==="image"||s==="swf")t.autoHeight=t.autoWidth=!1,t.scrolling="visible";s==="image"&&(t.aspectRatio=!0),s==="iframe"&&l&&(t.scrolling="scroll"),t.wrap=n(t.tpl.wrap).addClass("fancybox-"+(l?"mobile":"desktop")+" fancybox-type-"+s+" fancybox-tmp "+t.wrapCSS).appendTo(t.parent||"body"),n.extend(t,{skin:n(".fancybox-skin",t.wrap),outer:n(".fancybox-outer",t.wrap),inner:n(".fancybox-inner",t.wrap)}),n.each(["Top","Right","Bottom","Left"],function(e,n){t.skin.css("padding"+n,m(t.padding[e]))}),u.trigger("onReady");if(s==="inline"||s==="html"){if(!t.content||!t.content.length)return u._error("content")}else if(!i)return u._error("href");s==="image"?u._loadImage():s==="ajax"?u._loadAjax():s==="iframe"?u._loadIframe():u._afterLoad()},_error:function(e){n.extend(u.coming,{type:"html",autoWidth:!0,autoHeight:!0,minWidth:0,minHeight:0,scrolling:"no",hasError:e,content:u.coming.tpl.error}),u._afterLoad()},_loadImage:function(){var e=u.imgPreload=new Image;e.onload=function(){this.onload=this.onerror=null,u.coming.width=this.width/u.opts.pixelRatio,u.coming.height=this.height/u.opts.pixelRatio,u._afterLoad()},e.onerror=function(){this.onload=this.onerror=null,u._error("image")},e.src=u.coming.href,e.complete!==!0&&u.showLoading()},_loadAjax:function(){var e=u.coming;u.showLoading(),u.ajaxLoad=n.ajax(n.extend({},e.ajax,{url:e.href,error:function(e,t){u.coming&&t!=="abort"?u._error("ajax",e):u.hideLoading()},success:function(t,n){n==="success"&&(e.content=t,u._afterLoad())}}))},_loadIframe:function(){var e=u.coming,t=n(e.tpl.iframe.replace(/\{rnd\}/g,(new Date).getTime())).attr("scrolling",l?"auto":e.iframe.scrolling).attr("src",e.href);n(e.wrap).bind("onReset",function(){try{n(this).find("iframe").hide().attr("src","//about:blank").end().empty()}catch(e){}}),e.iframe.preload&&(u.showLoading(),t.one("load",function(){n(this).data("ready",1),l||n(this).bind("load.fb",u.update),n(this).parents(".fancybox-wrap").width("100%").removeClass("fancybox-tmp").show(),u._afterLoad()})),e.content=t.appendTo(e.inner),e.iframe.preload||u._afterLoad()},_preloadImages:function(){var e=u.group,t=u.current,n=e.length,r=t.preload?Math.min(t.preload,n-1):0,i,s;for(s=1;s<=r;s+=1)i=e[(t.index+s)%n],i.type==="image"&&i.href&&((new Image).src=i.href)},_afterLoad:function(){var e=u.coming,t=u.current,r="fancybox-placeholder",i,s,o,a,f,l;u.hideLoading();if(!e||u.isActive===!1)return;if(!1===u.trigger("afterLoad",e,t)){e.wrap.stop(!0).trigger("onReset").remove(),u.coming=null;return}t&&(u.trigger("beforeChange",t),t.wrap.stop(!0).removeClass("fancybox-opened").find(".fancybox-item, .fancybox-nav").remove()),u.unbindEvents(),i=e,s=e.content,o=e.type,a=e.scrolling,n.extend(u,{wrap:i.wrap,skin:i.skin,outer:i.outer,inner:i.inner,current:i,previous:t}),f=i.href;switch(o){case"inline":case"ajax":case"html":i.selector?s=n("<div>").html(s).find(i.selector):c(s)&&(s.data(r)||s.data(r,n('<div class="'+r+'"></div>').insertAfter(s).hide()),s=s.show().detach(),i.wrap.bind("onReset",function(){n(this).find(s).length&&s.hide().replaceAll(s.data(r)).data(r,!1)}));break;case"image":s=i.tpl.image.replace("{href}",f);break;case"swf":s='<object id="fancybox-swf" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="100%" height="100%"><param name="movie" value="'+f+'"></param>',l="",n.each(i.swf,function(e,t){s+='<param name="'+e+'" value="'+t+'"></param>',l+=" "+e+'="'+t+'"'}),s+='<embed src="'+f+'" type="application/x-shockwave-flash" width="100%" height="100%"'+l+"></embed></object>"}(!c(s)||!s.parent().is(i.inner))&&i.inner.append(s),u.trigger("beforeShow"),i.inner.css("overflow",a==="yes"?"scroll":a==="no"?"hidden":a),u._setDimension(),u.reposition(),u.isOpen=!1,u.coming=null,u.bindEvents(),u.isOpened?t.prevMethod&&u.transitions[t.prevMethod]():n(".fancybox-wrap").not(i.wrap).stop(!0).trigger("onReset").remove(),u.transitions[u.isOpened?i.nextMethod:i.openMethod](),u._preloadImages()},_setDimension:function(){var e=u.getViewport(),t=0,r=!1,i=!1,s=u.wrap,o=u.skin,a=u.inner,f=u.current,l=f.width,c=f.height,h=f.minWidth,d=f.minHeight,g=f.maxWidth,y=f.maxHeight,b=f.scrolling,w=f.scrollOutside?f.scrollbarWidth:0,E=f.margin,S=v(E[1]+E[3]),x=v(E[0]+E[2]),T,N,C,k,L,A,O,M,_,D,P,H,B,j,I;s.add(o).add(a).width("auto").height("auto").removeClass("fancybox-tmp"),T=v(o.outerWidth(!0)-o.width()),N=v(o.outerHeight(!0)-o.height()),C=S+T,k=x+N,L=p(l)?(e.w-C)*v(l)/100:l,A=p(c)?(e.h-k)*v(c)/100:c;if(f.type==="iframe"){j=f.content;if(f.autoHeight&&j.data("ready")===1)try{j[0].contentWindow.document.location&&(a.width(L).height(9999),I=j.contents().find("body"),w&&I.css("overflow-x","hidden"),A=I.outerHeight(!0))}catch(q){}}else if(f.autoWidth||f.autoHeight)a.addClass("fancybox-tmp"),f.autoWidth||a.width(L),f.autoHeight||a.height(A),f.autoWidth&&(L=a.width()),f.autoHeight&&(A=a.height()),a.removeClass("fancybox-tmp");l=v(L),c=v(A),_=L/A,h=v(p(h)?v(h,"w")-C:h),g=v(p(g)?v(g,"w")-C:g),d=v(p(d)?v(d,"h")-k:d),y=v(p(y)?v(y,"h")-k:y),O=g,M=y,f.fitToView&&(g=Math.min(e.w-C,g),y=Math.min(e.h-k,y)),H=e.w-S,B=e.h-x,f.aspectRatio?(l>g&&(l=g,c=v(l/_)),c>y&&(c=y,l=v(c*_)),l<h&&(l=h,c=v(l/_)),c<d&&(c=d,l=v(c*_))):(l=Math.max(h,Math.min(l,g)),f.autoHeight&&f.type!=="iframe"&&(a.width(l),c=a.height()),c=Math.max(d,Math.min(c,y)));if(f.fitToView){a.width(l).height(c),s.width(l+T),D=s.width(),P=s.height();if(f.aspectRatio)while((D>H||P>B)&&l>h&&c>d){if(t++>19)break;c=Math.max(d,Math.min(y,c-10)),l=v(c*_),l<h&&(l=h,c=v(l/_)),l>g&&(l=g,c=v(l/_)),a.width(l).height(c),s.width(l+T),D=s.width(),P=s.height()}else l=Math.max(h,Math.min(l,l-(D-H))),c=Math.max(d,Math.min(c,c-(P-B)))}w&&b==="auto"&&c<A&&l+T+w<H&&(l+=w),a.width(l).height(c),s.width(l+T),D=s.width(),P=s.height(),r=(D>H||P>B)&&l>h&&c>d,i=f.aspectRatio?l<O&&c<M&&l<L&&c<A:(l<O||c<M)&&(l<L||c<A),n.extend(f,{dim:{width:m(D),height:m(P)},origWidth:L,origHeight:A,canShrink:r,canExpand:i,wPadding:T,hPadding:N,wrapSpace:P-o.outerHeight(!0),skinSpace:o.height()-c}),!j&&f.autoHeight&&c>d&&c<y&&!i&&a.height("auto")},_getPosition:function(e){var t=u.current,n=u.getViewport(),r=t.margin,i=u.wrap.width()+r[1]+r[3],s=u.wrap.height()+r[0]+r[2],o={position:"absolute",top:r[0],left:r[3]};return t.autoCenter&&t.fixed&&!e&&s<=n.h&&i<=n.w?o.position="fixed":t.locked||(o.top+=n.y,o.left+=n.x),o.top=m(Math.max(o.top,o.top+(n.h-s)*t.topRatio)),o.left=m(Math.max(o.left,o.left+(n.w-i)*t.leftRatio)),o},_afterZoomIn:function(){var e=u.current;if(!e)return;u.isOpen=u.isOpened=!0,u.wrap.css("overflow","visible").addClass("fancybox-opened"),u.update(),(e.closeClick||e.nextClick&&u.group.length>1)&&u.inner.css("cursor","pointer").bind("click.fb",function(t){!n(t.target).is("a")&&!n(t.target).parent().is("a")&&(t.preventDefault(),u[e.closeClick?"close":"next"]())}),e.closeBtn&&n(e.tpl.closeBtn).appendTo(u.skin).bind("click.fb",function(e){e.preventDefault(),u.close()}),e.arrows&&u.group.length>1&&((e.loop||e.index>0)&&n(e.tpl.prev).appendTo(u.outer).bind("click.fb",u.prev),(e.loop||e.index<u.group.length-1)&&n(e.tpl.next).appendTo(u.outer).bind("click.fb",u.next)),u.trigger("afterShow"),!e.loop&&e.index===e.group.length-1?u.play(!1):u.opts.autoPlay&&!u.player.isActive&&(u.opts.autoPlay=!1,u.play())},_afterZoomOut:function(e){e=e||u.current,n(".fancybox-wrap").trigger("onReset").remove(),n.extend(u,{group:{},opts:{},router:!1,current:null,isActive:!1,isOpened:!1,isOpen:!1,isClosing:!1,wrap:null,skin:null,outer:null,inner:null}),u.trigger("afterClose",e)}}),u.transitions={getOrigPosition:function(){var e=u.current,t=e.element,n=e.orig,r={},i=50,s=50,o=e.hPadding,a=e.wPadding,f=u.getViewport();!n&&e.isDom&&t.is(":visible")&&(n=t.find("img:first"),n.length||(n=t)),c(n)?(r=n.offset(),n.is("img")&&(i=n.outerWidth(),s=n.outerHeight())):(r.top=f.y+(f.h-s)*e.topRatio,r.left=f.x+(f.w-i)*e.leftRatio);if(u.wrap.css("position")==="fixed"||e.locked)r.top-=f.y,r.left-=f.x;return r={top:m(r.top-o*e.topRatio),left:m(r.left-a*e.leftRatio),width:m(i+a),height:m(s+o)},r},step:function(e,t){var n,r,i,s=t.prop,o=u.current,a=o.wrapSpace,f=o.skinSpace;if(s==="width"||s==="height")n=t.end===t.start?1:(e-t.start)/(t.end-t.start),u.isClosing&&(n=1-n),r=s==="width"?o.wPadding:o.hPadding,i=e-r,u.skin[s](v(s==="width"?i:i-a*n)),u.inner[s](v(s==="width"?i:i-a*n-f*n))},zoomIn:function(){var e=u.current,t=e.pos,r=e.openEffect,i=r==="elastic",s=n.extend({opacity:1},t);delete s.position,i?(t=this.getOrigPosition(),e.openOpacity&&(t.opacity=.1)):r==="fade"&&(t.opacity=.1),u.wrap.css(t).animate(s,{duration:r==="none"?0:e.openSpeed,easing:e.openEasing,step:i?this.step:null,complete:u._afterZoomIn})},zoomOut:function(){var e=u.current,t=e.closeEffect,n=t==="elastic",r={opacity:.1};n&&(r=this.getOrigPosition(),e.closeOpacity&&(r.opacity=.1)),u.wrap.animate(r,{duration:t==="none"?0:e.closeSpeed,easing:e.closeEasing,step:n?this.step:null,complete:u._afterZoomOut})},changeIn:function(){var e=u.current,t=e.nextEffect,n=e.pos,r={opacity:1},i=u.direction,s=200,o;n.opacity=.1,t==="elastic"&&(o=i==="down"||i==="up"?"top":"left",i==="down"||i==="right"?(n[o]=m(v(n[o])-s),r[o]="+="+s+"px"):(n[o]=m(v(n[o])+s),r[o]="-="+s+"px")),t==="none"?u._afterZoomIn():u.wrap.css(n).animate(r,{duration:e.nextSpeed,easing:e.nextEasing,complete:u._afterZoomIn})},changeOut:function(){var e=u.previous,t=e.prevEffect,r={opacity:.1},i=u.direction,s=200;t==="elastic"&&(r[i==="down"||i==="up"?"top":"left"]=(i==="up"||i==="left"?"-":"+")+"="+s+"px"),e.wrap.animate(r,{duration:t==="none"?0:e.prevSpeed,easing:e.prevEasing,complete:function(){n(this).trigger("onReset").remove()}})}},u.helpers.overlay={defaults:{closeClick:!0,speedOut:200,showEarly:!0,css:{},locked:!l,fixed:!0},overlay:null,fixed:!1,el:n("html"),create:function(e){e=n.extend({},this.defaults,e),this.overlay&&this.close(),this.overlay=n('<div class="fancybox-overlay"></div>').appendTo(u.coming?u.coming.parent:e.parent),this.fixed=!1,e.fixed&&u.defaults.fixed&&(this.overlay.addClass("fancybox-overlay-fixed"),this.fixed=!0)},open:function(e){var t=this;e=n.extend({},this.defaults,e),this.overlay?this.overlay.unbind(".overlay").width("auto").height("auto"):this.create(e),this.fixed||(s.bind("resize.overlay",n.proxy(this.update,this)),this.update()),e.closeClick&&this.overlay.bind("click.overlay",function(e){if(n(e.target).hasClass("fancybox-overlay"))return u.isActive?u.close():t.close(),!1}),this.overlay.css(e.css).show()},close:function(){var e,t;s.unbind("resize.overlay"),this.el.hasClass("fancybox-lock")&&(n(".fancybox-margin").removeClass("fancybox-margin"),e=s.scrollTop(),t=s.scrollLeft(),this.el.removeClass("fancybox-lock"),s.scrollTop(e).scrollLeft(t)),n(".fancybox-overlay").remove().hide(),n.extend(this,{overlay:null,fixed:!1})},update:function(){var e="100%",n;this.overlay.width(e).height("100%"),a?(n=Math.max(t.documentElement.offsetWidth,t.body.offsetWidth),o.width()>n&&(e=o.width())):o.width()>s.width()&&(e=o.width()),this.overlay.width(e).height(o.height())},onReady:function(e,t){var r=this.overlay;n(".fancybox-overlay").stop(!0,!0),r||this.create(e),e.locked&&this.fixed&&t.fixed&&(r||(this.margin=o.height()>s.height()?n("html").css("margin-right").replace("px",""):!1),t.locked=this.overlay.append(t.wrap),t.fixed=!1),e.showEarly===!0&&this.beforeShow.apply(this,arguments)},beforeShow:function(e,t){var r,i;t.locked&&(this.margin!==!1&&(n("*").filter(function(){return n(this).css("position")==="fixed"&&!n(this).hasClass("fancybox-overlay")&&!n(this).hasClass("fancybox-wrap")}).addClass("fancybox-margin"),this.el.addClass("fancybox-margin")),r=s.scrollTop(),i=s.scrollLeft(),this.el.addClass("fancybox-lock"),s.scrollTop(r).scrollLeft(i)),this.open(e)},onUpdate:function(){this.fixed||this.update()},afterClose:function(e){this.overlay&&!u.coming&&this.overlay.fadeOut(e.speedOut,n.proxy(this.close,this))}},u.helpers.title={defaults:{type:"float",position:"bottom"},beforeShow:function(e){var t=u.current,r=t.title,i=e.type,s,o;n.isFunction(r)&&(r=r.call(t.element,t));if(!h(r)||n.trim(r)==="")return;s=n('<div class="fancybox-title fancybox-title-'+i+'-wrap">'+r+"</div>");switch(i){case"inside":o=u.skin;break;case"outside":o=u.wrap;break;case"over":o=u.inner;break;default:o=u.skin,s.appendTo("body"),a&&s.width(s.width()),s.wrapInner('<span class="child"></span>'),u.current.margin[2]+=Math.abs(v(s.css("margin-bottom")))}s[e.position==="top"?"prependTo":"appendTo"](o)}},n.fn.fancybox=function(e){var t,r=n(this),i=this.selector||"",s=function(s){var o=n(this).blur(),a=t,f,l;!(s.ctrlKey||s.altKey||s.shiftKey||s.metaKey)&&!o.is(".fancybox-wrap")&&(f=e.groupAttr||"data-fancybox-group",l=o.attr(f),l||(f="rel",l=o.get(0)[f]),l&&l!==""&&l!=="nofollow"&&(o=i.length?n(i):r,o=o.filter("["+f+'="'+l+'"]'),a=o.index(this)),e.index=a,u.open(o,e)!==!1&&s.preventDefault())};return e=e||{},t=e.index||0,!i||e.live===!1?r.unbind("click.fb-start").bind("click.fb-start",s):o.undelegate(i,"click.fb-start").delegate(i+":not('.fancybox-item, .fancybox-nav')","click.fb-start",s),this.filter("[data-fancybox-start=1]").trigger("click"),this},o.ready(function(){var t,s;n.scrollbarWidth===r&&(n.scrollbarWidth=function(){var e=n('<div style="width:50px;height:50px;overflow:auto"><div/></div>').appendTo("body"),t=e.children(),r=t.innerWidth()-t.height(99).innerWidth();return e.remove(),r}),n.support.fixedPosition===r&&(n.support.fixedPosition=function(){var e=n('<div style="position:fixed;top:20px;"></div>').appendTo("body"),t=e[0].offsetTop===20||e[0].offsetTop===15;return e.remove(),t}()),n.extend(u.defaults,{scrollbarWidth:n.scrollbarWidth(),fixed:n.support.fixedPosition,parent:n("body")}),t=n(e).width(),i.addClass("fancybox-lock-test"),s=n(e).width(),i.removeClass("fancybox-lock-test"),n("<style type='text/css'>.fancybox-margin{margin-right:"+(s-t)+"px;}</style>").appendTo("head")})})(window,document,e)}),tadpoles.define("fancyboxButtons",["jquery","fancybox"],function(e){(function(e){var t=e.fancybox;t.helpers.buttons={defaults:{skipSingle:!1,position:"top",tpl:'<div id="fancybox-buttons"><ul><li><a class="btnPrev" title="Previous" href="javascript:;"></a></li><li><a class="btnPlay" title="Start slideshow" href="javascript:;"></a></li><li><a class="btnNext" title="Next" href="javascript:;"></a></li><li><a class="btnToggle" title="Toggle size" href="javascript:;"></a></li><li><a class="btnClose" title="Close" href="javascript:;"></a></li></ul></div>'},list:null,buttons:null,beforeLoad:function(e,t){if(e.skipSingle&&t.group.length<2){t.helpers.buttons=!1,t.closeBtn=!0;return}t.margin[e.position==="bottom"?2:0]+=30},onPlayStart:function(){this.buttons&&this.buttons.play.attr("title","Pause slideshow").addClass("btnPlayOn")},onPlayEnd:function(){this.buttons&&this.buttons.play.attr("title","Start slideshow").removeClass("btnPlayOn")},afterShow:function(n,r){var i=this.buttons;i||(this.list=e(n.tpl).addClass(n.position).appendTo(".fancybox-overlay"),i={prev:this.list.find(".btnPrev").click(t.prev),next:this.list.find(".btnNext").click(t.next),play:this.list.find(".btnPlay").click(t.play),toggle:this.list.find(".btnToggle").click(t.toggle),close:this.list.find(".btnClose").click(t.close)}),r.index>0||r.loop?i.prev.removeClass("btnDisabled"):i.prev.addClass("btnDisabled"),r.loop||r.index<r.group.length-1?(i.next.removeClass("btnDisabled"),i.play.removeClass("btnDisabled")):(i.next.addClass("btnDisabled"),i.play.addClass("btnDisabled")),this.buttons=i,this.onUpdate(n,r)},onUpdate:function(e,t){var n;if(!this.buttons)return;n=this.buttons.toggle.removeClass("btnDisabled btnToggleOn"),t.canShrink?n.addClass("btnToggleOn"):t.canExpand||n.addClass("btnDisabled")},beforeClose:function(){this.list&&this.list.remove(),this.list=null,this.buttons=null}}})(e)}),Date.prototype.timestampAsSeconds=function(){return Math.round(this.getTime()/1e3)},Date.prototype.f=function(e){var t,n;if(e=="@")return this.getTime();if(e=="REL")return t=((new Date).getTime()-this.getTime())/1e3,n=Math.floor(t/86400),n==0&&(t<=0&&(t>-60&&"right now"||t>-120&&"in 1 minute"||t>-3600&&"in "+ -Math.floor(t/60)+" minute"||t>-7200&&"in 1 hour"||t>-86400&&"in "+ -Math.floor(t/3600)+" hours")||t<60&&"just now"||t<120&&"1 minute ago"||t<3600&&Math.floor(t/60)+" minutes ago"||t<7200&&"1 hour ago"||t<86400&&Math.floor(t/3600)+" hours ago"||n==0&&"Tomorrow")||n<0&&(n>-7&&-n+" days from now"||-Math.ceil(n/7)==1&&"1 week from now"||n>-78&&-Math.ceil(n/7)+" weeks from now"||n>-730&&-Math.ceil(n/30)+" months from now"||n<=-730&&-Math.ceil(n/365)+" years from now")||n==1&&"Yesterday"||n<7&&n+" days ago"||Math.ceil(n/7)==1&&"1 week ago"||n<78&&Math.ceil(n/7)+" weeks ago"||n<730&&Math.ceil(n/30)+" months ago"||Math.ceil(n/365)+" years ago";if(e=="SREL")return t=((new Date).getTime()-this.getTime())/1e3,n=Math.floor(t/86400),n==0&&(t<=0&&(t>-60&&"right now"||t>-120&&"1 min. from now"||t>-3600&&-Math.floor(t/60)+" mins from now"||t>-7200&&"1 hour ago"||t>-86400&&-Math.floor(t/3600)+" hrs from now")||t<60&&"just now"||t<120&&"1 min. ago"||t<3600&&Math.floor(t/60)+" mins ago"||t<7200&&"1 hour ago"||t<86400&&Math.floor(t/3600)+" hrs ago"||n==0&&"Tomorrow")||n<0&&(n>-7&&-n+" days from now"||-Math.ceil(n/7)==1&&"1 wk from now"||n>-78&&-Math.ceil(n/7)+" wks from now"||n>-730&&-Math.ceil(n/30)+" mnths from now"||n<=-730&&-Math.ceil(n/365)+" yrs from now")||n==1&&"Yesterday"||n<7&&n+" days ago"||Math.ceil(n/7)==1&&"1 wk ago"||n<78&&Math.ceil(n/7)+" wks ago"||n<730&&Math.ceil(n/30)+" mnths ago"||Math.ceil(n/365)+" years ago";if(e=="AGE")return t=((new Date).getTime()-this.getTime())/1e3,n=Math.floor(t/86400),n==0&&(t<=0&&t>-86400&&"Newborn"||t<86400&&"Newborn"||n==0&&"Tomorrow")||n<0&&"Expecting"||n==1&&"1 day"||n<7&&n+" days"||Math.floor(n/7)==1&&"1 week"||n<78&&Math.floor(n/7)+" weeks"||n<730&&Math.floor(n/30)+" months"||Math.floor(n/365)+" years";var r=["January","February","March","April","May","June","July","August","September","October","November","December"],i=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],s=function(e){return(e<0||e>9?"":"0")+e},o=this,e=e+"",u="",a=0,f="",l="",c=o.getYear()+"",h=o.getMonth()+1,p=o.getDate(),d=o.getDay(),v=o.getHours(),m=o.getMinutes(),g=o.getSeconds(),y,b,w,E,S,x,T,N,C,k,L,v,A,O,M,_,D={};c.length<4&&(c=""+(c-0+1900)),D.y=""+c,D.yyyy=c,D.yy=c.substr(2,4),D.M=h,D.MM=s(h),D.MMM=r[h-1],D.NNN=r[h-1].substr(0,3),D.N=r[h-1].substr(0,1),D.d=p,D.dd=s(p),D.e=i[d].substr(0,1),D.ee=i[d].substr(0,2),D.E=i[d].substr(0,3),D.EE=i[d],D.H=v,D.HH=s(v),v==0?D.h=12:v>12?D.h=v-12:D.h=v,D.hh=s(D.h),v>11?D.K=v-12:D.K=v,D.k=v+1,D.KK=s(D.K),D.kk=s(D.k),v>11?D.a="PM":D.a="AM",D.m=m,D.mm=s(m),D.s=g,D.ss=s(g);while(a<e.length){f=e.charAt(a),l="";while(e.charAt(a)==f&&a<e.length)l+=e.charAt(a++);D[l]!=null?u+=D[l]:u+=l}return u},Date.prototype.toISO8601=function(){return this.toISO8601String(3)},Date.prototype.toISO8601String=function(e,t){e||(e=6);var n;if(!t)t="Z",n=this;else{var r=t.match("/([-+])([0-9]{2}):([0-9]{2})/"),i=Number(r[2])*60+Number(r[3]);i*=r[1]=="-"?-1:1,n=new Date(Number(Number(this)+i*6e4))}var s=function(e){return(e<10?"0":"")+e},o="";o+=n.getUTCFullYear(),e>1&&(o+="-"+s(n.getUTCMonth()+1)),e>2&&(o+="-"+s(n.getUTCDate())),e>3&&(o+="T"+s(n.getUTCHours())+":"+s(n.getUTCMinutes()));if(e>5){var u=Number(n.getUTCSeconds()+"."+(n.getUTCMilliseconds()<100?"0":"")+s(n.getUTCMilliseconds()));o+=":"+s(u)}else e>4&&(o+=":"+s(n.getUTCSeconds()));return e>3&&(o+=t),o},Date.prototype.setISO8601=function(e){var t="([0-9]{4})(-([0-9]{2})(-([0-9]{2})(T([0-9]{2}):([0-9]{2})(:([0-9]{2})(.([0-9]+))?)?(Z|(([-+])([0-9]{2}):([0-9]{2})))?)?)?)?",n=e.match(new RegExp(t)),r=0,i=new Date(n[1],0,1),s=!1;n[3]&&i.setMonth(n[3]-1),n[5]&&i.setDate(n[5]),n[7]&&(i.setHours(n[7]),s=!0),n[8]&&i.setMinutes(n[8]),n[10]&&i.setSeconds(n[10]),n[12]&&i.setMilliseconds(Number("0."+n[12])*1e3),n[14]&&(r=Number(n[16])*60+Number(n[17]),r*=n[15]=="-"?1:-1),s&&(r-=i.getTimezoneOffset()),time=Number(i)+r*60*1e3,this.setTime(Number(time))},function(){function n(e,t){var n=.1;return e>=t&&e<=t*(1+n)?t:e}var e={ago:"-",from:"",now:"now",minute:"min",minutes:"min",hour:"hr",hours:"hrs",day:"day",days:"days",week:"week",weeks:"weeks",month:"month",months:"months",year:"year",years:"years"},t=[[60,e.now],[3600,e.minute,e.minutes,60],[86400,e.hour,e.hours,3600],[604800,e.day,e.days,86400],[2628e3,e.week,e.weeks,604800],[31536e3,e.month,e.months,2628e3],[Infinity,e.year,e.years,31536e3]];Date.prototype.humaneDate=function(r,i,s){var o=this,u=typeof o=="string",o=u?new Date((""+o).replace(/-/g,"/").replace(/T|(?:\.\d+)?Z/g," ")):o,r=r||new Date,a=(r-o+(r.getTimezoneOffset()-(u?0:o.getTimezoneOffset()))*6e4)/1e3,f;if(isNaN(a))return"unknown";var l=i?" ago":e.ago,c=i?" from now":e.from;a<0?(a=Math.abs(a),f=c):f=l;var h=!1,p=null;while(!h)for(var d=0,v=t[0];t[d];v=t[++d])if(a<v[0]){if(d===0)return p!=null?p:v[1];var m;p!=null||d<=1||s?(m=Math.round(n(a,v[3])/v[3]),h=!0):m=Math.floor(n(a,v[3])/v[3]),p==null&&(p=i?"":f),p+=m+" "+(m!=1?v[2]:v[1]),h||(a-=t[d-1][0]*m,p+=" ");break}return p+=i?f:"",p},Date.prototype.tomorrow=function(){var e=new Date(this);return e.setDate(this.getDate()+1),e},Date.prototype.yesterday=function(){var e=new Date(this);return e.setDate(this.getDate()-1),e}}(),tadpoles.define("date",function(){});var dateFormat=function(){var e=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,t=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,n=/[^-+\dA-Z]/g,r=function(e,t){e=String(e),t=t||2;while(e.length<t)e="0"+e;return e};return function(i,s,o){var u=dateFormat;arguments.length==1&&Object.prototype.toString.call(i)=="[object String]"&&!/\d/.test(i)&&(s=i,i=undefined),i=i?new Date(i):new Date;if(isNaN(i))return"";s=String(u.masks[s]||s||u.masks["default"]),s.slice(0,4)=="UTC:"&&(s=s.slice(4),o=!0);var a=o?"getUTC":"get",f=i[a+"Date"](),l=i[a+"Day"](),c=i[a+"Month"](),h=i[a+"FullYear"](),p=i[a+"Hours"](),d=i[a+"Minutes"](),v=i[a+"Seconds"](),m=i[a+"Milliseconds"](),g=o?0:i.getTimezoneOffset(),y={d:f,dd:r(f),ddd:u.i18n.dayNames[l],dddd:u.i18n.dayNames[l+7],m:c+1,mm:r(c+1),mmm:u.i18n.monthNames[c],mmmm:u.i18n.monthNames[c+12],yy:String(h).slice(2),yyyy:h,h:p%12||12,hh:r(p%12||12),H:p,HH:r(p),M:d,MM:r(d),s:v,ss:r(v),l:r(m,3),L:r(m>99?Math.round(m/10):m),t:p<12?"a":"p",tt:p<12?"am":"pm",T:p<12?"A":"P",TT:p<12?"AM":"PM",Z:o?"UTC":(String(i).match(t)||[""]).pop().replace(n,""),o:(g>0?"-":"+")+r(Math.floor(Math.abs(g)/60)*100+Math.abs(g)%60,4),S:["th","st","nd","rd"][f%10>3?0:(f%100-f%10!=10)*f%10]};return s.replace(e,function(e){return e in y?y[e]:e.slice(1,e.length-1)})}}();dateFormat.masks={"default":"ddd mmm dd yyyy HH:MM:ss",tinyDate:"m/d",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",tinyTime:"h:MM",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"},dateFormat.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]},Date.prototype.format=function(e,t){return dateFormat(this,e,t)},Date.prototype.withTime=function(e){var t=/([0-9]+):([0-9]+) ([AMPamp]+)/i,n=t.exec(e),r=parseInt(n[1]);r===12&&(r=0),n[3].toLowerCase()==="pm"&&(r+=12);var i=parseInt(n[2]);this.setHours(r),this.setMinutes(i)},tadpoles.define("dateformat",function(){}),function(){function m(){return function(){}}function n(e){return function(){return this[e]}}function p(e){return function(){return e}}function t(e,n,r){if("string"==typeof e){0===e.indexOf("#")&&(e=e.slice(1));if(t.Ca[e])return n&&t.log.warn('Player "'+e+'" is already initialised. Options will not be applied.'),r&&t.Ca[e].I(r),t.Ca[e];e=t.m(e)}if(!e||!e.nodeName)throw new TypeError("The element or ID supplied is not valid. (videojs)");return e.player||new t.Player(e,n,r)}function v(e,n,r,i){t.tc.forEach(r,function(t){e(n,t,i)})}function F(e,n){var r,i;r=Array.prototype.slice.call(n),i=m(),i=window.console||{log:i,warn:i,error:i},e?r.unshift(e.toUpperCase()+":"):e="log",t.log.history.push(r),r.unshift("VIDEOJS:"),i[e].apply?i[e].apply(i,r):i[e](r.join(" "))}function G(e){e.r("vjs-lock-showing")}function ca(e,n,r,i){if(r!==b){if(r===j||t.ge(r))r=0;return e.c.style[n]=-1!==(""+r).indexOf("%")||-1!==(""+r).indexOf("px")?r:"auto"===r?"":r+"px",i||e.o("resize"),e}return e.c?(r=e.c.style[n],i=r.indexOf("px"),-1!==i?parseInt(r.slice(0,i),10):parseInt(e.c["offset"+t.va(n)],10)):0}function da(e){var n,r,i,s,o,u,a,c;n=0,r=j,e.b("touchstart",function(e){1===e.touches.length&&(r=t.i.copy(e.touches[0]),n=(new Date).getTime(),s=f)}),e.b("touchmove",function(e){1<e.touches.length?s=l:r&&(u=e.touches[0].pageX-r.pageX,a=e.touches[0].pageY-r.pageY,c=Math.sqrt(u*u+a*a),10<c&&(s=l))}),o=function(){s=l},e.b("touchleave",o),e.b("touchcancel",o),e.b("touchend",function(e){r=j,s===f&&(i=(new Date).getTime()-n,200>i&&(e.preventDefault(),this.o("tap")))})}function ea(e,n){var r,i,s,o;return r=e.c,i=t.Vd(r),o=s=r.offsetWidth,r=e.handle,e.options().vertical?(o=i.top,i=n.changedTouches?n.changedTouches[0].pageY:n.pageY,r&&(r=r.m().offsetHeight,o+=r/2,s-=r),Math.max(0,Math.min(1,(o-i+s)/s))):(s=i.left,i=n.changedTouches?n.changedTouches[0].pageX:n.pageX,r&&(r=r.m().offsetWidth,s+=r/2,o-=r),Math.max(0,Math.min(1,(i-s)/o)))}function fa(e,n){e.aa(n),n.b("click",t.bind(e,function(){G(this)}))}function ga(e){e.Ja=f,e.za.p("vjs-lock-showing"),e.c.setAttribute("aria-pressed",f),e.H&&0<e.H.length&&e.H[0].m().focus()}function H(e){e.Ja=l,G(e.za),e.c.setAttribute("aria-pressed",l)}function ia(e){var n,r,i={sources:[],tracks:[]};n=t.Oa(e),r=n["data-setup"],r!==j&&t.i.D(n,t.JSON.parse(r||"{}")),t.i.D(i,n);if(e.hasChildNodes()){var s,o;e=e.childNodes,s=0;for(o=e.length;s<o;s++)n=e[s],r=n.nodeName.toLowerCase(),"source"===r?i.sources.push(t.Oa(n)):"track"===r&&i.tracks.push(t.Oa(n))}return i}function ka(e,n,r){e.h&&(e.ya=l,e.h.dispose(),e.h=l),"Html5"!==n&&e.L&&(t.f.Kb(e.L),e.L=j),e.Ta=n,e.ya=l;var i=t.i.D({source:r,parentEl:e.c},e.q[n.toLowerCase()]);r&&(e.Cc=r.type,r.src==e.K.src&&0<e.K.currentTime&&(i.startTime=e.K.currentTime),e.K.src=r.src),e.h=new window.videojs[n](e,i),e.h.I(function(){this.d.Va()})}function la(e,t){t!==b&&e.Jc!==t&&((e.Jc=t)?(e.p("vjs-has-started"),e.o("firstplay")):e.r("vjs-has-started"))}function N(e,n,r){if(e.h&&!e.h.ya)e.h.I(function(){this[n](r)});else try{e.h[n](r)}catch(i){throw t.log(i),i}}function M(e,n){if(e.h&&e.h.ya)try{return e.h[n]()}catch(r){throw e.h[n]===b?t.log("Video.js: "+n+" method not defined for "+e.Ta+" playback technology.",r):"TypeError"==r.name?(t.log("Video.js: "+n+" unavailable on "+e.Ta+" playback technology element.",r),e.h.ya=l):t.log(r),r}}function ma(e,t){var n=e.selectSource(t);n?n.h===e.Ta?e.src(n.source):ka(e,n.h,n.source):(e.setTimeout(function(){this.error({code:4,message:this.v(this.options().notSupportedMessage)})},0),e.Va())}function ja(e,t){return t!==b?(e.Lc=!!t,e):e.Lc}function na(e){return e.k().h&&e.k().h.featuresPlaybackRate&&e.k().options().playbackRates&&0<e.k().options().playbackRates.length}function oa(e,t){var n=/^blob\:/i;return t&&e&&n.test(e)?t:e}function ta(){var e=T[U],t=e.charAt(0).toUpperCase()+e.slice(1);ua["set"+t]=function(t){return this.c.vjs_setProperty(e,t)}}function va(e){ua[e]=function(){return this.c.vjs_getProperty(e)}}function P(e,n){var r=e.Ua.length;""+r in e||Object.defineProperty(e,r,{get:function(){return this.Ua[r]}}),n.addEventListener("modechange",t.bind(e,function(){this.o("change")})),e.Ua.push(n),e.o({type:"addtrack",Y:n})}function Q(e,t){for(var n=0,r=e.length,i;n<r;n++)if(i=e[n],i===t){e.Ua.splice(n,1);break}e.o({type:"removetrack",Y:t})}function W(e,t){return"rgba("+parseInt(e[1]+e[1],16)+","+parseInt(e[2]+e[2],16)+","+parseInt(e[3]+e[3],16)+","+t+")"}function X(e){var t;return e.Ge?t=e.Ge[0]:e.options&&(t=e.options[e.options.selectedIndex]),t.value}function Y(e,t){var n,r;if(t){for(n=0;n<e.options.length&&(r=e.options[n],r.value!==t);n++);e.selectedIndex=n}}function $(e,t){var n=e.split("."),r=Ba;!(n[0]in r)&&r.execScript&&r.execScript("var "+n[0]);for(var i;n.length&&(i=n.shift());)!n.length&&t!==b?r[i]=t:r=r[i]?r[i]:r[i]={}}var b=void 0,f=!0,j=null,l=!1,s;document.createElement("video"),document.createElement("audio"),document.createElement("track");var videojs=window.videojs=t;t.fc="4.12",t.sd="https:"==document.location.protocol?"https://":"http://",t.VERSION="4.12.15",t.options={techOrder:["html5","flash"],html5:{},flash:{},width:300,height:150,defaultVolume:0,playbackRates:[],inactivityTimeout:2e3,children:{mediaLoader:{},posterImage:{},loadingSpinner:{},textTrackDisplay:{},bigPlayButton:{},controlBar:{},errorDisplay:{},textTrackSettings:{}},language:document.getElementsByTagName("html")[0].getAttribute("lang")||navigator.languages&&navigator.languages[0]||navigator.Ef||navigator.language||"en",languages:{},notSupportedMessage:"No compatible source was found for this video."},"GENERATED_CDN_VSN"!==t.fc&&(videojs.options.flash.swf=t.sd+"vjs.zencdn.net/"+t.fc+"/video-js.swf"),t.Gd=function(e,n){return t.options.languages[e]=t.options.languages[e]!==b?t.Z.Aa(t.options.languages[e],n):n,t.options.languages},t.Ca={},"function"==typeof tadpoles.define&&tadpoles.define.amd?tadpoles.define("videojs",[],function(){return videojs}):"object"==typeof exports&&"object"==typeof module&&(module.exports=videojs),t.Ga=t.CoreObject=m(),t.Ga.extend=function(e){var n,r;e=e||{},n=e.init||e.l||this.prototype.init||this.prototype.l||m(),r=function(){n.apply(this,arguments)},r.prototype=t.i.create(this.prototype),r.prototype.constructor=r,r.extend=t.Ga.extend,r.create=t.Ga.create;for(var i in e)e.hasOwnProperty(i)&&(r.prototype[i]=e[i]);return r},t.Ga.create=function(){var e=t.i.create(this.prototype);return this.apply(e,arguments),e},t.b=function(e,n,r){if(t.i.isArray(n))return v(t.b,e,n,r);var i=t.getData(e);i.G||(i.G={}),i.G[n]||(i.G[n]=[]),r.s||(r.s=t.s++),i.G[n].push(r),i.ba||(i.disabled=l,i.ba=function(n){if(!i.disabled){n=t.Nb(n);var r=i.G[n.type];if(r)for(var r=r.slice(0),s=0,o=r.length;s<o&&!n.Nc();s++)r[s].call(e,n)}}),1==i.G[n].length&&(e.addEventListener?e.addEventListener(n,i.ba,l):e.attachEvent&&e.attachEvent("on"+n,i.ba))},t.n=function(e,n,r){if(t.Ic(e)){var i=t.getData(e);if(i.G){if(t.i.isArray(n))return v(t.n,e,n,r);if(n){var s=i.G[n];if(s){if(r){if(r.s)for(i=0;i<s.length;i++)s[i].s===r.s&&s.splice(i--,1)}else i.G[n]=[];t.xc(e,n)}}else for(s in i.G)n=s,i.G[n]=[],t.xc(e,n)}}},t.xc=function(e,n){var r=t.getData(e);0===r.G[n].length&&(delete r.G[n],e.removeEventListener?e.removeEventListener(n,r.ba,l):e.detachEvent&&e.detachEvent("on"+n,r.ba)),t.hb(r.G)&&(delete r.G,delete r.ba,delete r.disabled),t.hb(r)&&t.Zc(e)},t.Nb=function(e){function t(){return f}function n(){return l}if(!e||!e.Sb){var r=e||window.event;e={};for(var i in r)"layerX"!==i&&"layerY"!==i&&"keyLocation"!==i&&("returnValue"==i&&r.preventDefault||(e[i]=r[i]));e.target||(e.target=e.srcElement||document),e.relatedTarget=e.fromElement===e.target?e.toElement:e.fromElement,e.preventDefault=function(){r.preventDefault&&r.preventDefault(),e.returnValue=l,e.ee=t,e.defaultPrevented=f},e.ee=n,e.defaultPrevented=l,e.stopPropagation=function(){r.stopPropagation&&r.stopPropagation(),e.cancelBubble=f,e.Sb=t},e.Sb=n,e.stopImmediatePropagation=function(){r.stopImmediatePropagation&&r.stopImmediatePropagation(),e.Nc=t,e.stopPropagation()},e.Nc=n;if(e.clientX!=j){i=document.documentElement;var s=document.body;e.pageX=e.clientX+(i&&i.scrollLeft||s&&s.scrollLeft||0)-(i&&i.clientLeft||s&&s.clientLeft||0),e.pageY=e.clientY+(i&&i.scrollTop||s&&s.scrollTop||0)-(i&&i.clientTop||s&&s.clientTop||0)}e.which=e.charCode||e.keyCode,e.button!=j&&(e.button=e.button&1?0:e.button&4?1:e.button&2?2:0)}return e},t.o=function(e,n){var r=t.Ic(e)?t.getData(e):{},i=e.parentNode||e.ownerDocument;return"string"==typeof n&&(n={type:n,target:e}),n=t.Nb(n),r.ba&&r.ba.call(e,n),i&&!n.Sb()&&n.bubbles!==l?t.o(i,n):!i&&!n.defaultPrevented&&(r=t.getData(n.target),n.target[n.type])&&(r.disabled=f,"function"==typeof n.target[n.type]&&n.target[n.type](),r.disabled=l),!n.defaultPrevented},t.N=function(e,n,r){function i(){t.n(e,n,i),r.apply(this,arguments)}if(t.i.isArray(n))return v(t.N,e,n,r);i.s=r.s=r.s||t.s++,t.b(e,n,i)};var w=Object.prototype.hasOwnProperty;t.e=function(e,n){var r;return n=n||{},r=document.createElement(e||"div"),t.i.ca(n,function(e,t){-1!==e.indexOf("aria-")||"role"==e?r.setAttribute(e,t):r[e]=t}),r},t.va=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},t.i={},t.i.create=Object.create||function(e){function t(){}return t.prototype=e,new t},t.i.ca=function(e,t,n){for(var r in e)w.call(e,r)&&t.call(n||this,r,e[r])},t.i.D=function(e,t){if(!t)return e;for(var n in t)w.call(t,n)&&(e[n]=t[n]);return e},t.i.Od=function(e,n){var r,i,s;e=t.i.copy(e);for(r in n)w.call(n,r)&&(i=e[r],s=n[r],e[r]=t.i.ib(i)&&t.i.ib(s)?t.i.Od(i,s):n[r]);return e},t.i.copy=function(e){return t.i.D({},e)},t.i.ib=function(e){return!!e&&"object"==typeof e&&"[object Object]"===e.toString()&&e.constructor===Object},t.i.isArray=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},t.ge=function(e){return e!==e},t.bind=function(e,n,r){function i(){return n.apply(e,arguments)}return n.s||(n.s=t.s++),i.s=r?r+"_"+n.s:n.s,i},t.ua={},t.s=1,t.expando="vdata"+(new Date).getTime(),t.getData=function(e){var n=e[t.expando];return n||(n=e[t.expando]=t.s++),t.ua[n]||(t.ua[n]={}),t.ua[n]},t.Ic=function(e){return e=e[t.expando],!!e&&!t.hb(t.ua[e])},t.Zc=function(e){var n=e[t.expando];if(n){delete t.ua[n];try{delete e[t.expando]}catch(r){e.removeAttribute?e.removeAttribute(t.expando):e[t.expando]=j}}},t.hb=function(e){for(var t in e)if(e[t]!==j)return l;return f},t.Pa=function(e,t){return-1!==(" "+e.className+" ").indexOf(" "+t+" ")},t.p=function(e,n){t.Pa(e,n)||(e.className=""===e.className?n:e.className+" "+n)},t.r=function(e,n){var r,i;if(t.Pa(e,n)){r=e.className.split(" ");for(i=r.length-1;0<=i;i--)r[i]===n&&r.splice(i,1);e.className=r.join(" ")}},t.A=t.e("video");var x=document.createElement("track");x.Tb="captions",x.ed="en",x.label="English",t.A.appendChild(x),t.P=navigator.userAgent,t.zd=/iPhone/i.test(t.P),t.yd=/iPad/i.test(t.P),t.Ad=/iPod/i.test(t.P),t.xd=t.zd||t.yd||t.Ad;var aa=t,y,z=t.P.match(/OS (\d+)_/i);y=z&&z[1]?z[1]:b,aa.ff=y,t.wd=/Android/i.test(t.P);var ba=t,B,C=t.P.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i),D,E;C?(D=C[1]&&parseFloat(C[1]),E=C[2]&&parseFloat(C[2]),B=D&&E?parseFloat(C[1]+"."+C[2]):D?D:j):B=j,ba.ec=B,t.Bd=t.wd&&/webkit/i.test(t.P)&&2.3>t.ec,t.gc=/Firefox/i.test(t.P),t.gf=/Chrome/i.test(t.P),t.pa=/MSIE\s8\.0/.test(t.P),t.Db=!!("ontouchstart"in window||window.ud&&document instanceof window.ud),t.td="backgroundSize"in t.A.style,t.ad=function(e,n){t.i.ca(n,function(t,n){n===j||"undefined"==typeof n||n===l?e.removeAttribute(t):e.setAttribute(t,n===f?"":n)})},t.Oa=function(e){var t,n,r,i;t={};if(e&&e.attributes&&0<e.attributes.length){n=e.attributes;for(var s=n.length-1;0<=s;s--){r=n[s].name,i=n[s].value;if("boolean"==typeof e[r]||-1!==",autoplay,controls,loop,muted,default,".indexOf(","+r+","))i=i!==j?f:l;t[r]=i}}return t},t.rf=function(e,t){var n="";return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(e,"").getPropertyValue(t):e.currentStyle&&(n=e["client"+t.substr(0,1).toUpperCase()+t.substr(1)]+"px"),n},t.Rb=function(e,t){t.firstChild?t.insertBefore(e,t.firstChild):t.appendChild(e)},t.bb={},t.m=function(e){return 0===e.indexOf("#")&&(e=e.slice(1)),document.getElementById(e)},t.Na=function(e,t){t=t||e;var n=Math.floor(e%60),r=Math.floor(e/60%60),i=Math.floor(e/3600),s=Math.floor(t/60%60),o=Math.floor(t/3600);if(isNaN(e)||Infinity===e)i=r=n="-";return i=0<i||0<o?i+":":"",i+(((i||10<=s)&&10>r?"0"+r:r)+":")+(10>n?"0"+n:n)},t.Id=function(){document.body.focus(),document.onselectstart=p(l)},t.Xe=function(){document.onselectstart=p(f)},t.trim=function(e){return(e+"").replace(/^\s+|\s+$/g,"")},t.round=function(e,t){return t||(t=0),Math.round(e*Math.pow(10,t))/Math.pow(10,t)},t.xa=function(e,t){return e===b&&t===b?{length:0,start:function(){throw Error("This TimeRanges object is empty")},end:function(){throw Error("This TimeRanges object is empty")}}:{length:1,start:function(){return e},end:function(){return t}}},t.Ie=function(e){try{var n=window.localStorage||l;n&&(n.volume=e)}catch(r){22==r.code||1014==r.code?t.log("LocalStorage Full (VideoJS)",r):18==r.code?t.log("LocalStorage not allowed (VideoJS)",r):t.log("LocalStorage Error (VideoJS)",r)}},t.Xd=function(e){return e.match(/^https?:\/\//)||(e=t.e("div",{innerHTML:'<a href="'+e+'">x</a>'}).firstChild.href),e},t.Ae=function(e){var n,r,i,s;s="protocol hostname port pathname search hash host".split(" "),r=t.e("a",{href:e});if(i=""===r.host&&"file:"!==r.protocol)n=t.e("div"),n.innerHTML='<a href="'+e+'"></a>',r=n.firstChild,n.setAttribute("style","display:none; position:absolute;"),document.body.appendChild(n);e={};for(var o=0;o<s.length;o++)e[s[o]]=r[s[o]];return"http:"===e.protocol&&(e.host=e.host.replace(/:80$/,"")),"https:"===e.protocol&&(e.host=e.host.replace(/:443$/,"")),i&&document.body.removeChild(n),e},t.log=function(){F(j,arguments)},t.log.history=[],t.log.error=function(){F("error",arguments)},t.log.warn=function(){F("warn",arguments)},t.Vd=function(e){var n,r;return e.getBoundingClientRect&&e.parentNode&&(n=e.getBoundingClientRect()),n?(e=document.documentElement,r=document.body,{left:t.round(n.left+(window.pageXOffset||r.scrollLeft)-(e.clientLeft||r.clientLeft||0)),top:t.round(n.top+(window.pageYOffset||r.scrollTop)-(e.clientTop||r.clientTop||0))}):{left:0,top:0}},t.tc={},t.tc.forEach=function(e,n,r){if(t.i.isArray(e)&&n instanceof Function)for(var i=0,s=e.length;i<s;++i)n.call(r||t,e[i],i,e);return e},t.bf=function(e,n){var r,i,s,o,u,a,l;"string"==typeof e&&(e={uri:e}),videojs.Z.Aa({method:"GET",timeout:45e3},e),n=n||m(),a=function(){window.clearTimeout(u),n(j,i,i.response||i.responseText)},l=function(e){window.clearTimeout(u);if(!e||"string"==typeof e)e=Error(e);n(e,i)},r=window.XMLHttpRequest,"undefined"==typeof r&&(r=function(){try{return new window.ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new window.ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(t){}try{return new window.ActiveXObject("Msxml2.XMLHTTP")}catch(n){}throw Error("This browser does not support XMLHttpRequest.")}),i=new r,i.uri=e.uri,r=t.Ae(e.uri),s=window.location,r.protocol+r.host===s.protocol+s.host||!window.XDomainRequest||"withCredentials"in i?(o="file:"==r.protocol||"file:"==s.protocol,i.onreadystatechange=function(){if(4===i.readyState){if(i.Ue)return l("timeout");200===i.status||o&&0===i.status?a():l()}},e.timeout&&(u=window.setTimeout(function(){4!==i.readyState&&(i.Ue=f,i.abort())},e.timeout))):(i=new window.XDomainRequest,i.onload=a,i.onerror=l,i.onprogress=m(),i.ontimeout=m());try{i.open(e.method||"GET",e.uri,f)}catch(c){l(c);return}e.withCredentials&&(i.withCredentials=f),e.responseType&&(i.responseType=e.responseType);try{i.send()}catch(h){l(h)}},t.Z={},t.Z.Aa=function(e,n){var r,i,s;e=t.i.copy(e);for(r in n)n.hasOwnProperty(r)&&(i=e[r],s=n[r],e[r]=t.i.ib(i)&&t.i.ib(s)?t.Z.Aa(i,s):n[r]);return e},t.z=m(),s=t.z.prototype,s.ab={},s.b=function(e,n){var r=this.addEventListener;this.addEventListener=Function.prototype,t.b(this,e,n),this.addEventListener=r},s.addEventListener=t.z.prototype.b,s.n=function(e,n){t.n(this,e,n)},s.removeEventListener=t.z.prototype.n,s.N=function(e,n){t.N(this,e,n)},s.o=function(e){var n=e.type||e;"string"==typeof e&&(e={type:n}),e=t.Nb(e),this.ab[n]&&this["on"+n]&&this["on"+n](e),t.o(this,e)},s.dispatchEvent=t.z.prototype.o,t.a=t.Ga.extend({l:function(e,n,r){this.d=e,this.q=t.i.copy(this.q),n=this.options(n),this.Qa=n.id||n.el&&n.el.id,this.Qa||(this.Qa=(e.id&&e.id()||"no_player")+"_component_"+t.s++),this.pe=n.name||j,this.c=n.el||this.e(),this.R=[],this.cb={},this.eb={},this.Kc(),this.I(r);if(n.$c!==l){var i,s;this.k().reportUserActivity&&(i=t.bind(this.k(),this.k().reportUserActivity),this.b("touchstart",function(){i(),this.clearInterval(s),s=this.setInterval(i,250)}),e=function(){i(),this.clearInterval(s)},this.b("touchmove",i),this.b("touchend",e),this.b("touchcancel",e))}}}),s=t.a.prototype,s.dispose=function(){this.o({type:"dispose",bubbles:l});if(this.R)for(var e=this.R.length-1;0<=e;e--)this.R[e].dispose&&this.R[e].dispose();this.eb=this.cb=this.R=j,this.n(),this.c.parentNode&&this.c.parentNode.removeChild(this.c),t.Zc(this.c),this.c=j},s.d=f,s.k=n("d"),s.options=function(e){return e===b?this.q:this.q=t.Z.Aa(this.q,e)},s.e=function(e,n){return t.e(e,n)},s.v=function(e){var t=this.d.language(),n=this.d.languages();return n&&n[t]&&n[t][e]?n[t][e]:e},s.m=n("c"),s.wa=function(){return this.B||this.c},s.id=n("Qa"),s.name=n("pe"),s.children=n("R"),s.Yd=function(e){return this.cb[e]},s.da=function(e){return this.eb[e]},s.aa=function(e,n){var r,i;return"string"==typeof e?(i=e,n=n||{},r=n.componentClass||t.va(i),n.name=i,r=new window.videojs[r](this.d||this,n)):r=e,this.R.push(r),"function"==typeof r.id&&(this.cb[r.id()]=r),(i=i||r.name&&r.name())&&(this.eb[i]=r),"function"==typeof r.el&&r.el()&&this.wa().appendChild(r.el()),r},s.removeChild=function(e){"string"==typeof e&&(e=this.da(e));if(e&&this.R){for(var t=l,n=this.R.length-1;0<=n;n--)if(this.R[n]===e){t=f,this.R.splice(n,1);break}t&&(this.cb[e.id()]=j,this.eb[e.name()]=j,(t=e.m())&&t.parentNode===this.wa()&&this.wa().removeChild(e.m()))}},s.Kc=function(){var e,n,r,i,s,o;e=this,n=e.options();if(r=n.children)if(o=function(t,r){n[t]!==b&&(r=n[t]),r!==l&&(e[t]=e.aa(t,r))},t.i.isArray(r))for(var u=0;u<r.length;u++)i=r[u],"string"==typeof i?(s=i,i={}):s=i.name,o(s,i);else t.i.ca(r,o)},s.T=p(""),s.b=function(e,n,r){var i,s,o;return"string"==typeof e||t.i.isArray(e)?t.b(this.c,e,t.bind(this,n)):(i=t.bind(this,r),o=this,s=function(){o.n(e,n,i)},s.s=i.s,this.b("dispose",s),r=function(){o.n("dispose",s)},r.s=i.s,e.nodeName?(t.b(e,n,i),t.b(e,"dispose",r)):"function"==typeof e.b&&(e.b(n,i),e.b("dispose",r))),this},s.n=function(e,n,r){return!e||"string"==typeof e||t.i.isArray(e)?t.n(this.c,e,n):(r=t.bind(this,r),this.n("dispose",r),e.nodeName?(t.n(e,n,r),t.n(e,"dispose",r)):(e.n(n,r),e.n("dispose",r))),this},s.N=function(e,n,r){var i,s,o;return"string"==typeof e||t.i.isArray(e)?t.N(this.c,e,t.bind(this,n)):(i=t.bind(this,r),s=this,o=function(){s.n(e,n,o),i.apply(this,arguments)},o.s=i.s,this.b(e,n,o)),this},s.o=function(e){return t.o(this.c,e),this},s.I=function(e){return e&&(this.ya?e.call(this):(this.mb===b&&(this.mb=[]),this.mb.push(e))),this},s.Va=function(){this.ya=f;var e=this.mb;this.mb=[];if(e&&0<e.length){for(var t=0,n=e.length;t<n;t++)e[t].call(this);this.o("ready")}},s.Pa=function(e){return t.Pa(this.c,e)},s.p=function(e){return t.p(this.c,e),this},s.r=function(e){return t.r(this.c,e),this},s.show=function(){return this.r("vjs-hidden"),this},s.W=function(){return this.p("vjs-hidden"),this},s.width=function(e,t){return ca(this,"width",e,t)},s.height=function(e,t){return ca(this,"height",e,t)},s.Qd=function(e,t){return this.width(e,f).height(t)},s.setTimeout=function(e,n){function r(){this.clearTimeout(i)}e=t.bind(this,e);var i=setTimeout(e,n);return r.s="vjs-timeout-"+i,this.b("dispose",r),i},s.clearTimeout=function(e){function t(){}return clearTimeout(e),t.s="vjs-timeout-"+e,this.n("dispose",t),e},s.setInterval=function(e,n){function r(){this.clearInterval(i)}e=t.bind(this,e);var i=setInterval(e,n);return r.s="vjs-interval-"+i,this.b("dispose",r),i},s.clearInterval=function(e){function t(){}return clearInterval(e),t.s="vjs-interval-"+e,this.n("dispose",t),e},t.w=t.a.extend({l:function(e,n){t.a.call(this,e,n),da(this),this.b("tap",this.u),this.b("click",this.u),this.b("focus",this.kb),this.b("blur",this.jb)}}),s=t.w.prototype,s.e=function(e,n){var r;return n=t.i.D({className:this.T(),role:"button","aria-live":"polite",tabIndex:0},n),r=t.a.prototype.e.call(this,e,n),n.innerHTML||(this.B=t.e("div",{className:"vjs-control-content"}),this.Ib=t.e("span",{className:"vjs-control-text",innerHTML:this.v(this.ta)||"Need Text"}),this.B.appendChild(this.Ib),r.appendChild(this.B)),r},s.T=function(){return"vjs-control "+t.a.prototype.T.call(this)},s.u=m(),s.kb=function(){t.b(document,"keydown",t.bind(this,this.ka))},s.ka=function(e){if(32==e.which||13==e.which)e.preventDefault(),this.u()},s.jb=function(){t.n(document,"keydown",t.bind(this,this.ka))},t.S=t.a.extend({l:function(e,n){t.a.call(this,e,n),this.Hd=this.da(this.q.barName),this.handle=this.da(this.q.handleName),this.b("mousedown",this.lb),this.b("touchstart",this.lb),this.b("focus",this.kb),this.b("blur",this.jb),this.b("click",this.u),this.b(e,"controlsvisible",this.update),this.b(e,this.Uc,this.update)}}),s=t.S.prototype,s.e=function(e,n){return n=n||{},n.className+=" vjs-slider",n=t.i.D({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},n),t.a.prototype.e.call(this,e,n)},s.lb=function(e){e.preventDefault(),t.Id(),this.p("vjs-sliding"),this.b(document,"mousemove",this.la),this.b(document,"mouseup",this.Ba),this.b(document,"touchmove",this.la),this.b(document,"touchend",this.Ba),this.la(e)},s.la=m(),s.Ba=function(){t.Xe(),this.r("vjs-sliding"),this.n(document,"mousemove",this.la),this.n(document,"mouseup",this.Ba),this.n(document,"touchmove",this.la),this.n(document,"touchend",this.Ba),this.update()},s.update=function(){if(this.c){var e,n=this.Qb(),r=this.handle,i=this.Hd;if("number"!=typeof n||n!==n||0>n||Infinity===n)n=0;e=n;if(r){e=this.c.offsetWidth;var s=r.m().offsetWidth;e=s?s/e:0,n*=1-e,e=n+e/2,r.m().style.left=t.round(100*n,2)+"%"}i&&(i.m().style.width=t.round(100*e,2)+"%")}},s.kb=function(){this.b(document,"keydown",this.ka)},s.ka=function(e){if(37==e.which||40==e.which)e.preventDefault(),this.fd();else if(38==e.which||39==e.which)e.preventDefault(),this.gd()},s.jb=function(){this.n(document,"keydown",this.ka)},s.u=function(e){e.stopImmediatePropagation(),e.preventDefault()},t.ga=t.a.extend(),t.ga.prototype.defaultValue=0,t.ga.prototype.e=function(e,n){return n=n||{},n.className+=" vjs-slider-handle",n=t.i.D({innerHTML:'<span class="vjs-control-text">'+this.defaultValue+"</span>"},n),t.a.prototype.e.call(this,"div",n)},t.qa=t.a.extend(),t.qa.prototype.e=function(){var e=this.options().zc||"ul";return this.B=t.e(e,{className:"vjs-menu-content"}),e=t.a.prototype.e.call(this,"div",{append:this.B,className:"vjs-menu"}),e.appendChild(this.B),t.b(e,"click",function(e){e.preventDefault(),e.stopImmediatePropagation()}),e},t.M=t.w.extend({l:function(e,n){t.w.call(this,e,n),this.selected(n.selected)}}),t.M.prototype.e=function(e,n){return t.w.prototype.e.call(this,"li",t.i.D({className:"vjs-menu-item",innerHTML:this.v(this.q.label)},n))},t.M.prototype.u=function(){this.selected(f)},t.M.prototype.selected=function(e){e?(this.p("vjs-selected"),this.c.setAttribute("aria-selected",f)):(this.r("vjs-selected"),this.c.setAttribute("aria-selected",l))},t.O=t.w.extend({l:function(e,n){t.w.call(this,e,n),this.update(),this.b("keydown",this.ka),this.c.setAttribute("aria-haspopup",f),this.c.setAttribute("role","button")}}),s=t.O.prototype,s.update=function(){var e=this.La();this.za&&this.removeChild(this.za),this.za=e,this.aa(e),this.H&&0===this.H.length?this.W():this.H&&1<this.H.length&&this.show()},s.Ja=l,s.La=function(){var e=new t.qa(this.d);this.options().title&&e.wa().appendChild(t.e("li",{className:"vjs-menu-title",innerHTML:t.va(this.options().title),Se:-1}));if(this.H=this.createItems())for(var n=0;n<this.H.length;n++)fa(e,this.H[n]);return e},s.Ka=m(),s.T=function(){return this.className+" vjs-menu-button "+t.w.prototype.T.call(this)},s.kb=m(),s.jb=m(),s.u=function(){this.N("mouseout",t.bind(this,function(){G(this.za),this.c.blur()})),this.Ja?H(this):ga(this)},s.ka=function(e){32==e.which||13==e.which?(this.Ja?H(this):ga(this),e.preventDefault()):27==e.which&&(this.Ja&&H(this),e.preventDefault())},t.J=function(e){"number"==typeof e?this.code=e:"string"==typeof e?this.message=e:"object"==typeof e&&t.i.D(this,e),this.message||(this.message=t.J.Pd[this.code]||"")},t.J.prototype.code=0,t.J.prototype.message="",t.J.prototype.status=j,t.J.gb="MEDIA_ERR_CUSTOM MEDIA_ERR_ABORTED MEDIA_ERR_NETWORK MEDIA_ERR_DECODE MEDIA_ERR_SRC_NOT_SUPPORTED MEDIA_ERR_ENCRYPTED".split(" "),t.J.Pd={1:"You aborted the video playback",2:"A network error caused the video download to fail part-way.",3:"The video playback was aborted due to a corruption problem or because the video used features your browser did not support.",4:"The video could not be loaded, either because the server or network failed or because the format is not supported.",5:"The video is encrypted and we do not have the keys to decrypt it."};for(var I=0;I<t.J.gb.length;I++)t.J[t.J.gb[I]]=I,t.J.prototype[t.J.gb[I]]=I;var J,ha,K,L;J=["requestFullscreen exitFullscreen fullscreenElement fullscreenEnabled fullscreenchange fullscreenerror".split(" "),"webkitRequestFullscreen webkitExitFullscreen webkitFullscreenElement webkitFullscreenEnabled webkitfullscreenchange webkitfullscreenerror".split(" "),"webkitRequestFullScreen webkitCancelFullScreen webkitCurrentFullScreenElement webkitCancelFullScreen webkitfullscreenchange webkitfullscreenerror".split(" "),"mozRequestFullScreen mozCancelFullScreen mozFullScreenElement mozFullScreenEnabled mozfullscreenchange mozfullscreenerror".split(" "),"msRequestFullscreen msExitFullscreen msFullscreenElement msFullscreenEnabled MSFullscreenChange MSFullscreenError".split(" ")],ha=J[0];for(L=0;L<J.length;L++)if(J[L][1]in document){K=J[L];break}if(K){t.bb.Pb={};for(L=0;L<K.length;L++)t.bb.Pb[ha[L]]=K[L]}t.Player=t.a.extend({l:function(e,n,r){this.L=e,e.id=e.id||"vjs_video_"+t.s++,this.Te=e&&t.Oa(e),n=t.i.D(ia(e),n),this.Pc=n.language||t.options.language,this.je=n.languages||t.options.languages,this.K={},this.Vc=n.poster||"",this.Jb=!!n.controls,e.controls=l,n.$c=l,ja(this,"audio"===this.L.nodeName.toLowerCase()),t.a.call(this,this,n,r),this.controls()?this.p("vjs-controls-enabled"):this.p("vjs-controls-disabled"),ja(this)&&this.p("vjs-audio"),t.Ca[this.Qa]=this,n.plugins&&t.i.ca(n.plugins,function(e,t){this[e](t)},this);var i,s,o,u,a;i=t.bind(this,this.reportUserActivity),this.b("mousedown",function(){i(),this.clearInterval(s),s=this.setInterval(i,250)}),this.b("mousemove",function(e){if(e.screenX!=u||e.screenY!=a)u=e.screenX,a=e.screenY,i()}),this.b("mouseup",function(){i(),this.clearInterval(s)}),this.b("keydown",i),this.b("keyup",i),this.setInterval(function(){if(this.Fa){this.Fa=l,this.userActive(f),this.clearTimeout(o);var e=this.options().inactivityTimeout;0<e&&(o=this.setTimeout(function(){this.Fa||this.userActive(l)},e))}},250)}}),s=t.Player.prototype,s.language=function(e){return e===b?this.Pc:(this.Pc=e,this)},s.languages=n("je"),s.q=t.options,s.dispose=function(){this.o("dispose"),this.n("dispose"),t.Ca[this.Qa]=j,this.L&&this.L.player&&(this.L.player=j),this.c&&this.c.player&&(this.c.player=j),this.h&&this.h.dispose(),t.a.prototype.dispose.call(this)},s.e=function(){var e=this.c=t.a.prototype.e.call(this,"div"),n=this.L,r;return n.removeAttribute("width"),n.removeAttribute("height"),r=t.Oa(n),t.i.ca(r,function(t){"class"==t?e.className=r[t]:e.setAttribute(t,r[t])}),n.id+="_html5_api",n.className="vjs-tech",n.player=e.player=this,this.p("vjs-paused"),this.width(this.q.width,f),this.height(this.q.height,f),n.ce=n.networkState,n.parentNode&&n.parentNode.insertBefore(e,n),t.Rb(n,e),this.c=e,this.b("loadstart",this.te),this.b("waiting",this.ze),this.b(["canplay","canplaythrough","playing","ended"],this.ye),this.b("seeking",this.we),this.b("seeked",this.ve),this.b("ended",this.qe),this.b("play",this.Xb),this.b("firstplay",this.re),this.b("pause",this.Wb),this.b("progress",this.ue),this.b("durationchange",this.Sc),this.b("fullscreenchange",this.se),e},s.te=function(){this.r("vjs-ended"),this.error(j),this.paused()?la(this,l):this.o("firstplay")},s.Jc=l,s.Xb=function(){this.r("vjs-ended"),this.r("vjs-paused"),this.p("vjs-playing"),la(this,f)},s.ze=function(){this.p("vjs-waiting")},s.ye=function(){this.r("vjs-waiting")},s.we=function(){this.p("vjs-seeking")},s.ve=function(){this.r("vjs-seeking")},s.re=function(){this.q.starttime&&this.currentTime(this.q.starttime),this.p("vjs-has-started")},s.Wb=function(){this.r("vjs-playing"),this.p("vjs-paused")},s.ue=function(){1==this.bufferedPercent()&&this.o("loadedalldata")},s.qe=function(){this.p("vjs-ended"),this.q.loop?(this.currentTime(0),this.play()):this.paused()||this.pause()},s.Sc=function(){var e=M(this,"duration");e&&(0>e&&(e=Infinity),this.duration(e),Infinity===e?this.p("vjs-live"):this.r("vjs-live"))},s.se=function(){this.isFullscreen()?this.p("vjs-fullscreen"):this.r("vjs-fullscreen")},s.play=function(){return N(this,"play"),this},s.pause=function(){return N(this,"pause"),this},s.paused=function(){return M(this,"paused")===l?l:f},s.currentTime=function(e){return e!==b?(N(this,"setCurrentTime",e),this):this.K.currentTime=M(this,"currentTime")||0},s.duration=function(e){return e!==b?(this.K.duration=parseFloat(e),this):(this.K.duration===b&&this.Sc(),this.K.duration||0)},s.remainingTime=function(){return this.duration()-this.currentTime()},s.buffered=function(){var e=M(this,"buffered");if(!e||!e.length)e=t.xa(0,0);return e},s.bufferedPercent=function(){var e=this.duration(),t=this.buffered(),n=0,r,i;if(!e)return 0;for(var s=0;s<t.length;s++)r=t.start(s),i=t.end(s),i>e&&(i=e),n+=i-r;return n/e},s.volume=function(e){return e!==b?(e=Math.max(0,Math.min(1,parseFloat(e))),this.K.volume=e,N(this,"setVolume",e),t.Ie(e),this):(e=parseFloat(M(this,"volume")),isNaN(e)?1:e)},s.muted=function(e){return e!==b?(N(this,"setMuted",e),this):M(this,"muted")||l},s.Sa=function(){return M(this,"supportsFullScreen")||l},s.Mc=l,s.isFullscreen=function(e){return e!==b?(this.Mc=!!e,this):this.Mc},s.isFullScreen=function(e){return t.log.warn('player.isFullScreen() has been deprecated, use player.isFullscreen() with a lowercase "s")'),this.isFullscreen(e)},s.requestFullscreen=function(){var e=t.bb.Pb;return this.isFullscreen(f),e?(t.b(document,e.fullscreenchange,t.bind(this,function(n){this.isFullscreen(document[e.fullscreenElement]),this.isFullscreen()===l&&t.n(document,e.fullscreenchange,arguments.callee),this.o("fullscreenchange")})),this.c[e.requestFullscreen]()):this.h.Sa()?N(this,"enterFullScreen"):(this.Fc(),this.o("fullscreenchange")),this},s.requestFullScreen=function(){return t.log.warn('player.requestFullScreen() has been deprecated, use player.requestFullscreen() with a lowercase "s")'),this.requestFullscreen()},s.exitFullscreen=function(){var e=t.bb.Pb;return this.isFullscreen(l),e?document[e.exitFullscreen]():this.h.Sa()?N(this,"exitFullScreen"):(this.Lb(),this.o("fullscreenchange")),this},s.cancelFullScreen=function(){return t.log.warn("player.cancelFullScreen() has been deprecated, use player.exitFullscreen()"),this.exitFullscreen()},s.Fc=function(){this.fe=f,this.Rd=document.documentElement.style.overflow,t.b(document,"keydown",t.bind(this,this.Gc)),document.documentElement.style.overflow="hidden",t.p(document.body,"vjs-full-window"),this.o("enterFullWindow")},s.Gc=function(e){27===e.keyCode&&(this.isFullscreen()===f?this.exitFullscreen():this.Lb())},s.Lb=function(){this.fe=l,t.n(document,"keydown",this.Gc),document.documentElement.style.overflow=this.Rd,t.r(document.body,"vjs-full-window"),this.o("exitFullWindow")},s.selectSource=function(e){for(var n=0,r=this.q.techOrder;n<r.length;n++){var i=t.va(r[n]),s=window.videojs[i];if(s){if(s.isSupported())for(var o=0,u=e;o<u.length;o++){var a=u[o];if(s.canPlaySource(a))return{source:a,h:i}}}else t.log.error('The "'+i+'" tech is undefined. Skipped browser support check for that tech.')}return l},s.src=function(e){return e===b?M(this,"src"):(t.i.isArray(e)?ma(this,e):"string"==typeof e?this.src({src:e}):e instanceof Object&&(e.type&&!window.videojs[this.Ta].canPlaySource(e)?ma(this,[e]):(this.K.src=e.src,this.Cc=e.type||"",this.I(function(){window.videojs[this.Ta].prototype.hasOwnProperty("setSource")?N(this,"setSource",e):N(this,"src",e.src),"auto"==this.q.preload&&this.load(),this.q.autoplay&&this.play()}))),this)},s.load=function(){return N(this,"load"),this},s.currentSrc=function(){return M(this,"currentSrc")||this.K.src||""},s.Nd=function(){return this.Cc||""},s.Ra=function(e){return e!==b?(N(this,"setPreload",e),this.q.preload=e,this):M(this,"preload")},s.autoplay=function(e){return e!==b?(N(this,"setAutoplay",e),this.q.autoplay=e,this):M(this,"autoplay")},s.loop=function(e){return e!==b?(N(this,"setLoop",e),this.q.loop=e,this):M(this,"loop")},s.poster=function(e){return e===b?this.Vc:(e||(e=""),this.Vc=e,N(this,"setPoster",e),this.o("posterchange"),this)},s.controls=function(e){return e!==b?(e=!!e,this.Jb!==e&&((this.Jb=e)?(this.r("vjs-controls-disabled"),this.p("vjs-controls-enabled"),this.o("controlsenabled")):(this.r("vjs-controls-enabled"),this.p("vjs-controls-disabled"),this.o("controlsdisabled"))),this):this.Jb},t.Player.prototype.bc,s=t.Player.prototype,s.usingNativeControls=function(e){return e!==b?(e=!!e,this.bc!==e&&((this.bc=e)?(this.p("vjs-using-native-controls"),this.o("usingnativecontrols")):(this.r("vjs-using-native-controls"),this.o("usingcustomcontrols"))),this):this.bc},s.ja=j,s.error=function(e){return e===b?this.ja:e===j?(this.ja=e,this.r("vjs-error"),this):(this.ja=e instanceof t.J?e:new t.J(e),this.o("error"),this.p("vjs-error"),t.log.error("(CODE:"+this.ja.code+" "+t.J.gb[this.ja.code]+")",this.ja.message,this.ja),this)},s.ended=function(){return M(this,"ended")},s.seeking=function(){return M(this,"seeking")},s.seekable=function(){return M(this,"seekable")},s.Fa=f,s.reportUserActivity=function(){this.Fa=f},s.ac=f,s.userActive=function(e){return e!==b?(e=!!e,e!==this.ac&&((this.ac=e)?(this.Fa=f,this.r("vjs-user-inactive"),this.p("vjs-user-active"),this.o("useractive")):(this.Fa=l,this.h&&this.h.N("mousemove",function(e){e.stopPropagation(),e.preventDefault()}),this.r("vjs-user-active"),this.p("vjs-user-inactive"),this.o("userinactive"))),this):this.ac},s.playbackRate=function(e){return e!==b?(N(this,"setPlaybackRate",e),this):this.h&&this.h.featuresPlaybackRate?M(this,"playbackRate"):1},s.Lc=l,s.networkState=function(){return M(this,"networkState")},s.readyState=function(){return M(this,"readyState")},s.textTracks=function(){return this.h&&this.h.textTracks()},s.X=function(){return this.h&&this.h.remoteTextTracks()},s.addTextTrack=function(e,t,n){return this.h&&this.h.addTextTrack(e,t,n)},s.ha=function(e){return this.h&&this.h.addRemoteTextTrack(e)},s.Da=function(e){this.h&&this.h.removeRemoteTextTrack(e)},t.tb=t.a.extend(),t.tb.prototype.q={sf:"play",children:{playToggle:{},currentTimeDisplay:{},timeDivider:{},durationDisplay:{},remainingTimeDisplay:{},liveDisplay:{},progressControl:{},fullscreenToggle:{},volumeControl:{},muteToggle:{},playbackRateMenuButton:{},subtitlesButton:{},captionsButton:{},chaptersButton:{}}},t.tb.prototype.e=function(){return t.e("div",{className:"vjs-control-bar"})},t.hc=t.a.extend({l:function(e,n){t.a.call(this,e,n)}}),t.hc.prototype.e=function(){var e=t.a.prototype.e.call(this,"div",{className:"vjs-live-controls vjs-control"});return this.B=t.e("div",{className:"vjs-live-display",innerHTML:'<span class="vjs-control-text">'+this.v("Stream Type")+"</span>"+this.v("LIVE"),"aria-live":"off"}),e.appendChild(this.B),e},t.kc=t.w.extend({l:function(e,n){t.w.call(this,e,n),this.b(e,"play",this.Xb),this.b(e,"pause",this.Wb)}}),s=t.kc.prototype,s.ta="Play",s.T=function(){return"vjs-play-control "+t.w.prototype.T.call(this)},s.u=function(){this.d.paused()?this.d.play():this.d.pause()},s.Xb=function(){this.r("vjs-paused"),this.p("vjs-playing"),this.c.children[0].children[0].innerHTML=this.v("Pause")},s.Wb=function(){this.r("vjs-playing"),this.p("vjs-paused"),this.c.children[0].children[0].innerHTML=this.v("Play")},t.ub=t.a.extend({l:function(e,n){t.a.call(this,e,n),this.b(e,"timeupdate",this.fa)}}),t.ub.prototype.e=function(){var e=t.a.prototype.e.call(this,"div",{className:"vjs-current-time vjs-time-controls vjs-control"});return this.B=t.e("div",{className:"vjs-current-time-display",innerHTML:'<span class="vjs-control-text">Current Time </span>0:00',"aria-live":"off"}),e.appendChild(this.B),e},t.ub.prototype.fa=function(){var e=this.d.nb?this.d.K.currentTime:this.d.currentTime();this.B.innerHTML='<span class="vjs-control-text">'+this.v("Current Time")+"</span> "+t.Na(e,this.d.duration())},t.vb=t.a.extend({l:function(e,n){t.a.call(this,e,n),this.b(e,"timeupdate",this.fa),this.b(e,"loadedmetadata",this.fa)}}),t.vb.prototype.e=function(){var e=t.a.prototype.e.call(this,"div",{className:"vjs-duration vjs-time-controls vjs-control"});return this.B=t.e("div",{className:"vjs-duration-display",innerHTML:'<span class="vjs-control-text">'+this.v("Duration Time")+"</span> 0:00","aria-live":"off"}),e.appendChild(this.B),e},t.vb.prototype.fa=function(){var e=this.d.duration();e&&(this.B.innerHTML='<span class="vjs-control-text">'+this.v("Duration Time")+"</span> "+t.Na(e))},t.qc=t.a.extend({l:function(e,n){t.a.call(this,e,n)}}),t.qc.prototype.e=function(){return t.a.prototype.e.call(this,"div",{className:"vjs-time-divider",innerHTML:"<div><span>/</span></div>"})},t.Cb=t.a.extend({l:function(e,n){t.a.call(this,e,n),this.b(e,"timeupdate",this.fa)}}),t.Cb.prototype.e=function(){var e=t.a.prototype.e.call(this,"div",{className:"vjs-remaining-time vjs-time-controls vjs-control"});return this.B=t.e("div",{className:"vjs-remaining-time-display",innerHTML:'<span class="vjs-control-text">'+this.v("Remaining Time")+"</span> -0:00","aria-live":"off"}),e.appendChild(this.B),e},t.Cb.prototype.fa=function(){this.d.duration()&&(this.B.innerHTML='<span class="vjs-control-text">'+this.v("Remaining Time")+"</span> -"+t.Na(this.d.remainingTime()))},t.Ya=t.w.extend({l:function(e,n){t.w.call(this,e,n)}}),t.Ya.prototype.ta="Fullscreen",t.Ya.prototype.T=function(){return"vjs-fullscreen-control "+t.w.prototype.T.call(this)},t.Ya.prototype.u=function(){this.d.isFullscreen()?(this.d.exitFullscreen(),this.Ib.innerHTML=this.v("Fullscreen")):(this.d.requestFullscreen(),this.Ib.innerHTML=this.v("Non-Fullscreen"))},t.Bb=t.a.extend({l:function(e,n){t.a.call(this,e,n)}}),t.Bb.prototype.q={children:{seekBar:{}}},t.Bb.prototype.e=function(){return t.a.prototype.e.call(this,"div",{className:"vjs-progress-control vjs-control"})},t.nc=t.S.extend({l:function(e,n){t.S.call(this,e,n),this.b(e,"timeupdate",this.Ea),e.I(t.bind(this,this.Ea))}}),s=t.nc.prototype,s.q={children:{loadProgressBar:{},playProgressBar:{},seekHandle:{}},barName:"playProgressBar",handleName:"seekHandle"},s.Uc="timeupdate",s.e=function(){return t.S.prototype.e.call(this,"div",{className:"vjs-progress-holder","aria-label":"video progress bar"})},s.Ea=function(){var e=this.d.nb?this.d.K.currentTime:this.d.currentTime();this.c.setAttribute("aria-valuenow",t.round(100*this.Qb(),2)),this.c.setAttribute("aria-valuetext",t.Na(e,this.d.duration()))},s.Qb=function(){return this.d.currentTime()/this.d.duration()},s.lb=function(e){t.S.prototype.lb.call(this,e),this.d.nb=f,this.d.p("vjs-scrubbing"),this.$e=!this.d.paused(),this.d.pause()},s.la=function(e){e=ea(this,e)*this.d.duration(),e==this.d.duration()&&(e-=.1),this.d.currentTime(e)},s.Ba=function(e){t.S.prototype.Ba.call(this,e),this.d.nb=l,this.d.r("vjs-scrubbing"),this.$e&&this.d.play()},s.gd=function(){this.d.currentTime(this.d.currentTime()+5)},s.fd=function(){this.d.currentTime(this.d.currentTime()-5)},t.yb=t.a.extend({l:function(e,n){t.a.call(this,e,n),this.b(e,"progress",this.update)}}),t.yb.prototype.e=function(){return t.a.prototype.e.call(this,"div",{className:"vjs-load-progress",innerHTML:'<span class="vjs-control-text"><span>'+this.v("Loaded")+"</span>: 0%</span>"})},t.yb.prototype.update=function(){var e,n,r,i,s=this.d.buffered();e=this.d.duration();var o,u=this.d;o=u.buffered(),u=u.duration(),o=o.end(o.length-1),o>u&&(o=u),u=this.c.children,this.c.style.width=100*(o/e||0)+"%";for(e=0;e<s.length;e++)n=s.start(e),r=s.end(e),(i=u[e])||(i=this.c.appendChild(t.e())),i.style.left=100*(n/o||0)+"%",i.style.width=100*((r-n)/o||0)+"%";for(e=u.length;e>s.length;e--)this.c.removeChild(u[e-1])},t.jc=t.a.extend({l:function(e,n){t.a.call(this,e,n)}}),t.jc.prototype.e=function(){return t.a.prototype.e.call(this,"div",{className:"vjs-play-progress",innerHTML:'<span class="vjs-control-text"><span>'+this.v("Progress")+"</span>: 0%</span>"})},t.Za=t.ga.extend({l:function(e,n){t.ga.call(this,e,n),this.b(e,"timeupdate",this.fa)}}),t.Za.prototype.defaultValue="00:00",t.Za.prototype.e=function(){return t.ga.prototype.e.call(this,"div",{className:"vjs-seek-handle","aria-live":"off"})},t.Za.prototype.fa=function(){var e=this.d.nb?this.d.K.currentTime:this.d.currentTime();this.c.innerHTML='<span class="vjs-control-text">'+t.Na(e,this.d.duration())+"</span>"},t.Fb=t.a.extend({l:function(e,n){t.a.call(this,e,n),e.h&&e.h.featuresVolumeControl===l&&this.p("vjs-hidden"),this.b(e,"loadstart",function(){e.h.featuresVolumeControl===l?this.p("vjs-hidden"):this.r("vjs-hidden")})}}),t.Fb.prototype.q={children:{volumeBar:{}}},t.Fb.prototype.e=function(){return t.a.prototype.e.call(this,"div",{className:"vjs-volume-control vjs-control"})},t.Eb=t.S.extend({l:function(e,n){t.S.call(this,e,n),this.b(e,"volumechange",this.Ea),e.I(t.bind(this,this.Ea))}}),s=t.Eb.prototype,s.Ea=function(){this.c.setAttribute("aria-valuenow",t.round(100*this.d.volume(),2)),this.c.setAttribute("aria-valuetext",t.round(100*this.d.volume(),2)+"%")},s.q={children:{volumeLevel:{},volumeHandle:{}},barName:"volumeLevel",handleName:"volumeHandle"},s.Uc="volumechange",s.e=function(){return t.S.prototype.e.call(this,"div",{className:"vjs-volume-bar","aria-label":"volume level"})},s.la=function(e){this.d.muted()&&this.d.muted(l),this.d.volume(ea(this,e))},s.Qb=function(){return this.d.muted()?0:this.d.volume()},s.gd=function(){this.d.volume(this.d.volume()+.1)},s.fd=function(){this.d.volume(this.d.volume()-.1)},t.rc=t.a.extend({l:function(e,n){t.a.call(this,e,n)}}),t.rc.prototype.e=function(){return t.a.prototype.e.call(this,"div",{className:"vjs-volume-level",innerHTML:'<span class="vjs-control-text"></span>'})},t.Gb=t.ga.extend(),t.Gb.prototype.defaultValue="00:00",t.Gb.prototype.e=function(){return t.ga.prototype.e.call(this,"div",{className:"vjs-volume-handle"})},t.ra=t.w.extend({l:function(e,n){t.w.call(this,e,n),this.b(e,"volumechange",this.update),e.h&&e.h.featuresVolumeControl===l&&this.p("vjs-hidden"),this.b(e,"loadstart",function(){e.h.featuresVolumeControl===l?this.p("vjs-hidden"):this.r("vjs-hidden")})}}),t.ra.prototype.e=function(){return t.w.prototype.e.call(this,"div",{className:"vjs-mute-control vjs-control",innerHTML:'<div><span class="vjs-control-text">'+this.v("Mute")+"</span></div>"})},t.ra.prototype.u=function(){this.d.muted(this.d.muted()?l:f)},t.ra.prototype.update=function(){var e=this.d.volume(),n=3;0===e||this.d.muted()?n=0:.33>e?n=1:.67>e&&(n=2),this.d.muted()?this.c.children[0].children[0].innerHTML!=this.v("Unmute")&&(this.c.children[0].children[0].innerHTML=this.v("Unmute")):this.c.children[0].children[0].innerHTML!=this.v("Mute")&&(this.c.children[0].children[0].innerHTML=this.v("Mute"));for(e=0;4>e;e++)t.r(this.c,"vjs-vol-"+e);t.p(this.c,"vjs-vol-"+n)},t.Ha=t.O.extend({l:function(e,n){t.O.call(this,e,n),this.b(e,"volumechange",this.af),e.h&&e.h.featuresVolumeControl===l&&this.p("vjs-hidden"),this.b(e,"loadstart",function(){e.h.featuresVolumeControl===l?this.p("vjs-hidden"):this.r("vjs-hidden")}),this.p("vjs-menu-button")}}),t.Ha.prototype.La=function(){var e=new t.qa(this.d,{zc:"div"}),n=new t.Eb(this.d,this.q.volumeBar);return n.b("focus",function(){e.p("vjs-lock-showing")}),n.b("blur",function(){G(e)}),e.aa(n),e},t.Ha.prototype.u=function(){t.ra.prototype.u.call(this),t.O.prototype.u.call(this)},t.Ha.prototype.e=function(){return t.w.prototype.e.call(this,"div",{className:"vjs-volume-menu-button vjs-menu-button vjs-control",innerHTML:'<div><span class="vjs-control-text">'+this.v("Mute")+"</span></div>"})},t.Ha.prototype.af=t.ra.prototype.update,t.lc=t.O.extend({l:function(e,n){t.O.call(this,e,n),this.pd(),this.od(),this.b(e,"loadstart",this.pd),this.b(e,"ratechange",this.od)}}),s=t.lc.prototype,s.ta="Playback Rate",s.className="vjs-playback-rate",s.e=function(){var e=t.O.prototype.e.call(this);return this.Oc=t.e("div",{className:"vjs-playback-rate-value",innerHTML:1}),e.appendChild(this.Oc),e},s.La=function(){var e=new t.qa(this.k()),n=this.k().options().playbackRates;if(n)for(var r=n.length-1;0<=r;r--)e.aa(new t.Ab(this.k(),{rate:n[r]+"x"}));return e},s.Ea=function(){this.m().setAttribute("aria-valuenow",this.k().playbackRate())},s.u=function(){for(var e=this.k().playbackRate(),t=this.k().options().playbackRates,n=t[0],r=0;r<t.length;r++)if(t[r]>e){n=t[r];break}this.k().playbackRate(n)},s.pd=function(){na(this)?this.r("vjs-hidden"):this.p("vjs-hidden")},s.od=function(){na(this)&&(this.Oc.innerHTML=this.k().playbackRate()+"x")},t.Ab=t.M.extend({zc:"button",l:function(e,n){var r=this.label=n.rate,i=this.Wc=parseFloat(r,10);n.label=r,n.selected=1===i,t.M.call(this,e,n),this.b(e,"ratechange",this.update)}}),t.Ab.prototype.u=function(){t.M.prototype.u.call(this),this.k().playbackRate(this.Wc)},t.Ab.prototype.update=function(){this.selected(this.k().playbackRate()==this.Wc)},t.mc=t.w.extend({l:function(e,n){t.w.call(this,e,n),this.update(),e.b("posterchange",t.bind(this,this.update))}}),s=t.mc.prototype,s.dispose=function(){this.k().n("posterchange",this.update),t.w.prototype.dispose.call(this)},s.e=function(){var e=t.e("div",{className:"vjs-poster",tabIndex:-1});return t.td||(this.Mb=t.e("img"),e.appendChild(this.Mb)),e},s.update=function(){var e=this.k().poster();this.na(e),e?this.show():this.W()},s.na=function(e){var t;this.Mb?this.Mb.src=e:(t="",e&&(t='url("'+e+'")'),this.c.style.backgroundImage=t)},s.u=function(){this.d.play()},t.ic=t.a.extend({l:function(e,n){t.a.call(this,e,n)}}),t.ic.prototype.e=function(){return t.a.prototype.e.call(this,"div",{className:"vjs-loading-spinner"})},t.rb=t.w.extend(),t.rb.prototype.e=function(){return t.w.prototype.e.call(this,"div",{className:"vjs-big-play-button",innerHTML:'<span aria-hidden="true"></span>',"aria-label":"play video"})},t.rb.prototype.u=function(){this.d.play()},t.wb=t.a.extend({l:function(e,n){t.a.call(this,e,n),this.update(),this.b(e,"error",this.update)}}),t.wb.prototype.e=function(){var e=t.a.prototype.e.call(this,"div",{className:"vjs-error-display"});return this.B=t.e("div"),e.appendChild(this.B),e},t.wb.prototype.update=function(){this.k().error()&&(this.B.innerHTML=this.v(this.k().error().message))};var O;t.j=t.a.extend({l:function(e,n,r){n=n||{},n.$c=l,t.a.call(this,e,n,r),this.featuresProgressEvents||this.ne(),this.featuresTimeupdateEvents||this.oe(),this.be(),this.featuresNativeTextTracks||this.Sd(),this.de()}}),s=t.j.prototype,s.be=function(){var e,t;e=this.k(),t=function(){e.controls()&&!e.usingNativeControls()&&this.Fd()},this.I(t),this.b(e,"controlsenabled",t),this.b(e,"controlsdisabled",this.De),this.I(function(){this.networkState&&0<this.networkState()&&this.k().o("loadstart")})},s.Fd=function(){var e;this.b("mousedown",this.u),this.b("touchstart",function(){e=this.d.userActive()}),this.b("touchmove",function(){e&&this.k().reportUserActivity()}),this.b("touchend",function(e){e.preventDefault()}),da(this),this.b("tap",this.xe)},s.De=function(){this.n("tap"),this.n("touchstart"),this.n("touchmove"),this.n("touchleave"),this.n("touchcancel"),this.n("touchend"),this.n("click"),this.n("mousedown")},s.u=function(e){0===e.button&&this.k().controls()&&(this.k().paused()?this.k().play():this.k().pause())},s.xe=function(){this.k().userActive(!this.k().userActive())},s.ne=function(){this.Qc=f,this.We()},s.me=function(){this.Qc=l,this.hd()},s.We=function(){this.Ce=this.setInterval(function(){var e=this.k().bufferedPercent();this.Jd!=e&&this.k().o("progress"),this.Jd=e,1===e&&this.hd()},500)},s.hd=function(){this.clearInterval(this.Ce)},s.oe=function(){var e=this.d;this.Vb=f,this.b(e,"play",this.md),this.b(e,"pause",this.qb),this.N("timeupdate",function(){this.featuresTimeupdateEvents=f,this.Rc()})},s.Rc=function(){var e=this.d;this.Vb=l,this.qb(),this.n(e,"play",this.md),this.n(e,"pause",this.qb)},s.md=function(){this.Bc&&this.qb(),this.Bc=this.setInterval(function(){this.k().o("timeupdate")},250)},s.qb=function(){this.clearInterval(this.Bc),this.k().o("timeupdate")},s.dispose=function(){this.Qc&&this.me(),this.Vb&&this.Rc(),t.a.prototype.dispose.call(this)},s.Zb=function(){this.Vb&&this.k().o("timeupdate")},s.de=function(){function e(){var e=n.da("textTrackDisplay");e&&e.C()}var n=this.d,r;if(r=this.textTracks())r.addEventListener("removetrack",e),r.addEventListener("addtrack",e),this.b("dispose",t.bind(this,function(){r.removeEventListener("removetrack",e),r.removeEventListener("addtrack",e)}))},s.Sd=function(){var e=this.d,n,r,i;window.WebVTT||(i=document.createElement("script"),i.src=e.options()["vtt.js"]||"../node_modules/vtt.js/dist/vtt.js",e.m().appendChild(i),window.WebVTT=f);if(r=this.textTracks())n=function(){var n,r,i;i=e.da("textTrackDisplay"),i.C();for(n=0;n<this.length;n++)r=this[n],r.removeEventListener("cuechange",t.bind(i,i.C)),"showing"===r.mode&&r.addEventListener("cuechange",t.bind(i,i.C))},r.addEventListener("change",n),this.b("dispose",t.bind(this,function(){r.removeEventListener("change",n)}))},s.textTracks=function(){return this.d.ld=this.d.ld||new t.F,this.d.ld},s.X=function(){return this.d.Xc=this.d.Xc||new t.F,this.d.Xc},O=function(e,n,r,i,s){var o=e.textTracks();return s=s||{},s.kind=n,r&&(s.label=r),i&&(s.language=i),s.player=e.d,e=new t.t(s),P(o,e),e},t.j.prototype.addTextTrack=function(e,t,n){if(!e)throw Error("TextTrack kind is required but was not provided");return O(this,e,t,n)},t.j.prototype.ha=function(e){return e=O(this,e.kind,e.label,e.language,e),P(this.X(),e),{Y:e}},t.j.prototype.Da=function(e){Q(this.textTracks(),e),Q(this.X(),e)},t.j.prototype.bd=m(),t.j.prototype.featuresVolumeControl=f,t.j.prototype.featuresFullscreenResize=l,t.j.prototype.featuresPlaybackRate=l,t.j.prototype.featuresProgressEvents=l,t.j.prototype.featuresTimeupdateEvents=l,t.j.prototype.featuresNativeTextTracks=l,t.j.dc=function(e){e.registerSourceHandler=function(t,n){var r=e.cd;r||(r=e.cd=[]),n===b&&(n=r.length),r.splice(n,0,t)},e.ob=function(t){for(var n=e.cd||[],r,i=0;i<n.length;i++)if(r=n[i].canHandleSource(t))return n[i];return j},e.wc=function(t){var n=e.ob(t);return n?n.canHandleSource(t):""},e.prototype.ma=function(n){var r=e.ob(n);return r||(e.nativeSourceHandler?r=e.nativeSourceHandler:t.log.error("No source hander found for the current source.")),this.ia(),this.n("dispose",this.ia),this.fb=n,this.$b=r.handleSource(n,this),this.b("dispose",this.ia),this},e.prototype.ia=function(){this.$b&&this.$b.dispose&&this.$b.dispose()}},t.media={},t.f=t.j.extend({l:function(e,n,r){var i,s,o;if(n.nativeCaptions===l||n.nativeTextTracks===l)this.featuresNativeTextTracks=l;t.j.call(this,e,n,r);for(r=t.f.xb.length-1;0<=r;r--)this.b(t.f.xb[r],this.Td);(n=n.source)&&(this.c.currentSrc!==n.src||e.L&&3===e.L.ce)&&this.ma(n);if(this.c.hasChildNodes()){r=this.c.childNodes,i=r.length;for(n=[];i--;)s=r[i],o=s.nodeName.toLowerCase(),"track"===o&&(this.featuresNativeTextTracks?P(this.X(),s.track):n.push(s));for(r=0;r<n.length;r++)this.c.removeChild(n[r])}if(t.Db&&e.options().nativeControlsForTouch===f){var u,a,c,h;u=this,a=this.k(),n=a.controls(),u.c.controls=!!n,c=function(){u.c.controls=f},h=function(){u.c.controls=l},a.b("controlsenabled",c),a.b("controlsdisabled",h),n=function(){a.n("controlsenabled",c),a.n("controlsdisabled",h)},u.b("dispose",n),a.b("usingcustomcontrols",n),a.usingNativeControls(f)}e.I(function(){this.src()&&this.L&&this.q.autoplay&&this.paused()&&(delete this.L.poster,this.play())}),this.Va()}}),s=t.f.prototype,s.dispose=function(){t.f.Kb(this.c),t.j.prototype.dispose.call(this)},s.e=function(){var e=this.d,n,r,i,s=e.L;if(!s||this.movingMediaElementInDOM===l){s?(i=s.cloneNode(l),t.f.Kb(s),s=i,e.L=j):(s=t.e("video"),i=videojs.Z.Aa({},e.Te),(!t.Db||e.options().nativeControlsForTouch!==f)&&delete i.controls,t.ad(s,t.i.D(i,{id:e.id()+"_html5_api","class":"vjs-tech"}))),s.player=e;if(e.q.nd)for(i=0;i<e.q.nd.length;i++)n=e.q.nd[i],r=document.createElement("track"),r.Tb=n.Tb,r.label=n.label,r.ed=n.ed,r.src=n.src,"default"in n&&r.setAttribute("default","default"),s.appendChild(r);t.Rb(s,e.m())}n=["autoplay","preload","loop","muted"];for(i=n.length-1;0<=i;i--){r=n[i];var o={};"undefined"!=typeof e.q[r]&&(o[r]=e.q[r]),t.ad(s,o)}return s},s.Td=function(e){"error"==e.type&&this.error()?this.k().error(this.error().code):(e.bubbles=l,this.k().o(e))},s.play=function(){this.c.play()},s.pause=function(){this.c.pause()},s.paused=function(){return this.c.paused},s.currentTime=function(){return this.c.currentTime},s.Zb=function(e){try{this.c.currentTime=e}catch(n){t.log(n,"Video is not ready. (Video.js)")}},s.duration=function(){return this.c.duration||0},s.buffered=function(){return this.c.buffered},s.volume=function(){return this.c.volume},s.Oe=function(e){this.c.volume=e},s.muted=function(){return this.c.muted},s.Ke=function(e){this.c.muted=e},s.width=function(){return this.c.offsetWidth},s.height=function(){return this.c.offsetHeight},s.Sa=function(){return"function"==typeof this.c.webkitEnterFullScreen&&(/Android/.test(t.P)||!/Chrome|Mac OS X 10.5/.test(t.P))?f:l},s.Ec=function(){var e=this.c;"webkitDisplayingFullscreen"in e&&this.N("webkitbeginfullscreen",function(){this.d.isFullscreen(f),this.N("webkitendfullscreen",function(){this.d.isFullscreen(l),this.d.o("fullscreenchange")}),this.d.o("fullscreenchange")}),e.paused&&e.networkState<=e.ef?(this.c.play(),this.setTimeout(function(){e.pause(),e.webkitEnterFullScreen()},0)):e.webkitEnterFullScreen()},s.Ud=function(){this.c.webkitExitFullScreen()},s.src=function(e){var t=this.c.src;if(e===b)return oa(t,this.dd);this.na(e)},s.na=function(e){this.c.src=e},s.load=function(){this.c.load()},s.currentSrc=function(){var e=this.c.currentSrc;return this.fb?oa(e,this.fb.src):e},s.poster=function(){return this.c.poster},s.bd=function(e){this.c.poster=e},s.Ra=function(){return this.c.Ra},s.Me=function(e){this.c.Ra=e},s.autoplay=function(){return this.c.autoplay},s.He=function(e){this.c.autoplay=e},s.controls=function(){return this.c.controls},s.loop=function(){return this.c.loop},s.Je=function(e){this.c.loop=e},s.error=function(){return this.c.error},s.seeking=function(){return this.c.seeking},s.seekable=function(){return this.c.seekable},s.ended=function(){return this.c.ended},s.playbackRate=function(){return this.c.playbackRate},s.Le=function(e){this.c.playbackRate=e},s.networkState=function(){return this.c.networkState},s.readyState=function(){return this.c.readyState},s.textTracks=function(){return this.featuresNativeTextTracks?this.c.textTracks:t.j.prototype.textTracks.call(this)},s.addTextTrack=function(e,n,r){return this.featuresNativeTextTracks?this.c.addTextTrack(e,n,r):t.j.prototype.addTextTrack.call(this,e,n,r)},s.ha=function(e){if(!this.featuresNativeTextTracks)return t.j.prototype.ha.call(this,e);var n=document.createElement("track");e=e||{},e.kind&&(n.kind=e.kind),e.label&&(n.label=e.label);if(e.language||e.srclang)n.srclang=e.language||e.srclang;return e["default"]&&(n["default"]=e["default"]),e.id&&(n.id=e.id),e.src&&(n.src=e.src),this.m().appendChild(n),P(this.X(),n.Y),n},s.Da=function(e){if(!this.featuresNativeTextTracks)return t.j.prototype.Da.call(this,e);var n,r;Q(this.X(),e),n=this.m().querySelectorAll("track");for(r=0;r<n.length;r++)if(n[r]===e||n[r].track===e){n[r].parentNode.removeChild(n[r]);break}},t.f.isSupported=function(){try{t.A.volume=.5}catch(e){return l}return!!t.A.canPlayType},t.j.dc(t.f);var pa=t.f.prototype.ma,qa=t.f.prototype.ia;t.f.prototype.ma=function(e){var t=pa.call(this,e);return this.dd=e.src,t},t.f.prototype.ia=function(){return this.dd=b,qa.call(this)},t.f.nativeSourceHandler={},t.f.nativeSourceHandler.canHandleSource=function(e){function n(e){try{return t.A.canPlayType(e)}catch(n){return""}}return e.type?n(e.type):e.src?(e=(e=e.src.match(/\.([^.\/\?]+)(\?[^\/]+)?$/i))&&e[1],n("video/"+e)):""},t.f.nativeSourceHandler.handleSource=function(e,t){t.na(e.src)},t.f.nativeSourceHandler.dispose=m(),t.f.registerSourceHandler(t.f.nativeSourceHandler),t.f.Ld=function(){var e=t.A.volume;return t.A.volume=e/2+.1,e!==t.A.volume},t.f.Kd=function(){var e=t.A.playbackRate;return t.A.playbackRate=e/2+.1,e!==t.A.playbackRate},t.f.Re=function(){var e;return(e=!!t.A.textTracks)&&0<t.A.textTracks.length&&(e="number"!=typeof t.A.textTracks[0].mode),e&&t.gc&&(e=l),e},t.f.prototype.featuresVolumeControl=t.f.Ld(),t.f.prototype.featuresPlaybackRate=t.f.Kd(),t.f.prototype.movingMediaElementInDOM=!t.xd,t.f.prototype.featuresFullscreenResize=f,t.f.prototype.featuresProgressEvents=f,t.f.prototype.featuresNativeTextTracks=t.f.Re();var S,ra=/^application\/(?:x-|vnd\.apple\.)mpegurl/i,sa=/^video\/mp4/i;t.f.Tc=function(){4<=t.ec&&(S||(S=t.A.constructor.prototype.canPlayType),t.A.constructor.prototype.canPlayType=function(e){return e&&ra.test(e)?"maybe":S.call(this,e)}),t.Bd&&(S||(S=t.A.constructor.prototype.canPlayType),t.A.constructor.prototype.canPlayType=function(e){return e&&sa.test(e)?"maybe":S.call(this,e)})},t.f.Ye=function(){var e=t.A.constructor.prototype.canPlayType;return t.A.constructor.prototype.canPlayType=S,S=j,e},t.f.Tc(),t.f.xb="loadstart suspend abort error emptied stalled loadedmetadata loadeddata canplay canplaythrough playing waiting seeking seeked ended durationchange timeupdate progress play pause ratechange volumechange".split(" "),t.f.Kb=function(e){if(e){e.player=j;for(e.parentNode&&e.parentNode.removeChild(e);e.hasChildNodes();)e.removeChild(e.firstChild);e.removeAttribute("src");if("function"==typeof e.load)try{e.load()}catch(t){}}},t.g=t.j.extend({l:function(e,n,r){t.j.call(this,e,n,r);var i=n.source;r=e.id()+"_flash_api";var s=e.q,s=t.i.D({readyFunction:"videojs.Flash.onReady",eventProxyFunction:"videojs.Flash.onEvent",errorEventProxyFunction:"videojs.Flash.onError",autoplay:s.autoplay,preload:s.Ra,loop:s.loop,muted:s.muted},n.flashVars),o=t.i.D({wmode:"opaque",bgcolor:"#000000"},n.params);r=t.i.D({id:r,name:r,"class":"vjs-tech"},n.attributes),i&&this.I(function(){this.ma(i)}),t.Rb(this.c,n.parentEl),n.startTime&&this.I(function(){this.load(),this.play(),this.currentTime(n.startTime)}),t.gc&&this.I(function(){this.b("mousemove",function(){this.k().o({type:"mousemove",bubbles:l})})}),e.b("stageclick",e.reportUserActivity),this.c=t.g.Dc(n.swf,this.c,s,o,r)}}),s=t.g.prototype,s.dispose=function(){t.j.prototype.dispose.call(this)},s.play=function(){this.ended()&&this.setCurrentTime(0),this.c.vjs_play()},s.pause=function(){this.c.vjs_pause()},s.src=function(e){return e===b?this.currentSrc():this.na(e)},s.na=function(e){e=t.Xd(e),this.c.vjs_src(e);if(this.d.autoplay()){var n=this;this.setTimeout(function(){n.play()},0)}},t.g.prototype.setCurrentTime=function(e){this.ke=e,this.c.vjs_setProperty("currentTime",e),t.j.prototype.Zb.call(this)},t.g.prototype.currentTime=function(){return this.seeking()?this.ke||0:this.c.vjs_getProperty("currentTime")},t.g.prototype.currentSrc=function(){return this.fb?this.fb.src:this.c.vjs_getProperty("currentSrc")},t.g.prototype.load=function(){this.c.vjs_load()},t.g.prototype.poster=function(){this.c.vjs_getProperty("poster")},t.g.prototype.setPoster=m(),s=t.g.prototype,s.seekable=function(){return 0===this.duration()?t.xa():t.xa(0,this.duration())},s.buffered=function(){return this.c.vjs_getProperty?t.xa(0,this.c.vjs_getProperty("buffered")):t.xa()},s.duration=function(){return this.c.vjs_getProperty?this.c.vjs_getProperty("duration"):0},s.Sa=p(l),s.Ec=p(l);var ua=t.g.prototype,T="rtmpConnection rtmpStream preload defaultPlaybackRate playbackRate autoplay loop mediaGroup controller controls volume muted defaultMuted".split(" "),wa="error networkState readyState seeking initialTime startOffsetTime paused played ended videoTracks audioTracks videoWidth videoHeight".split(" "),U;for(U=0;U<T.length;U++)va(T[U]),ta();for(U=0;U<wa.length;U++)va(wa[U]);t.g.isSupported=function(){return 10<=t.g.version()[0]},t.j.dc(t.g),t.g.nativeSourceHandler={},t.g.nativeSourceHandler.canHandleSource=function(e){return e.type?e.type.replace(/;.*/,"").toLowerCase()in t.g.Wd?"maybe":"":""},t.g.nativeSourceHandler.handleSource=function(e,t){t.na(e.src)},t.g.nativeSourceHandler.dispose=m(),t.g.registerSourceHandler(t.g.nativeSourceHandler),t.g.Wd={"video/flv":"FLV","video/x-flv":"FLV","video/mp4":"MP4","video/m4v":"MP4"},t.g.onReady=function(e){var n;if(n=(e=t.m(e))&&e.parentNode&&e.parentNode.player)e.player=n,t.g.checkReady(n.h)},t.g.checkReady=function(e){e.m()&&(e.m().vjs_getProperty?e.Va():this.setTimeout(function(){t.g.checkReady(e)},50))},t.g.onEvent=function(e,n){t.m(e).player.o(n)},t.g.onError=function(e,n){var r=t.m(e).player,i="FLASH: "+n;"srcnotfound"==n?r.error({code:4,message:i}):r.error(i)},t.g.version=function(){var e="0,0,0";try{e=(new window.ActiveXObject("ShockwaveFlash.ShockwaveFlash")).GetVariable("$version").replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}catch(t){try{navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin&&(e=(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]).description.replace(/\D+/g,",").match(/^,?(.+),?$/)[1])}catch(n){}}return e.split(",")},t.g.Dc=function(e,n,r,i,s){e=t.g.$d(e,r,i,s),e=t.e("div",{innerHTML:e}).childNodes[0],r=n.parentNode,n.parentNode.replaceChild(e,n),e[t.expando]=n[t.expando];var o=r.childNodes[0];return setTimeout(function(){o.style.display="block"},1e3),e},t.g.$d=function(e,n,r,i){var s="",o="",u="";return n&&t.i.ca(n,function(e,t){s+=e+"="+t+"&amp;"}),r=t.i.D({movie:e,flashvars:s,allowScriptAccess:"always",allowNetworking:"all"},r),t.i.ca(r,function(e,t){o+='<param name="'+e+'" value="'+t+'" />'}),i=t.i.D({data:e,width:"100%",height:"100%"},i),t.i.ca(i,function(e,t){u+=e+'="'+t+'" '}),'<object type="application/x-shockwave-flash" '+u+">"+o+"</object>"},t.g.Qe={"rtmp/mp4":"MP4","rtmp/flv":"FLV"},t.g.Df=function(e,t){return e+"&"+t},t.g.Pe=function(e){var t={yc:"",jd:""};if(!e)return t;var n=e.indexOf("&"),r;return-1!==n?r=n+1:(n=r=e.lastIndexOf("/")+1,0===n&&(n=r=e.length)),t.yc=e.substring(0,n),t.jd=e.substring(r,e.length),t},t.g.ie=function(e){return e in t.g.Qe},t.g.Dd=/^rtmp[set]?:\/\//i,t.g.he=function(e){return t.g.Dd.test(e)},t.g.Yb={},t.g.Yb.canHandleSource=function(e){return t.g.ie(e.type)||t.g.he(e.src)?"maybe":""},t.g.Yb.handleSource=function(e,n){var r=t.g.Pe(e.src);n.setRtmpConnection(r.yc),n.setRtmpStream(r.jd)},t.g.registerSourceHandler(t.g.Yb),t.Cd=t.a.extend({l:function(e,n,r){t.a.call(this,e,n,r);if(!e.q.sources||0===e.q.sources.length){n=0;for(r=e.q.techOrder;n<r.length;n++){var i=t.va(r[n]),s=window.videojs[i];if(s&&s.isSupported()){ka(e,i);break}}}else e.src(e.q.sources)}}),t.oc={disabled:"disabled",hidden:"hidden",showing:"showing"},t.Ed={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},t.t=function(e){var n,r,i,s,o,u,a,c,h,p,d;e=e||{};if(!e.player)throw Error("A player was not provided.");n=this;if(t.pa)for(d in n=document.createElement("custom"),t.t.prototype)n[d]=t.t.prototype[d];n.d=e.player,i=t.oc[e.mode]||"disabled",s=t.Ed[e.kind]||"subtitles",o=e.label||"",u=e.language||e.srclang||"",r=e.id||"vjs_text_track_"+t.s++;if("metadata"===s||"chapters"===s)i="hidden";n.V=[],n.Ia=[],a=new t.U(n.V),c=new t.U(n.Ia),p=l,h=t.bind(n,function(){this.activeCues,p&&(this.trigger("cuechange"),p=l)}),"disabled"!==i&&n.d.b("timeupdate",h),Object.defineProperty(n,"kind",{get:function(){return s},set:Function.prototype}),Object.defineProperty(n,"label",{get:function(){return o},set:Function.prototype}),Object.defineProperty(n,"language",{get:function(){return u},set:Function.prototype}),Object.defineProperty(n,"id",{get:function(){return r},set:Function.prototype}),Object.defineProperty(n,"mode",{get:function(){return i},set:function(e){t.oc[e]&&(i=e,"showing"===i&&this.d.b("timeupdate",h),this.o("modechange"))}}),Object.defineProperty(n,"cues",{get:function(){return this.Ub?a:j},set:Function.prototype}),Object.defineProperty(n,"activeCues",{get:function(){var e,t,n,r,i;if(!this.Ub)return j;if(0===this.cues.length)return c;r=this.d.currentTime(),e=0,t=this.cues.length;for(n=[];e<t;e++)i=this.cues[e],i.startTime<=r&&i.endTime>=r?n.push(i):i.startTime===i.endTime&&i.startTime<=r&&i.startTime+.5>=r&&n.push(i);p=l;if(n.length!==this.Ia.length)p=f;else for(e=0;e<n.length;e++)-1===xa.call(this.Ia,n[e])&&(p=f);return this.Ia=n,c.pb(this.Ia),c},set:Function.prototype}),e.src?ya(e.src,n):n.Ub=f;if(t.pa)return n},t.t.prototype=t.i.create(t.z.prototype),t.t.prototype.constructor=t.t,t.t.prototype.ab={cuechange:"cuechange"},t.t.prototype.sc=function(e){var t=this.d.textTracks(),n=0;if(t)for(;n<t.length;n++)t[n]!==this&&t[n].Yc(e);this.V.push(e),this.cues.pb(this.V)},t.t.prototype.Yc=function(e){for(var t=0,n=this.V.length,r,i=l;t<n;t++)r=this.V[t],r===e&&(this.V.splice(t,1),i=f);i&&this.Ac.pb(this.V)};var ya,V,xa;ya=function(e,n){t.bf(e,t.bind(this,function(e,r,i){if(e)return t.log.error(e);n.Ub=f,V(i,n)}))},V=function(e,n){if("function"!=typeof window.WebVTT)window.setTimeout(function(){V(e,n)},25);else{var r=new window.WebVTT.Parser(window,window.vttjs,window.WebVTT.StringDecoder());r.oncue=function(e){n.sc(e)},r.onparsingerror=function(e){t.log.error(e)},r.parse(e),r.flush()}},xa=function(e,t){var n;if(this==j)throw new TypeError('"this" is null or not defined');var r=Object(this),i=r.length>>>0;if(0===i)return-1;n=+t||0,Infinity===Math.abs(n)&&(n=0);if(n>=i)return-1;for(n=Math.max(0<=n?n:i-Math.abs(n),0);n<i;){if(n in r&&r[n]===e)return n;n++}return-1},t.F=function(e){var n=this,r,i=0;if(t.pa)for(r in n=document.createElement("custom"),t.F.prototype)n[r]=t.F.prototype[r];e=e||[],n.Ua=[];for(Object.defineProperty(n,"length",{get:function(){return this.Ua.length}});i<e.length;i++)P(n,e[i]);if(t.pa)return n},t.F.prototype=t.i.create(t.z.prototype),t.F.prototype.constructor=t.F,t.F.prototype.ab={change:"change",addtrack:"addtrack",removetrack:"removetrack"};for(var za in t.F.prototype.ab)t.F.prototype["on"+za]=j;t.F.prototype.ae=function(e){for(var t=0,n=this.length,r=j,i;t<n;t++)if(i=this[t],i.id===e){r=i;break}return r},t.U=function(e){var r=this,i;if(t.pa)for(i in r=document.createElement("custom"),t.U.prototype)r[i]=t.U.prototype[i];t.U.prototype.pb.call(r,e),Object.defineProperty(r,"length",{get:n("le")});if(t.pa)return r},t.U.prototype.pb=function(e){var t=this.length||0,n=0,r=e.length;this.V=e,this.le=e.length,e=function(e){""+e in this||Object.defineProperty(this,""+e,{get:function(){return this.V[e]}})};if(t<r)for(n=t;n<r;n++)e.call(this,n)},t.U.prototype.Zd=function(e){for(var t=0,n=this.length,r=j,i;t<n;t++)if(i=this[t],i.id===e){r=i;break}return r},t.sa=t.a.extend({l:function(e,n,r){t.a.call(this,e,n,r),e.b("loadstart",t.bind(this,this.Ve)),e.I(t.bind(this,function(){if(e.h&&e.h.featuresNativeTextTracks)this.W();else{var n,r,i;e.b("fullscreenchange",t.bind(this,this.C)),r=e.q.tracks||[];for(n=0;n<r.length;n++)i=r[n],this.d.ha(i)}}))}}),t.sa.prototype.Ve=function(){this.d.h&&this.d.h.featuresNativeTextTracks?this.W():this.show()},t.sa.prototype.e=function(){return t.a.prototype.e.call(this,"div",{className:"vjs-text-track-display"})},t.sa.prototype.Md=function(){"function"==typeof window.WebVTT&&window.WebVTT.processCues(window,[],this.c)};var Aa={tf:"monospace",zf:"sans-serif",Bf:"serif",uf:'"Andale Mono", "Lucida Console", monospace',vf:'"Courier New", monospace',xf:"sans-serif",yf:"serif",kf:'"Comic Sans MS", Impact, fantasy',Af:'"Monotype Corsiva", cursive',Cf:'"Andale Mono", "Lucida Console", monospace, sans-serif'};t.sa.prototype.C=function(){var e=this.d.textTracks(),t=0,n;this.Md();if(e)for(;t<e.length;t++)n=e[t],"showing"===n.mode&&this.Ze(n)},t.sa.prototype.Ze=function(e){if("function"==typeof window.WebVTT&&e.activeCues){for(var t=0,n=this.d.textTrackSettings.Hc(),r,i=[];t<e.activeCues.length;t++)i.push(e.activeCues[t]);window.WebVTT.processCues(window,e.activeCues,this.c);for(t=i.length;t--;){e=i[t].lf,n.color&&(e.firstChild.style.color=n.color);if(n.kd)try{e.firstChild.style.color=W(n.color||"#fff",n.kd)}catch(s){}n.backgroundColor&&(e.firstChild.style.backgroundColor=n.backgroundColor);if(n.vc)try{e.firstChild.style.backgroundColor=W(n.backgroundColor||"#000",n.vc)}catch(o){}if(n.cc)if(n.rd)try{e.style.backgroundColor=W(n.cc,n.rd)}catch(u){}else e.style.backgroundColor=n.cc;n.Ma&&("dropshadow"===n.Ma?e.firstChild.style.textShadow="2px 2px 3px #222, 2px 2px 4px #222, 2px 2px 5px #222":"raised"===n.Ma?e.firstChild.style.textShadow="1px 1px #222, 2px 2px #222, 3px 3px #222":"depressed"===n.Ma?e.firstChild.style.textShadow="1px 1px #ccc, 0 1px #ccc, -1px -1px #222, 0 -1px #222":"uniform"===n.Ma&&(e.firstChild.style.textShadow="0 0 4px #222, 0 0 4px #222, 0 0 4px #222, 0 0 4px #222")),n.Ob&&1!==n.Ob&&(r=window.wf(e.style.fontSize),e.style.fontSize=r*n.Ob+"px",e.style.height="auto",e.style.top="auto",e.style.bottom="2px"),n.fontFamily&&"default"!==n.fontFamily&&("small-caps"===n.fontFamily?e.firstChild.style.fontVariant="small-caps":e.firstChild.style.fontFamily=Aa[n.fontFamily])}}},t.$=t.M.extend({l:function(e,n){var r=this.Y=n.track,i=e.textTracks(),s,o;i&&(s=t.bind(this,function(){var e="showing"===this.Y.mode,n,r,s;if(this instanceof t.zb){e=f,r=0;for(s=i.length;r<s;r++)if(n=i[r],n.kind===this.Y.kind&&"showing"===n.mode){e=l;break}}this.selected(e)}),i.addEventListener("change",s),e.b("dispose",function(){i.removeEventListener("change",s)})),n.label=r.label||r.language||"Unknown",n.selected=r["default"]||"showing"===r.mode,t.M.call(this,e,n),i&&i.onchange===b&&this.b(["tap","click"],function(){if("object"!=typeof window.vd)try{o=new window.vd("change")}catch(e){}o||(o=document.createEvent("Event"),o.initEvent("change",f,f)),i.dispatchEvent(o)})}}),t.$.prototype.u=function(){var e=this.Y.kind,n=this.d.textTracks(),r,i=0;t.M.prototype.u.call(this);if(n)for(;i<n.length;i++)r=n[i],r.kind===e&&(r.mode=r===this.Y?"showing":"disabled")},t.zb=t.$.extend({l:function(e,n){n.track={kind:n.kind,player:e,label:n.kind+" off","default":l,mode:"disabled"},t.$.call(this,e,n),this.selected(f)}}),t.sb=t.$.extend({l:function(e,n){n.track={kind:n.kind,player:e,label:n.kind+" settings","default":l,mode:"disabled"},t.$.call(this,e,n),this.p("vjs-texttrack-settings")}}),t.sb.prototype.u=function(){this.k().da("textTrackSettings").show()},t.Q=t.O.extend({l:function(e,n){var r,i;t.O.call(this,e,n),r=this.d.textTracks(),1>=this.H.length&&this.W(),r&&(i=t.bind(this,this.update),r.addEventListener("removetrack",i),r.addEventListener("addtrack",i),this.d.b("dispose",function(){r.removeEventListener("removetrack",i),r.removeEventListener("addtrack",i)}))}}),t.Q.prototype.Ka=function(){var e=[],n,r;this instanceof t.oa&&(!this.k().h||!this.k().h.featuresNativeTextTracks)&&e.push(new t.sb(this.d,{kind:this.ea})),e.push(new t.zb(this.d,{kind:this.ea})),r=this.d.textTracks();if(!r)return e;for(var i=0;i<r.length;i++)n=r[i],n.kind===this.ea&&e.push(new t.$(this.d,{track:n}));return e},t.oa=t.Q.extend({l:function(e,n,r){t.Q.call(this,e,n,r),this.c.setAttribute("aria-label","Captions Menu")}}),t.oa.prototype.ea="captions",t.oa.prototype.ta="Captions",t.oa.prototype.className="vjs-captions-button",t.oa.prototype.update=function(){var e=2;t.Q.prototype.update.call(this),this.k().h&&this.k().h.featuresNativeTextTracks&&(e=1),this.H&&this.H.length>e?this.show():this.W()},t.$a=t.Q.extend({l:function(e,n,r){t.Q.call(this,e,n,r),this.c.setAttribute("aria-label","Subtitles Menu")}}),t.$a.prototype.ea="subtitles",t.$a.prototype.ta="Subtitles",t.$a.prototype.className="vjs-subtitles-button",t.Wa=t.Q.extend({l:function(e,n,r){t.Q.call(this,e,n,r),this.c.setAttribute("aria-label","Chapters Menu")}}),s=t.Wa.prototype,s.ea="chapters",s.ta="Chapters",s.className="vjs-chapters-button",s.Ka=function(){var e=[],n,r;r=this.d.textTracks();if(!r)return e;for(var i=0;i<r.length;i++)n=r[i],n.kind===this.ea&&e.push(new t.$(this.d,{track:n}));return e},s.La=function(){for(var e=this.d.textTracks()||[],n=0,r=e.length,i,s,o=this.H=[];n<r;n++)if(i=e[n],i.kind==this.ea){if(i.Ac){s=i;break}i.mode="hidden",window.setTimeout(t.bind(this,function(){this.La()}),100)}e=this.za,e===b&&(e=new t.qa(this.d),e.wa().appendChild(t.e("li",{className:"vjs-menu-title",innerHTML:t.va(this.ea),Se:-1})));if(s){i=s.cues;for(var u,n=0,r=i.length;n<r;n++)u=i[n],u=new t.Xa(this.d,{track:s,cue:u}),o.push(u),e.aa(u);this.aa(e)}return 0<this.H.length&&this.show(),e},t.Xa=t.M.extend({l:function(e,n){var r=this.Y=n.track,i=this.cue=n.cue,s=e.currentTime();n.label=i.text,n.selected=i.startTime<=s&&s<i.endTime,t.M.call(this,e,n),r.addEventListener("cuechange",t.bind(this,this.update))}}),t.Xa.prototype.u=function(){t.M.prototype.u.call(this),this.d.currentTime(this.cue.startTime),this.update(this.cue.startTime)},t.Xa.prototype.update=function(){var e=this.cue,t=this.d.currentTime();this.selected(e.startTime<=t&&t<e.endTime)},t.pc=t.a.extend({l:function(e,n){t.a.call(this,e,n),this.W(),t.b(this.m().querySelector(".vjs-done-button"),"click",t.bind(this,function(){this.Fe(),this.W()})),t.b(this.m().querySelector(".vjs-default-button"),"click",t.bind(this,function(){this.m().querySelector(".vjs-fg-color > select").selectedIndex=0,this.m().querySelector(".vjs-bg-color > select").selectedIndex=0,this.m().querySelector(".window-color > select").selectedIndex=0,this.m().querySelector(".vjs-text-opacity > select").selectedIndex=0,this.m().querySelector(".vjs-bg-opacity > select").selectedIndex=0,this.m().querySelector(".vjs-window-opacity > select").selectedIndex=0,this.m().querySelector(".vjs-edge-style select").selectedIndex=0,this.m().querySelector(".vjs-font-family select").selectedIndex=0,this.m().querySelector(".vjs-font-percent select").selectedIndex=2,this.C()})),t.b(this.m().querySelector(".vjs-fg-color > select"),"change",t.bind(this,this.C)),t.b(this.m().querySelector(".vjs-bg-color > select"),"change",t.bind(this,this.C)),t.b(this.m().querySelector(".window-color > select"),"change",t.bind(this,this.C)),t.b(this.m().querySelector(".vjs-text-opacity > select"),"change",t.bind(this,this.C)),t.b(this.m().querySelector(".vjs-bg-opacity > select"),"change",t.bind(this,this.C)),t.b(this.m().querySelector(".vjs-window-opacity > select"),"change",t.bind(this,this.C)),t.b(this.m().querySelector(".vjs-font-percent select"),"change",t.bind(this,this.C)),t.b(this.m().querySelector(".vjs-edge-style select"),"change",t.bind(this,this.C)),t.b(this.m().querySelector(".vjs-font-family select"),"change",t.bind(this,this.C)),e.options().persistTextTrackSettings&&this.Ee()}}),s=t.pc.prototype,s.e=function(){return t.a.prototype.e.call(this,"div",{className:"vjs-caption-settings vjs-modal-overlay",innerHTML:'<div class="vjs-tracksettings"><div class="vjs-tracksettings-colors"><div class="vjs-fg-color vjs-tracksetting"><label class="vjs-label">Foreground</label><select><option value="">---</option><option value="#FFF">White</option><option value="#000">Black</option><option value="#F00">Red</option><option value="#0F0">Green</option><option value="#00F">Blue</option><option value="#FF0">Yellow</option><option value="#F0F">Magenta</option><option value="#0FF">Cyan</option></select><span class="vjs-text-opacity vjs-opacity"><select><option value="">---</option><option value="1">Opaque</option><option value="0.5">Semi-Opaque</option></select></span></div><div class="vjs-bg-color vjs-tracksetting"><label class="vjs-label">Background</label><select><option value="">---</option><option value="#FFF">White</option><option value="#000">Black</option><option value="#F00">Red</option><option value="#0F0">Green</option><option value="#00F">Blue</option><option value="#FF0">Yellow</option><option value="#F0F">Magenta</option><option value="#0FF">Cyan</option></select><span class="vjs-bg-opacity vjs-opacity"><select><option value="">---</option><option value="1">Opaque</option><option value="0.5">Semi-Transparent</option><option value="0">Transparent</option></select></span></div><div class="window-color vjs-tracksetting"><label class="vjs-label">Window</label><select><option value="">---</option><option value="#FFF">White</option><option value="#000">Black</option><option value="#F00">Red</option><option value="#0F0">Green</option><option value="#00F">Blue</option><option value="#FF0">Yellow</option><option value="#F0F">Magenta</option><option value="#0FF">Cyan</option></select><span class="vjs-window-opacity vjs-opacity"><select><option value="">---</option><option value="1">Opaque</option><option value="0.5">Semi-Transparent</option><option value="0">Transparent</option></select></span></div></div><div class="vjs-tracksettings-font"><div class="vjs-font-percent vjs-tracksetting"><label class="vjs-label">Font Size</label><select><option value="0.50">50%</option><option value="0.75">75%</option><option value="1.00" selected>100%</option><option value="1.25">125%</option><option value="1.50">150%</option><option value="1.75">175%</option><option value="2.00">200%</option><option value="3.00">300%</option><option value="4.00">400%</option></select></div><div class="vjs-edge-style vjs-tracksetting"><label class="vjs-label">Text Edge Style</label><select><option value="none">None</option><option value="raised">Raised</option><option value="depressed">Depressed</option><option value="uniform">Uniform</option><option value="dropshadow">Dropshadow</option></select></div><div class="vjs-font-family vjs-tracksetting"><label class="vjs-label">Font Family</label><select><option value="">Default</option><option value="monospaceSerif">Monospace Serif</option><option value="proportionalSerif">Proportional Serif</option><option value="monospaceSansSerif">Monospace Sans-Serif</option><option value="proportionalSansSerif">Proportional Sans-Serif</option><option value="casual">Casual</option><option value="script">Script</option><option value="small-caps">Small Caps</option></select></div></div></div><div class="vjs-tracksettings-controls"><button class="vjs-default-button">Defaults</button><button class="vjs-done-button">Done</button></div>'})},s.Hc=function(){var e,t,n,r,i,s,o,u,a,f;e=this.m(),i=X(e.querySelector(".vjs-edge-style select")),s=X(e.querySelector(".vjs-font-family select")),o=X(e.querySelector(".vjs-fg-color > select")),n=X(e.querySelector(".vjs-text-opacity > select")),u=X(e.querySelector(".vjs-bg-color > select")),t=X(e.querySelector(".vjs-bg-opacity > select")),a=X(e.querySelector(".window-color > select")),r=X(e.querySelector(".vjs-window-opacity > select")),e=window.parseFloat(X(e.querySelector(".vjs-font-percent > select"))),t={backgroundOpacity:t,textOpacity:n,windowOpacity:r,edgeStyle:i,fontFamily:s,color:o,backgroundColor:u,windowColor:a,fontPercent:e};for(f in t)(""===t[f]||"none"===t[f]||"fontPercent"===f&&1===t[f])&&delete t[f];return t},s.Ne=function(e){var t=this.m();Y(t.querySelector(".vjs-edge-style select"),e.Ma),Y(t.querySelector(".vjs-font-family select"),e.fontFamily),Y(t.querySelector(".vjs-fg-color > select"),e.color),Y(t.querySelector(".vjs-text-opacity > select"),e.kd),Y(t.querySelector(".vjs-bg-color > select"),e.backgroundColor),Y(t.querySelector(".vjs-bg-opacity > select"),e.vc),Y(t.querySelector(".window-color > select"),e.cc),Y(t.querySelector(".vjs-window-opacity > select"),e.rd),(e=e.Ob)&&(e=e.toFixed(2)),Y(t.querySelector(".vjs-font-percent > select"),e)},s.Ee=function(){var e;try{e=JSON.parse(window.localStorage.getItem("vjs-text-track-settings"))}catch(t){}e&&this.Ne(e)},s.Fe=function(){var e;if(this.d.options().persistTextTrackSettings){e=this.Hc();try{t.hb(e)?window.localStorage.removeItem("vjs-text-track-settings"):window.localStorage.setItem("vjs-text-track-settings",JSON.stringify(e))}catch(n){}}},s.C=function(){var e=this.d.da("textTrackDisplay");e&&e.C()};if("undefined"!=typeof window.JSON&&"function"==typeof window.JSON.parse)t.JSON=window.JSON;else{t.JSON={};var Z=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;t.JSON.parse=function(a,c){function d(e,t){var n,r,i=e[t];if(i&&"object"==typeof i)for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r=d(i,n),r!==b?i[n]=r:delete i[n]);return c.call(e,t,i)}var e;a=String(a),Z.lastIndex=0,Z.test(a)&&(a=a.replace(Z,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return e=eval("("+a+")"),"function"==typeof c?d({"":e},""):e;throw new SyntaxError("JSON.parse(): invalid or malformed JSON data")}}t.uc=function(){var e,n,r,i;e=document.getElementsByTagName("video"),n=document.getElementsByTagName("audio");var s=[];if(e&&0<e.length){r=0;for(i=e.length;r<i;r++)s.push(e[r])}if(n&&0<n.length){r=0;for(i=n.length;r<i;r++)s.push(n[r])}if(s&&0<s.length){r=0;for(i=s.length;r<i;r++){if(!(n=s[r])||!n.getAttribute){t.Hb();break}n.player===b&&(e=n.getAttribute("data-setup"),e!==j&&videojs(n))}}else t.qd||t.Hb()},t.Hb=function(){setTimeout(t.uc,1)},"complete"===document.readyState?t.qd=f:t.N(window,"load",function(){t.qd=f}),t.Hb(),t.Be=function(e,n){t.Player.prototype[e]=n};var Ba=this;$("videojs",t),$("_V_",t),$("videojs.options",t.options),$("videojs.players",t.Ca),$("videojs.TOUCH_ENABLED",t.Db),$("videojs.cache",t.ua),$("videojs.Component",t.a),t.a.prototype.player=t.a.prototype.k,t.a.prototype.options=t.a.prototype.options,t.a.prototype.init=t.a.prototype.l,t.a.prototype.dispose=t.a.prototype.dispose,t.a.prototype.createEl=t.a.prototype.e,t.a.prototype.contentEl=t.a.prototype.wa,t.a.prototype.el=t.a.prototype.m,t.a.prototype.addChild=t.a.prototype.aa,t.a.prototype.getChild=t.a.prototype.da,t.a.prototype.getChildById=t.a.prototype.Yd,t.a.prototype.children=t.a.prototype.children,t.a.prototype.initChildren=t.a.prototype.Kc,t.a.prototype.removeChild=t.a.prototype.removeChild,t.a.prototype.on=t.a.prototype.b,t.a.prototype.off=t.a.prototype.n,t.a.prototype.one=t.a.prototype.N,t.a.prototype.trigger=t.a.prototype.o,t.a.prototype.triggerReady=t.a.prototype.Va,t.a.prototype.show=t.a.prototype.show,t.a.prototype.hide=t.a.prototype.W,t.a.prototype.width=t.a.prototype.width,t.a.prototype.height=t.a.prototype.height,t.a.prototype.dimensions=t.a.prototype.Qd,t.a.prototype.ready=t.a.prototype.I,t.a.prototype.addClass=t.a.prototype.p,t.a.prototype.removeClass=t.a.prototype.r,t.a.prototype.hasClass=t.a.prototype.Pa,t.a.prototype.buildCSSClass=t.a.prototype.T,t.a.prototype.localize=t.a.prototype.v,t.a.prototype.setInterval=t.a.prototype.setInterval,t.a.prototype.setTimeout=t.a.prototype.setTimeout,$("videojs.EventEmitter",t.z),t.z.prototype.on=t.z.prototype.b,t.z.prototype.addEventListener=t.z.prototype.addEventListener,t.z.prototype.off=t.z.prototype.n,t.z.prototype.removeEventListener=t.z.prototype.removeEventListener,t.z.prototype.one=t.z.prototype.N,t.z.prototype.trigger=t.z.prototype.o,t.z.prototype.dispatchEvent=t.z.prototype.dispatchEvent,t.Player.prototype.ended=t.Player.prototype.ended,t.Player.prototype.enterFullWindow=t.Player.prototype.Fc,t.Player.prototype.exitFullWindow=t.Player.prototype.Lb,t.Player.prototype.preload=t.Player.prototype.Ra,t.Player.prototype.remainingTime=t.Player.prototype.remainingTime,t.Player.prototype.supportsFullScreen=t.Player.prototype.Sa,t.Player.prototype.currentType=t.Player.prototype.Nd,t.Player.prototype.requestFullScreen=t.Player.prototype.requestFullScreen,t.Player.prototype.requestFullscreen=t.Player.prototype.requestFullscreen,t.Player.prototype.cancelFullScreen=t.Player.prototype.cancelFullScreen,t.Player.prototype.exitFullscreen=t.Player.prototype.exitFullscreen,t.Player.prototype.isFullScreen=t.Player.prototype.isFullScreen,t.Player.prototype.isFullscreen=t.Player.prototype.isFullscreen,t.Player.prototype.textTracks=t.Player.prototype.textTracks,t.Player.prototype.remoteTextTracks=t.Player.prototype.X,t.Player.prototype.addTextTrack=t.Player.prototype.addTextTrack,t.Player.prototype.addRemoteTextTrack=t.Player.prototype.ha,t.Player.prototype.removeRemoteTextTrack=t.Player.prototype.Da,t.Player.prototype.seekable=t.Player.prototype.seekable,$("videojs.MediaLoader",t.Cd),$("videojs.TextTrackDisplay",t.sa),$("videojs.ControlBar",t.tb),$("videojs.Button",t.w),$("videojs.PlayToggle",t.kc),$("videojs.FullscreenToggle",t.Ya),$("videojs.BigPlayButton",t.rb),$("videojs.LoadingSpinner",t.ic),$("videojs.CurrentTimeDisplay",t.ub),$("videojs.DurationDisplay",t.vb),$("videojs.TimeDivider",t.qc),$("videojs.RemainingTimeDisplay",t.Cb),$("videojs.LiveDisplay",t.hc),$("videojs.ErrorDisplay",t.wb),$("videojs.Slider",t.S),$("videojs.ProgressControl",t.Bb),$("videojs.SeekBar",t.nc),$("videojs.LoadProgressBar",t.yb),$("videojs.PlayProgressBar",t.jc),$("videojs.SeekHandle",t.Za),$("videojs.VolumeControl",t.Fb),$("videojs.VolumeBar",t.Eb),$("videojs.VolumeLevel",t.rc),$("videojs.VolumeMenuButton",t.Ha),$("videojs.VolumeHandle",t.Gb),$("videojs.MuteToggle",t.ra),$("videojs.PosterImage",t.mc),$("videojs.Menu",t.qa),$("videojs.MenuItem",t.M),$("videojs.MenuButton",t.O),$("videojs.PlaybackRateMenuButton",t.lc),$("videojs.ChaptersTrackMenuItem",t.Xa),$("videojs.TextTrackButton",t.Q),$("videojs.TextTrackMenuItem",t.$),$("videojs.OffTextTrackMenuItem",t.zb),$("videojs.CaptionSettingsMenuItem",t.sb),t.O.prototype.createItems=t.O.prototype.Ka,t.Q.prototype.createItems=t.Q.prototype.Ka,t.Wa.prototype.createItems=t.Wa.prototype.Ka,$("videojs.SubtitlesButton",t.$a),$("videojs.CaptionsButton",t.oa),$("videojs.ChaptersButton",t.Wa),$("videojs.MediaTechController",t.j),t.j.withSourceHandlers=t.j.dc,t.j.prototype.featuresVolumeControl=t.j.prototype.qf,t.j.prototype.featuresFullscreenResize=t.j.prototype.mf,t.j.prototype.featuresPlaybackRate=t.j.prototype.nf,t.j.prototype.featuresProgressEvents=t.j.prototype.of,t.j.prototype.featuresTimeupdateEvents=t.j.prototype.pf,t.j.prototype.setPoster=t.j.prototype.bd,t.j.prototype.textTracks=t.j.prototype.textTracks,t.j.prototype.remoteTextTracks=t.j.prototype.X,t.j.prototype.addTextTrack=t.j.prototype.addTextTrack,t.j.prototype.addRemoteTextTrack=t.j.prototype.ha,t.j.prototype.removeRemoteTextTrack=t.j.prototype.Da,$("videojs.Html5",t.f),t.f.Events=t.f.xb,t.f.isSupported=t.f.isSupported,t.f.canPlaySource=t.f.wc,t.f.patchCanPlayType=t.f.Tc,t.f.unpatchCanPlayType=t.f.Ye,t.f.prototype.setCurrentTime=t.f.prototype.Zb,t.f.prototype.setVolume=t.f.prototype.Oe,t.f.prototype.setMuted=t.f.prototype.Ke,t.f.prototype.setPreload=t.f.prototype.Me,t.f.prototype.setAutoplay=t.f.prototype.He,t.f.prototype.setLoop=t.f.prototype.Je,t.f.prototype.enterFullScreen=t.f.prototype.Ec,t.f.prototype.exitFullScreen=t.f.prototype.Ud,t.f.prototype.playbackRate=t.f.prototype.playbackRate,t.f.prototype.setPlaybackRate=t.f.prototype.Le,t.f.selectSourceHandler=t.f.ob,t.f.prototype.setSource=t.f.prototype.ma,t.f.prototype.disposeSourceHandler=t.f.prototype.ia,t.f.prototype.textTracks=t.f.prototype.textTracks,t.f.prototype.remoteTextTracks=t.f.prototype.X,t.f.prototype.addTextTrack=t.f.prototype.addTextTrack,t.f.prototype.addRemoteTextTrack=t.f.prototype.ha,t.f.prototype.removeRemoteTextTrack=t.f.prototype.Da,$("videojs.Flash",t.g),t.g.isSupported=t.g.isSupported,t.g.canPlaySource=t.g.wc,t.g.onReady=t.g.onReady,t.g.embed=t.g.Dc,t.g.version=t.g.version,t.g.prototype.setSource=t.g.prototype.ma,t.g.selectSourceHandler=t.g.ob,t.g.prototype.setSource=t.g.prototype.ma,t.g.prototype.disposeSourceHandler=t.g.prototype.ia,$("videojs.TextTrack",t.t),$("videojs.TextTrackList",t.F),$("videojs.TextTrackCueList",t.U),$("videojs.TextTrackSettings",t.pc),t.t.prototype.id=t.t.prototype.id,t.t.prototype.label=t.t.prototype.label,t.t.prototype.kind=t.t.prototype.Tb,t.t.prototype.mode=t.t.prototype.mode,t.t.prototype.cues=t.t.prototype.Ac,t.t.prototype.activeCues=t.t.prototype.jf,t.t.prototype.addCue=t.t.prototype.sc,t.t.prototype.removeCue=t.t.prototype.Yc,t.F.prototype.getTrackById=t.F.prototype.ae,t.U.prototype.getCueById=t.F.prototype.Zd,$("videojs.CaptionsTrack",t.cf),$("videojs.SubtitlesTrack",t.hf),$("videojs.ChaptersTrack",t.df),$("videojs.autoSetup",t.uc),$("videojs.plugin",t.Be),$("videojs.createTimeRange",t.xa),$("videojs.util",t.Z),t.Z.mergeOptions=t.Z.Aa,t.addLanguage=t.Gd}(),!function(e){var t=e.vttjs={},n=t.VTTCue,r=t.VTTRegion,i=e.VTTCue,s=e.VTTRegion;t.shim=function(){t.VTTCue=n,t.VTTRegion=r},t.restore=function(){t.VTTCue=i,t.VTTRegion=s}}(this),function(e,t){function n(e){if("string"!=typeof e)return!1;var t=u[e.toLowerCase()];return t?e.toLowerCase():!1}function r(e){if("string"!=typeof e)return!1;var t=a[e.toLowerCase()];return t?e.toLowerCase():!1}function i(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]=n[r]}return e}function s(e,t,s){var u=this,a=/MSIE\s8\.0/.test(navigator.userAgent),f={};a?u=document.createElement("custom"):f.enumerable=!0,u.hasBeenReset=!1;var l="",h=!1,p=e,v=t,m=s,y=null,b="",w=!0,E="auto",S="start",x=50,T="middle",N=50,C="middle";return Object.defineProperty(u,"id",i({},f,{get:function(){return l},set:function(e){l=""+e}})),Object.defineProperty(u,"pauseOnExit",i({},f,{get:function(){return h},set:function(e){h=!!e}})),Object.defineProperty(u,"startTime",i({},f,{get:function(){return p},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");p=e,this.hasBeenReset=!0}})),Object.defineProperty(u,"endTime",i({},f,{get:function(){return v},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");v=e,this.hasBeenReset=!0}})),Object.defineProperty(u,"text",i({},f,{get:function(){return m},set:function(e){m=""+e,this.hasBeenReset=!0}})),Object.defineProperty(u,"region",i({},f,{get:function(){return y},set:function(e){y=e,this.hasBeenReset=!0}})),Object.defineProperty(u,"vertical",i({},f,{get:function(){return b},set:function(e){var t=n(e);if(t===!1)throw new SyntaxError("An invalid or illegal string was specified.");b=t,this.hasBeenReset=!0}})),Object.defineProperty(u,"snapToLines",i({},f,{get:function(){return w},set:function(e){w=!!e,this.hasBeenReset=!0}})),Object.defineProperty(u,"line",i({},f,{get:function(){return E},set:function(e){if("number"!=typeof e&&e!==o)throw new SyntaxError("An invalid number or illegal string was specified.");E=e,this.hasBeenReset=!0}})),Object.defineProperty(u,"lineAlign",i({},f,{get:function(){return S},set:function(e){var t=r(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");S=t,this.hasBeenReset=!0}})),Object.defineProperty(u,"position",i({},f,{get:function(){return x},set:function(e){if(0>e||e>100)throw new Error("Position must be between 0 and 100.");x=e,this.hasBeenReset=!0}})),Object.defineProperty(u,"positionAlign",i({},f,{get:function(){return T},set:function(e){var t=r(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");T=t,this.hasBeenReset=!0}})),Object.defineProperty(u,"size",i({},f,{get:function(){return N},set:function(e){if(0>e||e>100)throw new Error("Size must be between 0 and 100.");N=e,this.hasBeenReset=!0}})),Object.defineProperty(u,"align",i({},f,{get:function(){return C},set:function(e){var t=r(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");C=t,this.hasBeenReset=!0}})),u.displayState=void 0,a?u:void 0}var o="auto",u={"":!0,lr:!0,rl:!0},a={start:!0,middle:!0,end:!0,left:!0,right:!0};s.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)},e.VTTCue=e.VTTCue||s,t.VTTCue=s}(this,this.vttjs||{}),function(e,t){function n(e){if("string"!=typeof e)return!1;var t=s[e.toLowerCase()];return t?e.toLowerCase():!1}function r(e){return"number"==typeof e&&e>=0&&100>=e}function i(){var e=100,t=3,i=0,s=100,o=0,u=100,a="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return e},set:function(t){if(!r(t))throw new Error("Width must be between 0 and 100.");e=t}},lines:{enumerable:!0,get:function(){return t},set:function(e){if("number"!=typeof e)throw new TypeError("Lines must be set to a number.");t=e}},regionAnchorY:{enumerable:!0,get:function(){return s},set:function(e){if(!r(e))throw new Error("RegionAnchorX must be between 0 and 100.");s=e}},regionAnchorX:{enumerable:!0,get:function(){return i},set:function(e){if(!r(e))throw new Error("RegionAnchorY must be between 0 and 100.");i=e}},viewportAnchorY:{enumerable:!0,get:function(){return u},set:function(e){if(!r(e))throw new Error("ViewportAnchorY must be between 0 and 100.");u=e}},viewportAnchorX:{enumerable:!0,get:function(){return o},set:function(e){if(!r(e))throw new Error("ViewportAnchorX must be between 0 and 100.");o=e}},scroll:{enumerable:!0,get:function(){return a},set:function(e){var t=n(e);if(t===!1)throw new SyntaxError("An invalid or illegal string was specified.");a=t}}})}var s={"":!0,up:!0};e.VTTRegion=e.VTTRegion||i,t.VTTRegion=i}(this,this.vttjs||{}),function(e){function t(e,t){this.name="ParsingError",this.code=e.code,this.message=t||e.message}function n(e){function t(e,t,n,r){return 3600*(0|e)+60*(0|t)+(0|n)+(0|r)/1e3}var n=e.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return n?n[3]?t(n[1],n[2],n[3].replace(":",""),n[4]):n[1]>59?t(n[1],n[2],0,n[4]):t(0,n[1],n[2],n[4]):null}function r(){this.values=d(null)}function i(e,t,n,r){var i=r?e.split(r):[e];for(var s in i)if("string"==typeof i[s]){var o=i[s].split(n);if(2===o.length){var u=o[0],a=o[1];t(u,a)}}}function s(e,s,o){function u(){var r=n(e);if(null===r)throw new t(t.Errors.BadTimeStamp,"Malformed timestamp: "+l);return e=e.replace(/^[^\sa-zA-Z-]+/,""),r}function a(e,t){var n=new r;i(e,function(e,t){switch(e){case"region":for(var r=o.length-1;r>=0;r--)if(o[r].id===t){n.set(e,o[r].region);break}break;case"vertical":n.alt(e,t,["rl","lr"]);break;case"line":var i=t.split(","),s=i[0];n.integer(e,s),n.percent(e,s)?n.set("snapToLines",!1):null,n.alt(e,s,["auto"]),2===i.length&&n.alt("lineAlign",i[1],["start","middle","end"]);break;case"position":i=t.split(","),n.percent(e,i[0]),2===i.length&&n.alt("positionAlign",i[1],["start","middle","end"]);break;case"size":n.percent(e,t);break;case"align":n.alt(e,t,["start","middle","end","left","right"])}},/:/,/\s/),t.region=n.get("region",null),t.vertical=n.get("vertical",""),t.line=n.get("line","auto"),t.lineAlign=n.get("lineAlign","start"),t.snapToLines=n.get("snapToLines",!0),t.size=n.get("size",100),t.align=n.get("align","middle"),t.position=n.get("position",{start:0,left:0,middle:50,end:100,right:100},t.align),t.positionAlign=n.get("positionAlign",{start:"start",left:"start",middle:"middle",end:"end",right:"end"},t.align)}function f(){e=e.replace(/^\s+/,"")}var l=e;if(f(),s.startTime=u(),f(),"-->"!==e.substr(0,3))throw new t(t.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '-->'): "+l);e=e.substr(3),f(),s.endTime=u(),f(),a(e,s)}function o(e,t){function r(){function e(e){return t=t.substr(e.length),e}if(!t)return null;var n=t.match(/^([^<]*)(<[^>]+>?)?/);return e(n[1]?n[1]:n[2])}function i(e){return v[e]}function s(e){for(;d=e.match(/&(amp|lt|gt|lrm|rlm|nbsp);/);)e=e.replace(d[0],i);return e}function o(e,t){return!y[t.localName]||y[t.localName]===e.localName}function u(t,n){var r=m[t];if(!r)return null;var i=e.document.createElement(r);i.localName=r;var s=g[t];return s&&n&&(i[s]=n.trim()),i}for(var a,f=e.document.createElement("div"),l=f,c=[];null!==(a=r());)if("<"!==a[0])l.appendChild(e.document.createTextNode(s(a)));else{if("/"===a[1]){c.length&&c[c.length-1]===a.substr(2).replace(">","")&&(c.pop(),l=l.parentNode);continue}var h,p=n(a.substr(1,a.length-2));if(p){h=e.document.createProcessingInstruction("timestamp",p),l.appendChild(h);continue}var d=a.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!d)continue;if(h=u(d[1],d[3]),!h)continue;if(!o(l,h))continue;d[2]&&(h.className=d[2].substr(1).replace("."," ")),c.push(d[1]),l.appendChild(h),l=h}return f}function u(e){function t(e,t){for(var n=t.childNodes.length-1;n>=0;n--)e.push(t.childNodes[n])}function n(e){if(!e||!e.length)return null;var r=e.pop(),i=r.textContent||r.innerText;if(i){var s=i.match(/^.*(\n|\r)/);return s?(e.length=0,s[0]):i}return"ruby"===r.tagName?n(e):r.childNodes?(t(e,r),n(e)):void 0}var r,i=[],s="";if(!e||!e.childNodes)return"ltr";for(t(i,e);s=n(i);)for(var o=0;o<s.length;o++){r=s.charCodeAt(o);for(var u=0;u<b.length;u++)if(b[u]===r)return"rtl"}return"ltr"}function a(e){if("number"==typeof e.line&&(e.snapToLines||e.line>=0&&e.line<=100))return e.line;if(!e.track||!e.track.textTrackList||!e.track.textTrackList.mediaElement)return-1;for(var t=e.track,n=t.textTrackList,r=0,i=0;i<n.length&&n[i]!==t;i++)"showing"===n[i].mode&&r++;return-1*++r}function f(){}function l(e,t,n){var r=/MSIE\s8\.0/.test(navigator.userAgent),i="rgba(255, 255, 255, 1)",s="rgba(0, 0, 0, 0.8)";r&&(i="rgb(255, 255, 255)",s="rgb(0, 0, 0)"),f.call(this),this.cue=t,this.cueDiv=o(e,t.text);var a={color:i,backgroundColor:s,position:"relative",left:0,right:0,top:0,bottom:0,display:"inline"};r||(a.writingMode=""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"vertical-rl",a.unicodeBidi="plaintext"),this.applyStyles(a,this.cueDiv),this.div=e.document.createElement("div"),a={textAlign:"middle"===t.align?"center":t.align,font:n.font,whiteSpace:"pre-line",position:"absolute"},r||(a.direction=u(this.cueDiv),a.writingMode=""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"vertical-rl".stylesunicodeBidi="plaintext"),this.applyStyles(a),this.div.appendChild(this.cueDiv);var l=0;switch(t.positionAlign){case"start":l=t.position;break;case"middle":l=t.position-t.size/2;break;case"end":l=t.position-t.size}this.applyStyles(""===t.vertical?{left:this.formatStyle(l,"%"),width:this.formatStyle(t.size,"%")}:{top:this.formatStyle(l,"%"),height:this.formatStyle(t.size,"%")}),this.move=function(e){this.applyStyles({top:this.formatStyle(e.top,"px"),bottom:this.formatStyle(e.bottom,"px"),left:this.formatStyle(e.left,"px"),right:this.formatStyle(e.right,"px"),height:this.formatStyle(e.height,"px"),width:this.formatStyle(e.width,"px")})}}function c(e){var t,n,r,i,s=/MSIE\s8\.0/.test(navigator.userAgent);if(e.div){n=e.div.offsetHeight,r=e.div.offsetWidth,i=e.div.offsetTop;var o=(o=e.div.childNodes)&&(o=o[0])&&o.getClientRects&&o.getClientRects();e=e.div.getBoundingClientRect(),t=o?Math.max(o[0]&&o[0].height||0,e.height/o.length):0}this.left=e.left,this.right=e.right,this.top=e.top||i,this.height=e.height||n,this.bottom=e.bottom||i+(e.height||n),this.width=e.width||r,this.lineHeight=void 0!==t?t:e.lineHeight,s&&!this.lineHeight&&(this.lineHeight=13)}function h(e,t,n,r){function i(e,t){for(var i,s=new c(e),o=1,u=0;u<t.length;u++){for(;e.overlapsOppositeAxis(n,t[u])||e.within(n)&&e.overlapsAny(r);)e.move(t[u]);if(e.within(n))return e;var a=e.intersectPercentage(n);o>a&&(i=new c(e),o=a),e=new c(s)}return i||s}var s=new c(t),o=t.cue,u=a(o),f=[];if(o.snapToLines){var l;switch(o.vertical){case"":f=["+y","-y"],l="height";break;case"rl":f=["+x","-x"],l="width";break;case"lr":f=["-x","+x"],l="width"}var h=s.lineHeight,p=h*Math.round(u),d=n[l]+h,v=f[0];Math.abs(p)>d&&(p=0>p?-1:1,p*=Math.ceil(d/h)*h),0>u&&(p+=""===o.vertical?n.height:n.width,f=f.reverse()),s.move(v,p)}else{var m=s.lineHeight/n.height*100;switch(o.lineAlign){case"middle":u-=m/2;break;case"end":u-=m}switch(o.vertical){case"":t.applyStyles({top:t.formatStyle(u,"%")});break;case"rl":t.applyStyles({left:t.formatStyle(u,"%")});break;case"lr":t.applyStyles({right:t.formatStyle(u,"%")})}f=["+y","-x","+x","-y"],s=new c(t)}var g=i(s,f);t.move(g.toCSSCompatValues(n))}function p(){}var d=Object.create||function(){function e(){}return function(t){if(1!==arguments.length)throw new Error("Object.create shim only accepts one parameter.");return e.prototype=t,new e}}();t.prototype=d(Error.prototype),t.prototype.constructor=t,t.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}},r.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,n){for(var r=0;r<n.length;++r)if(t===n[r]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){var n;return(n=t.match(/^([\d]{1,3})(\.[\d]*)?%$/))&&(t=parseFloat(t),t>=0&&100>=t)?(this.set(e,t),!0):!1}};var v={"&amp;":"&","&lt;":"<","&gt;":">","&lrm;":"","&rlm;":"","&nbsp;":" "},m={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},g={v:"title",lang:"lang"},y={rt:"ruby"},b=[1470,1472,1475,1478,1488,1489,1490,1491,1492,1493,1494,1495,1496,1497,1498,1499,1500,1501,1502,1503,1504,1505,1506,1507,1508,1509,1510,1511,1512,1513,1514,1520,1521,1522,1523,1524,1544,1547,1549,1563,1566,1567,1568,1569,1570,1571,1572,1573,1574,1575,1576,1577,1578,1579,1580,1581,1582,1583,1584,1585,1586,1587,1588,1589,1590,1591,1592,1593,1594,1595,1596,1597,1598,1599,1600,1601,1602,1603,1604,1605,1606,1607,1608,1609,1610,1645,1646,1647,1649,1650,1651,1652,1653,1654,1655,1656,1657,1658,1659,1660,1661,1662,1663,1664,1665,1666,1667,1668,1669,1670,1671,1672,1673,1674,1675,1676,1677,1678,1679,1680,1681,1682,1683,1684,1685,1686,1687,1688,1689,1690,1691,1692,1693,1694,1695,1696,1697,1698,1699,1700,1701,1702,1703,1704,1705,1706,1707,1708,1709,1710,1711,1712,1713,1714,1715,1716,1717,1718,1719,1720,1721,1722,1723,1724,1725,1726,1727,1728,1729,1730,1731,1732,1733,1734,1735,1736,1737,1738,1739,1740,1741,1742,1743,1744,1745,1746,1747,1748,1749,1765,1766,1774,1775,1786,1787,1788,1789,1790,1791,1792,1793,1794,1795,1796,1797,1798,1799,1800,1801,1802,1803,1804,1805,1807,1808,1810,1811,1812,1813,1814,1815,1816,1817,1818,1819,1820,1821,1822,1823,1824,1825,1826,1827,1828,1829,1830,1831,1832,1833,1834,1835,1836,1837,1838,1839,1869,1870,1871,1872,1873,1874,1875,1876,1877,1878,1879,1880,1881,1882,1883,1884,1885,1886,1887,1888,1889,1890,1891,1892,1893,1894,1895,1896,1897,1898,1899,1900,1901,1902,1903,1904,1905,1906,1907,1908,1909,1910,1911,1912,1913,1914,1915,1916,1917,1918,1919,1920,1921,1922,1923,1924,1925,1926,1927,1928,1929,1930,1931,1932,1933,1934,1935,1936,1937,1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,1954,1955,1956,1957,1969,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2e3,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024,2025,2026,2036,2037,2042,2048,2049,2050,2051,2052,2053,2054,2055,2056,2057,2058,2059,2060,2061,2062,2063,2064,2065,2066,2067,2068,2069,2074,2084,2088,2096,2097,2098,2099,2100,2101,2102,2103,2104,2105,2106,2107,2108,2109,2110,2112,2113,2114,2115,2116,2117,2118,2119,2120,2121,2122,2123,2124,2125,2126,2127,2128,2129,2130,2131,2132,2133,2134,2135,2136,2142,2208,2210,2211,2212,2213,2214,2215,2216,2217,2218,2219,2220,8207,64285,64287,64288,64289,64290,64291,64292,64293,64294,64295,64296,64298,64299,64300,64301,64302,64303,64304,64305,64306,64307,64308,64309,64310,64312,64313,64314,64315,64316,64318,64320,64321,64323,64324,64326,64327,64328,64329,64330,64331,64332,64333,64334,64335,64336,64337,64338,64339,64340,64341,64342,64343,64344,64345,64346,64347,64348,64349,64350,64351,64352,64353,64354,64355,64356,64357,64358,64359,64360,64361,64362,64363,64364,64365,64366,64367,64368,64369,64370,64371,64372,64373,64374,64375,64376,64377,64378,64379,64380,64381,64382,64383,64384,64385,64386,64387,64388,64389,64390,64391,64392,64393,64394,64395,64396,64397,64398,64399,64400,64401,64402,64403,64404,64405,64406,64407,64408,64409,64410,64411,64412,64413,64414,64415,64416,64417,64418,64419,64420,64421,64422,64423,64424,64425,64426,64427,64428,64429,64430,64431,64432,64433,64434,64435,64436,64437,64438,64439,64440,64441,64442,64443,64444,64445,64446,64447,64448,64449,64467,64468,64469,64470,64471,64472,64473,64474,64475,64476,64477,64478,64479,64480,64481,64482,64483,64484,64485,64486,64487,64488,64489,64490,64491,64492,64493,64494,64495,64496,64497,64498,64499,64500,64501,64502,64503,64504,64505,64506,64507,64508,64509,64510,64511,64512,64513,64514,64515,64516,64517,64518,64519,64520,64521,64522,64523,64524,64525,64526,64527,64528,64529,64530,64531,64532,64533,64534,64535,64536,64537,64538,64539,64540,64541,64542,64543,64544,64545,64546,64547,64548,64549,64550,64551,64552,64553,64554,64555,64556,64557,64558,64559,64560,64561,64562,64563,64564,64565,64566,64567,64568,64569,64570,64571,64572,64573,64574,64575,64576,64577,64578,64579,64580,64581,64582,64583,64584,64585,64586,64587,64588,64589,64590,64591,64592,64593,64594,64595,64596,64597,64598,64599,64600,64601,64602,64603,64604,64605,64606,64607,64608,64609,64610,64611,64612,64613,64614,64615,64616,64617,64618,64619,64620,64621,64622,64623,64624,64625,64626,64627,64628,64629,64630,64631,64632,64633,64634,64635,64636,64637,64638,64639,64640,64641,64642,64643,64644,64645,64646,64647,64648,64649,64650,64651,64652,64653,64654,64655,64656,64657,64658,64659,64660,64661,64662,64663,64664,64665,64666,64667,64668,64669,64670,64671,64672,64673,64674,64675,64676,64677,64678,64679,64680,64681,64682,64683,64684,64685,64686,64687,64688,64689,64690,64691,64692,64693,64694,64695,64696,64697,64698,64699,64700,64701,64702,64703,64704,64705,64706,64707,64708,64709,64710,64711,64712,64713,64714,64715,64716,64717,64718,64719,64720,64721,64722,64723,64724,64725,64726,64727,64728,64729,64730,64731,64732,64733,64734,64735,64736,64737,64738,64739,64740,64741,64742,64743,64744,64745,64746,64747,64748,64749,64750,64751,64752,64753,64754,64755,64756,64757,64758,64759,64760,64761,64762,64763,64764,64765,64766,64767,64768,64769,64770,64771,64772,64773,64774,64775,64776,64777,64778,64779,64780,64781,64782,64783,64784,64785,64786,64787,64788,64789,64790,64791,64792,64793,64794,64795,64796,64797,64798,64799,64800,64801,64802,64803,64804,64805,64806,64807,64808,64809,64810,64811,64812,64813,64814,64815,64816,64817,64818,64819,64820,64821,64822,64823,64824,64825,64826,64827,64828,64829,64848,64849,64850,64851,64852,64853,64854,64855,64856,64857,64858,64859,64860,64861,64862,64863,64864,64865,64866,64867,64868,64869,64870,64871,64872,64873,64874,64875,64876,64877,64878,64879,64880,64881,64882,64883,64884,64885,64886,64887,64888,64889,64890,64891,64892,64893,64894,64895,64896,64897,64898,64899,64900,64901,64902,64903,64904,64905,64906,64907,64908,64909,64910,64911,64914,64915,64916,64917,64918,64919,64920,64921,64922,64923,64924,64925,64926,64927,64928,64929,64930,64931,64932,64933,64934,64935,64936,64937,64938,64939,64940,64941,64942,64943,64944,64945,64946,64947,64948,64949,64950,64951,64952,64953,64954,64955,64956,64957,64958,64959,64960,64961,64962,64963,64964,64965,64966,64967,65008,65009,65010,65011,65012,65013,65014,65015,65016,65017,65018,65019,65020,65136,65137,65138,65139,65140,65142,65143,65144,65145,65146,65147,65148,65149,65150,65151,65152,65153,65154,65155,65156,65157,65158,65159,65160,65161,65162,65163,65164,65165,65166,65167,65168,65169,65170,65171,65172,65173,65174,65175,65176,65177,65178,65179,65180,65181,65182,65183,65184,65185,65186,65187,65188,65189,65190,65191,65192,65193,65194,65195,65196,65197,65198,65199,65200,65201,65202,65203,65204,65205,65206,65207,65208,65209,65210,65211,65212,65213,65214,65215,65216,65217,65218,65219,65220,65221,65222,65223,65224,65225,65226,65227,65228,65229,65230,65231,65232,65233,65234,65235,65236,65237,65238,65239,65240,65241,65242,65243,65244,65245,65246,65247,65248,65249,65250,65251,65252,65253,65254,65255,65256,65257,65258,65259,65260,65261,65262,65263,65264,65265,65266,65267,65268,65269,65270,65271,65272,65273,65274,65275,65276,67584,67585,67586,67587,67588,67589,67592,67594,67595,67596,67597,67598,67599,67600,67601,67602,67603,67604,67605,67606,67607,67608,67609,67610,67611,67612,67613,67614,67615,67616,67617,67618,67619,67620,67621,67622,67623,67624,67625,67626,67627,67628,67629,67630,67631,67632,67633,67634,67635,67636,67637,67639,67640,67644,67647,67648,67649,67650,67651,67652,67653,67654,67655,67656,67657,67658,67659,67660,67661,67662,67663,67664,67665,67666,67667,67668,67669,67671,67672,67673,67674,67675,67676,67677,67678,67679,67840,67841,67842,67843,67844,67845,67846,67847,67848,67849,67850,67851,67852,67853,67854,67855,67856,67857,67858,67859,67860,67861,67862,67863,67864,67865,67866,67867,67872,67873,67874,67875,67876,67877,67878,67879,67880,67881,67882,67883,67884,67885,67886,67887,67888,67889,67890,67891,67892,67893,67894,67895,67896,67897,67903,67968,67969,67970,67971,67972,67973,67974,67975,67976,67977,67978,67979,67980,67981,67982,67983,67984,67985,67986,67987,67988,67989,67990,67991,67992,67993,67994,67995,67996,67997,67998,67999,68e3,68001,68002,68003,68004,68005,68006,68007,68008,68009,68010,68011,68012,68013,68014,68015,68016,68017,68018,68019,68020,68021,68022,68023,68030,68031,68096,68112,68113,68114,68115,68117,68118,68119,68121,68122,68123,68124,68125,68126,68127,68128,68129,68130,68131,68132,68133,68134,68135,68136,68137,68138,68139,68140,68141,68142,68143,68144,68145,68146,68147,68160,68161,68162,68163,68164,68165,68166,68167,68176,68177,68178,68179,68180,68181,68182,68183,68184,68192,68193,68194,68195,68196,68197,68198,68199,68200,68201,68202,68203,68204,68205,68206,68207,68208,68209,68210,68211,68212,68213,68214,68215,68216,68217,68218,68219,68220,68221,68222,68223,68352,68353,68354,68355,68356,68357,68358,68359,68360,68361,68362,68363,68364,68365,68366,68367,68368,68369,68370,68371,68372,68373,68374,68375,68376,68377,68378,68379,68380,68381,68382,68383,68384,68385,68386,68387,68388,68389,68390,68391,68392,68393,68394,68395,68396,68397,68398,68399,68400,68401,68402,68403,68404,68405,68416,68417,68418,68419,68420,68421,68422,68423,68424,68425,68426,68427,68428,68429,68430,68431,68432,68433,68434,68435,68436,68437,68440,68441,68442,68443,68444,68445,68446,68447,68448,68449,68450,68451,68452,68453,68454,68455,68456,68457,68458,68459,68460,68461,68462,68463,68464,68465,68466,68472,68473,68474,68475,68476,68477,68478,68479,68608,68609,68610,68611,68612,68613,68614,68615,68616,68617,68618,68619,68620,68621,68622,68623,68624,68625,68626,68627,68628,68629,68630,68631,68632,68633,68634,68635,68636,68637,68638,68639,68640,68641,68642,68643,68644,68645,68646,68647,68648,68649,68650,68651,68652,68653,68654,68655,68656,68657,68658,68659,68660,68661,68662,68663,68664,68665,68666,68667,68668,68669,68670,68671,68672,68673,68674,68675,68676,68677,68678,68679,68680,126464,126465,126466,126467,126469,126470,126471,126472,126473,126474,126475,126476,126477,126478,126479,126480,126481,126482,126483,126484,126485,126486,126487,126488,126489,126490,126491,126492,126493,126494,126495,126497,126498,126500,126503,126505,126506,126507,126508,126509,126510,126511,126512,126513,126514,126516,126517,126518,126519,126521,126523,126530,126535,126537,126539,126541,126542,126543,126545,126546,126548,126551,126553,126555,126557,126559,126561,126562,126564,126567,126568,126569,126570,126572,126573,126574,126575,126576,126577,126578,126580,126581,126582,126583,126585,126586,126587,126588,126590,126592,126593,126594,126595,126596,126597,126598,126599,126600,126601,126603,126604,126605,126606,126607,126608,126609,126610,126611,126612,126613,126614,126615,126616,126617,126618,126619,126625,126626,126627,126629,126630,126631,126632,126633,126635,126636,126637,126638,126639,126640,126641,126642,126643,126644,126645,126646,126647,126648,126649,126650,126651,1114109];f.prototype.applyStyles=function(e,t){t=t||this.div;for(var n in e)e.hasOwnProperty(n)&&(t.style[n]=e[n])},f.prototype.formatStyle=function(e,t){return 0===e?0:e+t},l.prototype=d(f.prototype),l.prototype.constructor=l,c.prototype.move=function(e,t){switch(t=void 0!==t?t:this.lineHeight,e){case"+x":this.left+=t,this.right+=t;break;case"-x":this.left-=t,this.right-=t;break;case"+y":this.top+=t,this.bottom+=t;break;case"-y":this.top-=t,this.bottom-=t}},c.prototype.overlaps=function(e){return this.left<e.right&&this.right>e.left&&this.top<e.bottom&&this.bottom>e.top},c.prototype.overlapsAny=function(e){for(var t=0;t<e.length;t++)if(this.overlaps(e[t]))return!0;return!1},c.prototype.within=function(e){return this.top>=e.top&&this.bottom<=e.bottom&&this.left>=e.left&&this.right<=e.right},c.prototype.overlapsOppositeAxis=function(e,t){switch(t){case"+x":return this.left<e.left;case"-x":return this.right>e.right;case"+y":return this.top<e.top;case"-y":return this.bottom>e.bottom}},c.prototype.intersectPercentage=function(e){var t=Math.max(0,Math.min(this.right,e.right)-Math.max(this.left,e.left)),n=Math.max(0,Math.min(this.bottom,e.bottom)-Math.max(this.top,e.top)),r=t*n;return r/(this.height*this.width)},c.prototype.toCSSCompatValues=function(e){return{top:this.top-e.top,bottom:e.bottom-this.bottom,left:this.left-e.left,right:e.right-this.right,height:this.height,width:this.width}},c.getSimpleBoxPosition=function(e){var t=e.div?e.div.offsetHeight:e.tagName?e.offsetHeight:0,n=e.div?e.div.offsetWidth:e.tagName?e.offsetWidth:0,r=e.div?e.div.offsetTop:e.tagName?e.offsetTop:0;e=e.div?e.div.getBoundingClientRect():e.tagName?e.getBoundingClientRect():e;var i={left:e.left,right:e.right,top:e.top||r,height:e.height||t,bottom:e.bottom||r+(e.height||t),width:e.width||n};return i},p.StringDecoder=function(){return{decode:function(e){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}},p.convertCueToDOMTree=function(e,t){return e&&t?o(e,t):null};var w=.05,E="sans-serif",S="1.5%";p.processCues=function(e,t,n){function r(e){for(var t=0;t<e.length;t++)if(e[t].hasBeenReset||!e[t].displayState)return!0;return!1}if(!e||!t||!n)return null;for(;n.firstChild;)n.removeChild(n.firstChild);var i=e.document.createElement("div");if(i.style.position="absolute",i.style.left="0",i.style.right="0",i.style.top="0",i.style.bottom="0",i.style.margin=S,n.appendChild(i),r(t)){var s=[],o=c.getSimpleBoxPosition(i),u=Math.round(o.height*w*100)/100,a={font:u+"px "+E};!function(){for(var n,r,u=0;u<t.length;u++)r=t[u],n=new l(e,r,a),i.appendChild(n.div),h(e,n,o,s),r.displayState=n.div,s.push(c.getSimpleBoxPosition(n))}()}else for(var f=0;f<t.length;f++)i.appendChild(t[f].displayState)},p.Parser=function(e,t,n){n||(n=t,t={}),t||(t={}),this.window=e,this.vttjs=t,this.state="INITIAL",this.buffer="",this.decoder=n||new TextDecoder("utf8"),this.regionList=[]},p.Parser.prototype={reportOrThrowError:function(e){if(!(e instanceof t))throw e;this.onparsingerror&&this.onparsingerror(e)},parse:function(e){function n(){for(var e=a.buffer,t=0;t<e.length&&"\r"!==e[t]&&"\n"!==e[t];)++t;var n=e.substr(0,t);return"\r"===e[t]&&++t,"\n"===e[t]&&++t,a.buffer=e.substr(t),n}function o(e){var t=new r;if(i(e,function(e,n){switch(e){case"id":t.set(e,n);break;case"width":t.percent(e,n);break;case"lines":t.integer(e,n);break;case"regionanchor":case"viewportanchor":var i=n.split(",");if(2!==i.length)break;var s=new r;if(s.percent("x",i[0]),s.percent("y",i[1]),!s.has("x")||!s.has("y"))break;t.set(e+"X",s.get("x")),t.set(e+"Y",s.get("y"));break;case"scroll":t.alt(e,n,["up"])}},/=/,/\s/),t.has("id")){var n=new(a.vttjs.VTTRegion||a.window.VTTRegion);n.width=t.get("width",100),n.lines=t.get("lines",3),n.regionAnchorX=t.get("regionanchorX",0),n.regionAnchorY=t.get("regionanchorY",100),n.viewportAnchorX=t.get("viewportanchorX",0),n.viewportAnchorY=t.get("viewportanchorY",100),n.scroll=t.get("scroll",""),a.onregion&&a.onregion(n),a.regionList.push({id:t.get("id"),region:n})}}function u(e){i(e,function(e,t){switch(e){case"Region":o(t)}},/:/)}var a=this;e&&(a.buffer+=a.decoder.decode(e,{stream:!0}));try{var f;if("INITIAL"===a.state){if(!/\r\n|\n/.test(a.buffer))return this;f=n();var l=f.match(/^WEBVTT([ \t].*)?$/);if(!l||!l[0])throw new t(t.Errors.BadSignature);a.state="HEADER"}for(var c=!1;a.buffer;){if(!/\r\n|\n/.test(a.buffer))return this;switch(c?c=!1:f=n(),a.state){case"HEADER":/:/.test(f)?u(f):f||(a.state="ID");continue;case"NOTE":f||(a.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(f)){a.state="NOTE";break}if(!f)continue;if(a.cue=new(a.vttjs.VTTCue||a.window.VTTCue)(0,0,""),a.state="CUE",-1===f.indexOf("-->")){a.cue.id=f;continue};case"CUE":try{s(f,a.cue,a.regionList)}catch(h){a.reportOrThrowError(h),a.cue=null,a.state="BADCUE";continue}a.state="CUETEXT";continue;case"CUETEXT":var p=-1!==f.indexOf("-->");if(!f||p&&(c=!0)){a.oncue&&a.oncue(a.cue),a.cue=null,a.state="ID";continue}a.cue.text&&(a.cue.text+="\n"),a.cue.text+=f;continue;case"BADCUE":f||(a.state="ID");continue}}}catch(h){a.reportOrThrowError(h),"CUETEXT"===a.state&&a.cue&&a.oncue&&a.oncue(a.cue),a.cue=null,a.state="INITIAL"===a.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){var e=this;try{if(e.buffer+=e.decoder.decode(),(e.cue||"HEADER"===e.state)&&(e.buffer+="\n\n",e.parse()),"INITIAL"===e.state)throw new t(t.Errors.BadSignature)}catch(n){e.reportOrThrowError(n)}return e.onflush&&e.onflush(),this}},e.WebVTT=p}(this,this.vttjs||{}),function(e){typeof require=="function"&&typeof exports=="object"&&typeof module=="object"?e(require("ko"),exports):typeof tadpoles.define=="function"&&tadpoles.define.amd?tadpoles.define("koDelegatedEvents",["ko","exports"],e):e(ko,ko.actions={})}(function(e,t){var n="ko_delegated_",r=function(r,i){return function(s){var o,u,a,f,l,c,h,p=s.target||s.srcElement,d=e.contextFor(p),v="data-"+r,m=n+r;if(d){while(!u&&p)u=p.getAttribute(v)||e.utils.domData.get(p,m),u||(p=p!==i?p.parentElement:null);u&&(d=e.contextFor(p),d&&(o=d.$data,typeof u=="string"?(u in t?(c=t[u],c&&(a=typeof c=="function"?c:c.action,f=c.owner||o)):o&&o[u]&&typeof o[u]=="function"&&(a=o[u],f=o),a||(l=e.utils.arrayFirst(d.$parents,function(e){return e[u]&&typeof e[u]=="function"}),a=l&&l[u],f=l)):typeof u=="function"&&(a=u,f=o)),a&&(h=a.call(f,o,s),h!==!0&&(s.preventDefault?s.preventDefault():s.returnValue=!1)))}}},i=function(t){var r;t&&(r="delegated"+t.substr(0,1).toUpperCase()+t.slice(1)),e.bindingHandlers[r]||(e.bindingHandlers[r]={init:function(r,i){var s=i();e.utils.domData.set(r,n+t,s)}})};e.bindingHandlers.delegatedHandler={init:function(t,n){var s=e.utils.unwrapObservable(n())||[];typeof s=="string"&&(s=[s]),e.utils.arrayForEach(s,function(n){i(n),e.utils.registerEventHandler(t,n,r(n,t))})}}}),tadpoles.define("text!view/attendance.html",[],function(){return'<div class="attendance-details">\n    \n    <h2 class="panel-title" ><span class="stat-warn stat-medium"></span>attendance</h2>\n    <div style="margin-top:20px;height:40px;" data-bind="visible: processing(), spin: {trigger: processing(), color: \'#000\'}"></div>\n    <div data-bind="visible: !processing()">\n        <div style="margin-bottom:8px;">\n            <button class="pull-left btn btn-mini btn-danger" style="margin-top:8px;" id="attendanceChart" data-bind="click:graphAttendance" data-original-title="Attendance 15 minute counts">\n                15 Minute Counts\n            </button>\n            <button class="pull-left btn btn-mini btn-info" style="margin-top:8px;margin-left:4px;" id="attendanceReport" data-bind="click:reportAttendance" data-original-title="Reports">\n                Reports\n            </button>\n            <button class="pull-left btn btn-mini btn-success" style="margin-top:8px;margin-left:4px;" data-bind="click:exportData">\n                Export to CSV\n            </button>\n\n            <div class="clearfix"></div>\n        </div>\n\n        <table style="width:100%">\n            <thead>\n                <tr>\n                    <th class="student">student</th>\n                    <th>in</th>\n                    <th>out</th>\n                    <th>hours</th>\n                </tr>\n            </thead>\n            <tbody>\n                <!-- ko foreach: filteredCheckpoints-->\n                <tr data-bind="css: { sick : wasSick() , vacation : wasVacation(), visit : didVisit(), excused : wasOtherAbsence() }, popover: getPopoverParams(), click: edit">\n                    <td class="student">\n                    <div>\n                        <i class="fa fa-edit"></i>\n                        <span data-bind="text:childDisplayName()"></span>\n                    </div></td>\n                    <td data-bind="text:displayInTime()"></td>\n                    <td class="out" data-bind="text:displayOutTime()"></td>\n                    <td class="hours">\n                    <div style="padding-left:10px;">\n                        <span data-bind="text:hours"></span>\n                    </div></td>\n                </tr>\n                <!-- /ko -->\n            </tbody>\n        </table>\n    </div>\n</div>'}),tadpoles.define("text!view/branding.html",[],function(){return'<div>\n    <form class="form-horizontal" data-bind="submit: submit, fileUpload: files, uploadType: \'png|gif|jpg|jpeg\'">\n        <div class="control-group">\n            <label><h4 style="color:gray;">brand logo</h4></label>\n            <span class="btn btn-success btn-small fileinput-button">\n                <i class="fa fa-plus fa-white"></i>\n                <span>Add Image</span>\n                <!-- not visible -->\n                <input type="file" name="attachment" accept="image/*"/>\n            </span><div style="display: inline-block; position: relative;" data-bind="popover: getPopoverParams()" ><img  style="height: 28px;" data-bind="visible: logoUrl(), attr:{src:logoImageUrl()}"></div>\n            <span data-bind="visible: hasAttachedFile()"style="width: 287px;" class="filename-box" ><i class="fa fa-paperclip" aria-hidden="true" style="margin-right: 4px; margin-left: 2px; font-size: 20px"></i><span style="max-width:220px; margin-top: -6px;" class="ellipsis filename" data-bind="text:fileName()"></span><i class=\'fa fa-times pointable\' style="float: right; margin-top: 2px; margin-left: 16px; margin-right: 4px; color: #666; font-size: 16px;" data-bind="click: clearFiles"></i></span>\n            <p class="help-block">Logo images should be 320 pixels wide</p>\n            <label><h4 style="color:gray;margin-top: 20px;">brand url</h4></label>\n            <input type="text" data-bind="value: logoUrl, valueUpdate: \'keyup\'" placeholder="http://yourwebsite.com">\n\n            <!-- ko if:logoUrl() -->\n            <div style="margin-top: 20px;">\n                <img data-bind="attr:{src:logoImageUrl()}" width="310">\n            </div>\n            <!-- /ko -->\n\n        </div>\n        <div  class="control-group">\n            <button class="btn btn-success pull-right" type="submit" data-bind="enable: valid()">Upload</button>\n        </div>\n    </form>\n\n</div>'}),tadpoles.define("text!view/breadcrumb.html",[],function(){return'<div id="breadcrumb-pop" data-bind="popover: getBreadcrumbPopover()">\n    \n	<h1 class="hero-h1 nav-title" data-bind="text: title()"></h1>\n</div>'}),tadpoles.define("text!view/classroomMetrics.html",[],function(){return'<div style="display: inline-block;" data-bind="style : { width : detailViewPanel.attendanceDetailsActive() || detailViewPanel.rosterActive() || detailViewPanel.portfolioActive() ? \'546px\' : \'900px\'}" >\n    <h2 class="pull-left" style="color:gray;">choose a classroom</h2>\n    <!-- ko if:$root.currentUser.isAdmin() -->\n    <div class=" pull-left btn-group" style="margin: 8px 5px 0px 10px;" data-bind="visible:!$root.detailViewPanel.rosterActive()">\n        <button style="margin-left:10px;" class="pull-left btn btn-mini btn-success" data-bind="click: $root.addClass">\n            Add Class\n        </button>\n    </div>\n    <div class=" pull-left btn-group" style="margin: 8px 5px 0px 0px;" data-bind="visible:$root.currentUser.isCsr()">\n        <button class="pull-left btn btn-mini btn-danger" data-bind="click: $root.toggleInactiveClasses">\n            <!-- ko if:$root.inactiveClassesShown() -->\n            Hide Deleted\n            <!-- /ko -->\n            <!-- ko if:!$root.inactiveClassesShown() -->\n            Show Deleted\n            <!-- /ko -->\n        </button>\n    </div>\n    <div class="pull-left btn-group" style="margin: 8px 10px 0px 0px;" data-bind="visible: !$root.detailViewPanel.lessonsActive() && !$root.detailViewPanel.dailyReportsActive() && !$root.detailViewPanel.rosterActive() && !$root.detailViewPanel.observationsActive()">\n        <button  class="btn btn-info dropdown-toggle btn-mini" data-toggle="dropdown">\n            Change Metric <span class="caret"></span>\n        </button>\n        <ul class="dropdown-menu" data-bind="foreach: metrics.metrics">\n            <li>\n                <a href="#" data-bind="click: $root.metrics.currentMetric"><span data-bind="text: name"></span></a>\n            </li>\n        </ul>\n    </div>\n    <!-- /ko -->\n    <div class="clearfix"></div>\n    \n    <div>\n        <ul data-bind="delegatedHandler: \'click\', tiles: { bricks: groups.groupsForLocationDisplay, template:\'view/tiles/classTile\', tileSize:80, groutWidth: 4 }"></ul>\n    </div>\n\n    <div style="margin-top:6px;" data-bind="visible: !$root.detailViewPanel.metricsActive() && !$root.detailViewPanel.rosterActive()">\n\n        <div class="pull-left" style="margin: 2px 8px 0px 0px;line-height:1">\n            <!-- ko if:!$root.detailViewPanel.observationsActive() -->\n                Showing <div class="btn-group" style="display:inline-block;vertical-align:middle">\n                            <a class="btn btn-success btn-mini dropdown-toggle" data-toggle="dropdown" href="#">\n                                <span data-bind="text:$root.detailViewPanel.countOption"></span>&nbsp;\n                                <span class="caret"></span>\n                            </a>\n                            <ul class="dropdown-menu" data-bind="foreach: $root._.values($root.detailViewPanel.CountOptions)">\n                                <li>\n                                    <a href="#" data-bind="click: $root.detailViewPanel.countOption"><span data-bind="text: $data"></span></a>\n                                </li>\n                            </ul>\n                </div> for each classroom.\n            <!-- /ko -->\n            <!-- ko if:$root.detailViewPanel.observationsActive() -->Showing % children with<span data-bind="text: $root.product.minPhotosPerChild() > 1 ? \' \' + $root.product.minPhotosPerChild() + \' photos \': \' a photo \' " ></span> taken today.<!-- /ko -->\n        </div>\n        <!-- /ko -->\n\n\n        <div class="clearfix"></div>\n\n    </div>\n</div>'}),tadpoles.define("text!view/classroomSelector.html",[],function(){return'<div style="display: inline-block;" data-bind="style : { width : \'900px\'}" >\n    <h2 style="color:gray;">classes</h2>\n    <div>\n        <ul data-bind="delegatedHandler: \'click\', tiles: { bricks: groups.allForCurrentLocationWithChildren, template:\'view/tiles/classSelectorTile\', tileSize:70, groutWidth: 4 }"></ul>\n    </div>\n    <div class="clearfix"></div>\n</div>'}),tadpoles.define("text!view/communications.html",[],function(){return'<div>\n    <div style="margin-top:20px;height:40px; width:606px" data-bind="visible: processing(), spin: {trigger: processing(), color: \'#000\'}"></div>\n    <div data-bind="visible: !processing()">\n        <form style="margin-bottom: 0px;" class="form-horizontal" data-bind="submit: submit, fileUpload: files">\n            <div class="control-group">\n                <ul data-bind="visible:!rosterSendMode()" class="nav nav-pills pull-left" style="margin-bottom:0px;">\n                    <li data-bind="css: { \'active\' : noteTypeActive() }" >\n                        <a href="#" class="dash emphasized" data-bind="click: chooseTypeNote, tooltip: \'Send an email to parents or staff\'"><h4 style="line-height:1">email</h4></a>\n                    </li>\n                    <li data-bind="css: { \'active\' : textTypeActive() }" >\n                        <a href="#" class="dash emphasized nav-green" data-bind="click: chooseTypeText, tooltip: \'Send a text to parents or staff (an email will be sent if they do not have a mobile number)\'"><h4 style="line-height:1">text</h4></a>\n                    </li>\n                    <li data-bind="visible: stickyTypeVisible(), css: { \'active\' : stickyTypeActive() }" >\n                        <a href="#" class="dash emphasized nav-warn" data-bind="click: chooseTypeSticky, tooltip: \'Send a sticky note to a teacher on the device\'"><h4 style="line-height:1">sticky note</h4></a>\n                    </li>\n                    <li data-bind="visible: alertTypeVisible(), css: { \'active\' : alertTypeActive() }">\n                        <a href="#" class="dash emphasized nav-emergency" data-bind="click: chooseTypeAlert, tooltip: \'Sends text and email to all parents and staff\'"><h4 style="line-height:1">emergency alert</h4></a>\n                    </li>\n                </ul>\n            </div>\n            <div style="margin-bottom: 5px;" class="control-group" data-bind="visible: !alertTypeActive()">\n                <select style="margin-bottom: 4px;" class="span3" data-bind="value: selectedRecipient,  visible: chooseRecipientSelectVisible()">\n                    <option value=>Choose a recipient</option>\n                    <optgroup data-bind="foreach: caregiverOptions" label="caregivers">\n                         <option data-bind="text: name, value: key"></option>\n                    </optgroup>\n                    <optgroup data-bind="visible: hasGroupOptions, foreach: groupOptions" label="classrooms">\n                         <option data-bind="text: name, value: key"></option>\n                    </optgroup>\n                    <optgroup data-bind="visible: hasRosterOptions, foreach: rosterOptions" label="pipeline">\n                         <option data-bind="text: name, value: \'roster_\' + $data.value()"></option>\n                    </optgroup>\n                </select>\n\n                <div data-bind="foreach: selectedGroups" style="float: right; width: 375px">\n                    <span class="groupname-box" data-bind="style: {backgroundColor: color}"><span class="ellipsis filename" style="max-width:100px; margin-top:-1px; margin-bottom: 1px; margin-left:3px;" data-bind="text:name()"></span><i class=\'fa fa-times pointable\' style="float: right; margin-top: 1px; margin-left: 16px; margin-right: 1px; color: #666; font-size: 16px;" data-bind="click: $parent.removeSelectedGroup"></i></span>\n                </div>\n                <span class="control-label" style="text-align: left;font-size: large; margin-left: 2px; margin-right: 6px; width: auto" data-bind="text:\'to \' + getRecipientText(), visible: !chooseRecipientSelectVisible()"></span>\n            </div>\n            <div style="margin-bottom: 9px;" class="control-group">\n                <style>\n                    /* this is taken from bootstrap\'s text area styles */\n                    .textarea-like-focus {\n                      border-color: rgba(82, 168, 236, 0.8);\n                      -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 8px rgba(82, 168, 236, 0.6);\n                      -moz-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 8px rgba(82, 168, 236, 0.6);\n                      box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 8px rgba(82, 168, 236, 0.6);\n                      outline: 0;\n                      outline: thin dotted \\9;\n                      /* IE6-9 */\n                    }\n\n                    /* this is done to prevent the fat blue highlight from appearing when clicking in the area next to an attached file*/\n                    :focus {\n                        outline: -webkit-focus-ring-color auto 5px;\n                        outline-color: -webkit-focus-ring-color;\n                        outline-style: auto;\n                        outline-width: 0px;\n                    }\n                </style>\n                <div tabindex="0" style="border-color: rgb(204,204,204); border-radius: 3px; border-style:solid; border-width: 1px;" data-bind="css:{\'textarea-like-focus\': parentMessageFocus() }">\n                    <textarea style="border-style: hidden; resize: none; width:595px;height:80px; box-shadow: none;" type="text" data-bind="hasFocus: parentMessageFocus, attr: { \'maxlength\' : alertTypeActive() ? 130 : textTypeActive() ? 140 : 9999, \'placeholder\' : instructions() }, value: content, valueUpdate: \'afterkeydown\'" placeholder="your message here"></textarea>\n                    <div data-bind=\'visible: scheduledSendActive()\' style="color: #666; font-size: 10px; margin-left: 6px;">\n                        <span style="font-style: italic;margin-right: 4px;" data-bind="text:scheduleDisplay()"></span><a data-bind="click:clearSchedule">clear</a>\n                    </div>\n                    <div data-bind="visible: hasAttachedFile(), foreach: fileNames()" style="padding: 4px 4px 0px;">\n                        <span style="width: 287px;" class="filename-box" ><i class="fa fa-file-pdf-o" aria-hidden="true" style="margin-right: 6px; margin-left: 2px; font-size: 20px"></i><span style="max-width:220px; margin-top: -6px;" class="ellipsis filename" data-bind="text:$data"></span><i class=\'fa fa-times pointable\' style="float: right; margin-top: 2px; margin-left: 16px; margin-right: 4px; color: #666; font-size: 16px;" data-bind="click: $parent.removeSelectedFiles"></i></span>\n                    </div>\n                </div>\n            </div>\n            <button class="btn btn-success pull-right" type="submit" data-bind="enable: !processing() && valid(), visible: sendCommunicationButtonVisible()">\n                <span data-bind="text: sendButtonText()"></span>\n            </button>\n            <div style="margin-right: 6px;" class="btn btn-info pull-right" type="submit" data-bind="enable: !processing() && valid(), visible: !scheduledSendActive() && sendCommunicationButtonVisible() && !alertTypeActive(), click:toggleScheduleOptions">\n                 <span data-bind="text: scheduleButtonText" ></span>\n            </div>\n            <div style="margin-right: 5px;" data-bind="visible: scheduledSendActive()"  class="input-append pull-right">\n                    <input style="width:70px;margin-bottom:0px;" data-bind="datepicker: scheduleDate, datepickerOptions: { minDate : 0 }">\n                    <span class="add-on" style="margin-left:-5px;"><i class="fa fa-calendar"></i></span>\n                    <input type="text" class="time ui-timepicker-input" style="width:53px;" autocomplete="off" data-bind="timePicker: {observable: scheduleTime, step:5, scrollDefaultNow: true, disableTextInput: true}">\n                    <span class="add-on" style="margin-left:-5px;"><i class="fa fa-clock-o"></i></span>\n            </div>\n            <div data-bind="visible: noteTypeActive()" class="btn btn-default btn-small fileinput-button">\n                <i style="font-size: 14px; margin-right: 4px;" class="fa fa-paperclip"></i>\n                <span>add PDF</span>\n                <input type="file" name="attachment" accept="application/pdf" multiple/>\n            </div>\n        </form>\n    </div>\n</div>\n'}),tadpoles.define("text!view/curriculaMetrics.html",[],function(){return'<!-- ko if:$data -->\n<div data-bind="visible:assessmentMetricsForCurricula() && assessmentMetricsForCurricula().length > 0">\n    <div>\n        <h2 class="pull-left" style="color: gray;">choose a curriculum</h2>\n    </div>\n    <div class="clearfix"></div>\n\n\n    <div>\n\n        <div class="tile pointable" style="background-color: rgb(219, 219, 219); float: left; position: relative; width: 80px; height: 80px; margin-top:2px; margin-right: 2px;" data-bind="click: function() { selectCurriculum(null);}, visible:assessmentMetricsForCurricula().length > 1 ">\n\n            <div style="height:100%">\n                <div style="height:75%;">\n                    <div style="position:relative;width:100%;height:100%">\n                        <div class="valign" style="height:100%">\n                            <div class="center">\n                                <div class="metric">\n                                    <span class="stat-medium stat-ok" data-bind="text:ratingCount()"></span>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="valign" style="height:25%">\n                <div class="center mask footer note mask">\n                    <span>All</span>\n                </div>\n                </div>\n\n                <div class="fill inside-border tile-menu-border" data-bind="visible: !activeCurriculumId()"></div>\n            </div>\n        </div>\n\n        <ul class="float-left" data-bind="tiles: { bricks: assessmentMetricsForCurricula(), template:\'view/tiles/curriculumTile\', tileSize:80, groutWidth: 4 }"></ul>\n    </div>\n    <div class="pull-left" style="margin: 8px 8px 0px 0px;line-height:1">\n        Showing number of outcomes for each curriculum.\n    </div>\n</div>\n<!-- /ko -->'}),tadpoles.define("text!view/dailyReport.html",[],function(){return'<!-- ko if: $data -->\n\n\n<!-- ko if: themes().length > 0  || (isEditable() && !isPrinting()) -->\n<div style="text-align:center;margin-bottom:10px;margin-top:10px;">\n    <ul class="unstyled dr-entries">\n        <!-- ko if: themes().length === 0 -->\n        <li class="editable dr-add" data-bind="visible:canEditTheme() && !isPrinting(),click: editTheme.bind($data,null)">\n            <h3><i class="fa fa-edit" style="margin-right:5px;"></i>set the weekly theme...</h3>\n        </li>\n        <!-- /ko -->\n        <!-- ko if: themes().length > 0 -->\n        <li data-bind="css: { editable : canEditTheme(), pointable : canEditTheme() }, click: canEditTheme() ? editTheme.bind($data, themes()[0]) : null">\n        <h3 style="color:#333;font-size:22px;font-weight:200"><i class="fa fa-edit" style="margin-right:5px;"></i>The weekly theme is <span data-bind="text: themes()[0].name"></span></h3>\n        <!-- /ko -->\n    </ul>\n</div>\n<!-- /ko -->\n<!-- ko if: pleaseBrings().length > 0 || notes().length > 0  || (isEditable() && !isPrinting())-->\n<div class="alert alert-block alert-info" style="padding-right:14px;margin-bottom:0px">\n    <h3 class="alert-heading">Notes:</h3>\n    <div>\n        <ul class="unstyled dr-entries">\n            <li class="editable dr-add" data-bind="visible:isEditable() && !isPrinting() && !($root.config.isParentApp && notes().length > 0),click: editNote.bind($data,null)">\n                <i class="fa fa-edit"></i>add note...\n            </li>\n            <!-- ko foreach: notes -->\n            <li style="margin-bottom:10px;" data-bind="css: { parentnote: parent, editable : editable && $parent.isEditable(), pointable : editable && $parent.isEditable() }, click: editable && $parent.isEditable() ? $parent.editNote.bind($parent, $data) : null">\n                <div>\n                    <div style="width:100%">\n                        <i class="fa fa-edit"></i>\n                        <span class="dr-note" data-bind="text: getNote()"></span>\n                    </div>\n                    <!-- ko if: parent -->\n                    <div>\n                        <div class="parent-marker">parent</div>\n                    </div>\n                    <!-- /ko -->\n                </div>\n            </li>\n            <!-- /ko -->\n        </ul>\n    </div>\n    <!-- ko if: pleaseBrings().length > 0  -->\n    Please bring in the following items:\n    <br/>\n    <ul data-bind="foreach: pleaseBrings">\n        <li>\n            <span data-bind="text: $data"></span>\n        </li>\n    </ul>\n    <!-- /ko -->\n</div>\n<!-- /ko -->\n<!-- ko if: feelings().length > 0 -->\n\n<h3 style="text-align:center;margin-top:5px;">"Today I felt <span data-bind="text: getFeelingsText()"></span>."</h3>\n\n<!-- /ko -->\n<!-- ko if: naps().length > 0 || ((!$root.config.isParentApp || (stage === \'infant\' || stage === \'toddler\')) && isEditable() && !isPrinting() && !isLessonPlan())-->\n<h2 style="color:#0772A1;" data-bind="text: $root.product.translate(\'naps\', \'naps/sleep\'), style: { color : $root.brand.getBrandColor(\'naps_color\') }"></h2>\n<ul class="unstyled dr-entries">\n    <li class="editable dr-add" data-bind="visible:isEditable() && !isPrinting() && (!$root.config.isParentApp || naps().length == 0),click: editNap.bind($data,null)">\n        <i class="fa fa-edit"></i><!-- ko if: $root.config.isParentApp-->add nap/sleep...<!--/ko--><!-- ko if: !$root.config.isParentApp-->add nap...<!--/ko-->\n    </li>\n    <!-- ko foreach: naps -->\n        <li style="white-space:nowrap;margin-bottom:2px" data-bind="css: { parent: parent, editable : editable && $parent.isEditable(), pointable : editable && $parent.isEditable() }, click: editable && $parent.isEditable() ? $parent.editNap.bind($parent, $data) : null">\n            <div>\n                <div style="width:100%">\n                    <div style="display:inline-block">\n                        <span class="dr-primary" style="vertical-align:middle;" data-bind="text: getPrimary()"></span>\n                    </div>\n                    <!-- ko if: getNote() -->\n                    <div style="margin-left:20px;">\n                        <span class="dr-note" data-bind="text: getNote()"></span>\n                    </div>\n                    <!-- /ko -->\n                    <!-- ko if: getEditors() -->\n                    <div style="margin-left:0px;">\n                        <span class="dr-editors" data-bind="text: getEditors()"></span>\n                    </div>\n                    <!-- /ko -->\n                    <!-- ko if: $data.checks && !$parent.isPrinting()-->\n                    <div style="margin-left:20px;">\n                        <i class="fa fa-thumbs-o-up" style="vertical-align:middle"></i>\n                        <ul class="unstyled" style="display:inline-block;vertical-align:middle;">\n                            <!-- ko foreach: $data.getCheckDisplayData() -->\n                            <li class="pull-left" style="margin-left:3px;" data-bind="tooltip: $data.tooltip">\n                                <span class="check" data-bind="text:$data.check, css: $data.css"></span>\n                            </li>\n                            <!-- /ko -->\n                        </ul>\n                        <div class="clearfix"></div>\n                    </div>\n                    <!-- /ko -->\n                </div>\n\n                <!-- ko if: parent -->\n                <div>\n                    <div class="parent-marker">parent</div>\n                </div>\n                <!-- /ko -->\n\n            </div>\n        </li>\n    <!-- /ko -->\n</ul>\n<!-- /ko -->\n<!-- ko if: food_drops().length > 0 || (($root.config.isParentApp && (stage === \'infant\' || stage === \'toddler\')) && isEditable() && !isPrinting()) -->\n<h2 style="color:#00C322;" data-bind="text: $root.product.translate(\'food provided\'), style: { color : $root.brand.getBrandColor(\'meals_color\') }"></h2>\n<ul class="unstyled dr-entries">\n    <li class="editable dr-add" data-bind="visible:isEditable() && !isPrinting() && food_drops().length == 0, click: editFoodDrop.bind($data,null)">\n        <i class="fa fa-edit"></i>add food provided...\n    </li>\n    <!-- ko foreach: food_drops() -->\n    <li data-bind="css: { parent: parent, editable : editable && $parent.isEditable(), pointable : editable && $parent.isEditable() }, click: editable && $parent.isEditable() ? $parent.editMeal.bind($parent, $data) : null">\n        <div>\n            <div style="width:100%">\n                <i class="fa fa-edit"></i>\n                <span class="dr-primary" data-bind="text: getPrimary()"></span>\n                <span class="dr-note" data-bind="text: getNote()"></span>\n                <br/>\n                <!-- ko if: editors -->\n                <div>\n                    <span class="dr-editors" data-bind="text: getEditors()"></span>\n                </div>\n                <!-- /ko -->\n            </div>\n            <!-- ko if: getActor() -->\n                <div>\n                    <div class="dr-actor" data-bind="text: getActor()"></div>\n                </div>\n            <!-- /ko -->\n            <!-- ko if: parent -->\n            <div>\n                <div class="parent-marker">parent</div>\n            </div>\n            <!-- /ko -->\n        </div>\n    </li>\n    <!-- /ko -->\n</ul>\n<!-- /ko -->\n<!-- ko if: meals().length > 0 || ((!$root.config.isParentApp || (stage === \'infant\' || stage === \'toddler\')) && isEditable() && !isPrinting()) -->\n<h2 style="color:#00C322;" data-bind="text: $root.product.translate(\'meals\'), style: { color : $root.brand.getBrandColor(\'meals_color\') }"></h2>\n<ul class="unstyled dr-entries">\n    <li class="editable dr-add" data-bind="visible:isEditable() && !isPrinting(),click: editMeal.bind($data,null)">\n        <i class="fa fa-edit"></i>add meal...\n    </li>\n    <!-- ko foreach: meals() -->\n    <li data-bind="css: { parent: parent, editable : editable && $parent.isEditable(), pointable : editable && $parent.isEditable() }, click: editable && $parent.isEditable() ? $parent.editMeal.bind($parent, $data) : null">\n        <div>\n            <div style="width:100%">\n                <i class="fa fa-edit"></i>\n                <span class="dr-primary" data-bind="text: getPrimary()"></span>\n                <span class="dr-note" data-bind="text: getNote()"></span>\n                <br/>\n                <!-- ko if: editors -->\n                <div>\n                    <span class="dr-editors" data-bind="text: getEditors()"></span>\n                </div>\n                <!-- /ko -->\n            </div>\n            <!-- ko if: getActor() -->\n                <div>\n                    <div class="dr-actor" data-bind="text: getActor()"></div>\n                </div>\n            <!-- /ko -->\n            <!-- ko if: parent -->\n            <div>\n                <div class="parent-marker">parent</div>\n            </div>\n            <!-- /ko -->\n        </div>\n    </li>\n    <!-- /ko -->\n</ul>\n<!-- /ko -->\n<!-- ko if: diapers().length > 0 || ((stage === \'infant\' || stage === \'toddler\') && isEditable() && !isPrinting() && !isLessonPlan())-->\n<h2 style="color:#964241;" data-bind="style: { color : $root.brand.getBrandColor(\'bathroom_color\') }">diapers</h2>\n<ul class="unstyled dr-entries">\n    <li class="editable dr-add" data-bind="visible:isEditable() && !isPrinting(),click: editDiaper.bind($data,null)">\n        <i class="fa fa-edit"></i>add diaper...\n    </li>\n    <!-- ko foreach: diapers() -->\n    <li data-bind="css: { parent: parent, editable : editable && $parent.isEditable(), pointable : editable && $parent.isEditable() }, click: editable && $parent.isEditable() ? $parent.editDiaper.bind($parent, $data) : null">\n        <div>\n            <div style="width:100%">\n                <span class="dr-primary" data-bind="text: getPrimary()"></span>\n                <span class="dr-note" data-bind="text: getNote()"></span>\n                <!-- ko if: editors -->\n                <div>\n                    <span class="dr-editors" data-bind="text: getEditors()"></span>\n                </div>\n                <!-- /ko -->\n            </div>\n            <!-- ko if: getActor() -->\n                <div>\n                    <div class="dr-actor" data-bind="text: getActor()"></div>\n                </div>\n            <!-- /ko -->\n            <!-- ko if: parent -->\n            <div>\n                <div class="parent-marker">parent</div>\n            </div>\n            <!-- /ko -->\n        </div>\n    </li>\n    <!-- /ko -->\n</ul>\n<!-- /ko -->\n\n<!-- ko if: bathrooms().length > 0 || ((!$root.config.isParentApp || (stage === \'infant\' || stage === \'toddler\')) && isEditable() && !isPrinting() && !isLessonPlan())-->\n<h2 style="color:#964241;" data-bind="style: { color : $root.brand.getBrandColor(\'bathroom_color\') }">bathroom</h2>\n<ul class="unstyled dr-entries">\n    <li class="editable dr-add" data-bind="visible:isEditable() && !isPrinting(),click: editPotty.bind($data,null)">\n        <i class="fa fa-edit"></i>add bathroom...\n    </li>\n    <!-- ko foreach: bathrooms() -->\n    <li data-bind="css: { parent: parent, editable : editable && $parent.isEditable(), pointable : editable && $parent.isEditable() }, click: editable && $parent.isEditable() ? $parent.editPotty.bind($parent, $data) : null">\n        <div>\n            <div style="width:100%">\n                <span class="dr-primary" data-bind="text: getPrimary()"></span>\n                <span class="dr-note" data-bind="text: getNote()"></span>\n                <!-- ko if: editors -->\n                <div>\n                    <span class="dr-editors" data-bind="text: getEditors()"></span>\n                </div>\n                <!-- /ko -->\n            </div>\n            <!-- ko if: getActor() -->\n                <div>\n                    <div class="dr-actor" data-bind="text: getActor()"></div>\n                </div>\n            <!-- /ko -->\n            <!-- ko if: parent -->\n            <div>\n                <div class="parent-marker">parent</div>\n            </div>\n            <!-- /ko -->\n        </div>\n    </li>\n    <!-- /ko -->\n</ul>\n<!-- /ko -->\n<!-- ko if: meds().length > 0 -->\n<h2 style="color:#f00" data-bind="style: { color : $root.brand.getBrandColor(\'meds_color\') }">medications</h2>\n<ul class="unstyled dr-entries" data-bind="foreach: meds">\n    <li>\n        <span class="dr-primary" data-bind="text: getPrimary()"></span>\n        <span class="dr-note" data-bind="text: getNote()"></span>\n        <!-- ko if: getActor() -->\n            <span class="dr-actor" data-bind="text: getActor()" style="float:right;"></span>\n        <!-- /ko -->\n        <!-- ko if: editors -->\n        <div>\n            <span class="dr-editors" data-bind="text: getEditors()"></span>\n        </div>\n        <!-- /ko -->\n    </li>\n</ul>\n<!-- /ko -->\n<!-- ko if: activities().length > 0 || (canEditEntryType(\'activity\') && !isPrinting()) -->\n<div>\n    <h2 style="color:#ff9312;" data-bind="style: { color : $root.brand.getBrandColor(\'activities_color\') }">activities</h2>\n</div>\n<ul class="unstyled dr-entries">\n    <!-- ko if: $root.config.isProviderApp -->\n    <li class="editable dr-add" data-bind="visible:canEditEntryType(\'activity\') && !isPrinting(),click: editActivity.bind($data,null)">\n        <i class="fa fa-edit"></i>add activity...\n    </li>\n    <!-- /ko -->\n    <!-- ko foreach: activities() -->\n    <li>\n        <table cellpadding="0" cellspacing="0">\n            <tr>\n                <td style="vertical-align:top;width:100%" data-bind="css: { editable : $parent.canEditEntryType(\'activity\'), pointable : $parent.canEditEntryType(\'activity\') }, click: $parent.canEditEntryType(\'activity\') ? $parent.editActivity.bind($parent, $data) : null">\n                    <i class="fa fa-edit"></i>\n                    <span class="dr-activity-primary" data-bind="text: getPrimary()"></span>\n                    <span class="dr-activity-note" data-bind="text: getNote()"></span>\n                    <!-- ko if: getActor() -->\n                    <span class="dr-actor" data-bind="text: getActor()"></span>\n                    <!-- /ko -->\n                    <div class="dr-lesson-detail" data-bind="visible: hasLessonDetails($parent)">\n                        <!-- ko if: c_goals && c_goals.length > 0 && c_goal_labels-->\n                        <div>\n                            <span class="dr-activity-primary">Curricular Goals</span> -\n                            <!-- ko foreach: getGoals() -->\n                            <span class="dr-activity-note" data-bind="text: $index() > 0 ? \', \' + displayText() : displayText(), tooltip: hierarchyText()"></span>\n                            <!-- /ko -->\n                        </div>\n                        <!-- /ko -->\n                        <!-- ko if: $root.config.isProviderApp && $parent.subject_type !== \'individual\' -->\n                        <div data-bind="visible: (members && members.length > 0)">\n                            <span class="dr-activity-primary">Children</span> -\n                            <span class="dr-activity-note" data-bind="text: getMemberNames()"></span>\n                        </div>\n                        <!-- /ko -->\n                        <!-- ko if: $parent.type_name === \'lesson_plan\' -->\n                        <div data-bind="visible: goals">\n                            <span class="dr-activity-primary">Curricular Notes</span> -\n                            <span class="dr-activity-note" data-bind="text: goals"></span>\n                        </div>\n                        <div data-bind="visible: materials">\n                            <span class="dr-activity-primary">Materials</span> -\n                            <span class="dr-activity-note" data-bind="text: materials"></span>\n                        </div>\n                        <div data-bind="visible: (options && options.length > 0)">\n                            <span class="dr-activity-primary">Options</span> -\n                            <span class="dr-activity-note" data-bind="text: options"></span>\n                        </div>\n                        <!-- /ko -->\n                    </div>\n\n                    <!-- ko if: editors -->\n                    <div>\n                        <span class="dr-editors" data-bind="text: getEditors()"></span>\n                    </div>\n                    <!-- /ko -->\n                </td>\n                <td style="vertical-align:top">\n                    <!-- ko if: attachment() -->\n                    <div style="margin-left:15px" data-bind="template: {name: \'view/tiles/snapshotTile\'}"></div>\n                    <!-- /ko -->\n                </td>\n            </tr>\n        </table>\n\n    </li>\n    <!-- /ko -->\n</ul>\n<!-- /ko -->\n<!-- ko if: snapshots().length > 0 -->\n<h2 style="color:#534d96;" data-bind="style: { color : $root.brand.getBrandColor(\'snapshots_color\') }">snapshots</h2>\n<ul class="unstyled" data-bind="foreach: snapshots">\n    <li style="margin-bottom:3px;">\n        <table cellpadding="0" cellspacing="0">\n            <tr>\n                <td style="vertical-align:top">\n                    <div data-bind="template: {name: \'view/tiles/snapshotTile\'}"></div>\n                </td>\n                <td style="vertical-align:top">\n                    <div style="margin-left:15px;">\n                        <span class="dr-activity-primary" data-bind="text: getPrimary()"></span>\n                        <span class="dr-note" data-bind="text: getNote()"></span>\n                    </div>\n                </td>\n            </tr>\n        </table>\n    </li>\n</ul>\n<!-- /ko -->\n\n<!-- /ko -->\n'}),tadpoles.define("text!view/dailyReportDetail.html",[],function(){return'<!-- ko if: !$data -->\n<div class="thumbnail-panel2">\n    <h2 class="panel-title"><span class="stat-ok stat-medium" data-bind=""></span><span style="text-transform:lowercase;" data-bind="text: $root.product.translate(\'daily report\')"></span></h2>\n\n    <div class="centered">\n        <h1 class="empty-text" style="text-transform:lowercase;" data-bind="text: \'no \' + $root.product.translate(\'daily report\') + \' chosen\'"></h1>\n    </div>\n</div>\n<!-- /ko -->\n<!-- ko if: $data -->\n<!-- ko if: $root.currentUser.isAdmin() && action_history().rejections().length > 0 -->\n<div class="thumbnail-panel2" style="padding-left:8px;padding-right:8px;border:2px dashed #da4f49;margin:0px 0px 5px 0px;min-height:inherit" data-bind="visible:action_history().rejections().length > 0">\n    <div class="action-history">\n        <div class="pull-right" data-bind="visible: action_history().spamActors().length > 0">\n            <button class="btn btn-success btn-mini" style="margin-left:5px;" data-bind="click:$root._.bind(unblockEmailsAndResend, null, action_history().spamActors())">\n                Unblock and Resend\n            </button>\n        </div>\n        <h2 class="panel-title">delivery errors</h2>\n        <table style="width:100%">\n            <thead>\n            <tr>\n                <th>email</th>\n                <th>reason</th>\n            </tr>\n            </thead>\n            <tbody>\n            <!-- ko foreach: action_history().rejections() -->\n            <tr>\n                <td style="width:50%">\n                    <span style="color:#49AFCD;" data-bind="text:actor"></span>\n                </td>\n                <td style="width:50%">\n                    <span data-bind="text: action === \'spam\' ? \'marked as spam\' : \'unable to send email\'"></span>\n                </td>\n            </tr>\n            <!-- /ko -->\n            </tbody>\n        </table>\n    </div>\n</div>\n<!-- /ko -->\n<div data-bind="css:{\'thumbnail-panel2\':$root.config.isProviderApp}">\n    <!-- ko if: $root.config.isProviderApp -->\n    <div class="pull-right">\n        <button class="btn btn-success btn-mini" style="margin-left:5px;" data-bind="click:print">\n            Print Report\n        </button>\n    </div>\n    <!-- ko if: $root.product.hasFeature($root.product.Features.CUSTOM_DAILY_REPORT) -->\n    <div class="pull-right">\n        <button class="btn btn-warning btn-mini" style="margin-left:5px;"data-bind="click:printCustom, visible: isGroupReport()">\n            Preview WITW\n        </button>\n    </div>\n    <!-- /ko -->\n    <div class="pull-right">\n        <button class="btn btn-danger btn-mini" style="margin-left:5px;"data-bind="click:audit, visible: $data.key && $root.currentUser.isCsr()">\n            Audit Report\n        </button>\n    </div>\n    <div class="pull-right">\n        <button class="btn btn-danger btn-mini" style="margin-left:5px;"data-bind="click:republish, visible: canResend()">\n            Resend Report\n        </button>\n        <button class="btn btn-danger btn-mini" style="margin-left:5px;"data-bind="click:publish, visible: canPublish() && isIndividualReport()">\n            Send Report\n        </button>\n    </div>\n    <!-- /ko -->\n\n    <div id="dr-printable">\n        <div style="position:relative;margin-top:21px;" data-bind="popover: getPopoverParams()">\n        <h2 class="panel-title ellipsis" style="padding-bottom:0;width:447px;">\n            <span class="stat-ok stat-medium" data-bind=""></span><span style="text-transform:lowercase;" data-bind="text: $root.product.translate(\'daily report\')"></span>&nbsp;for&nbsp;<span class="stat-ok" data-bind="text:getName()"></span></h2>\n\n        <h2 class="panel-title"><!-- ko if: realDate.format(\'isoDate\') === new Date().format(\'isoDate\') -->for\n            <span class="stat-warn">today</span><!-- /ko -->\n            <!-- ko if: realDate.format(\'isoDate\') !== new Date().format(\'isoDate\') --> on\n            <span class="stat-warn" data-bind="text:realDate.format(\'tinyDate\')"></span><!-- /ko --></h2>\n        </div>\n\n        <div class="centered" data-bind="visible: entries().length === 0 && !isEditable()">\n            <h1 class="empty-text">no entries</h1>\n        </div>\n\n        <div data-bind="template: {name: \'view/dailyReport\'}"></div>\n    </div>\n\n</div>\n<!-- ko if:$root.currentUser.isAdmin() && $root.config.isProviderApp -->\n<div class="thumbnail-panel2" style="margin:5px 0px 10px 0px;min-height:inherit" data-bind="visible:action_history().entries().length > 0">\n    <div class="action-history">\n\n        <h2 class="panel-title">delivery history</h2>\n        <table style="width:100%">\n            <thead>\n            <tr>\n                <th class="time">time</th>\n                <th>action</th>\n            </tr>\n            </thead>\n            <tbody>\n            <!-- ko foreach: action_history().entries() -->\n            <tr data-bind="css: { error : $parent.action_history().isError($data) }">\n                <td class="time">\n                    <div>\n                        <span data-bind="text:new Date(action_timestamp).format(\'m/d h:MM TT\')"></span>\n                    </div>\n                </td>\n                <td>\n                    <span data-bind="text:$parent.action_history().getEntryPrefix($data)"></span><span style="color:#49AFCD;" data-bind="text:actor"></span><span data-bind="text:$parent.action_history().getEntryPostfix($data)"></span>\n                </td>\n            </tr>\n            <!-- /ko -->\n            </tbody>\n        </table>\n    </div>\n</div>\n<!-- /ko -->\n<!-- /ko -->'}),tadpoles.define("text!view/dailyReports.html",[],function(){return'<div>\n    <h2 class="panel-title" ><span class="stat-ok stat-medium" data-bind=""></span>choose a child</h2>\n    <div data-bind="visible: processing(), spin: {trigger:processing(), color: \'#000\', top:20, left:190}"></div>\n    <div data-bind="visible: !processing()">\n        <ul style="width:447px;" data-bind="delegatedHandler: \'click\', tiles: { bricks: $root.childs.childrenForCurrentGroupOnDailyReport(), template:\'view/tiles/dailyReportStudentTile\', numCols:5, groutWidth: 4 }"></ul>\n    </div>\n</div>'}),tadpoles.define("text!view/dashboard.html",[],function(){return'<div>\n    <div class="alert alert-block alert-danger" data-bind="visible: maintenance()">\n         <h4 class="alert-heading">Maintenance Alert!</h4>\n        Tadpoles is under maintenance.  You can still view all of your data but you will not be able to make any changes until the maintenance period is over\n    </div>\n    <div class="alert alert-block alert-danger" data-bind="visible: !realtime()">\n         <h4 class="alert-heading">Offline Alert!</h4>\n        Your browser couldn\'t make a real-time connection to Tadpoles.  Attendance and other updates will not be shown in real-time.\n    </div>\n    <div id="title-bar" class="row sub-nav-bar" style="margin-bottom:10px;">\n        <!-- ko if: $root.brand.getBrandImageUrl(\'main-logo\') -->\n        <div class="main-logo-container pull-left">\n            <img class="main-logo" data-bind="attr: { src : $root.brand.getBrandImageUrl(\'main-logo\') }"/>\n        </div>\n        <!-- /ko -->\n        <div class="pull-left" style="position:relative;height:60px;margin-left:20px;" >\n            <div data-bind="template: {name: \'view/breadcrumb\'}"></div>\n        </div>\n        <div style="clear:both;"></div>\n    </div>\n    <div style="text-align: center; padding-top: 90px;" data-bind="visible: isLocationSelected() === false" >\n        <h1 style="color: gray; font-size: 110px; line-height: 130px;">let\'s get started!</h1>\n        <h1 style="color: #49AFCD; font-size: 75px; line-height: 75px;">select a location</h1>\n    </div>\n    <div data-bind="fadeVisible: isLocationSelected()" class="hide">\n        <div class="row">\n            <div style="margin-left:20px;margin-bottom:5px;">\n                <div class="pull-left">\n                    <ul class="nav nav-pills nav-tight-pills" style="margin-bottom:0px;">\n                        <!-- ko if:$root.currentUser.isAdmin() -->\n                        <li data-bind="css: { \'active\' : $root.detailViewPanel.attendanceDetailsActive() }">\n                            <a href="#" class="dash top-tab" data-bind="click: $root.detailViewPanel.chooseAttendanceDetails"><h3 style="line-height:1">attendance</h3></a>\n                        </li>\n                        <li data-bind="css: { \'active\' : $root.detailViewPanel.observationsActive() }">\n                            <a href="#" class="dash top-tab" data-bind="click: $root.detailViewPanel.chooseObservations"><h3 style="line-height:1">photos & videos <span style="vertical-align: middle;" class="badge" data-bind="visible:outbox.eventsForCurrentClass().length>0, text:outbox.eventsForCurrentClass().length"></span></h3></a>\n                        </li>\n                        <!-- /ko -->\n                        <li data-bind="css: { \'active\' : $root.detailViewPanel.lessonsActive() }">\n                            <a href="#" class="dash top-tab" data-bind="click: $root.detailViewPanel.chooseLessons"><h3 style="line-height:1">lesson plans</h3></a>\n                        </li>\n\n                        <li data-bind="css: { \'active\' : $root.detailViewPanel.dailyReportsActive() }">\n                            <a href="#" class="dash top-tab" data-bind="click: $root.detailViewPanel.chooseDailyReports"><h3 style="line-height:1;text-transform:lowercase;"> <span data-bind="text: $root.product.translate(\'daily report\') + \'s\'"></span> <span style="vertical-align: middle;" class="badge" data-bind="visible:reports.parentReportCount()>0 && ($root.currentUser.isAdmin() || $root.currentUser.isCsr()), text:reports.parentReportCount()"></span></h3></a>\n                        </li>\n\n                        <li data-bind="css: { \'active\' : $root.detailViewPanel.portfolioActive() }">\n                            <a href="#" class="dash top-tab" data-bind="click: $root.detailViewPanel.choosePortfolio"><h3 style="line-height:1">portfolio</h3></a>\n                        </li>\n                        <!-- ko if:$root.currentUser.isAdmin() -->\n                        <li data-bind="css: { \'active\' : $root.detailViewPanel.communicationsActive() }" >\n                            <a href="#" class="dash top-tab" data-bind="click: $root.detailViewPanel.chooseCommunications"><h3 style="line-height:1">notes & alerts</h3></a>\n                        </li>\n                        <li data-bind="css: { \'active\' : $root.detailViewPanel.rosterActive() }" >\n                            <a href="#" class="dash top-tab" data-bind="click: $root.detailViewPanel.chooseRoster"><h3 style="line-height:1">pipeline</h3></a>\n                        </li>\n                        <!-- /ko -->\n                        <!-- ko if: $root.detailViewPanel.metricsEnabled() -->\n                        <li data-bind="css: { \'active\' : $root.detailViewPanel.metricsActive() }" >\n                            <a href="#" class="dash top-tab" data-bind="click: $root.detailViewPanel.chooseMetrics"><h3 style="line-height:1">metrics</h3></a>\n                        </li>\n                        <!-- /ko -->\n                    </ul>\n                </div>\n\n                <div class="clearfix"></div>\n            </div>\n\n        </div>\n        <!-- ko if: false && $root.detailViewPanel.metricsActive() -->\n\n            <div style="display: inline-block; width: 898px; padding: 15px 20px;margin-bottom:8px;" data-bind="fadeVisible: isLocationSelected()" class="well hide">\n                <div class="pull-left" data-bind="template: { name : \'view/classroomSelector\'}"></div>\n            </div>\n        <!-- /ko -->\n        <!-- ko if: !$root.detailViewPanel.metricsActive() -->\n         <div style="display: inline-block; width: 898px; padding: 15px 20px;margin-bottom:8px;" data-bind="fadeVisible: isLocationSelected()" class="well hide">\n            <div class="pull-left" data-bind="template: { name : \'view/rosterOptions\'}, visible: $root.detailViewPanel.rosterActive()"></div>\n            <!-- ko if:$root.detailViewPanel.rosterActive() -->\n            <div class="pull-left" data-bind="template: { name : \'view/classroomSelector\'}"></div>\n            <!-- /ko -->\n            <!-- ko if:!$root.detailViewPanel.rosterActive() && !($root.isCurriculaMetricAccountGroupMaster() && $root.detailViewPanel.portfolioActive())-->\n            <div class="pull-left" data-bind="template: { name : \'view/classroomMetrics\'}"></div>\n            <!-- /ko -->\n            <!-- ko if:$root.isCurriculaMetricAccountGroupMaster() && $root.detailViewPanel.portfolioActive() -->\n            <div style="width: 550px;" class="pull-left" data-bind="template: { name : \'view/curriculaMetrics\', data : $root.observationMetrics}"></div>\n            <!-- /ko -->\n            <div style="width: 270px; display: inline-block; float: right;" data-bind="visible: $root.detailViewPanel.attendanceDetailsActive()">\n                <h2 class="pull-right" style="color:gray;"><span data-bind="visible: !filter.groupSelected()">center</span><span data-bind="visible: filter.groupSelected()">class</span> stats</h2>\n                <div class="clearfix"></div>\n                <div class="pull-right" data-bind="template: {name: \'view/stat_tiles\', afterRender: setupStats}"></div>\n                <div style="margin-bottom: 15px; height: 20px; padding:3px 0px 3px 0px;">\n                    <div class="pull-right" style="padding: 4px 0px 8px 8px;">\n                        Hover over stats for more details.\n                    </div>\n                </div>\n            </div>\n\n            <div style="width: 340px; display: inline-block; float: right;" data-bind="visible: $root.detailViewPanel.portfolioActive() && $root.observationMetrics.activeCurriculumName() && $root.observationMetrics.isPortfolioProgressView()">\n                <h2 class="pull-right" style="color:gray;"><span>center assessments</span></h2>\n                <div class="clearfix"></div>\n                <div class="pull-right" data-bind="template: {name: \'view/portfolioStatTiles\', data: $root.observationMetrics}"></div>\n                <div style="margin-bottom: 15px; height: 20px; padding:3px 0px 3px 0px;">\n                    <div class="pull-right" style="padding: 4px 0px 8px 8px;">\n                        Showing stats for <span data-bind="text: $root.observationMetrics.activeCurriculumName()"></span>\n                    </div>\n                </div>\n            </div>\n\n            <div class="clearfix"></div>\n        </div>\n\n        <div style="display: inline-block; width: 100%;height:47px;text-align:center;position:relative" data-bind="visible: isLocationSelected() && !detailViewPanel.lessonsActive() " >\n             <div class="btn-group" style="margin: 0; position:absolute; top:0px;left:0px;" data-bind="visible: isLocationSelected() && $root.detailViewPanel.attendanceDetailsActive()">\n                <ul class="nav nav-pills pull-right" style="margin-bottom:0px;">\n                    <li data-bind="css: { \'active\' : detailViewPanel.allActive() }, visible: !$root.detailViewPanel.rosterActive()">\n                        <a href="#" class="dash" data-bind="click: $root.detailViewPanel.chooseAll"><h4 style="line-height:1">combined</h4></a>\n                    </li>\n                    <li data-bind="css: { \'active\' : detailViewPanel.studentsActive() }" >\n                        <a href="#" class="dash" data-bind="click: $root.detailViewPanel.chooseStudents"><h4 style="line-height:1">students</h4></a>\n                    </li>\n                    <li data-bind="css: { \'active\' : detailViewPanel.staffActive() }">\n                        <a href="#" class="dash" data-bind="click: $root.detailViewPanel.chooseStaff"><h4 style="line-height:1">staff</h4></a>\n                    </li>\n\n                </ul>\n            </div>\n\n            <!-- ko if:$root.currentUser.isCsr() || $root.hasRosterForecaster()-->\n             <div class="btn-group" style="margin: 0; position:absolute; top:0px;left:0px;" data-bind="visible: isLocationSelected() && $root.detailViewPanel.rosterActive()">\n                <ul class="nav nav-pills pull-right" style="margin-bottom:0px;">\n                    <li id="leadActive" class="active" data-bind="css: {\'active\':!$root.rosterForecaster.forecastActive()}">\n                        <a href="#" class="dash" data-bind="click: $root.rosterForecaster.setLeadsActive"><h4 style="line-height:1">leads</h4></a>\n                    </li>\n                    <li id="forecastActive" data-bind="css: {\'active\':$root.rosterForecaster.forecastActive()}">\n                        <a href="#" class="dash" data-bind="click: $root.rosterForecaster.setForecastActive"><h4 style="line-height:1">forecast</h4></a>\n                    </li>\n                </ul>\n             </div>\n             <!-- /ko -->\n\n\n             <div class="btn-group" style="margin: 0; position:absolute; top:0px;left:0px;" data-bind="visible: isLocationSelected() && $root.detailViewPanel.portfolioActive() && $root.observationMetrics.customCurriculaPeriodsActive()">\n                <ul class="nav nav-pills pull-right" style="margin-bottom:0px;">\n                    <li data-bind="css: { \'active\' : observationMetrics.isPortfolioIndividualView() }, visible: !$root.detailViewPanel.rosterActive() && !$root.isCurriculaMetricAccountGroupMaster()">\n                        <a href="#" class="dash" data-bind="click: $root.observationMetrics.chooseIndividialView"><h4 style="line-height:1">individual</h4></a>\n                    </li>\n                    <!-- ko if:$root.currentUser.isAdmin() -->\n                    <li data-bind="css: { \'active\' : observationMetrics.isPortfolioProgressView() }" >\n                        <a href="#" class="dash" data-bind="click: $root.observationMetrics.chooseProgressView"><h4 style="line-height:1">progress</h4></a>\n                    </li>\n                    <!-- /ko -->\n                    <!-- ko if:$root.currentUser.isAdmin() && $root.isCurriculaMetricAccountGroupMaster()  -->\n                    <li data-bind="css: { \'active\' : observationMetrics.isPortfolioParticipationView() }" >\n                        <a href="#" class="dash" data-bind="click: $root.observationMetrics.chooseParticipationView"><h4 style="line-height:1">participation</h4></a>\n                    </li>\n                    <!-- /ko -->\n                    <!-- ko if:$root.currentUser.isAdmin() && !$root.isCurriculaMetricAccountGroupMaster() -->\n                    <li data-bind="css: { \'active\' : observationMetrics.isPortfolioGrowthView() }, visible: $root.observationMetrics.hasPeriods() && $root.observationMetrics.curriculumPeriods().length > 1 && !$root.isCurriculaMetricAccountGroupMaster()">\n                        <a href="#" class="dash" data-bind="click: $root.observationMetrics.chooseGrowthView"><h4 style="line-height:1">growth</h4></a>\n                    </li>\n                    <!-- /ko -->\n\n                </ul>\n            </div>\n\n            <div style="position:absolute;top:0px;right:0px;">\n                <!-- ko if:$root.currentUser.isAdmin() || $root.atFacility -->\n                <div class="input-append" style="margin-bottom:0px;margin-top:4px;" data-bind="visible: !detailViewPanel.lessonsActive() && !detailViewPanel.rosterActive() && !$root.detailViewPanel.metricsActive() && !$root.detailViewPanel.portfolioActive() && !$root.rosterForecaster.forecastActive()">\n                    <input style="width:70px;margin-bottom:0px;" data-bind="datepicker: $root.filter.date, datepickerOptions: { maxDate : 0 }"/>\n                    <span class="add-on" style="margin-left:-5px;"><i class="fa fa-calendar"></i></span>\n                </div>\n                <div class="btn-group" style="margin-top:8px;" data-bind="visible: isLocationSelected() && $root.detailViewPanel.rosterActive() ">\n                    <button class="btn btn-info btn-mini dropdown-toggle" data-toggle="dropdown">\n                        Quick Lists <span class="caret"></span>\n                    </button>\n                    <ul class="dropdown-menu" data-bind="foreach: labels">\n                        <li>\n                            <a href="#" data-bind="click: $root.requestFilterChange"><span data-bind="text: $data"></span></a>\n                        </li>\n                    </ul>\n                </div>\n                <!-- /ko -->\n            </div>\n\n\n            <div style="margin-top:4px;display:inline-block">\n                <div class="input-append pull-left" style="margin-left:0px;margin-bottom:0px;margin-top:0px"\n                     data-bind="visible: !detailViewPanel.lessonsActive() && !detailViewPanel.communicationsActive() && !$root.detailViewPanel.metricsActive() && !$root.rosterForecaster.forecastActive() && !($root.detailViewPanel.portfolioActive() && !$root.observationMetrics.isPortfolioIndividualView())">\n                    <input class="span2" style="margin-bottom:0px;" id="inputIcon" type="text" placeholder="filter by name" data-bind="value:  $root.detailViewPanel.nameFilter, valueUpdate: \'afterkeydown\'">\n                    <span class="add-on" style="margin-left:-5px;"><i class="fa fa-search"></i></span>\n                </div>\n            </div>\n        </div>\n        <!-- /ko -->\n    </div>\n\n    <div data-bind="if: isEventsMode() && isLocationSelected()">\n        <div class="row" >\n            <div data-bind="visible: $root.detailViewPanel.attendanceDetailsActive()">\n                <div class="thumbnail-panel3 left-panel pull-left" style="position:relative">\n                    <h2 class="panel-title">\n                        <!-- ko if: $root.detailViewPanel.allActive() -->\n                            <span class="stat-ok stat-medium" data-bind="text: filter.group() ? filter.group().displayableCombinedIn() : 0"></span> in \n                        <!-- /ko -->\n                        <!-- ko if: !$root.detailViewPanel.allActive() -->\n                            <span class="stat-ok stat-medium" data-bind="text: filter.group() ? filter.group().peopleIn().length : 0"></span> in \n                        <!-- /ko -->\n                    </h2>\n                    <ul style="width:290px;" data-bind="delegatedHandler: \'click\', tiles: {bricks: filter.group() ? filter.group().peopleIn : null, template: \'view/tiles/studentTile\', numCols: 3, groutWidth: 4,textSizingRef:100}"></ul>\n                    <div class="mask fill abs-top-left" style="text-align:center" data-bind="visible:!$root.filter.isToday()">\n                        <h4 style="margin-top:5px;color:#DDD">choose today\'s date to reenable</h4>\n                    </div>\n                </div>\n                <div class="thumbnail-panel3 panel3-mid pull-left" style="position:relative">\n                    <button class="pull-right btn btn-mini btn-warning" style="margin-left:5px;margin-top:-5px;" data-bind="click: $root.employees.createEmployee, visible: $root.currentUser.isAdmin() && ($root.detailViewPanel.allActive() || $root.detailViewPanel.staffActive())">\n                        Add Employee\n                    </button>\n                    <button class="pull-right btn btn-mini btn-success" style="margin-top:-5px;" data-bind="click: $root.requestQuickAdd, visible: $root.detailViewPanel.allActive() || $root.detailViewPanel.studentsActive()">\n                        Add Child\n                    </button>\n                    <h2 class="panel-title">\n                    <!-- ko if: $root.detailViewPanel.allActive() -->\n                        <span class="stat-warn stat-medium" data-bind="text: filter.group() ? filter.group().numChildrenOut() : 0"></span> out \n                    <!-- /ko -->\n                    <!-- ko if: !$root.detailViewPanel.allActive() -->\n                        <span class="stat-warn stat-medium" data-bind="text: filter.group() ? filter.group().peopleOut().length : 0"></span> out \n                    <!-- /ko -->\n                    </h2>\n                    <ul style="width:290px;" data-bind="delegatedHandler: \'click\', tiles: {bricks: filter.group() ? filter.group().peopleOut : null, template: \'view/tiles/studentTile\', numCols: 3, groutWidth: 4,textSizingRef:100}"></ul>\n                    <div class="mask fill abs-top-left" style="text-align:center" data-bind="visible:!$root.filter.isToday()">\n                        <h4 style="margin-top:5px;color:#DDD">choose today\'s date to reenable</h4>\n                    </div>\n                </div>\n                <div class="thumbnail-panel3 panel3-mid pull-left">\n                    <div data-bind="visible: $root.detailViewPanel.attendanceDetailsActive()">\n                        <div data-bind="template: { name: \'view/attendance\', data: $root.attendanceDetails }"></div>\n                    </div>\n                </div>\n            </div>\n            <div data-bind="visible: $root.detailViewPanel.observationsActive()">\n                <div class="thumbnail-panel2 left-panel pull-left" >\n                    <div data-bind="template: { name: \'view/outbox\', data: $root.outbox }"></div>\n                </div>\n                <div class="thumbnail-panel2 panel3-mid pull-left">\n                    <div data-bind="template: { name: \'view/events\', data: $root.events }"></div>\n                </div>\n            </div>\n            <!-- ko if: $root.detailViewPanel.dailyReportsWasActive() -->\n            <div data-bind="visible: $root.detailViewPanel.dailyReportsActive()">\n                <div class="thumbnail-panel2 left-panel pull-left" >\n                        <div class="pull-right">\n        <button class="btn btn-info btn-mini" style="margin-left:5px;"data-bind="click: $root.product.hasFeature($root.product.Features.MINUTE_MENU_SFTP) ? $root._.bind($root.product.disableFeature, null, $root.product.Features.MINUTE_MENU_SFTP) : $root._.bind($root.product.enableFeature, null, $root.product.Features.MINUTE_MENU_SFTP), text: $root.product.hasFeature($root.product.Features.MINUTE_MENU_SFTP) ? \'Disable Minute Menu\' : \'Enable Minute Menu\', visible: $root.currentUser.isAdmin() && $root.product.getFeature($root.product.Features.MINUTE_MENU_SFTP)">\n\n        </button>\n    </div>\n                    <div data-bind="template: { name: \'view/dailyReports\', data: $root.reports }"></div>\n                </div>\n                <div class="panel3-mid pull-left">\n                    <div data-bind="template: { name: \'view/dailyReportDetail\', data: $root.reports.report() }"></div>\n                </div>\n            </div>\n            <!-- /ko -->\n            <!-- ko if: $root.detailViewPanel.lessonsActive() -->\n            <div data-bind="visible: $root.detailViewPanel.lessonsActive()">\n                <div class="thumbnail-panel2 left-panel pull-left" >\n                    <div data-bind="template: { name: \'view/lessons\', data: $root.lessons }"></div>\n                </div>\n                <div class="thumbnail-panel2 panel3-mid pull-left">\n                    <div data-bind="template: { name: \'view/lessonDetail\', data: $root.lessons.lesson() }"></div>\n                </div>\n            </div>\n            <!-- /ko -->\n            <!-- ko if: $root.detailViewPanel.portfolioWasActive()-->\n            <div class="well left-panel" data-bind="visible: $root.detailViewPanel.portfolioActive()">\n                <!-- ko if: $root.observationMetrics.isPortfolioIndividualView() -->\n                <h2 class="panel-title pull-left"><span class="stat-ok stat-medium" data-bind="text: childs.activeChildrenForSelectedGroup().length"></span> portfolios </h2>\n                <div class="clearfix"></div>\n                <ul style="width:900px" data-bind="delegatedHandler: \'click\', tiles: {bricks: childs.activeChildrenForSelectedGroup, template:\'view/tiles/studentTile\', numCols: 8, groutWidth: 4, textSizingRef:100}"></ul>\n                <!-- /ko -->\n                <!-- ko if: !$root.observationMetrics.isPortfolioIndividualView() && $root.observationMetrics.customCurriculaPeriodsActive()  -->\n                <div data-bind="template: { name: \'view/portfolioMetrics\', data: $root.observationMetrics }"></div>\n                <!-- /ko -->\n            </div>\n            <!-- /ko -->\n            <div data-bind="visible: $root.detailViewPanel.communicationsActive()">\n                <div class="thumbnail-panel3-2 left-panel pull-left">\n                    <button class="pull-right btn btn-mini btn-info" data-bind="click: $root.openEditReplyToForm">\n                        Change Reply To\n                    </button>\n                    <!-- ko if:$root.currentUser.isCsr() || $root.currentUser.isRegionalAdmin() || ($root.currentUser.isAdmin() && $root.communications.parentCommDisabled())-->\n                    <button class="pull-right btn btn-mini btn-warning" style="margin-right:5px;" data-bind="click: $root.communications.toggleParentCommunication">\n                        <span data-bind="text: ($root.communications.parentCommDisabled() ? \'Enable \' : \'Disable \') + \'Sending to Parents\'"></span>\n                    </button>\n                    <!-- /ko -->\n                    <!-- ko if:$root.currentUser.isCsr()-->\n                    <button class="pull-right btn btn-mini btn-success" style="margin-right:5px;" data-bind="click: $root.branding.edit">\n                        <span data-bind="text: \'Edit Account Branding\'"></span>\n                    </button>\n                    <!-- /ko -->\n                    <h2 class="panel-title" ><span class="stat-warn stat-medium"></span>compose</h2>\n                    <div data-bind="template: { name: \'view/communications\', data: $root.communications }"></div>\n                </div>\n                <div class="thumbnail-panel3 panel3-mid pull-left">\n                    <div data-bind="template: { name: \'view/notes\', data: $root.events }"></div>\n                </div>\n            </div>\n\n            <!-- ko if: $root.detailViewPanel.rosterWasActive()-->\n            <div class="well left-panel" data-bind="visible: $root.detailViewPanel.rosterActive() && !$root.rosterForecaster.forecastActive()">\n                <div data-bind="template: { name: \'view/roster\' }"></div>\n            </div>\n            <!-- /ko -->\n\n            <!-- ko if: $root.detailViewPanel.rosterWasActive() && $root.rosterForecaster.forecastActive()-->\n            <div data-bind="visible: $root.detailViewPanel.rosterActive(), template: { name: \'view/rosterForecaster\'}">\n            </div>\n            <!-- /ko -->\n\n            <div class="well left-panel" data-bind="visible: $root.detailViewPanel.metricsActive()">\n                <div data-bind="template: { name: \'view/metrics\' }"></div>\n            </div>\n            \n        </div>\n        <div class="spinner-primary" data-bind="fadeVisible: shouldShowSpinny, spin: {trigger: shouldShowSpinny(), top:27, left:27}"></div>\n\n        <div data-bind="foreach: modals">\n            <div class="hide" style="width:auto" data-bind="attr: { id: id }, template: {name: template, data: model }"></div>\n        </div>\n        <div id="galleryy" style="width:auto" data-bind="visible: $root.gallery.visible(), template: {name: \'view/modals/gallery\', data: $root.gallery}"></div>\n\n    </div>\n</div>'}),tadpoles.define("text!view/events.html",[],function(){return'<div>\n    <button class="pull-right btn btn-mini btn-success" id="galleryButton" data-bind="click:showGallery" data-original-title="Live Gallery">Live Gallery</button>\n    <h2 class="panel-title" ><span class="stat-warn stat-medium" data-bind="text:observationsForSelection().length"></span> sent <!-- ko if: $root.filter.isToday() --><span class="stat-warn">today</span><!-- /ko --><!-- ko if: !$root.filter.isToday() -->on <span class="stat-warn" data-bind="text:$root.filter.dateForDisplay()"></span><!-- /ko --></h2>\n    <div data-bind="visible: processing(), spin: {trigger:processing(), color: \'#000\', top:20, left:190}"></div>\n    <div data-bind="visible: !processing()">\n        <div style="text-align:center;margin-top:15px;" data-bind="visible: observationsForSelection().length === 0">\n            <h1 style="color:#DDD">on <span data-bind="text:$root.filter.dateForDisplay()"></span></h1>\n        </div>\n        <ul style="width:447px;" data-bind="delegatedHandler: \'click\', tiles: {bricks: observationsForSelection(), template: \'view/tiles/eventTile\', numCols: 4, groutWidth: 4, textSizingRef:100}"></ul>\n    </div>\n</div>'}),tadpoles.define("text!view/lessonDetail.html",[],function(){return'<div style="position:relative">\n    <!-- ko if: !$data -->\n    <div class="centered">\n        <h1 class="empty-text">no lesson plan chosen</h1>\n    </div>\n    <!-- /ko -->\n    <!-- ko if: $data -->\n    <!-- ko if: (!$root.currentUser.isAdmin()) && approvalNote() -->\n    <div class="alert alert-block alert-warning">\n        <h2 class="panel-title">note from director</h2>\n        <div>\n            <ul class="unstyled dr-entries">\n                <li style="margin-bottom:10px;">\n                    <span class="dr-note" data-bind="text: approvalNote"></span>\n                </li>\n            </ul>\n        </div>\n    </div>\n    <div class="clearfix"></div>\n     <!-- /ko -->\n    <div class="pull-right">\n        <button class="btn btn-danger btn-mini" style="margin-left:5px;" data-bind="click:audit, visible: $data.key && $root.currentUser.isCsr()">\n            Audit\n        </button>\n        <button class="btn btn-info btn-mini" data-bind="visible: key || isWeek(), click:copyTo">\n            Copy\n        </button>\n        <button class="btn btn-success btn-mini" data-bind="visible: canSubmit(), click:resubmit, text:\'Submit for approval\'"></button>\n\n        <button class="btn btn-warning btn-mini" data-bind="visible: isWeek(), click: $root.lessons.viewWeekly">\n            View Entire Week\n        </button>\n\n        <button class="btn btn-warning btn-mini" data-bind="visible: !isWeek(), click:print">\n            Print Lesson Plan\n        </button>\n    </div>\n\n\n    <div id="lesson-printable">\n        <h2 class="panel-title ellipsis" style="padding-bottom:0px;width:447px;" data-bind="popover: getPopoverParams()">\n            <span class="stat-ok stat-medium" data-bind=""></span>lesson plan for\n            <span class="stat-ok" data-bind="text: isLocation() ? $root.filter.location().name : $root.lessons.group().name"></span>\n        </h2>\n\n        <h2 class="panel-title">\n            <span data-bind="text:isWeek() ? \'for \' : \'on \'"></span><span class="stat-warn" data-bind="text: isWeek() ? (\'the week of \' + realDate.format(\'m/d\')) : realDate.format(\'tinyDate\')"></span>\n        </h2>\n\n        <div class="centered" data-bind="visible: numVisibleEntries() === 0 && !isEditable()">\n            <h1 class="empty-text">no entries</h1>\n        </div>\n        <div data-bind="template: {name: \'view/dailyReport\', data: $root.lessons.lesson()}"></div>\n    </div>\n     <!-- ko if: $data && $root.currentUser.isAdmin() && (canReject() || approvalNote() || canApprove()) -->\n    <div class="alert alert-block alert-warning" style="padding-right:14px;margin-bottom:0px;margin-top:20px;">\n\n        <div>\n            <div class="pull-right">\n                <button class="btn btn-danger btn-mini" data-bind="visible: canReject(), click:reject, text:\'Request changes\'"></button>\n                <button class="btn btn-success btn-mini" data-bind="visible: canApprove(), click:approve, text:\'Mark Approved\'"></button>\n            </div>\n\n            <h2 class="panel-title">note to teacher</h2>\n        </div>\n\n        <div>\n            <!-- ko if: canReject() -->\n            <textarea style="min-width:400px;width:100%;height:80px;box-sizing:border-box" type="text" data-bind="value: approvalNote, valueUpdate: \'afterkeydown\'"></textarea>\n            <!-- /ko -->\n            <!-- ko if:  !canReject() -->\n                <ul class="unstyled dr-entries">\n                    <li style="margin-bottom:10px;">\n                        <span class="dr-note" data-bind="text: approvalNote"></span>\n                    </li>\n                </ul>\n            <!-- /ko -->\n        </div>\n\n    </div>\n    <!-- /ko -->\n    <!-- /ko -->\n</div>\n\n\n'}),tadpoles.define("text!view/lessons.html",[],function(){return'<div>\n    <!-- ko if: !group() -->\n    <div class="centered">\n        <h1 class="empty-text">please select a class</h1>\n    </div>\n    <!-- /ko -->\n    <!-- ko if: group()-->\n    <div class="pull-right">\n        <button class="btn btn-info btn-mini" data-bind="monthPicker: {observable : selectedDate}">\n            Change Month\n        </button>\n    </div>\n\n    <!-- ko if:$root.canEditCurriculum() -->\n    <div class="pull-right" style="margin-right:5px;">\n        <button class="btn btn-success btn-mini" data-bind="click: $root.curricula.editCurriculum">\n            Manage Subjects and Goals\n        </button>\n    </div>\n    <!-- /ko -->\n\n    <h2 class="panel-title"><span class="stat-ok stat-medium" data-bind=""></span>lessons for <span class="stat-warn" data-bind="text: selectedDate() ? selectedDate().format(\'mmmm yyyy\').toLowerCase() : \'\'"></span>\n    </h2>\n\n    <div data-bind="visible: processing(), spin: {trigger:processing(), color: \'#000\', top:20, left:190}"></div>\n    <div data-bind="visible: !processing()">\n        <ul style="width:447px;" data-bind="delegatedHandler: \'click\', tiles: {bricks: lessons(), template: \'view/tiles/lessonTile\', numCols: 6, groutWidth: 4, textSizingRef:100}"></ul>\n    </div>\n    <!-- /ko -->\n</div>'}),tadpoles.define("text!view/metrics.html",[],function(){return'\n<div style="display: inline-block; width: 898px;" data-bind="fadeVisible: isLocationSelected()">\n    <div class="pull-left" data-bind="template: { name : \'view/classroomSelector\'}"></div>\n    <h3 class="pull-left" style="color:gray;margin-top:5px;">hover over graph for counts.&nbsp;&nbsp;&nbsp;click on graph for detail.</h3>\n\n</div>\n<div class="row" data-bind="foreach: graphs.graphs">\n    <div class="span5" style="margin-right:60px;margin-top:20px;" data-bind="attr: { id: divId }, event: { mouseenter: enableActions, mouseleave: disableActions }"></div>\n</div>\n'}),tadpoles.define("text!view/notes.html",[],function(){return'<div>\n    <h2 class="panel-title pull-left" >\n        <span class="stat-warn stat-medium" data-bind="text:$root.communications.notesForSelection().length"></span>\n        <span style="margin-right: 2px; margin-right: 2px;" data-bind="text: $root.communications.sentNotesViewTypeSentActive() ? \' sent \' : \'for later\'"></span>\n        <!-- ko if: $root.filter.isToday() && $root.communications.sentNotesViewTypeSentActive()-->\n            <span class="stat-warn">today</span>\n        <!-- /ko -->\n        <!-- ko if: !$root.filter.isToday() && $root.communications.sentNotesViewTypeSentActive()-->on <span class="stat-warn" data-bind="text:$root.filter.dateForDisplay()"></span>\n        <!-- /ko -->\n    </h2>\n\n    <div class="pull-right btn-group" style="margin: 8px 10px 0px 0px;" data-bind="visible: $root.filter.isToday()">\n        <button  class="btn btn-info dropdown-toggle btn-mini" data-toggle="dropdown" >\n            <span style="margin-right: 6px;" data-bind="text:$root.communications.sentNotesViewType()"></span><span class="caret"></span>\n        </button>\n        <ul class="dropdown-menu">\n            <li>\n                <a href="#" data-bind="click:$root.communications.chooseNotesViewTypeSent"><span>sent</span></a>\n            </li>\n            <li>\n                <a href="#" data-bind="click:$root.communications.chooseNotesViewTypeScheduled"><span>scheduled</span></a>\n            </li>\n        </ul>\n    </div>\n\n    <div style="clear: both"></div>\n    <div data-bind="visible: processing(), spin: {trigger:processing(), color: \'#000\', top:20, left:105}"></div>\n    <div data-bind="visible: !processing()">\n        <div style="text-align:center;margin-top:15px;" data-bind="visible: $root.communications.notesForSelection().length === 0">\n            <h1 style="color:#DDD">on <span data-bind="text:$root.filter.dateForDisplay()"></span></h1>\n        </div>\n        <ul style="width:290px;" data-bind="delegatedHandler: \'click\', tiles: {bricks: $root.communications.notesForSelection(), template: \'view/tiles/eventTile\', numCols: 3, groutWidth: 4, textSizingRef:100}"></ul>\n    </div>\n</div>'}),tadpoles.define("text!view/outbox.html",[],function(){return'<div>\n    <div class="pull-right btn-group" style="margin-bottom:0px;">\n         \n        <button class="pull-left btn btn-mini btn-success" style="margin-left:5px;" id="sendAll" data-bind="click:sendAll" data-original-title="Send All">Approve All</button>\n        <button class="btn btn-info dropdown-toggle btn-mini" style="margin-left:5px;" data-toggle="dropdown">\n            <span data-bind="text: outboxPeriodDisplay()"></span> <span class="caret"></span>\n        </button>\n        <ul class="dropdown-menu pull-left" data-bind="foreach: periodOptions">\n            <li>\n                <a href="#" data-bind="click: $parent.changeOutboxPeriod.bind($data.value)"><span data-bind="text: $data.name"></span></a>\n            </li>\n        </ul>\n        \n    </div>\n    <h2 class="panel-title" style="white-space:nowrap"><span class="stat-ok stat-medium" data-bind="text:eventsForCurrentClass().length"></span> waiting for approval</h2>\n    <div data-bind="visible: processing(), spin: {trigger:processing(), color: \'#000\', top:20, left:190}"></div>\n    <div data-bind="visible: !processing()">\n        <div style="text-align:center;color:#DDD;margin-top:15px;" data-bind="visible: eventsForCurrentClass().length === 0">\n            <h1></h1>\n        </div>\n        <ul style="width:447px;" data-bind="delegatedHandler: \'click\', tiles: {bricks: eventsForCurrentClass, template: \'view/tiles/eventTile\', numCols: 4, groutWidth: 4, textSizingRef:100}"></ul>\n    </div>\n</div>'}),tadpoles.define("text!view/quickAdd.html",[],function(){return'<div style="float:left;background-color:#f2f2f2;min-width:250px;padding:15px;height:320px;overflow:hidden;">\n    <h3 style="color:gray;margin-bottom:15px;"><span style="font-size:30px;margin-right:10px;">1.</span>enter child info</h3>\n    <label><h4 style="color:gray;">child\'s full name</h4></label>\n    <input class="span3" style="font-size:20px;height:20px;width:240px;" data-bind="value: fullName, valueUpdate: \'afterkeydown\'"/>\n    <label><h4 style="color:gray;">classroom</h4></label>\n    <select class="span3" style="width:250px;" data-bind="options: $root.groups.groupsForCurrentLocation, optionsValue: \'key\', optionsText: \'name\', optionsCaption: \'Choose a classroom...\', value: groupKey"></select>\n    <!-- ko if: selectedGuardians().length > 0 -->\n    <label><h4 style="color:gray;">contacts</h4></label>\n    <ul style="width:250px;" data-bind="tiles: { bricks: selectedGuardians, template:\'view/tiles/addChildTinyGuardianTile\', numCols: 4, groutWidth: 4,textSizingRef: 100 }"></ul>\n    <!-- /ko -->\n</div>\n<div style="margin-left:20px;float:left;background-color:#f2f2f2;padding:15px;height:320px;overflow:hidden;">\n    <div style="width:250px;text-align:center">\n        <h3 style="color:gray;"><span style="font-size:30px;margin-right:10px;">2.</span>choose a sibling <span style="font-size:12px;">(optional)</span></h3></label>\n        <div style="max-height:270px;margin-top:15px;overflow:auto;">\n            <ul style="width:250px;" data-bind="visible: siblings().length > 0, tiles: { bricks: siblings(), template:\'view/tiles/addChildStudentTile\', numCols: 3, groutWidth: 4, textSizingRef: 105 }"></ul>\n            <!-- ko if:siblings().length === 0 -->\n            <h1 style="color:#DDD;margin-top:50px;">none available</h1>\n            <span style="color:#DDD">type the child\'s full name to find matches</span>\n            <!-- /ko -->\n        </div>\n    </div>\n</div>\n<div style="margin-left:20px;float:left;background-color:#f2f2f2;padding:15px;height:320px;overflow:hidden;">\n    <div style="width:250px;text-align:center">\n        <h3 style="color:gray;"><span style="font-size:30px;margin-right:10px;">3.</span>choose contacts <span style="font-size:12px;">(optional)</span></h3></label>\n        <div style="max-height:270px;margin-top:15px;overflow:auto;position:relative">\n            <div style="height:270px;" data-bind="visible: loadingGuardians(), spin: {trigger:loadingGuardians(), top:80, left:90}"></div>\n            <div data-bind="visible: !loadingGuardians()">\n                <ul style="width:250px;" data-bind="visible:sibling(), tiles: { bricks: guardians, template:\'view/tiles/addChildGuardianTile\', numCols: 3, groutWidth: 4, textSizingRef: 105 }"></ul>\n                <!-- ko if:!sibling() -->\n                <h1 style="color:#DDD;margin-top:50px;">none available</h1>\n                <span style="color:#DDD">click a sibling to show contacts</span>\n                <!-- /ko -->\n            </div>\n        </div>\n    </div>\n</div>\n\n<div style="clear:both;"></div>\n'}),tadpoles.define("text!view/quickLists.html",[],function(){return'<div class="quick-lists">\n    <div class="labels">\n        <span data-bind="foreach: labels">\n            <span class="label-with-close">\n                <span class="label label-success label-close" data-bind="text: $data"></span><a href="#"><span class="label close-label" data-bind="click: $parent.removeLabel.bind($parent,$data)"></span></a>\n            </span>\n        </span>\n    </div>  \n</div>'}),tadpoles.define("text!view/roster.html",[],function(){return'<!-- ko if: filter.group() -->\n<h2 class="panel-title pull-left"><span class="stat-ok stat-medium" data-bind="text: filter.group().childrenForRoster().length"></span> <span data-bind="text: $root.roster.getDisplayableStatus($root.roster.filter()).toLowerCase()"></span> </h2>\n\n<button class="pull-left btn btn-mini btn-success" style="margin-left:20px;" data-bind="click: $root.requestQuickAdd">\n    Add Child\n</button>\n<button class="pull-left btn btn-mini btn-info" style="margin-left:5px;" data-bind="click: $root.requestAddTour">\n    Add Lead\n</button>\n<button class="pull-left btn btn-mini btn-info" style="margin-left:5px;" data-bind="style: { backgroundColor : $root.roster.colorForSelectedStatus() }, visible:filter.group().childrenForRoster().length > 0 ,click: $root.roster.sendNote">\n    Send Note\n</button>\n<button class="pull-left btn btn-mini btn-warning" style="margin-left:5px;" data-bind="click: $root.editCurrentGroup, visible: $root.showGroupEdit">\n    Edit Class\n</button>\n<!-- ko if: $root.detailViewPanel.staffActive() -->\n<button class="pull-left btn btn-mini btn-warning" style="margin-left:20px;" data-bind="click: $root.employees.createEmployee">\n    Add Employee\n</button>\n<!-- /ko -->\n<!-- ko if: $root.canResyncSchool() -->\n<button class="pull-left btn btn-mini btn-warning" style="margin-left:5px;" data-bind="click:$root.resyncSchool">\n    Resync Roster\n</button>\n<!-- /ko -->\n<!-- ko if: $root.currentUser.isCsr() -->\n<button class="pull-left btn btn-mini btn-warning" style="margin-left:5px;" data-bind="click: $root.dedup">\n    Dedup\n</button>\n<!-- /ko -->\n<!-- ko if: $root.product.hasFeature($root.product.Features.WEB_DATA_IMPORT) && ($root.currentUser.isCsr() || $root.currentUser.isAdmin()) -->\n<button class="pull-left btn btn-mini" style="margin-left:5px;" data-bind="click: $root.importData">\n    Import Data\n</button>\n<!-- /ko -->\n<div class="clearfix"></div>\n<ul style="width:900px" data-bind="delegatedHandler: \'click\', tiles: {bricks: filter.group().childrenForRoster(), template:\'view/tiles/studentTile\', numCols: 8, groutWidth: 4, textSizingRef:100}"></ul>\n<!-- /ko -->\n\n'}),tadpoles.define("text!view/rosterOptions.html",[],function(){return'<div style="width:800px">\n    <div>\n        <div style="float:left">\n            <h2 style="color:gray;">leads to enrollment</h2>\n            <div style="margin-bottom:10px;">\n                <ul data-bind="delegatedHandler: \'click\', tiles: { bricks: $root.roster.groups(), template:\'view/tiles/rosterTile\', tileSize:75, groutWidth: 4 }"></ul>\n            </div>\n        </div>\n    </div>\n</div>\n'}),tadpoles.define("text!view/rosterForecaster.html",[],function(){return' <div class="well left-panel">\n    <h1 class="panel-title" style="font-size: 30px; margin: 6px;">legend</h1>\n    <p style="margin-bottom: 8px;">The roster planning feature allows you to make intelligent enrollment decisions by displaying current and future classroom capacity.  Use this\n    feature to plan for openings and always have full classrooms!</p>\n\n\n    <div style="float: left; width:24px;height: 24px; background-color: rgb(29, 192, 116)"></div>\n    <div style="float: left; margin-left: 6px; padding-top: 2px;">This child is the appropriate age for their classroom and is not near move up or graduation</div>\n    <div style="clear: both; margin-bottom: 6px;"></div>\n\n    <div style="float: left; width:24px;height: 24px; background-color: #faa732"></div>\n    <div style="margin-left: 6px; float: left; padding-top: 2px;">This child is the appropriate age for their classroom but is within 1 month of move up or graduation</div>\n    <div style="clear: both; margin-bottom: 6px;"></div>\n\n    <div style="float: left; width:24px;height: 24px; background-color: rgb(143, 86, 228)"></div>\n    <div style="float: left; margin-left: 6px; padding-top: 2px;">This child is either too young or too old for this classroom</div>\n    <div style="clear: both; margin-bottom: 6px;"></div>\n\n    <div style="float: left; width:24px;height: 24px; background-color: rgba(218, 79, 73, 1.0)"></div>\n    <div style="float: left; margin-left: 6px; padding-top: 2px;">This child requires <b>birthday</b>, <b>enrollment date</b> and <b>graduation date </b> to show complete roster data</div>\n    <div style="clear: both; margin-bottom: 6px;"></div>\n\n     <div style="float: left; width:24px;height: 24px; background-color: #faa732">\n        <div class="class-triangle" style="position:absolute; border-top-width: 23px; border-right-width: 23px; opacity: 1.0; border-right-color: white;"></div>\n        <div class="class-triangle" style="position:absolute; border-top-width: 24px; border-right-width: 24px; opacity: 1.0; border-right-color: rgb(29, 192, 116)"></div>\n     </div>\n    <div style="float: left; margin-left: 6px; padding-top: 2px;">This is a seat filled in the morning and afternoon by different children.  The top triangle is the morning child, the bottom the afternoon child</div>\n    <div style="clear: both; margin-bottom: 6px;"></div>\n\n    <div style="float: left; width:24px;height: 24px; background-color: rgba(219, 219, 219, 1.0)"></div>\n    <div style="float: left; margin-left: 6px; padding-top: 2px;">This is an available unfilled seat in the classroom</div>\n    <div style="clear: both; margin-bottom: 6px;"></div>\n\n </div>\n<div style="clear: both;"></div>\n\n\n<div data-bind="with: $root.rosterForecaster">\n    <style>\n        .seatNumber:first-child {\n            width: 20px;\n            border-top-width: 1px;\n            border-top-color: white;\n            border-top-style: solid;\n            height: 16px;\n            padding-top: 28px;\n        }\n        .seatNumber:last-child {\n            width: 20px;\n            border-bottom-width: 1px;\n            border-bottom-color: lightgrey;\n            border-bottom-style: solid;\n            height: 16px;\n            padding-top: 28px;\n        }\n        .seatNumber {\n            width: 20px;\n            border-top-width: 1px;\n            border-top-color: lightgray;\n            border-top-style: solid;\n            height: 16px;\n            padding-top: 28px;\n        }\n        .seatNumberOverCapacity {\n            width: 20px;\n            border-top-width: 1px;\n            border-top-color: lightgray;\n            border-top-style: solid;\n            height: 16px;\n            padding-top: 28px;\n            background-color: rgb(250, 236, 233);\n        }\n        .seatNumberOverCapacity:last-child {\n            width: 20px;\n            border-bottom-width: 1px;\n            border-bottom-color: lightgray;\n            border-bottom-style: solid;\n            height: 16px;\n            padding-top: 28px;\n            background-color: rgb(250, 236, 233);\n        }\n    </style>\n    <div  data-bind="foreach: rosterGridClasses()">\n        <div class="well left-panel" style="margin-top: 20px;" data-bind="visible: valid() && visible()">\n            <!--<button class="pull-left btn btn-mini btn-warning" style="position: relative; top: -18px; left: 896px;" data-bind="click: refresh">\n                <i class="fa fa-refresh fa-white"></i>\n            </button>-->\n            <h1 class="panel-title" style="font-size: 30px; float: left; margin: 6px;" data-bind="text: className"></h1>\n            <button class="pull-right btn btn-mini btn-warning" style="position: relative; margin-top: 14px;" data-bind="click: toggleExpanded">\n                <i data-bind="visible: !expanded()" class="fa fa-chevron-down fa-white"></i><i data-bind="visible: expanded()" class="fa fa-chevron-up fa-white"></i>\n            </button>\n\n            <div style="clear: both;"></div>\n\n            <div data-bind="visible: expanded">\n                <button class="pull-left btn btn-mini btn-info" style="margin-left:5px; margin-top: 4px;" data-bind="visible: showBack(), click: back">\n                    <i style="color: white" class="fa fa-chevron-left"></i>\n                </button>\n\n                <div data-bind="foreach: getDateHeader()">\n                    <h3 style="margin-left: 10px; float: left;" data-bind="text: $data, style: { width: $index() === 0 && $parent.showBack() ? \'194px\' : ($index() === 3 ?  \'166px\' : \'215px\') }">\n                    </h3>\n                </div>\n                <button style="margin-top: 4px;" class="pull-right btn btn-mini btn-info" style="margin-left:20px;" data-bind="click: more">\n                    <i style="color: white" class="fa fa-chevron-right"></i>\n                </button>\n\n                <div style="clear: both;"></div>\n\n                <div data-bind="foreach: $root.rosterForecaster.dayHeader">\n                    <div style="width: 45px; float: left; text-align: center;">\n                        <span style="font-size: 14px;" data-bind="text:$data"></span>\n                    </div>\n                </div>\n                <div style="clear: both;"></div>\n                <div data-bind="style : { height: maxSeatCount()*45 + \'px\' }, foreach: seatNumbers" style="margin-left: -20px;width: 20px;float: left;text-align: center;color: grey;">\n                    <div data-bind="text: $data, css: {seatNumber : $index() < $parent.classroom.capacity() , seatNumberOverCapacity : $index() >= $parent.classroom.capacity() }">\n\n                    </div>\n                </div>\n                <ul style="float: left;" data-bind="tiles: {bricks: getGrid(), template: \'view/tiles/rosterGridTile\', numCols: 20, groutWidth: 0, tileSize: 45}"></ul>\n                <h3 style="float: left; margin: 6px;" data-bind="text: capacityDisplay"></h3>\n                <h3 style="float: right; margin: 6px;" data-bind="text: enrollmentAgeDisplay"></h3>\n                <div style="clear: both;"></div>\n\n            </div>\n        </div>\n        <div class="well left-panel" style="margin-top: 20px;" data-bind="visible: !valid() && visible()">\n            <h1 class="panel-title" style="font-size: 30px; margin: 6px;" data-bind="text: className"></h1>\n            <div class="alert alert-block alert-danger">\n                Please add <b>spots for enrollment</b> and <b>enrollment ages</b> to enable roster visiblity. <button class="pull-right btn btn-mini btn-warning" style="margin-left:20px;" data-bind="click:editClass">Edit class</button>\n            </div>\n            <div style="clear: both;"></div>\n        </div>\n    </div>\n</div>'}),tadpoles.define("text!view/stat_tiles.html",[],function(){return'<ul class="unstyled" style="margin: 0px;">\n    <li style="width:75px;height:75px; float: left; padding: 3px;" >\n        <div class="tile pointable" style="background-color: #DA4F49;position:relative;" data-original-title="Daily Enrollment" data-bind="popover: $root.stats.enrollmentChart.popoverData()">\n            <div class="valign" style="height:100%">\n                <div class="center">\n                    <div class="metric" style="text-align: center;">\n                        <span class="stat-tile" data-bind="text: $root.stats.enrollmentCount()"></span>\n                    </div>\n                </div>\n            </div>\n            <div class="footer stat-name">\n                enrollment\n            </div>\n        </div>\n    </li>\n\n    <li style="width:75px;height:75px; float: left; padding: 3px;">\n        <div class="tile pointable" style="background-color: #FAA732;position:relative;" data-original-title="Reminders for today" id="todaysReminders" >\n            <div class="valign" style="height:100%">\n                <div class="center">\n                    <div class="metric" style="text-align: center;">\n                        <span class="stat-tile" data-bind="text: reminders_for_selection().length"></span>\n                    </div>\n                </div>\n            </div>\n            <div class="footer stat-name">\n                reminders\n            </div>\n        </div>\n    </li>\n    <li style="width:75px;height:75px; float: left; padding: 3px;">\n        <div class="tile pointable" style="background-color: #49A;position:relative;" data-original-title="Children out today" id="todaysChildrenOut">\n            <div class="valign" style="height:100%">\n                <div class="center">\n                    <div class="metric" style="text-align: center;">\n                        <span class="stat-tile" data-bind="text: childrenOutToday().length"></span>\n                    </div>\n                </div>\n            </div>\n            <div class="footer stat-name">\n                out today\n            </div>\n        </div>\n    </li>\n</ul>\n'}),tadpoles.define("text!view/portfolioStatTiles.html",[],function(){return'<ul class="unstyled" style="margin: 0px;">\n    <li style="width:75px;height:75px; float: left; padding: 3px;" >\n        <div class="tile" style="background-color: #DA4F49;position:relative;">\n            <div class="valign" style="height:100%">\n                <div class="center">\n                    <div class="metric" style="text-align: center;">\n                        <span style="font-size: 32px" class="stat-tile" data-bind="text: unassessed"></span>\n                    </div>\n                </div>\n            </div>\n            <div class="footer stat-name">\n                none\n            </div>\n        </div>\n    </li>\n\n    <li style="width:75px;height:75px; float: left; padding: 3px;">\n        <div class="tile" style="background-color: #FAA732;position:relative;"  >\n            <div class="valign" style="height:100%">\n                <div class="center">\n                    <div class="metric" style="text-align: center;">\n                        <span style="font-size: 32px" class="stat-tile" data-bind="text: assessmentStarted"></span>\n                    </div>\n                </div>\n            </div>\n            <div class="footer stat-name">\n                started\n            </div>\n        </div>\n    </li>\n    <li style="width:75px;height:75px; float: left; padding: 3px;">\n        <div class="tile" style="background-color: #5bb75b;position:relative;" >\n            <div class="valign" style="height:100%">\n                <div class="center">\n                    <div class="metric" style="text-align: center;">\n                        <span style="font-size: 32px" class="stat-tile" data-bind="text: assessmentMostlyComplete"></span>\n                    </div>\n                </div>\n            </div>\n            <div class="footer stat-name">\n                majority\n            </div>\n        </div>\n    </li>\n    <li style="width:75px;height:75px; float: left; padding: 3px;">\n        <div class="tile" style="background-color: #49A;position:relative;" >\n            <div class="valign" style="height:100%">\n                <div class="center">\n                    <div class="metric" style="text-align: center;">\n                        <span style="font-size: 32px" class="stat-tile" data-bind="text: assessmentComplete"></span>\n                    </div>\n                </div>\n            </div>\n            <div class="footer stat-name">\n                complete\n            </div>\n        </div>\n    </li>\n</ul>\n'}),tadpoles.define("text!view/portfolioMetrics.html",[],function(){return'<div>\n\n    <div style="text-align: center" data-bind="visible:!hasPeriods()">\n        <h1 style="color: gray; font-size: 60px; line-height: 80px;">no periods defined</h1>\n        <button class="btn btn-success"  data-bind="click: editPeriod">\n                    Add a Period\n        </button>\n    </div>\n\n    <div style="text-align: center" data-bind="visible:!reportVisible() && hasPeriods()">\n        <!-- ko if:$root.isCurriculaMetricAccountGroupMaster() -->\n        <h1 style="color: gray; font-size: 60px; line-height: 130px;">select a curriculum</h1>\n        <!-- /ko -->\n\n        <!-- ko if:!$root.isCurriculaMetricAccountGroupMaster() -->\n        <h1 style="color: gray; font-size: 60px; line-height: 130px;">select a classroom</h1>\n        <!-- /ko -->\n    </div>\n    <!-- ko if:$root.currentUser.isAdmin() || $root.atFacility-->\n    <div style="margin-right: -5px;" class="pull-right" data-bind="visible:reportVisible() || participationMetrics()">\n        <button class="btn btn-success btn-mini" data-bind="click:printReport">\n        Print Report\n        </button>\n        <!-- ko if: selectedPeriod() && customCurriculaPeriodsActive() && $root.isMasterAccount() && ($root.currentUser.isAccountAdmin() || $root.currentUser.isCsr()) -->\n        <button style="vertical-align: middle; margin-left: 8px" data-bind="click: editPeriod" class="btn btn-mini btn-success pull-right">Edit Period</button>\n        <!-- /ko -->\n\n    </div>\n    <!-- /ko -->\n\n    <div class="pull-left" style="margin-top:15px;padding-right:15px;width:760px">\n        <!-- spinny -->\n        <div style="margin-top:10px;margin-left: 380px;" data-bind="visible:assessmentMetricsLoader.processing()">\n            <i class="fa fa-4x fa-spinner fa-spin"></i>\n        </div>\n\n        <!-- domain metrics -->\n        <div id="assess-printable" data-bind="visible: reportVisible()">\n            <style>\n                .metricCell {border-bottom: 1px solid #BFBFBF; padding:5px 2px;}\n                .metricHeader {background-color: #49AFCD; width: 70px; padding:5px 2px; color: #FFF; font-weight: bold}\n            </style>\n            <!-- ko if: (isPortfolioGrowthView() || isPortfolioProgressView()) && !assessmentMetricsLoader.processing()-->\n            <div style="text-align: center" data-bind="visible: hasPeriods() && assessmentMetricsForCurricula().length === 0">\n                <h1 style="color: gray; font-size: 60px; line-height: 70px;">this report is being created check back in a bit!</h1>\n            </div>\n            <!--  -->\n            <div style="text-align: center" data-bind="visible: assessmentMetricsForCurricula().length > 0 && (!assessmentMetrics() || !assessmentMetrics().domainMetrics || assessmentMetrics().domainMetrics.length === 0 )">\n                <h1 style="color: gray; font-size: 60px; line-height: 70px;">please select a period with assessment data</h1>\n            </div>\n            <div style="width:746px;padding:15px;margin-bottom:20px;margin-left:13px;background-color:#fff;page-break-inside:avoid;border:1px solid #CCC;" data-bind="visible: assessmentMetrics() && assessmentMetrics().isPrinting() ">\n                <h2 data-bind="text: reportHeader()"></h2>\n            </div>\n            <!-- ko if: assessmentMetrics() -->\n            <!-- ko foreach: assessmentMetrics().domainMetrics -->\n            <div style="width:746px;padding:15px;margin-bottom:20px;background-color:#fff;page-break-inside:avoid;" data-bind="style: { marginLeft: $parent.assessmentMetrics().isPrinting() ? \'13px\' : \'auto\',border: $parent.assessmentMetrics().isPrinting() ? \'1px solid #CCC\' : \'none\' }">\n                <h2 data-bind="text:$data.name" style="font-weight:normal;margin-bottom:10px;"></h2>\n                <!-- ko if: $data.ratings -->\n                <div style="margin-top:5px;margin-bottom:20px;">\n                    <table cellspacing="0" cellpadding="0" style="border-spacing: 0px;border-collapse:collapse;">\n                        <thead>\n                        <tr>\n                            <th style="width:420px;text-align:left">\n                            </th>\n                            <th style="width:20px;"></th>\n                            <th class="metricHeader" style="background-color: rgb(189, 143, 220);">rated</th>\n                            <th class="metricHeader" data-bind="text:$root.product.translate(\'assess:unmet\',\'unmet\')"></th>\n                            <th class="metricHeader" data-bind="text:$root.product.translate(\'assess:improved\',\'improved\')"></th>\n                            <th class="metricHeader" data-bind="text:$root.product.translate(\'assess:meets\',\'meets\')"></th>\n                            <th class="metricHeader" data-bind="text:$root.product.translate(\'assess:exceeds\',\'exceeds\')"></th>\n                        </tr>\n                        </thead>\n                        <tbody>\n                        <!-- ko foreach: $data.ratings -->\n                        <tr data-bind="popover: $data.getPopoverParams(), event:{ mouseover: function(){ $element.style.backgroundColor=\'#e3f3f8\';}, mouseout: function() { $element.style.backgroundColor=\'#fff\';}}">\n                            <td  style="text-align:left" class="metricCell">\n                                <div style="display:inline-block;vertical-align:middle;width:300px;overflow:hidden;text-overflow: ellipsis;">\n                                    <!-- todo externalId stuff -->\n                                    <span data-bind="text:$data.goalName"></span>\n                                </div>\n                            </td>\n                            <td class="metricCell">&nbsp;</td>\n                            <td  style="text-align: center" class="metricCell" >\n                                <span data-bind="text:$data.rated"></span>\n                            </td>\n                            <td  style="text-align: center; background-color: rgba(238, 238, 238, 0.22);" class="metricCell">\n                                <span data-bind="text:$data.unmet"></span>\n                            </td>\n                            <td  style="text-align: center; background-color: rgba(238, 238, 238, 0.22);" class="metricCell">\n                                <span data-bind="text:$data.improved"></span>\n                            </td>\n                            <td  style="text-align: center; background-color: rgba(238, 238, 238, 0.22);" class="metricCell">\n                                <span data-bind="text:$data.meets"></span>\n                            </td>\n                            <td  style="text-align: center; background-color: rgba(238, 238, 238, 0.22);" class="metricCell">\n                                <span data-bind="text:$data.exceeds"></span>\n                            </td>\n                        </tr>\n                        <!-- /ko -->\n                        </tbody>\n                    </table>\n                </div>\n                <!-- /ko -->\n            </div>\n            <!-- /ko -->\n            <!-- /ko -->\n            <!-- /ko -->\n            <!-- ko if: isPortfolioParticipationView() && participationMetrics()-->\n            <div style="width:746px;padding:15px;margin-bottom:20px;margin-left:13px;background-color:#fff;page-break-inside:avoid;border:1px solid #CCC;" data-bind="visible: participationMetrics().isPrinting() ">\n                <h2 data-bind="text: reportHeader()"></h2>\n            </div>\n            <div style="width:746px;padding:15px;margin-bottom:20px;background-color:#fff;page-break-inside:avoid;" data-bind="style: { marginLeft: participationMetrics().isPrinting() ? \'13px\' : \'auto\',border: participationMetrics().isPrinting() ? \'1px solid #CCC\' : \'none\' }">\n                <div style="margin-top:5px;margin-bottom:20px;">\n                    <table cellspacing="0" cellpadding="0" style="border-spacing: 0px;border-collapse:collapse;">\n                        <thead>\n                        <tr>\n                            <th style="width:520px;text-align:left">\n                            </th>\n                            <th style="width:20px;"></th>\n                            <th class="metricHeader">none</th>\n                            <th class="metricHeader">started</th>\n                            <th class="metricHeader">majority</th>\n                            <th class="metricHeader">complete</th>\n                        </tr>\n                        </thead>\n                        <tbody>\n                        <!-- ko foreach: participationMetrics().accountMetrics -->\n                        <tr>\n                            <td  style="text-align:left" class="metricCell">\n                                <div style="display:inline-block;vertical-align:middle;width:300px;overflow:hidden;text-overflow: ellipsis;">\n                                    <!-- todo externalId stuff -->\n                                    <span data-bind="text:$data.name"></span>\n                                </div>\n                            </td>\n                            <td class="metricCell">&nbsp;</td>\n                            <td  style="text-align: center" class="metricCell" >\n                                <span data-bind="text:$data.unassessed"></span>\n                            </td>\n                            <td  style="text-align: center" class="metricCell">\n                                <span data-bind="text:$data.assessmentStarted"></span>\n                            </td>\n                            <td  style="text-align: center" class="metricCell">\n                                <span data-bind="text:$data.assessmentMostlyComplete"></span>\n                            </td>\n                            <td  style="text-align: center" class="metricCell">\n                                <span data-bind="text:$data.assessmentComplete, style : {color:$data.assessmentCompleteColor }"></span>\n                            </td>\n                        </tr>\n                        <!-- /ko -->\n                        </tbody>\n                    </table>\n                </div>\n            </div>\n            <!-- /ko -->\n        </div>\n        <div class="alert alert-block alert-error" style="padding-right:14px" data-bind="visible: assessmentMetricsLoader.hasErrors()">\n            <h3 class="alert-heading">An error occurred!</h3>\n\n            <div data-bind="foreach: assessmentMetricsLoader.results.errors()">\n                <span data-bind="text: $data"></span>\n                <br/>\n            </div>\n        </div>\n    </div>\n    <!-- data-bind="visible: reportVisible() && (assessmentMetrics() || participationMetrics())" -->\n    <div data-bind="visible: reportVisible() || participationMetrics()" class="pull-right" style="width:135px;position:relative;overflow:hidden;margin-top:13px;margin-right:-15px;padding-right:0px;/*height:400px*/">\n        <div data-bind="visible: portfolioViewType() === \'growth\'"style="text-align: center; font-size: medium; color: grey; margin-bottom: 4px; margin-right: 10px">select a range</div>\n        <div style="display: inline-block;/*max-height: 400px*/; overflow: auto; padding-right: 8px; float:right">\n            <ul data-bind="visible: portfolioViewType() === \'growth\', style: { width : \'55px\' },tiles: {bricks: deltaPeriods(), template: \'view/tiles/templateWrapper\', numCols: 1, groutWidth: 4, textSizingRef:65, tileSize: 55}"></ul>\n        </div>\n        <div style="display: inline-block;/*max-height: 400px;*/ overflow: auto; padding-right: 8px; float: right" >\n            <ul data-bind="style: { width : \'55px\' },tiles: {bricks: periods(), template: \'view/tiles/templateWrapper\', numCols: 1, groutWidth: 4, textSizingRef:65, tileSize: 55}"></ul>\n        </div>\n    </div>\n    <div class="clearfix"></div>\n</div>\n'}),tadpoles.define("text!view/custom/bh-witw.html",[],function(){return'<div id="witw-printable" data-bind="style: {zoom: isPrinting() ? \'72%\' : \'100%\'}">\n    <!-- ko if: !isPrinting() -->\n    <div class=\'thumbnail-panel1\' style="min-height: 20px">\n        <div class="pull-right">\n            <button class="btn btn-success btn-mini" style="margin-left:5px;" data-bind="click:print">\n                Print Report\n            </button>\n        </div>\n        <div class="pull-right">\n            <button class="btn error btn-mini" style="margin-left:5px;" data-bind="click:$parent.close">\n                Close Window\n            </button>\n        </div>\n    </div>\n    <!-- /ko -->\n\n    <div style="text-align:center;margin:10px; padding-bottom: 5px;">\n        <h1 class="hero-h1 witw witw-header" >What in the <b><i>World</i></b></h1>\n        <h1 class="hero-h1 witw witw-header" style="padding-bottom: 20px;">Happened Today</h1>\n        <hr style="border-width: 2px;border-top-color:#BBBBBB;border-bottom-color:#BBBBBB;"/>\n        <div class="pull-left" style="text-align: left; margin-left: 5px; ">\n            <h3 class="panel-title">\n                <span class="witw witw-bold">Date: </span><span class="witw" data-bind="text: date().format(\'m/d/yyyy\') "></span>\n            </h3>\n        </div>\n\n        <div class="pull-right" style=" text-align: right; margin-right: 5px;">\n            <h3 class="panel-title">\n                <span class="witw witw-bold">Classroom: </span><span class="witw " data-bind="text: name() "></span>\n            </h3>\n        </div>\n        <div style="text-align: center;" >\n            <h3 class="panel-title">\n                <!-- ko if: getStaffCount() > 1 -->\n                <span class="witw witw-bold">Teachers: </span>\n                <!-- /ko -->\n                <!-- ko if: getStaffCount() <= 1 -->\n                <span class="witw witw-bold">Teacher: </span>\n                <!-- /ko -->\n                <span class="witw " data-bind="text: getStaffNames()"></span>\n            </h3>\n        </div>\n        <div style="clear: both"/>\n    </div>\n\n    <!-- ko if: activities().length > 0 -->\n    <ul class="unstyled dr-entries" style="margin-left: 10px; margin-right: 10px">\n        <!-- ko foreach: activities() -->\n        <li style="margin-bottom: 20px; border: 4px solid #BBBBBB; page-break-inside: avoid">\n            <div style="text-align:center; width: 100%;">\n                <h1 class="witw witw-header" style="padding-top: 15px;padding-bottom: 15px;">\n                    <!-- ko if: getGoals().length > 0-->\n                    <span style="text-transform: capitalize;" data-bind="text: getPrimary() +\' / \' +  getGoals().map(function(goal){ return goal.displayText(); }).join(\', \')"></span>\n                    <!-- /ko -->\n                    <!-- ko if: getGoals().length <= 0 -->\n                    <span style="text-transform: capitalize;"data-bind="text: getPrimary()"></span>\n                    <!-- /ko -->\n                </h1>\n            </div>\n            <table class="witw" style="width: 100%" cellpadding="0" cellspacing="0">\n                <tr>\n                    <td style="padding-left: 10px;">\n                        <span class="witw" data-bind="text: note"></span>\n                    </td>\n                    <td>\n                        <!-- ko if: $parent.getSecondarySnapshot(id()) -->\n                        <div data-bind="with: $parent.getSecondarySnapshot(id())">\n                            <div data-bind="template: {name: \'view/tiles/custom/witwTile\'}"></div>\n                        </div>\n                        <!-- /ko -->\n                    </td>\n                    <td>\n                        <!-- ko if: attachment() -->\n                        <div data-bind="template: {name: \'view/tiles/custom/witwTile\'}"></div>\n                        <!-- /ko -->\n                    </td>\n                </tr>\n            </table>\n        </li>\n        <!-- /ko -->\n    </ul>\n    <!-- /ko -->\n\n    <!-- ko if: $root.product.getBrandImageUrl(\'main-logo\') -->\n    <div style="text-align:center;margin:10px; padding-bottom: 5px;">\n        <img style="height:79px" data-bind="attr: { src : $root.product.getBrandImageUrl(\'main-logo\') }"/>\n    </div>\n    <!-- /ko -->\n</div>\n'}),tadpoles.define("text!view/tiles/addChildGuardianTile.html",[],function(){return'<li style="width:125px;height:125px;">\n    <div class="tile pointable" data-bind="style: {\'backgroundImage\': guardian.backgroundImage() }, click: toggleSelection" >\n        <div style="height:100%">\n            <div>\n                <div class="header mask" style="height:21%">\n                    <h5 class="note" data-bind="text: guardian.fullName()"></h5>\n                </div>\n            </div>\n            <!-- ko if:selected() -->\n            <div class="fill inside-border tile-menu-border"></div>\n            <!-- /ko -->\n        </div>\n    </div>\n</li>'}),tadpoles.define("text!view/tiles/addChildStudentTile.html",[],function(){return'<li style="width:125px;height:125px;">\n    <div class="tile pointable" data-bind="style: { backgroundImage: child.backgroundImage() }">\n        <div data-bind="click: $parent.selectSibling.bind($data)" style="position:relative;height:100%;">\n            <div class="mask" >\n                <h4 class="name note"><span data-bind="text: child.firstName"></span>&nbsp;<span data-bind="text: child.lastName"></span></h4>\n            </div>\n            <!-- ko if:selected() -->\n            <div class="fill inside-border tile-menu-border"></div>\n            <!-- /ko -->\n        </div>\n    </div>\n</li>\n'}),tadpoles.define("text!view/tiles/addChildTinyGuardianTile.html",[],function(){return'<li>\n    <div class="tile pointable" data-bind="style: {\'backgroundImage\': guardian.backgroundImage() }" >\n        <div style="height:100%">\n            <div>\n                <div class="header mask" style="height:21%;">\n                    <h5 class="note" style="line-height:12px;" data-bind="text: guardian.fullName()"></h5>\n                </div>\n            </div>\n        </div>\n    </div>\n</li>'}),tadpoles.define("text!view/tiles/addTile.html",[],function(){return'<div class="tile pointable action-tile" style="background-color:#6ba06c" data-bind="click:function(){ if($data.select) $data.select(); }">\n    <div class="valign">\n        <div class="center">\n            <h5>add</h5>\n            <strong class="plus">+</strong>\n        </div>\n    </div>\n</div>'}),tadpoles.define("text!view/tiles/allKidsTile.html",[],function(){return'<div class="tile pointable" style="position: relative; background-color: rgb(46, 167, 201);width: 75px; height: 75px" data-bind="click: function() { $root.childSelection(null);}, visible:$root.children().length > 1 ">\n    <div data-bind="visible: !$root.childSelection()" class="fill inside-border tile-menu-border"></div>\n    <div  style="height:100%">\n        <div class="valign" style="height:100%">\n            <div class="center">\n                <div class="metric" style="text-align: center;">\n                    <span class="stat-tile">A</span>\n                </div>\n            </div>\n        </div>\n        <div class="footer stat-name">all kids</div>\n    </div>\n</div>\n'}),tadpoles.define("text!view/tiles/classMetricTile.html",[],function(){return'<div class="valign" style="height:100%">\n    <div class="center">\n        <div class="metric">\n            <span class="stat-ok" data-bind="text: displayedMetric, css: metricClass"></span>\n        </div>\n    </div>\n</div>\n'}),tadpoles.define("text!view/tiles/classSelectorTile.html",[],function(){return'<li>\n    <div class="tile pointable" data-bind="style: {backgroundColor: color}">\n\n        <div data-bind="event: { mouseenter: enableActions, mouseleave: disableActions },delegatedClick: selectAndToggleMenu" style="height:100%">\n            <div style="position:relative;width:100%;height:75%">\n                <div class="class-triangle" style="position:absolute;"></div>\n                <div style="text-align:center;position:absolute;top:4px;left:0px;width:45px;" data-bind="style: { \'width\' : childrenForRoster().length < 99 ? 45 : 50 }">\n                    <span class="stat-ok stat-small-double" style="margin-right: 3px;" data-bind="text: childrenForRoster().length"></span><span style="vertical-align:top;" class="stat-ok stat-double-text" data-bind="visible:childrenForRoster().length < 100">kids</span>\n                </div>\n                <div style="text-align:center;position:absolute;bottom:0px;right:0px;width:65px;" data-bind="style: { \'width\' : capacity() < 99 ? 65 : 70 }">\n                    <span class="stat-grey stat-double-text">spots</span><span class="stat-grey stat-small-double" style="margin-left: 3px;" data-bind="text: calculateCapacity() || \'?\'"></span>\n                </div>\n            </div>\n            <div class="valign" style="height:25%">\n            <div class="center mask footer note" >\n                <span data-bind="text: name"> </span>\n            </div>\n            </div>\n            <!-- ko if:isActionsEnabled() || ($root.filter.group() && $root.filter.group().key === key)-->\n            <div class="fill inside-border tile-menu-border"></div>\n            <!-- /ko -->\n\n        </div>\n    </div>\n</li>\n'}),tadpoles.define("text!view/tiles/classTile.html",[],function(){return'<li>\n    <div class="tile pointable" data-bind="style: {backgroundColor: color}">\n\n        <div data-bind="event: { mouseenter: enableActions, mouseleave: disableActions }, delegatedClick: selectAndToggleMenu, popover: getPopoverParams()" style="height:100%">\n            <!-- ko if:isActive() -->\n            <div style="height:75%;">\n                <div style="position:relative;width:100%;height:100%" data-bind="template: metricTemplate"></div>\n            </div>\n            <!-- /ko -->\n            <div class="valign" style="height:25%">\n            <div class="center mask footer note" data-bind="css: {\'mask\': !isOutOfRatio()}, style: { \'backgroundColor\': isOutOfRatio() ? \'#DA4F49\' : \'transparent\'}">\n                <span data-bind="text: name"> </span>\n\n            </div>\n            </div>\n\n            <div class="fill inside-border tile-menu-border" data-bind="visible: isActionsEnabled() || ($root.filter.group() && $root.filter.group().key === key)"></div>\n            \n            <div class="tile-menu-indicator valign" style="width:25%;height:25%" data-bind="visible: isActionsEnabled()">\n                <div class="center">\n                    <i class="fa fa-chevron-right fa-white"></i>\n                </div>\n            </div>\n\n            <!-- ko if:$root.currentUser.isAdmin() -->\n            <div class="tile-menu valign" data-bind="visible: isMenuEnabled() && !isLocation()">\n                <div class="center" style="position:relative; padding:5px;">\n                    <!-- ko if:isClass() -->\n                    <!--\n                    DetailViewPanel.getInstance().portfolioActive()\n                    -->\n                    <!-- ko if:isActive() -->\n                     <div style="min-height: 25px;">\n                        <button style="width:85%;" class="btn btn-success btn-mini btn-action" data-bind="click: requestMove">\n                            move\n                        </button>\n                    </div>\n                    <div style="min-height: 25px;margin-top: 4px;">\n                        <button style="width:85%;" class="btn btn-warning btn-mini btn-action" data-bind="click: requestEdit">\n                            edit\n                        </button>\n                    </div>\n                    <div style="min-height: 25px;margin-top: 4px;">\n                        <button style="width:85%;" class="btn btn-danger btn-mini btn-action" data-bind="click: remove">\n                            delete\n                        </button>\n                    </div>\n                    <!-- /ko -->\n                    <!-- ko if:!isActive() -->\n                        <div style="min-height: 25px;margin-top: 4px;">\n                        <button style="width:85%;" class="btn btn-danger btn-mini btn-action" data-bind="click: revive">\n                            undelete\n                        </button>\n                    </div>\n                    <!-- /ko -->\n                    <!-- /ko -->\n                </div>\n            </div>\n            <!-- /ko -->\n\n        </div>\n    </div>\n</li>\n'}),tadpoles.define("text!view/tiles/copyClassTile.html",[],function(){return'<li>\n    <div class="tile pointable" data-bind="css: wrapped().child_type">\n        <div data-bind="click: toggleSelection" style="height:100%">\n            <div class="valign" style="height:25%">\n                <div class="center mask footer note">\n                    <span data-bind="text: wrapped().name"> </span>\n                </div>\n            </div>\n            <!-- ko if:selected() -->\n            <div class="fill inside-border tile-menu-border"></div>\n            <!-- /ko -->\n        </div>\n    </div>\n</li>\n'}),tadpoles.define("text!view/tiles/corpClassTile.html",[],function(){return'<li>\n    <div class="tile" data-bind="css: type">\n        <div style="height:100%">\n            <div style="height:75%">\n                <div style="position:relative;width:100%;height:100%"> \n                    <div class="stats-triangle" style="position:absolute;"></div>\n                    <div style="text-align:center;position:absolute;top:4px;left:0px;width:60px;" data-bind="style: { \'width\' : numChildrenIn() < 10 && numChildrenIn() > 99 ? 55 : 62 }">\n                        <span class="stat-ok stat-double" style="margin-right: 4px;" data-bind="text: numChildrenIn()"></span><span style="vertical-align:top;" class="stat-ok stat-double-text" data-bind="visible:numChildrenIn() < 100">kids</span>\n                    </div>\n                     <div style="text-align:center;position:absolute;bottom:0px;right:0px;width:60px;" data-bind="style: { \'width\' : numChildrenIn() < 10 && numChildrenIn() > 99 ? 55 : 62 }">\n                        <span class="stat-grey stat-double-text">staff</span><span class="stat-grey stat-double" style="margin-left: 4px;" data-bind="text: numStaffIn()"></span>\n                    </div>\n                </div>\n\n            </div>\n            <div class="mask footer note" style="height:25%">\n                <span data-bind="text: name"> </span>\n            </div>\n        </div>\n    </div>\n</li>\n\n'}),tadpoles.define("text!view/tiles/curriculumTile.html",[],function(){return'<li style="margin: 2px; height: 80px; width: 80px;">\n    <div class="tile pointable" data-bind="style: {backgroundColor: color}, click: function() { $parent.selectCurriculum(curriculumId);}">\n\n        <div style="height:100%">\n            <div style="height:75%;">\n                <div style="position:relative;width:100%;height:100%">\n                    <div class="valign" style="height:100%">\n                        <div class="center">\n                            <div class="metric">\n                                <span class="stat-medium stat-ok" data-bind="text:ratingCount()"></span>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class="valign" style="height:25%">\n            <div class="center mask footer note mask">\n                <span data-bind="text: curriculumName"> </span>\n            </div>\n            </div>\n\n            <div class="fill inside-border tile-menu-border" data-bind="visible:  $parent.activeCurriculumId() === curriculumId"></div>\n        </div>\n    </div>\n</li>\n'}),tadpoles.define("text!view/tiles/dailyReportClassTile.html",[],function(){return'<li>\n    <div class="tile pointable" data-bind="css: child_type">\n\n        <div data-bind="event: { mouseenter: enableActions, mouseleave: disableActions },click: $root.requestGroupChange" style="height:100%">\n            <div class="mask footer note" style="height:25%">\n                <span data-bind="text: name"> </span>\n            </div>\n\n            <!-- ko if:isActionsEnabled() || ($root.filter.group() && $root.filter.group().key === key) -->\n            <div class="fill inside-border tile-menu-border"></div>\n\n            <!-- ko if:isActionsEnabled() -->\n            <div class="tile-menu-indicator valign" style="width:25%;height:25%">\n                <div class="center">\n                    <i class="fa fa-chevron-right fa-white"></i>\n                </div>\n            </div>\n            <!-- /ko -->\n            <!-- /ko -->\n\n        </div>\n    </div>\n</li>\n'}),tadpoles.define("text!view/tiles/dailyReportStudentTile.html",[],function(){return'<li style="width:125px;height:125px;">\n    <div class="tile pointable" data-bind="style: { backgroundImage: backgroundImage() }, delegatedClick : $parent.selectReport.bind($parent, key, \'child\')">\n        <div data-bind="event: { mouseenter: enableActions, mouseleave: disableActions }" style="height:100%">\n            <!-- ko if: reportStatus() === \'unviewed\' || ((!wasInToday() || isOutForReason()) && !reportStatus()) -->\n            <div class="fill mask-30 abs-top-left"></div>\n            <!-- /ko -->\n\n            <div class="note" data-bind="css: { header: reportStatus() === \'unviewed\', unviewed: reportStatus() === \'unviewed\', mask: reportStatus() !== \'unviewed\' }">\n                <span data-bind="text: firstName"></span>&nbsp;<span data-bind="text: lastName"></span>\n            </div>\n\n            <!-- ko if: reportStatus() -->\n            <div class="footer note" data-bind="text: reportStatus(), css: reportStatusCSS()">\n            </div>\n            <!-- /ko -->\n            <!-- ko if: reportStatus() === \'unviewed\'-->\n            <div class="tile-unviewed-indicator valign" >\n                <div class="center">\n                    <i class="fa fa-exclamation-circle fa-white fa-3x"></i>\n                </div>\n            </div>\n            <!-- /ko -->\n            <!-- ko if:isActionsEnabled() || ($parent.report() && $parent.report().subject_key === key) -->\n            <div class="fill inside-border tile-menu-border"></div>\n\n            <!-- ko if:isActionsEnabled() -->\n            <div class="tile-menu-indicator valign" style="width:25%;height:25%">\n                <div class="center">\n                    <i class="fa fa-chevron-right fa-white"></i>\n                </div>\n            </div>\n            <!-- /ko -->\n            <!-- /ko -->\n        </div>\n    </div>\n</li>\n'}),tadpoles.define("text!view/tiles/eventTile.html",[],function(){return'<li style="width:125px;height:125px;">\n    <div class="tile pointable" data-bind="attr: {id: \'t-\' + id()}, style: {\'backgroundImage\': backgroundImage() },css: type === \'note\' && action === \'Alert\'? \'emergency_alert\' : \'\'">\n\n        <div style="height:100%;position:relative;" data-bind="event: { mouseenter: enableActions, mouseleave: disableActions },delegatedClick:toggleMenu, popover: getPopoverParams()">\n            <div data-bind="visible:!isActionsEnabled() || !hasMedia()">\n                <!-- ko if:title() -->\n                <div style="line-height:1;padding:2px 0px" class="header note" data-bind="css: headerCSS()">\n                    <span class="name"><span data-bind="text: title()"></span></span>\n                    <!-- ko if: inOutbox() -->\n                    <br/>\n                    <span style="font-size:80%;" data-bind="text: date.humaneDate(null,true,true)"></span>\n                    <!-- /ko -->\n                </div>\n                <!-- /ko -->\n                <!-- ko if:(portfolioView() || inOutbox())-->\n                    <div class="footer note" data-bind="css: sentTypeCSS()">\n                        <!-- ko if: type != \'note\' && comment()-->\n                            <span style="font-size:80%; display: inline-block" data-bind="text: comment()"></span>\n                        <!--/ko-->\n                        <!-- ko if: type == \'note\' || !comment()-->\n                            <span style="display: inline-block"></span>\n                        <!--/ko-->\n                    </div>\n                <!-- /ko -->\n                <!-- ko if: (!portfolioView() && !inOutbox()) && sentType() -->\n                <div class="footer note" data-bind="text: sentType(), css: sentTypeCSS()">\n                </div>\n                <!-- /ko -->\n                <!-- ko if:hasVideo() -->\n                    <div class="play-icon">\n                        <i class="fa fa-play-circle-o fa-3x" style="color:#FFF"></i>\n                    </div>\n                <!-- /ko -->\n            </div>\n            <!-- ko if:hasMedia()-->\n                <a class="fancybox" data-bind="attr: {id: \'a\' + \'-\' + id(), href: hasVideo() ? (\'#\' + id()) : attachmentUrl(), type: hasVideo() ? \'inline\' : \'image\', title: comment(), rel:galleryGroup() }"></a>\n                <!-- ko if:hasVideo() -->\n                <div style="display:none;background-color:black" data-bind="attr: {id: id(), rel: attachmentUrl() }, style: {width:width+\'px\', height:height+\'px\'}"></div>\n                <!--/ko-->\n            <!--/ko-->\n\n            <!-- ko if: type == \'dailyreport\' -->\n            <div class="valign" data-bind="style: { height: !title() ? \'79%\' : \'100%\' }">\n                <div class="center">\n                    <h2 style="line-height:1;"><span data-bind="text: getCurrentEventDateUTC().format(\'tinyDate\')"></span></h2>\n                </div>\n            </div>\n            <div class="mask footer note">\n                <span style="text-transform:lowercase;" data-bind="text: $root.product.translate(\'daily report\')"></span>\n            </div>\n            <!-- /ko -->\n\n            <!-- ko if: type == \'note\' -->\n            <div style="height:100%;overflow:hidden">\n            <div class="valign" style="height:100%" data-bind="style: { \'padding\': title() ? \'21% 0% 0% 0%\' : \'0px\' }">\n                <div>\n                    <div style="font-size: 12px; color:#49AFCD; font-weight: 400" data-bind="visible: isScheduled()">\n                        <span data-bind="text: scheduleDisplay()"></span>\n                    </div>\n                    <div class="center">\n                        <div style="min-height: 25px;padding: 0px 2px;">\n                            <span style="font-size:13px;" data-bind="text: comment()"></span>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            </div>\n            <!-- /ko -->\n\n\n            <div class="fill inside-border tile-menu-border" data-bind="visible: isActionsEnabled()"></div>\n            <div class="tile-menu-indicator valign" style="width:25%;height:25%" data-bind="visible: isActionsEnabled()">\n                <div class="center">\n                    <i class="fa fa-chevron-right fa-white"></i>\n                </div>\n            </div>\n            <div class="tile-menu valign" data-bind="visible: isMenuEnabled()">\n                <div class="center" style="position:relative; padding:5px;">\n                    <div style="min-height: 25px;">\n                        <button style="width:85%;" class="btn btn-success btn-mini btn-action" data-bind="click: showDetails">\n                            view\n                        </button>\n                    </div>\n                    <!-- ko if: $root.currentUser.isAdmin() -->\n                    <!-- ko if:inOutbox() || isScheduled() -->\n                    <div style="min-height: 25px;margin-top: 4px;">\n                        <button style="width:85%;" class="btn btn-info btn-mini btn-action" data-bind="click: edit">\n                            edit\n                        </button>\n                    </div>\n                    <!-- /ko -->\n                    <!-- ko if:inOutbox() -->\n                    <div style="min-height: 25px;margin-top: 4px;">\n                        <button style="width:85%;" class="btn btn-warning btn-mini btn-action" data-bind="click: approve">\n                            approve\n                        </button>\n                    </div>\n                    <!-- /ko -->\n                    <!-- ko if:!inOutbox() && !isScheduled() -->\n                    <div style="min-height: 25px;margin-top: 4px;">\n                        <button style="width:85%;" class="btn btn-warning btn-mini btn-action" data-bind="click: resend">\n                            resend\n                        </button>\n                    </div>\n                    <!--/ko-->\n                    <div style="min-height: 25px;margin-top: 4px;">\n                        <button style="width:85%;" class="btn btn-danger btn-mini btn-action" data-bind="click: remove">\n                            delete\n                        </button>\n                    </div>\n                    <!-- ko if:hasMedia() && !inOutbox() -->\n                    <div style="min-height: 25px;margin-top: 4px;">\n                        <button style="width:85%;" class="btn btn-inverse btn-mini btn-action" data-bind="click: download">\n                            save\n                        </button>\n                    </div>\n                    <!-- /ko -->\n                    <!-- /ko -->\n                </div>\n            </div>\n        </div>\n       \n\n    </div>\n</li>\n'}),tadpoles.define("text!view/tiles/evidenceTile.html",[],function(){return'<li>\n<div class="tile pointable" data-bind="attr: {id: \'t-\' + id()}, style: {\'backgroundImage\': backgroundImage() }">\n\n    <div style="height:100%;" data-bind="event: { mouseenter: function() {enableActions();onEnter();}, mouseleave: function() {disableActions();onLeave();} },click:toggleMenu, tooltip: mediaTitle() || false">\n        <div data-bind="visible:!isActionsEnabled()">\n        <!-- ko if:realDate -->\n            <div style="line-height:1;padding:2px 0px" class="header note mask">\n                <span class="name"><span data-bind="text: realDate.format(\'tinyDate\')"></span></span>\n            </div>\n        <!-- /ko -->\n\n        <!-- ko if:isvideo() -->\n        <div class="play-icon">\n            <i class="fa fa-play-circle-o fa-3x" style="color:#FFF"></i>\n        </div>\n        <!-- /ko -->\n        </div>\n        <a class="fancybox" data-bind="attr: {id: \'a\' + \'-\' + id(), href: isvideo() ? (\'#\' + id()) : largeImage(), type: isvideo() ? \'inline\' : \'image\', title: getNote(), rel:galleryGroup() }"></a>\n\n        <!-- ko if:isvideo() -->\n        <div style="display:none;background-color:black" data-bind="attr: {id: id(), rel: attachmentUrl() }, style: {width:width()+\'px\', height:height()+\'px\'}"></div>\n        <!--/ko-->\n        <!-- ko if: $root.currentUser.isAdmin() -->\n        <!-- ko if:isActionsEnabled() -->\n        <div class="fill inside-border tile-menu-border"></div>\n        <div class="tile-menu-indicator valign" style="width:25%;height:25%">\n            <div class="center">\n                <i class="fa fa-chevron-right fa-white"></i>\n            </div>\n        </div>\n        <!-- /ko -->\n\n        <div class="tile-menu valign" data-bind="visible: isMenuEnabled()">\n            <div class="center" style="position:relative; padding:5px;">\n                <div style="min-height: 25px;">\n                    <button style="width:85%;" class="btn btn-success btn-mini btn-action" data-bind="click: view">\n                        view\n                    </button>\n                    <button style="margin-top:4px; width:85%;" class="btn btn-info btn-mini btn-action" data-bind="click: function(){ $root.observations.editEvidence($data) }">\n                        edit\n                    </button>\n                </div>\n            </div>\n        </div>\n        <!-- /ko -->\n    </div>\n\n</div>\n</li>\n'}),tadpoles.define("text!view/tiles/guardianTile.html",[],function(){return'<li style="width:125px;height:125px;">\n    <div class="tile pointable" data-bind="style: {\'backgroundImage\': backgroundImage() },  event: { mouseenter: enableActions, mouseleave: disableActions }, click:!$root.config.isParentApp ? (key === \'__add__\' ? add.bind($data,$parent) : edit.bind($data,$parent)) : $parent.selectGuardian.bind($parent,$data)" >\n        <div data-bind="visible: key == \'__add__\', template:{ name: \'view/tiles/addTile\' }" style="height:100%"></div>\n        <div data-bind="visible: key != \'__add__\'" style="height:100%">\n            <div>\n                <div class="header mask note" style="height:21%">\n                    <h5 class="name" data-bind="text: firstName()"></h5>\n                </div>\n\n                <div class="footer mask note" data-bind="visible: primaryPhoneNumber() != null">\n                    <span data-bind="text: primaryPhoneNumber()"> </span>\n                </div>\n            </div>\n            <!-- ko if:isActionsEnabled() || isSelected() -->\n            <div class="fill inside-border tile-menu-border"></div>\n            <!-- /ko -->\n        </div>\n    </div>\n</li>'}),tadpoles.define("text!view/tiles/lessonTile.html",[],function(){return'<li>\n    <div class="tile pointable" data-bind="style: {\'backgroundColor\': backgroundColor() },delegatedClick: $parent.lesson">\n\n        <div data-bind="event: { mouseenter: enableActions, mouseleave: disableActions }" style="height:100%">\n            <!-- ko if:!isEditable() -->\n            <div class="fill mask-30 abs-top-left"></div>\n            <!-- /ko -->\n\n            <div class="valign" style="height:100%">\n                <div class="center">\n                    <div style="text-align:left;display:inline-block;color:#FFF">\n                        <span style="font-size:30px;" data-bind="style: { \'fontSize\' : subject_type===\'week\' ? \'24px\' : \'28px\'}, text: subject_type === \'week\' ? \'week\' : realDate.format(\'ddd\').toLowerCase()"></span>\n                        <br/>\n                        <span style="font-size:14px;" data-bind="text: realDate.format(\'tinyDate\')"> </span>\n                    </div>\n                </div>\n            </div>\n\n            \n            <!-- ko if:isActionsEnabled() || $parent.lesson() === $data -->\n            <div class="fill inside-border tile-menu-border"></div>\n            \n            <!-- ko if:isActionsEnabled() -->\n            <div class="tile-menu-indicator valign" style="width:25%;height:25%">\n                <div class="center">\n                    <i class="fa fa-chevron-right fa-white"></i>\n                </div>\n            </div>\n            <!-- /ko -->\n            <!-- /ko -->\n\n        </div>\n    </div>\n</li>\n'}),tadpoles.define("text!view/tiles/monthTile.html",[],function(){return'\n<div class="tile pointable" data-bind="click: select, style: {backgroundColor: selected() ? selectedColor :  \'#999\' }">\n    <div class="valign" style="height:100%">\n        <div class="center">\n            <div style="text-align:left;display:inline-block;color:#FFF">\n                <span style="font-size:190%;font-weight:200" data-bind="text: displayName "></span>\n                <br/>\n                <span style="font-size:100%;" data-bind="text: caption"></span>\n            </div>\n        </div>\n    </div>\n</div>\n'}),tadpoles.define("text!view/tiles/parentChildTile.html",[],function(){return'<li style="width:75px;height:75px;">\n    <div class="tile"  data-bind="style: { backgroundImage: backgroundImage() }, event: { mouseenter: enableActions, mouseleave: disableActions }, click: tileClicked">\n        <div style="position:relative;height:100%;">\n\n            <!-- ko if: !attachmentKey() -->\n            <div class="footer mask note" data-bind="css: { \'mask\' :  \'light-mask-90\'}">\n                <div style="color: #FFF;" class="name note"><span data-bind="text: firstName"></span></div>\n            </div>\n            <!-- /ko -->\n\n            <!-- ko if:isSelected() && $root.children().length != 1 -->\n            <div class="fill inside-border tile-menu-border"></div>\n            <!-- /ko -->\n\n        </div>\n    </div>\n\n</li>\n'}),tadpoles.define("text!view/tiles/parentEventTile.html",[],function(){return'<li style="width:125px;height:125px;">\n    <div class="tile pointable" data-bind="attr: {id: \'t-\' + id()}, style: {\'backgroundImage\': backgroundImage() },css: type === \'note\' && action === \'Alert\'? \'emergency_alert\' : \'\'">\n\n        <div style="height:100%;position:relative;" data-placement="in top" data-bind="event: { mouseenter: enableActions, mouseleave: disableActions },delegatedClick:showDetails">\n            <div data-bind="visible:!isActionsEnabled() || !hasMedia()">\n                <!-- ko if:title() && !hasMedia() -->\n                <div style="line-height:1;padding:2px 0px" class="header note" data-bind="css: headerCSS()">\n                    <span class="name"><span data-bind="text: title()"></span></span>\n\n                </div>\n                <!-- /ko -->\n                <!-- ko if: comment() && type != \'note\'-->\n                    <div class="footer note">\n                        <span style="font-size:80%" data-bind="text: comment()"> </span>\n                    </div>\n                <!-- /ko -->\n\n                <!-- ko if:hasVideo() -->\n                    <div class="play-icon">\n                        <i class="fa fa-play-circle-o fa-3x" style="color:#FFF"></i>\n                    </div>\n                <!-- /ko -->\n            </div>\n            <!-- ko if:hasMedia()-->\n                <a class="fancybox" data-bind="attr: {id: \'a\' + \'-\' + id(), href: hasVideo() ? (\'#\' + id()) : attachmentUrl(), type: hasVideo() ? \'inline\' : \'image\', title: comment(), rel:galleryGroup() }"></a>\n                <!-- ko if:hasVideo() -->\n                <div style="display:none;background-color:black" data-bind="attr: {id: id(), rel: attachmentUrl() }, style: {width:width+\'px\', height:height+\'px\'}"></div>\n                <!--/ko-->\n            <!--/ko-->\n\n            <!-- ko if: type == \'dailyreport\' -->\n            <div class="valign" data-bind="style: { height: !title() ? \'79%\' : \'100%\' }">\n                <div class="center">\n                    <h2 style="line-height:1;"><span data-bind="dateFormat: {date:getCurrentEventDateUTC(), format: \'tinyDate\'}"></span></h2>\n                </div>\n            </div>\n            <div class="mask footer note">\n                <span style="text-transform:lowercase;" data-bind="text: $root.product.translate(\'daily report\')"></span>\n            </div>\n            <!-- /ko -->\n\n            <!-- ko if: type == \'note\' -->\n            <div style="height:100%;overflow:hidden">\n            <div class="valign" style="height:100%" data-bind="style: { \'padding\': title() ? \'21% 0% 0% 0%\' : \'0px\' }">\n                <div class="center">\n                    <div style="min-height: 25px;padding: 0px 2px;">\n                        <span style="font-size:13px;" data-bind="text: comment()"></span>\n                    </div>\n                </div>\n            </div>\n            </div>\n            <!-- /ko -->\n\n\n            <div class="fill inside-border tile-menu-border" data-bind="visible: isActionsEnabled()"></div>\n\n        </div>\n       \n\n    </div>\n</li>\n'}),tadpoles.define("text!view/tiles/plainClassTile.html",[],function(){return'<li>\n    <div class="tile pointable" data-bind="css: child_type">\n        <div style="height:100%">\n            <div class="valign" style="height:25%">\n                <div class="center mask footer note">\n                    <span data-bind="text: name"> </span>\n                </div>\n            </div>\n        </div>\n    </div>\n</li>\n'}),tadpoles.define("text!view/tiles/portfolioEventTile.html",[],function(){return'<li style="width:125px;height:125px;">\n    <div class="tile pointable" data-bind="attr: {id: \'t-\' + id()}, style: {\'backgroundImage\': backgroundImage() },css: type === \'note\' && action === \'Alert\'? \'emergency_alert\' : \'\'">\n\n        <div style="height:100%;position:relative;" data-placement="top" data-bind="event: { mouseenter: enableActions, mouseleave: disableActions },delegatedClick:toggleSelection, tooltip: tooltip()">\n            <div data-bind="visible:!isActionsEnabled() || !hasMedia()">\n                <!-- ko if:title() -->\n                <div style="line-height:1;padding:2px 0px" class="header note" data-bind="css: headerCSS()">\n                    <span class="name"><span data-bind="text: title()"></span></span>\n\n                </div>\n                <!-- /ko -->\n                <!-- ko if: false && comment() && type != \'note\'-->\n                    <div class="mask footer note">\n                        <span style="font-size:80%" data-bind="text: comment()"> </span>\n                    </div>\n                <!-- /ko -->\n\n                <!-- ko if:hasVideo() -->\n                    <div class="play-icon">\n                        <i class="fa fa-play-circle-o fa-3x" style="color:#FFF"></i>\n                    </div>\n                <!-- /ko -->\n            </div>\n            <!-- ko if:hasMedia()-->\n                <a class="fancybox" data-bind="attr: {id: \'a\' + \'-\' + id(), href: hasVideo() ? (\'#\' + id()) : attachmentUrl(), type: hasVideo() ? \'inline\' : \'image\', title: comment(), rel:galleryGroup() }"></a>\n                <!-- ko if:hasVideo() -->\n                <div style="display:none;background-color:black" data-bind="attr: {id: id(), rel: attachmentUrl() }, style: {width:width+\'px\', height:height+\'px\'}"></div>\n                <!--/ko-->\n            <!--/ko-->\n\n            <!-- ko if: type == \'dailyreport\' -->\n            <div class="valign" data-bind="style: { height: !title() ? \'79%\' : \'100%\' }">\n                <div class="center">\n                    <h2 style="line-height:1;"><span data-bind="dateFormat: {date:date, format: \'tinyDate\'}"></span></h2>\n                </div>\n            </div>\n            <div class="mask footer note">\n                <span style="text-transform:lowercase;" data-bind="text: $root.product.translate(\'daily report\')"></span>\n            </div>\n            <!-- /ko -->\n\n            <!-- ko if: type == \'note\' -->\n            <div style="height:100%;overflow:hidden">\n            <div class="valign" style="height:100%" data-bind="style: { \'padding\': title() ? \'21% 0% 0% 0%\' : \'0px\' }">\n                <div class="center">\n                    <div style="min-height: 25px;padding: 0px 2px;">\n                        <span style="font-size:13px;" data-bind="text: comment()"></span>\n                    </div>\n                </div>\n            </div>\n            </div>\n            <!-- /ko -->\n\n\n            <div class="fill inside-border tile-selection-hover" data-bind="visible: isActionsEnabled()"></div>\n            <div class="fill inside-border tile-selected-portfolio-border" data-bind="visible: isSelected()"></div>\n            \n        </div>\n       \n\n    </div>\n</li>\n'}),tadpoles.define("text!view/tiles/portfolioPrintTile.html",[],function(){return'<li style="width:250px;height:250px;">\n    <div class="tile" data-bind="attr: {id: \'t-\' + id()}, style: {\'backgroundImage\': backgroundLargeImage() },css: type === \'note\' && action === \'Alert\'? \'emergency_alert\' : \'\'">\n\n        <div style="height:100%;position:relative;" data-placement="in top">\n            <div data-bind="visible:!isActionsEnabled() || !hasMedia()">\n\n                <!-- ko if: comment() && $parent.showNotes()-->\n                    <div style="line-height: 38px;" class="mask footer note">\n                        <span style="font-size:60%" data-bind="text: comment()"> </span>\n                    </div>\n                <!-- /ko -->\n            </div>\n\n\n            <!-- ko if: type == \'dailyreport\' -->\n            <div class="valign" data-bind="style: { height: !title() ? \'79%\' : \'100%\' }">\n                <div class="center">\n                    <h2 style="line-height:1;"><span data-bind="dateFormat: {date:date, format: \'tinyDate\'}"></span></h2>\n                </div>\n            </div>\n            <div class="mask footer note">\n                <span style="text-transform:lowercase;" data-bind="text: $root.product.translate(\'daily report\')"></span>\n            </div>\n            <!-- /ko -->\n\n            <!-- ko if: type == \'note\' -->\n            <div style="height:100%;overflow:hidden">\n            <div class="valign" style="height:100%" data-bind="style: { \'padding\': title() ? \'21% 0% 0% 0%\' : \'0px\' }">\n                <div class="center">\n                    <div style="min-height: 25px;padding: 0px 2px;">\n                        <span style="font-size:13px;" data-bind="text: comment()"></span>\n                    </div>\n                </div>\n            </div>\n            </div>\n            <!-- /ko -->\n\n            \n        </div>\n       \n\n    </div>\n</li>\n'}),tadpoles.define("text!view/tiles/rosterTile.html",[],function(){return'<li style="width:75px;height:75px;">\n    <div class="tile pointable" style="position:relative;" data-bind="style: { backgroundColor : color() } , delegatedClick: $root.roster.selectGroup">\n        <div data-bind="event: { mouseenter: enableActions, mouseleave: disableActions }" style="height:100%">\n            <div class="valign" style="height:100%">\n                <div class="center">\n                    <div class="metric" style="text-align: center;">\n                        <span class="stat-tile" data-bind="text: selectedCount()"></span>\n                    </div>\n                </div>\n            </div>\n            <div class="footer stat-name" data-bind="text: name()">\n            </div>\n\n            <!-- ko if:isActionsEnabled() || $root.roster.filter() === value() -->\n            <div class="fill inside-border tile-menu-border"></div>\n\n            <!-- ko if:isActionsEnabled() -->\n            <div class="tile-menu-indicator valign" style="width:25%;height:25%">\n                <div class="center">\n                    <i class="icon-chevron-right icon-white"></i>\n                </div>\n            </div>\n            <!-- /ko -->\n            <!-- /ko -->\n        </div>\n    </div>\n</li>\n'}),tadpoles.define("text!view/tiles/rosterGridTile.html",[],function(){return'<li style="width:45px;height:45px; margin: 0">\n    <div class="tile" style="border-color: white; border-width: 1px; border-style: solid;" data-bind="style: { backgroundColor: color()}">\n\n        <div style="height:100%">\n            <div style="position:relative;width:100%;height:98%">\n                <div class="class-triangle" style="position:absolute; border-top-width: 44px; border-right-width: 44px; opacity: 1.0" data-bind="style: { borderRightColor: shared() ? \'white\' : color()}"></div>\n                <div class="class-triangle" style="position:absolute; border-top-width: 45px; border-right-width: 45px; opacity: 1.0;" data-bind="style: { borderRightColor: sharedColor()}"></div>\n                <div style="text-align:center;position:absolute;top:2px;left:0px;width:32px;">\n                    <span class="stat-small-double pointable" style="margin-right: 3px; font-size: 11px; color: white;" data-bind="text: displayName(), click: click"></span>\n                    <span style="vertical-align:top;" class="stat-ok stat-double-text"></span>\n                </div>\n                <div style="text-align:center;position:absolute;bottom:0px;right:6px">\n                    <span class="stat-small-double pointable" style="margin-left: 3px; font-size: 11px; color: white;" data-bind="text: sharedDisplayName(), click: clickShared"></span>\n                </div>\n            </div>\n            <!--<div class="valign" style="height:25%">\n            <div class="center mask footer note" >\n                <span > </span>\n            </div>\n            </div>-->\n        </div>\n    </div>\n</li>'}),tadpoles.define("text!view/tiles/snapshotTile.html",[],function(){return'<div class="tile pointable" style="width:75px;height:75px;" data-bind="attr: {id: \'t-\' + id()}, style: {\'backgroundImage\': backgroundImage(), \'backgroundColor\' : ispdf() ? \'white\' : \'#dddddd\' }">\n\n    <!-- ko !if:ispdf() -->\n    <a class="fancybox" data-bind="attr: {id: \'a\' + \'-\' + id(), href: isvideo() ? (\'#\' + id()) : largeImage(), type: isvideo() ? \'inline\' : \'image\', title: getNote(), rel:galleryGroup() }"></a>\n    <!-- /ko -->\n\n    <div style="height:100%;position:relative;" data-bind="event: { mouseenter: enableActions, mouseleave: disableActions }, click: $parent.isEditable() ? toggleMenu : view">\n\n        <!-- ko if:isvideo() -->\n        <div class="play-icon">\n            <i class="fa fa-play-circle-o fa-3x" style="color:#FFF"></i>\n        </div>\n        <!-- /ko -->\n\n        <!-- ko if:isvideo() -->\n        <div style="display:none;background-color:black" data-bind="attr: {id: id(), rel: largeImage() }, style: {width:width()+\'px\', height:height()+\'px\'}"></div>\n        <!--/ko-->\n\n        <!-- ko if:isActionsEnabled() -->\n        <div class="fill inside-border tile-menu-border"></div>\n        <div class="tile-menu-indicator valign" style="width:25%;height:25%">\n            <div class="center">\n                <i class="fa fa-chevron-right fa-white"></i>\n            </div>\n        </div>\n        <!-- /ko -->\n        <div class="tile-menu valign" data-bind="visible: isMenuEnabled()">\n            <div class="center" style="position:relative; padding:5px;">\n                <div style="min-height: 20px;">\n                    <button style="width:85%;" class="btn btn-success btn-mini btn-action" data-bind="click: view">\n                        view\n                    </button>\n                </div>\n                <!-- ko if: $parent.isEditable() && !ispdf()-->\n                <div style="min-height: 20px;margin-top: 4px;">\n                    <button style="width:85%;" class="btn btn-info btn-mini btn-action" data-bind="click: edit">\n                        edit\n                    </button>\n                </div>\n                <!-- /ko -->\n                <!-- ko if: $parent.isEditable() -->\n                <div style="min-height: 20px;margin-top: 4px;">\n                    <button style="width:85%;" class="btn btn-danger btn-mini btn-action" data-bind="click: $root._.bind(remove, $data, $parent)">\n                        delete\n                    </button>\n                </div>\n                <!-- /ko -->\n            </div>\n        </div>\n    </div>\n\n</div>\n'}),tadpoles.define("text!view/tiles/studentAndStaffTile.html",[],function(){return'<!-- ko if: $root.detailViewPanel.countOption() === $root.detailViewPanel.CountOptions.EXPECTED_REMAINING -->\n<div class="stats-triangle" style="position:absolute;"></div>\n<div style="text-align:center;position:absolute;top:4px;left:0px;width:60px;" data-bind="style: { \'width\' : numChildrenExpected() < 10 && numChildrenExpected() > 99 ? 55 : 62 }">\n    <span class="stat-ok stat-double" style="margin-right: 4px;" data-bind="text: numChildrenExpected()"></span><span style="vertical-align:top;" class="stat-ok stat-double-text" data-bind="visible:numChildrenExpected() < 100">exp</span>\n</div>\n<div style="text-align:center;position:absolute;bottom:0px;right:0px;width:60px;" data-bind="style: { \'width\' : numChildrenOut() < 10 && numChildrenOut() > 99 ? 55 : 62 }">\n    <span class="stat-grey stat-double-text" data-bind="visible: numChildrenOut() < 100 ">remain</span><span class="stat-grey stat-double" style="margin-left: 4px;" data-bind="text: numChildrenOut()"></span>\n</div>\n<!-- /ko -->\n<!-- ko if: $root.detailViewPanel.countOption() === $root.detailViewPanel.CountOptions.EXPECTED_IN -->\n<div class="stats-triangle" style="position:absolute;"></div>\n<div style="text-align:center;position:absolute;top:4px;left:0px;width:60px;" data-bind="style: { \'width\' : numChildrenExpected() < 10 && numChildrenExpected() > 99 ? 55 : 62 }">\n    <span class="stat-ok stat-double" style="margin-right: 4px;" data-bind="text: numChildrenExpected()"></span><span style="vertical-align:top;" class="stat-ok stat-double-text" data-bind="visible:numChildrenExpected() < 100">exp</span>\n</div>\n<div style="text-align:center;position:absolute;bottom:0px;right:0px;width:60px;" data-bind="style: { \'width\' : numChildrenIn() < 10 && numChildrenIn() > 99 ? 55 : 62 }">\n    <span class="stat-grey stat-double-text" style="margin-left:13px">in</span><span class="stat-grey stat-double" style="margin-left: 4px;" data-bind="text: numChildrenIn()"></span>\n</div>\n<!-- /ko -->\n<!-- ko if: $root.detailViewPanel.countOption() === $root.detailViewPanel.CountOptions.RATIOS -->\n<div class="stats-triangle" style="position:absolute;"></div>\n<div style="text-align:center;position:absolute;top:4px;left:0px;width:60px;" data-bind="style: { \'width\' : numChildrenIn() < 10 && numChildrenIn() > 99 ? 55 : 62 }">\n    <span class="stat-ok stat-double" style="margin-right: 4px;" data-bind="text: numChildrenIn()"></span><span style="vertical-align:top;" class="stat-ok stat-double-text" data-bind="visible:numChildrenIn() < 100">kids</span>\n</div>\n<div style="text-align:center;position:absolute;bottom:0px;right:0px;width:60px;" data-bind="style: { \'width\' : numChildrenIn() < 10 && numChildrenIn() > 99 ? 55 : 62 }">\n    <span class="stat-grey stat-double-text">staff</span><span class="stat-grey stat-double" style="margin-left: 4px;" data-bind="text: numStaffIn()"></span>\n</div>\n<!-- /ko -->\n<!-- ko if: $root.detailViewPanel.countOption() === $root.detailViewPanel.CountOptions.STUDENTS_IN -->\n<div class="valign" style="height:100%">\n    <div class="center">\n        <div class="metric">\n            <span class="stat-ok stat-medium" data-bind="text: numChildrenIn()"></span>\n        </div>\n    </div>\n</div>\n<!-- /ko -->\n<!-- ko if: $root.detailViewPanel.countOption() === $root.detailViewPanel.CountOptions.STAFF_IN -->\n<div class="valign" style="height:100%">\n    <div class="center">\n        <div class="metric">\n            <span class="stat-ok stat-medium" data-bind="text: numStaffIn()"></span>\n        </div>\n    </div>\n</div>\n<!-- /ko -->\n'}),tadpoles.define("text!view/tiles/studentTile.html",[],function(){return'<li style="width:125px;height:125px;">\n    <div class="tile pointable" data-content="<div data-bind=&quot;template: { name: \'view/tiles/studentTileMenu\' }&quot;></div>" data-bind="style: { backgroundImage: backgroundImage() }">\n        \n        \n        <div data-bind="event: { mouseenter: enableActions, mouseleave: disableActions },delegatedClick: tileClicked" style="position:relative;height:100%;">\n      \n            <div class="mask" data-bind="css: { \'mask-red-50\' : type() !== \'employee\' && tsg_link_error , \'medium-mask-70\' : type() !== \'employee\' && !tsg_link_error, \'medium-mask-70\' : type() === \'employee\' && isAdmin() , \'light-mask-90\' : type() === \'employee\' && !isAdmin() }">\n                <div class="name note" data-bind="style : { \'color\' : type() != \'employee\' ? \'#FFF\' : \'#333\'} "><i class="fa fa-chain-broken" style="color: white; margin-right: 4px;" data-bind="visible: type() !==\'employee\' && tsg_link_error"></i><span data-bind="text: firstName"></span>&nbsp;<span data-bind="text: lastName"></span></div>\n            </div>\n\n            <!-- ko if: $root.detailViewPanel.rosterActive()-->\n            <div class="footer note" data-bind="css: { \'mask\' : \'true\' }, style: { \'backgroundColor\' : \'transparent\' }">\n                <!-- ko if: pipelineNote()-->\n                <div>\n                    <span data-bind="text: pipelineNote()"> </span>\n                </div>\n                <!-- /ko -->\n                <!-- ko if: age()-->\n                <div>\n                    <span data-bind="text: age"> </span>\n                </div>\n                <!-- /ko -->\n            </div>\n            <!-- /ko -->\n\n            <!-- ko if: !$root.detailViewPanel.rosterActive() && (note() != null || isOutForReason() || showWhereToFindMe()) -->\n            <div class="footer note" data-bind="css: { \'mask\' : !isScheduledToday() || (!isOutForReason() && !showWhereToFindMe()) }, style: { \'backgroundColor\': isTouring() ? \'green\' : isSick() ? \'#49AFCD\' : isVacation() ? \'#DA4F49\' : isOtherAbsence() ? \'#5bb75b\' : showWhereToFindMe() ? \'#FAA732\' : \'transparent\'}">\n                <span data-bind="text: isTouring() ? \'touring\' : isOutForReason() ? outText() : showWhereToFindMe() ? whereToFindMe() : note"> </span>\n            </div>\n            <!-- /ko -->\n\n            <!-- ko if: !$root.detailViewPanel.rosterActive() && (isOutForReason() || showWhereToFindMe())-->\n            <div class="fill mask-30 abs-top-left"></div>\n            <!-- /ko -->\n\n            <!-- ko if:isActionsEnabled() -->\n            <div class="fill inside-border tile-menu-border"></div>\n            <div class="tile-menu-indicator valign" style="width:25%;height:25%">\n                <div class="center">\n                    <i class="fa fa-chevron-right fa-white"></i>\n                </div>\n            </div>\n            <!-- /ko -->\n            <div class="tile-menu" data-bind="visible: isMenuEnabled()">\n                <div class="center" style="position:relative; padding:5px;">\n                    <div style="min-height: 25px;">\n                        <button style="width:85%;" class="btn btn-success btn-mini btn-action" data-bind="click: edit">\n                            profile\n                        </button>\n                    </div>\n                    <!-- ko if: $root.isAttendanceEnabled() && isActive() -->\n                    <div style="min-height: 25px;margin-top:4px;">\n                        <button style="width:85%;" class="btn btn-info btn-mini btn-action" data-bind="click: requestAttendance">\n                            check <span data-bind="text: otherState()"></span>\n                        </button>\n                    </div>\n                    <!-- /ko -->\n                    <div style="min-height: 25px;margin-top: 4px;">\n                        <button style="width:85%;" class="btn btn-danger btn-mini btn-action" data-bind="click: outToday">\n                            out a day\n                        </button>\n                    </div>\n                    <!-- ko if:canMove() -->\n                    <div style="min-height: 25px;margin-top: 4px;">\n                        <button style="width:85%;" class="btn btn-inverse btn-mini btn-action" data-bind="click: requestMove">\n                            move\n                        </button>\n                    </div>\n                    <!-- /ko -->\n                    <!-- ko if:isChild() -->\n                    <div style="min-height: 25px;margin-top: 4px;">\n                        <button style="width:85%;" class="btn btn-warning btn-mini btn-action" data-bind="click: sendNote">\n                            send note\n                        </button>\n                    </div>\n                    <!-- /ko -->\n                </div>\n            </div>\n        \n        </div>\n    </div>\n\n</li>\n'}),tadpoles.define("text!view/tiles/studentTileMenu.html",[],function(){return'<div class="center" style="position:relative; width: 80px; padding:5px;background-color: #333;">\n    <div style="min-height: 25px;">\n        <button style="width:85%;" class="btn btn-success btn-mini btn-action" data-bind="click: edit">\n            profile\n        </button>\n    </div>\n    <!-- ko if: $root.isAttendanceEnabled() && isActive() -->\n    <div style="min-height: 25px;margin-top:4px;">\n        <button style="width:85%;" class="btn btn-info btn-mini btn-action" data-bind="click: requestAttendance">\n            check <span data-bind="text: otherState()"></span>\n        </button>\n    </div>\n    <!-- /ko -->\n</div>\n'}),tadpoles.define("text!view/tiles/templateWrapper.html",[],function(){return'<li data-bind="template: { name: $data.template, data: $data }">\n</li>'}),tadpoles.define("text!view/tiles/eventStudentTagTile.html",[],function(){return'<li style="width:125px;height:125px;">\n    <div class="tile pointable" data-bind="event: { mouseenter: enableActions, mouseleave: disableActions, click: disableActions }, click: $parent.removeTag.bind($data, key), style: { backgroundImage: backgroundImage() }" style="position:relative;height:100%">\n    \n        <div class="footer note mask" data-bind="style : { \'color\' : \'#FFF\'} "><span data-bind="text: fullName()"></span></div>\n\n        <!-- ko if:isActionsEnabled() -->\n        <div class="fill inside-border tile-remove-border"></div>\n        <div class="tile-remove-indicator valign" style="width:25%;height:25%">\n            <div class="center">\n                <i class="fa fa-times fa-white"></i>\n            </div>\n        </div>\n        <!-- /ko -->\n\n    </div>\n</li>\n'}),tadpoles.define("text!view/tiles/eventClassTagTile.html",[],function(){return'<li style="width:125px;height:125px;">\n    <div class="tile pointable" data-bind="event: { mouseenter: enableActions, mouseleave: disableActions, click: disableActions }, click: $parent.removeTag.bind($data, key), css: child_type" style="position:relative;height:100%">\n\n        <div class="footer note mask" data-bind="style : { \'color\' : \'#FFF\'} "><span data-bind="text: name"></span></div>\n\n        <!-- ko if:isActionsEnabled() -->\n        <div class="fill inside-border tile-remove-border"></div>\n        <div class="tile-remove-indicator valign" style="width:25%;height:25%">\n            <div class="center">\n                <i class="fa fa-times fa-white"></i>\n            </div>\n        </div>\n        <!-- /ko -->\n    </div>\n</li>\n'}),tadpoles.define("text!view/tiles/eventLocationTagTile.html",[],function(){return'<li style="width:125px;height:125px;">\n    <div class="tile pointable infants" data-bind="event: { mouseenter: enableActions, mouseleave: disableActions, click: disableActions }, click: $parent.removeTag.bind($data, key)" style="position:relative;height:100%">\n\n        <div class="footer note mask" data-bind="style : { \'color\' : \'#FFF\'} "><span data-bind="text: name"></span></div>\n\n        <!-- ko if:isActionsEnabled() -->\n        <div class="fill inside-border tile-remove-border"></div>\n        <div class="tile-remove-indicator valign" style="width:25%;height:25%">\n            <div class="center">\n                <i class="fa fa-times fa-white"></i>\n            </div>\n        </div>\n        <!-- /ko -->\n    </div>\n</li>\n'}),tadpoles.define("text!view/tiles/custom/witwTile.html",[],function(){return"<div class=\"tile\" style=\"width:320px;height:240px;\" data-bind=\"attr: {id: id()}, style: {'backgroundImage': backgroundImage(), 'backgroundColor' : ispdf() ? 'white' : '#dddddd' }\">\n\n</div>\n"}),tadpoles.define("text!view/modals/addClassForm.html",[],function(){return'<label><h4 style="color:gray;">class name</h4></label>\n<input class="span3" type="text" data-bind="value: name, valueUpdate: \'afterkeydown\'" placeholder="my class"/>\n<label><h4 style="color:gray;">child type</h4></label>\n<select class="span3" data-bind="options: $root.displayableChildTypes(), optionsValue: \'key\', optionsText: \'value\', value: child_type, optionsCaption: \'choose a child type...\'"></select>\n'}),tadpoles.define("text!view/modals/addEmployeeForm.html",[],function(){return'<div style="width:530px;">\n    <div class="alert alert-block alert-info">\n        <div style="float:left">\n            <label><h4 style="color:black;">full name</h4></label>\n            <input class="span3" type="text" data-bind="value: fullName, valueUpdate: \'afterkeydown\'" placeholder="first and last name"/>\n\n            <label><h4 style="color:black;">role</h4></label>\n            <select class="span3" style="margin-bottom: 10px;" data-bind="options: $root.roleChoices(), optionsText: \'name\', optionsValue: \'value\', value: role, optionsCaption: \'choose a role...\'"></select>\n\n            <!-- ko if: role() && isRole(\'AccountAdmin\') == false && ($root.currentUser.isAccountAdmin() || $root.currentUser.isCsr()) -->\n            <label><h4 style="color:black;">location</h4></label>\n            <select class="span3" data-bind="options: $root.locations(), optionsText: \'name\', optionsValue: \'key\', value: location, optionsCaption: \'choose a location...\'"></select>\n            <!-- /ko -->\n            <!-- ko if: isRole(\'Employee\') && location() -->\n            <label><h4 style="color:black;">classroom</h4></label>\n            <select class="span3" data-bind="options: simpleGroupsForLocation(), optionsText: \'name\', optionsValue: \'key\', value: homeroom_key"></select>\n            <!-- /ko -->\n        </div>\n        <div style="float:right;width:47%">\n            <!-- ko if: isRole(\'Employee\') -->\n            Teachers can be assigned to a classroom. If assigned a classroom they will only see that classroom\n            for lesson planning purposes. Additionally they will automatically show up in that classroom for\n            attendance purposes.\n            <!--/ko-->\n            <!-- ko if: !role() -->\n            &nbsp;\n            <!--/ko -->\n        </div>\n        <div style="clear:both;"></div>\n    </div>\n    <div class="alert alert-block alert-warning">\n        <div style="float:left">\n            <label><h4 style="color:black;">pin code (4-digits)</h4></label>\n            <input class="span3" type="text" maxlength="4" data-bind="value: pin"/>\n        </div>\n        <div style="float:right;height:100%;width:47%">\n            PIN codes are used for staff timekeeping and are optional. If not assigned, staff can check in\n            without a PIN code right in the App.\n            <a href="http://help.tadpoles.com/customer/portal/articles/1280774-staff-sign-in" class="btn btn-mini" target="_new">More\n                help</a>\n\n        </div>\n        <div style="clear:both;"></div>\n    </div>\n    <div class="alert alert-block alert-danger" style="margin-bottom:0">\n        <div style="float:left">\n            <label><h4 style="color:black;">email address</h4></label>\n            <input class="span3" type="text" data-bind="value: email, valueUpdate: \'afterkeydown\'" placeholder="employeelogin@email.com"/>\n\n            <!-- ko if: isRole(\'Employee\') && email() -->\n            <div>\n                <div style="float: left; width: 210px; margin-bottom: 10px;">\n                    <input style="margin-top: 0px;" type="checkbox" data-bind="checked: allowEmployeeWebLogin" ><span style="margin-left: 4px; color: black;">&nbsp;Allow Web Login</span>\n                </div>\n            </div>\n            <!-- /ko -->\n\n\n\n            <label><h4 style="color:black;">phone number</h4></label>\n            <input class="span3" type="text" placeholder="123.456.7890" data-bind="value: mobile_number"/>\n        </div>\n\n        <div style="float:right;width:47%;">\n            <!-- ko if: isRole(\'Employee\') -->\n            Adding an email will allow the teacher to login via the web and enter lesson plans only.  <p style="margin-top: 4px;">Deselect <strong>Allow Web Login</strong> to use a teacher\'s email address for communication only.\n            <a href="http://help.tadpoles.com/customer/portal/articles/1251403-creating-lesson-plans" class="btn btn-mini" target="_new">More\n                help</a></p>\n            <!-- /ko -->\n            <!-- ko if: isRole(\'AccountAdmin\') || isRole(\'LocationAdmin\') -->\n            Adding an email will allow this employee to login to the director\'s dashboard and the mobile app.\n            <!-- /ko -->\n            <!-- ko if: !role() -->\n            Email addresses are optional and used as a username to login. Select the role of the employee to see\n            how emails are used for each role.\n            <!-- /ko -->\n        </div>\n        <div style="clear:both;"></div>\n    </div>\n</div>\n\n'}),tadpoles.define("text!view/modals/addGuardianForm.html",[],function(){return'<div style="max-height: 532px;overflow:auto">\n    <div style="padding-bottom:10px;">\n        <div style="float:left;">\n            <label><h4 style="color:gray;">full name</h4></label>\n            <input class="span3" type="text" data-bind="value: fullName, valueUpdate: \'afterkeydown\'" placeholder="first and last name"/>\n            <label><h4 style="color:gray;">email address</h4></label>\n            <input class="span3" type="text" data-bind="value: email, valueUpdate: \'afterkeydown\'" placeholder="guardian@email.com"/>\n            <label><h4 style="color:gray;">type</h4></label>\n            <select class="span3" data-bind="options: $root.guardianTypes(), value: type, optionsCaption: \'choose a guardian type...\'"></select>\n        </div>\n\n        <div class="span3" style="float:right">\n            <div class="alert alert-block alert-info">\n                <h4 class="alert-heading">Note:</h4>\n                You must enter the first and last name of the guardian, or their email address (or both), as well as the guardian type.\n            </div>\n        </div>\n        <div style="clear:both;"></div>\n    </div>\n    <hr style="margin:8px 0px;">\n    <div>\n        <h3 style="text-align:center;color:gray;">optional</h3>\n        <div style="float:left;">\n            <label><h4 style="color:gray;">mobile phone</h4></label>\n            <input class="span3" type="text" data-bind="value: mobile_number, valueUpdate: \'afterkeydown\'" placeholder="(555) 555-5555"/>\n            <label><h4 style="color:gray;">home phone</h4></label>\n            <input class="span3" type="text" data-bind="value: home_number, valueUpdate: \'afterkeydown\'" placeholder="(555) 555-5555"/>\n            <label><h4 style="color:gray;">work phone</h4></label>\n            <input class="span3" type="text" data-bind="value: work_number, valueUpdate: \'afterkeydown\'" placeholder="(555) 555-5555"/>\n        </div>\n        <div style="float:right;">\n            <label><h4 style="color:gray;">pin code (4-digits)</h4></label>\n            <input class="span3" type="text" maxlength="4" data-bind="value: pin" />\n        </div>\n        <div style="clear: both;"></div>\n        <div style="float:left;">\n            <label><h4 style="color:gray;">note</h4></label>\n            <textarea class="span3" style="height: 54px;" type="text" data-bind="value: note" maxlength="250"></textarea>\n        </div>\n        <div style="float:right;">\n            <label><h4 style="color:gray;">special note</h4></label>\n            <textarea class="span3" style="height: 54px;" type="text" data-bind="value: special_note" maxlength="250"></textarea>\n        </div>\n    </div>\n</div>\n\n'}),tadpoles.define("text!view/modals/addModal.html",[],function(){return'<!-- ko if: formModel() -->\n<div>\n    <div class="modal-header">\n        <i class="pull-right modal-close-button fa fa-times" data-bind="click: close, visible:!processing()"></i>\n        <h1 data-bind="attr: { id: id+\'-pop\' }, text: title(), popover: popoverParams(), style: { fontSize : titleSize()} "></h1>\n        <!-- ko if: subtitle() -->\n        <h3 data-bind="text: subtitle()"></h3>\n        <!-- /ko -->\n    </div>\n    <div class="modal-body" style="position:relative;overflow:auto;max-height:650px;">\n        <div data-bind="visible: (!processing() || uploading()) && !hasErrors()">\n            <div data-bind="template: { name: formTemplate(), data: formModel() }"></div>\n        </div>\n        <div class="alert alert-block alert-error" style="padding-right:14px" data-bind="visible: hasErrors()">\n            <h3 class="alert-heading">Oops!</h3>\n            <div data-bind="foreach: results.errors()">\n                <span data-bind="text: $data"></span>\n                <br/>\n            </div>\n        </div>\n        <div style="height:100px;width:100%;text-align:center;" data-bind="visible: processing() && !uploading()">\n            <i class="fa fa-spinner fa-spin fa-4x"></i>\n        </div>\n    </div>\n    <div class="modal-footer">\n        <button class="btn btn-primary btn-large pull-right" style="margin-left:10px;" data-bind="click: submit, visible: !processing() &&!hasErrors(), text: submitText()">\n        </button>\n        <!-- ko if:cancelText() -->\n            <button class="btn btn-large pull-right" data-bind="click: close, visible: !processing() &&!hasErrors(), text: cancelText()">\n            </button>\n        <!-- /ko -->\n        <button class="btn btn-danger btn-large pull-right" data-bind="click: results.clear, visible: hasErrors()">\n            try again\n        </button>\n    </div>\n</div>\n\n<!-- /ko -->\n'}),tadpoles.define("text!view/modals/addTour.html",[],function(){return'<div class="pull-left" style="background-color:#f2f2f2;width:250px;padding:15px;height:320px;overflow:hidden;">\n    <h3 style="color:gray;margin-bottom:15px;"><span style="font-size:30px;margin-right:10px;">1.</span>child info</h3>\n    <label><h4 style="color:gray;">child\'s full name</h4></label>\n    <input class="span3" style="font-size:20px;height:20px;width:240px;" data-bind="value: fullName, valueUpdate: \'afterkeydown\'"/>\n    <label><h4 style="color:gray;">classroom</h4></label>\n    <select class="span3" style="width:250px;" data-bind="options: $root.groups.groupsForCurrentLocation, optionsValue: \'key\', optionsText: \'name\', optionsCaption: \'Choose a classroom...\', value: groupKey"></select>\n    <label><h4 style="color:gray;">tour date</h4></label>\n    <input class="span3" style="height:20px;width:240px;" data-bind="datepicker: tourDate, datepickerOptions: { minDate: 0 }" />\n</div>\n<div class="pull-left" style="margin-left:20px;background-color:#f2f2f2;width:250px;padding:15px;height:320px;overflow:hidden;">\n    <h3 style="color:gray;margin-bottom:15px;"><span style="font-size:30px;margin-right:10px;">2.</span>parent info</h3>\n    <label><h4 style="color:gray;">parent\'s full name</h4></label>\n    <input class="span3" style="font-size:20px;height:20px;width:240px;" data-bind="value: parentFullName, valueUpdate: \'afterkeydown\'"/>\n    <label><h4 style="color:gray;">parent\'s email</h4></label>\n    <input class="span3" type="email" style="font-size:20px;height:20px;width:240px;" data-bind="value: parentEmail, valueUpdate: \'afterkeydown\'"/>\n    <label><h4 style="color:gray;">parent\'s phone</h4></label>\n    <input class="span3" type="email" style="font-size:20px;height:20px;width:240px;" data-bind="value: parentPhone, valueUpdate: \'afterkeydown\'"/>\n\n</div>\n\n<div class="clearfix"></div>\n'}),tadpoles.define("text!view/modals/alertModal.html",[],function(){return'<div>\n    <div class="modal-body">\n        <div class="alert alert-block" style="padding-right:14px;margin-bottom:0px" data-bind="css: \'alert-\' + alertStyle()">\n            <h2 class="alert-heading" data-bind="text: title()"></h2>\n            <span style="white-space:pre-wrap" data-bind="text: message()"></span>\n            <div data-bind="visible: errors().length > 0">\n                <ul class="unstyled" style="margin-top:15px;">\n                    <!-- ko foreach: errors() -->\n                        <li><span data-bind="text: $data"></span></li>\n                    <!-- /ko -->\n                </ul>\n            </div>\n            <!-- ko if:templateData() -->\n            <div data-bind="visible: templateName(), template: { name : templateName(), data : templateData()}"></div>\n            <!-- /ko -->\n            <br/>\n            <div style="text-align:center">\n                <!-- ko if: (type() == \'yesno\' || type() == \'approveok\' || type() == \'retry\') -->\n                <button class="btn btn-large" style="margin-top:20px;margin-right:10px;min-width:60px;" data-bind="click: close.bind($data,\'cancel\'), css: \'btn-warning\'">\n                    <span data-bind="text: cancelDisplay()"></span>\n                </button>\n                <!-- /ko -->\n                <button class="btn btn-large" style="margin-top:20px;min-width:60px;" data-bind="click: close.bind($data,\'success\'), css: \'btn-\' + (type() == \'yesno\' ? \'danger\' : buttonStyle())">\n                    <span data-bind="text: okDisplay()"></span>\n                </button>\n\n            </div>\n        </div>\n    </div>\n</div>\n'}),tadpoles.define("text!view/modals/attendanceChart.html",[],function(){return'<div class="modal-header">\n    <i class="pull-right modal-close-button fa fa-times" data-bind="click: $parent.close"></i>\n    <h1 class="hero-h1"><span data-bind="text: title()"></span></h1>\n    <h1 style="font-size: 25px;" class="nav-title"><span data-bind="text: subTitle()"></span></h1>\n</div>\n<div class="modal-body" style="max-height:700px;">\n    <style>\n            div.google-visualization-tooltip { z-index: 9999 }\n            li.google-visualization-tooltip-item { margin: 0 }\n    </style>\n    <!--ko if: !averageTypeActive() -->\n        <div id="attendance_chart_div" ></div>\n        <div id="toolbar_div" ></div>\n    <!-- /ko -->\n    <!-- ko if: averageTypeActive() -->\n        <div class="pull-left" style="width:50%" id="attendance_chart_0" ></div>\n        <div class="pull-left" style="width:50%" id="attendance_chart_1" ><h1>Loading</h1></div>\n        <div class="pull-left" style="width:50%" id="attendance_chart_2" ><h1>Loading</h1></div>\n        <div class="pull-left" style="width:50%" id="attendance_chart_3" ><h1>Loading</h1></div>\n        <div class="pull-left" style="width:50%" id="attendance_chart_4" ><h1>Loading</h1></div>\n        <div class="pull-left" style="width:50%" id="attendance_chart_5" ><h1>Loading</h1></div>\n        <div class="pull-left" style="width:50%" id="attendance_chart_6" ></div>\n        <div id="toolbar_div_1" ></div>\n        <div id="toolbar_div_2" ></div>\n        <div id="toolbar_div_3" ></div>\n        <div id="toolbar_div_4" ></div>\n        <div id="toolbar_div_5" ></div>\n\n        <div class="clearfix"></div>\n    <!-- /ko -->\n</div>\n<div class="modal-footer">\n\n    <ul class="nav nav-pills pull-left" style="margin-bottom:0px;">\n        <li data-bind="css: { \'active\' : countsTypeActive() }" >\n            <a href="#" class="dash emphasized " data-bind="click: chooseTypeCounts, tooltip: \'This will stack each count showing location totals\'"><h4 style="line-height:1">classroom counts</h4></a>\n        </li>\n        <li data-bind="css: { \'active\' : inRatioTypeActive() }">\n            <a href="#" class="dash emphasized nav-emergency" data-bind="click: chooseTypeInRatio, tooltip: \'This will layer each classroom\'"><h4 style="line-height:1">ratios</h4></a>\n        </li>\n\n        <!-- ko if:$root.currentUser.isAdmin() -->\n        <li data-bind="css: { \'active\' : averageTypeActive() }" >\n            <a href="#" class="dash emphasized " data-bind="click: chooseTypeAverage, tooltip: \'This will show a trailing average for the last month on this day of the week\'"><h4 style="line-height:1">trailing average</h4></a>\n        </li>\n        <!--/ko-->\n    </ul>\n\n    <button class="btn btn-primary pull-right btn-large" data-bind="click: $parent.close">\n        Done\n    </button>\n</div>\n'}),tadpoles.define("text!view/modals/attendanceReport.html",[],function(){return'<div id="attendance-printable" data-bind="style: {zoom: isPrinting() ? \'76%\' : \'100%\'}">\n<div class="modal-header">\n    <i class="pull-right modal-close-button fa fa-times" data-bind="click: $parent.close,visible:!isPrinting()"></i>\n    <!-- ko if: staffActive() -->\n        <!-- ko if: planningActive() -->\n        <h1 class="hero-h1"><span>Planning Report</span> <span style="margin-left: 8px;color:#999;font-size:24px;" >for Staff</span></h1>\n        <!-- /ko -->\n        <!-- ko if: !planningActive() -->\n        <h1 class="hero-h1"><span>Payroll Report</span> <span style="margin-left: 8px;color:#999;font-size:24px;" >for Staff</span></h1>\n        <!-- /ko -->\n    <!-- /ko -->\n    <!-- ko if: studentsActive() -->\n        <!-- ko if: planningActive() -->\n        <h1 class="hero-h1"><span>Planning Report</span> <!-- ko if: selectedClassroom() --><span style="margin-left: 8px;color:#999;font-size:24px;" data-bind="text: titleText()"></span> <!-- /ko --></h1>\n        <!-- /ko -->\n        <!-- ko if: mealDistributionActive() -->\n        <h1 class="hero-h1"><span>Meal Distributions</span> <!-- ko if: selectedClassroom() --><span style="margin-left: 8px;color:#999;font-size:24px;" data-bind="text: titleText"></span> <!-- /ko --></h1>\n        <!-- /ko -->\n        <!-- ko if: !planningActive() && !mealDistributionActive() -->\n        <h1 class="hero-h1"><span>Attendance Report</span> <!-- ko if: selectedClassroom() --><span style="margin-left: 8px;color:#999;font-size:24px;" data-bind="text: titleText"></span> <!-- /ko --></h1>\n        <!-- /ko -->\n    <!-- /ko -->\n    <!-- ko if: sickActive() -->\n    <h1 class="hero-h1"><span>Sickness Report</span></h1>\n    <!-- /ko -->\n</div>\n<div class="modal-body" style="overflow:auto" data-bind="style: {maxHeight: isPrinting() ? \'none\' : \'500px\', height: isPrinting() ? \'auto\' : \'500px\'}">\n    <!-- ko if: !selectedClassroom() && studentsActive() -->\n    <div class="centered" style="margin-top:200px;">\n        <h1 class="empty-text">please select a class and date below</h1>\n    </div>\n    <!-- /ko -->\n    <!-- ko if: selectedClassroom() || staffActive() || sickActive() -->\n    <div style="width:896px;" class="report" data-bind="css:{\'monthly-report\' : isMonthly}">\n        <ul style="margin: 0px;">\n            <!-- ko foreach:dates -->\n            <li class="tile report-cell" data-bind="style: {backgroundColor:$data.bg}">\n                <div class="valign center" style="height:100%;margin-top:10px;">\n                    <div data-bind="style: { textAlign: $parent.isMonthly() ? \'center\' : \'left\'}" style="display:inline-block">\n                        <div class="report-cell-name"  data-bind="text: $data.name, style: { color: $data.color, fontSize: $index() === 0 ? \'28px\' : \'\' }"></div>\n                        <div class="report-cell-date"  data-bind="text: $data.date"></div>\n                        <!-- ko if: $parent.studentsActive() && $parent.planningActive() && $index() > 0 -->\n                        <span style="font-size:12px;" data-bind="text: $data.numScheduledIn"></span> <span style="font-size:11px;">expected</span>\n                        <!-- /ko -->\n                    </div>\n                </div>\n            </li>\n            <!-- /ko -->\n            <!-- ko if: !planningActive() && !sickActive() -->\n            <li data-bind="visible: !processing()" class="report-cell report-cell-total tile" style="background-color: rgb(169, 169, 169);">\n                <div class="valign center" style="height:100%;margin-top:10px;">\n                    <div style="text-align:left;display:inline-block;">\n                        <span style="font-size: 28px;">total</span>\n                        <br>\n                        <span style="font-size:14px;">&nbsp;</span>\n                    </div>\n                </div>\n            </li>\n            <!-- /ko -->\n        </ul>\n        <div style="height:270px;width:100%" data-bind="visible: processing(), spin: {trigger:processing(),color:\'#000\'}"></div>\n        <!-- ko with: studentWeeklyAttendance -->\n        <!-- ko foreach: {data: studentsAttendance, as: \'studentAttendance\'} -->\n        <ul style="margin: 0px;">\n            <li class="report-cell report-cell-child tile" style="background-color: rgb(251, 180, 80);">\n                <div class="valign center" style="height:100%;margin-top:10px;" >\n                    <div style="text-align:left;display:inline-block;width:110px;" data-bind="style : {width: $parents[2].isMonthly() ? \'86px\' : \'110px\'}">\n                        <span class="first-name" data-bind="text:firstName"></span>\n                        <br>\n                        <span style="font-size:14px;" data-bind="text:lastName"></span>\n                        <br>\n                        <span style="font-size:10px;" data-bind="text:birthDate"></span>\n                    </div>\n                </div>\n            </li>\n            <!-- ko foreach: {data: studentAttendance.attendance(), as: \'day\'} -->\n                <!-- ko if: day.wasOutAllDay() && !$parents[3].mealDistributionActive()-->\n                    <li class="report-cell tile" data-bind="click: day.edit, style: {\'background-color\': day.absenceBackgroundColor(day.status()==\'sick\')}, css: {pointable: day.isEditable()}">\n                        <div class="valign center" style="height:100%;margin-top:20px;">\n                            <div style="text-align:left;display:inline-block;margin:5px">\n                                <!-- ko if: day.isSickReport() -->\n                                    <span style="font-size: 18px;" data-bind="text: day.note"></span>\n                                <!-- /ko -->\n                                <!-- ko if: !day.isSickReport() -->\n                                    <span style="font-size: 18px;" data-bind="text: day.status"></span>\n                                <!-- /ko -->\n                            </div>\n                        </div>\n                    </li>\n                <!-- /ko -->\n\n                <!-- ko if: !day.wasOutAllDay() || $parents[3].mealDistributionActive()-->\n                    <!-- ko if: $parents[3].mealDistributionActive()-->\n                    <li>\n                        <div class="monthly-meal-dist-cell">\n                            <div class="monthly-meal-dist-meal-cell">\n                                <div data-bind="style: { color: day.hadBreakfast() ? \'#959595\' : \'white\'}">B</div>\n                            </div>\n                            <div class="monthly-meal-dist-meal-cell">\n                                <div data-bind="style: { color: day.hadLunch() ? \'#959595\' : \'white\'}" >L</div>\n                            </div>\n                            <div class="monthly-meal-dist-meal-cell">\n                                <div data-bind="style: { color: day.hadDinner() ? \'#959595\' : \'white\'}" >D</div>\n                            </div>\n                            <div class="monthly-meal-dist-meal-cell">\n                                <div data-bind="style: { color: day.hadSnack() ? \'#959595\' : \'white\'}" >S</div>\n                            </div>\n                        </div>\n                    </li>\n                    <!-- /ko -->\n                    <!-- ko if: $parents[3].timesActive() -->\n                    <li class="report-cell report-cell-half tile" data-bind="click: day.edit, style: {\'background-color\': day.inCellBackgroundColor()}, css: {pointable: day.isEditable()}">\n                        <div class="valign center" style="height:100%;margin-top:7px">\n                        <!-- ko foreach: {data: day.checkpoints, as: \'cp\'} -->\n                            <!-- ko if: day.hasMultipleNonAbsence() && !cp.wasAbsent() -->\n                            <div style="display:inline-block;">\n                                <span style="font-size:16px;line-height:1" data-bind="text:cp.displayInTimeOnly()"></span>\n                                <span style="font-size:10px;line-height:1" data-bind="text:cp.inMeridian()"></span>\n                            </div>\n                            <!-- /ko -->\n                            <!-- ko if: !day.hasMultipleNonAbsence() && !cp.wasAbsent() -->\n                            <div style="text-align:left;display:inline-block;margin-top:8px">\n                                <span style="font-size:20px;line-height:1" data-bind="text:cp.displayInTimeOnly()"></span>\n                                <br/>\n                                <span style="font-size:14px;line-height:1" data-bind="text:cp.inMeridian()"></span>\n                            </div>\n                            <!-- /ko -->\n                        <!-- /ko -->\n                        </div>\n                    </li>\n                    <li class="report-cell report-cell-half tile" data-bind="click: day.edit, style: {\'background-color\': day.outCellBackgroundColor()}, css: {pointable: day.isEditable()}">\n                        <div class="valign center" style="height:100%;margin-top:7px">\n                        <!-- ko foreach: {data: day.checkpoints, as: \'cp\'} -->\n                            <!-- ko if: day.hasMultipleNonAbsence() && !cp.wasAbsent()-->\n                            <div style="text-align:left;display:inline-block;">\n                                <span style="font-size: 16px; line-height:1" data-bind="text:cp.displayOutTimeOnly() || \'&nbsp;\'"></span>\n                                <span style="font-size:10px; line-height:1" data-bind="text:cp.outMeridian() || \'&nbsp;\'"></span>\n                            </div>\n                            <!-- /ko -->\n                            <!-- ko if: !day.hasMultipleNonAbsence() && !cp.wasAbsent()-->\n                            <div style="text-align:left;display:inline-block;margin-top:8px" >\n                                <span style="font-size: 20px;line-height:1" data-bind="text:cp.displayOutTimeOnly()"></span>\n                                <br>\n                                <span style="font-size:14px;line-height:1" data-bind="text:cp.outMeridian()"></span>\n                            </div>\n                            <!-- /ko -->\n                        <!-- /ko -->\n                        </div>\n                    </li>\n                    <!-- /ko -->\n\n                    <!-- ko if: $parents[2].hoursActive() -->\n                    <li class="report-cell tile" data-bind="click: day.edit, style:{\'background-color\': day.hoursOrTransitionsCellBackgroundColor()}, css: {pointable: day.isEditable()}">\n                        <div class="hours-full">\n                            <span style="font-size: 28px;" data-bind="text: day.hours().toFixed(1)"></span>\n                        </div>\n                    </li>\n                    <!-- /ko -->\n\n                    <!-- ko if: $parents[2].transitionsActive() -->\n                    <li class="report-cell tile" data-bind="click: day.edit, style:{\'background-color\': day.hoursOrTransitionsCellBackgroundColor()}, css: {pointable: day.isEditable()}">\n                        <div class="transitions-full">\n                        <!-- ko foreach: {data: day.transitions(), as: \'transition\'} -->\n                            <span style="font-size: 9px;display: block;" data-bind="text: transition"></span>\n                        <!-- /ko -->\n                        </div>\n                    </li>\n                    <!-- /ko -->\n\n                    <!-- ko if: $parents[2].namesToFacesActive() -->\n                    <li class="report-cell tile" data-bind="click: day.edit, style:{\'background-color\': day.hoursOrTransitionsCellBackgroundColor()}, css: {pointable: day.isEditable()}">\n                        <div class="transitions-full">\n                        <!-- ko foreach: {data: day.namesToFaces(), as: \'ntf\'} -->\n                            <span style="font-size: 9px;display: block;" data-bind="text: ntf"></span>\n                        <!-- /ko -->\n                        </div>\n                    </li>\n                    <!-- /ko -->\n\n                    <!-- ko if: $parents[2].planningActive() -->\n                    <li class="report-cell tile" data-bind="click: day.edit, style:{\'background-color\': day.planningBackgroundColor()}, css: {pointable: day.isEditable()}">\n                        <div class="valign center" style="height:100%;margin-top:20px;">\n                            <!-- ko if: day.scheduled && day.planned_absence -->\n                                <div style="text-align:left;display:inline-block;margin:5px">\n                                    <span style="font-size: 18px;" data-bind="text: day.planned_absence.type"></span>\n                                </div>\n                            <!-- /ko -->\n                            <!-- ko if: !day.scheduled -->\n                                <div style="text-align:left;display:inline-block;margin:5px">\n                                    <span style="font-size: 18px;">unscheduled</span>\n                                </div>\n                            <!-- /ko -->\n                        </div>\n                    </li>\n                    <!-- /ko -->\n                <!-- /ko -->\n            <!-- /ko -->\n\n            <!-- ko if: !$parents[2].planningActive() && !$parents[2].sickActive() && !$parents[2].mealDistributionActive()-->\n            <li class="report-cell report-cell-total">\n                <div class="tile" style="background-color: #A9A9A9;">\n                    <div style="height:100%">\n                        <!-- ko if: $parents[2].studentsActive() -->\n                        <div class="hours-full">\n\n                            <span style="font-size:28px" data-bind="text: studentAttendance.regularHours().toFixed(1)"></span>\n                        </div>\n                        <!-- /ko -->\n                        <!-- ko if: $parents[2].staffActive() -->\n                        <div class="hours-triangle"></div>\n                        <div class="hours-top">\n                            <span class="stat-white report-hours" style="margin-right: 4px;" data-bind="text: studentAttendance.regularHours().toFixed(1),css: { \'report-hours-small\':studentAttendance.overtimeHours() >= 10 }"></span><span class="stat-white stat-double-text" style="vertical-align:top">HRS</span>\n                        </div>\n                        <div class="hours-bottom">\n                            <span class="stat-grey stat-double-text">OT</span><span class="stat-grey report-hours" style="margin-left: 4px;" data-bind="text: studentAttendance.overtimeHours().toFixed(1), css: { \'report-hours-small\':studentAttendance.overtimeHours() >= 10 }"></span>\n                        </div>\n                        <!-- /ko -->\n                    </div>\n                </div>\n            </li>\n            <!-- /ko -->\n            <!-- ko if: !$parents[2].planningActive() && !$parents[2].sickActive() && $parents[2].mealDistributionActive()-->\n            <li class="report-cell report-cell-total" style="width: 78px; margin: 1px;">\n                <div class="tile" style="background-color: #A9A9A9;">\n                    <div style="height:100%">\n                        <!-- ko if: $parents[2].studentsActive() -->\n                        <div class="hours-full">\n\n                            <span style="font-size:28px" data-bind="text: studentAttendance.totalMealDistributions()"></span>\n                        </div>\n                        <!-- /ko -->\n                    </div>\n                </div>\n            </li>\n            <!-- /ko -->\n        </ul>\n        <!-- /ko -->\n        <!-- /ko -->\n\n\n        <!-- ko if: mealDistributionActive() -->\n        <ul style="margin: 0px; margin-top: 20px;" data-bind="visible: !processing()">\n\n            <li style="margin-left: 130px;" class="tile meal-dist-total-cell" >\n                <div class="valign center" style="height:100%;margin-top:10px;">\n                    <div style="text-align:center;display:inline-block">\n                        <span style="font-size: 28px;">Breakfast</span>\n                        <br>\n                        <span style="font-size:20px;" data-bind="text: studentWeeklyAttendance().totalBreakfastDistributions()"></span>\n                    </div>\n                </div>\n            </li>\n            <li class="tile meal-dist-total-cell" >\n                <div class="valign center" style="height:100%;margin-top:10px;">\n                    <div style="text-align:center;display:inline-block">\n                        <span style="font-size: 28px;">Lunch</span>\n                        <br>\n                        <span style="font-size:20px;" data-bind="text: studentWeeklyAttendance().totalLunchDistributions()"></span>\n                    </div>\n                </div>\n            </li>\n            <li class="tile meal-dist-total-cell" >\n                <div class="valign center" style="height:100%;margin-top:10px;">\n                    <div style="text-align:center;display:inline-block">\n                        <span style="font-size: 28px;">Dinner</span>\n                        <br>\n                        <span style="font-size:20px;" data-bind="text: studentWeeklyAttendance().totalDinnerDistributions()"></span>\n                    </div>\n                </div>\n            </li>\n            <li class="tile meal-dist-total-cell" >\n                <div class="valign center" style="height:100%;margin-top:10px;">\n                    <div style="text-align:center;display:inline-block">\n                        <span style="font-size: 28px;">Snack</span>\n                        <br>\n                        <span style="font-size:20px;" data-bind="text: studentWeeklyAttendance().totalSnackDistributions()"></span>\n                    </div>\n                </div>\n            </li>\n            <li class="tile meal-dist-total-cell" >\n                <div class="valign center" style="height:100%;margin-top:10px;">\n                    <div style="text-align:center;display:inline-block">\n                        <span style="font-size: 28px;">Meals</span>\n                        <br>\n                        <span style="font-size:20px;" data-bind="text: studentWeeklyAttendance().totalMealDistributions()"></span>\n                    </div>\n                </div>\n            </li>\n\n        </ul>\n        <!-- /ko -->\n\n\n\n    </div>\n    <!-- /ko -->\n</div>\n<div class="modal-footer" style="background-color:white;" data-bind="visible:!isPrinting()">\n     <ul class="nav nav-pills pull-left" style="margin-bottom:0px;">\n        <li data-bind="css: { \'active\' : studentsActive() }" >\n            <a href="#" class="dash emphasized" data-bind="click: chooseStudents"><h4 style="line-height:1">students</h4></a>\n        </li>\n        <li data-bind="css: { \'active\' : staffActive() }">\n            <a href="#" class="dash emphasized" data-bind="click: chooseStaff"><h4 style="line-height:1">staff</h4></a>\n        </li>\n        <li data-bind="css: { \'active\' : sickActive() }">\n            <a href="#" class="dash emphasized" data-bind="click: chooseSick"><h4 style="line-height:1">sick</h4></a>\n        </li>\n\n    </ul>\n    <!--ko if: !sickActive() -->\n    <ul class="nav nav-pills pull-left" style="margin-bottom:0px;width: 292px;margin-left:10px;">\n        <li data-bind="css: { \'active\' : timesActive() }" >\n            <a href="#" class="dash emphasized nav-labels" data-bind="click: chooseTimes, tooltip: \'Show attendance times\'"><h4 style="line-height:1">times</h4></a>\n        </li>\n\n        <li data-bind="css: { \'active\' : hoursActive() }">\n            <a href="#" class="dash emphasized nav-warn" data-bind="click: chooseHours, tooltip: \'Show attendance hours\'"><h4 style="line-height:1">hours</h4></a>\n        </li>\n        <li data-bind="css: { \'active\' : transitionsActive() }">\n            <a href="#" class="dash emphasized nav-green" data-bind="click: chooseTransitions, tooltip: \'Show transitions\'"><h4 style="line-height:1">transitions</h4></a>\n        </li>\n        <li data-bind="css: { \'active\' : planningActive() }">\n            <a href="#" class="dash emphasized nav-blue" data-bind="click: choosePlanning, tooltip: \'Show planning calendar\'"><h4 style="line-height:1">planning</h4></a>\n        </li>\n        <!--ko if: studentsActive() -->\n        <li data-bind="css: { \'active\' : namesToFacesActive() }">\n            <a href="#" class="dash emphasized nav-blue" data-bind="click: chooseNamesToFaces, tooltip: \'Show name to faces\'"><h4 style="line-height:1">name to faces</h4></a>\n        </li>\n        <li data-bind="css: { \'active\' : mealDistributionActive() }">\n            <a href="#" class="dash emphasized" data-bind="click: chooseMealDistribution, tooltip: \'Show meal distributions\'"><h4 style="line-height:1">meal distributions</h4></a>\n        </li>\n        <!-- /ko -->\n    </ul>\n    <!-- /ko -->\n    <!--ko if: studentsActive() || allActive() -->\n        <div class="pull-left" style="margin-left:10px;margin-top:3px;width:184px;">\n            <select style="font-size:16px;margin-bottom:0px; width: 184px;"data-bind="options: classrooms, optionsText: \'name\', value: selectedClassroom, optionsCaption: \'Choose a classroom\'"></select>\n        </div>\n    <!-- /ko -->\n    <div class="input-append pull-left" style="margin-bottom:0px;margin-top:3px; margin-left: 10px;" >\n        <!-- ko if: !sickActive() && planningActive() -->\n            <input style="width:86px;margin-bottom:0px;font-size:16px;" data-bind="datepicker: date, datepickerOptions: { minDate : 0, selectWeek: false }" />\n        <!-- /ko -->\n        <!-- ko if: sickActive() || !planningActive() -->\n            <input style="width:86px;margin-bottom:0px;font-size:16px;" data-bind="datepicker: date, datepickerOptions: { maxDate : 0, selectWeek: false }" />\n        <!-- /ko -->\n        <span class="add-on" style="margin-left:-5px;"><i class="fa fa-calendar"></i></span>\n    </div>\n    <button class="btn btn-success pull-right" style="margin-left:10px;margin-right:0px;margin-top:3px;" data-bind="click:print">Print</button>\n    <!-- ko if: mealDistributionActive() && selectedClassroom()-->\n        <form data-bind="attr:{ action:exportRequestHref()}" method="post">\n            <button type=\'submit\' class="btn btn-info pull-right" style="margin-left:10px;margin-right:0px;margin-top:4px;">Export</button>\n             <!-- ko foreach:studentWeeklyAttendance().studentsAttendance() -->\n                <input type="hidden" name="childKey" data-bind="value: $data.childKey"/>\n            <!-- /ko -->\n        </form>\n    <!-- /ko -->\n\n\n</div>\n</div>'}),tadpoles.define("text!view/modals/auditModal.html",[],function(){return'<div class= "audit">\n    <div class="modal-header">\n        <i class="pull-right modal-close-button fa fa-times" data-bind="click: $parent.close"></i>\n        <h1>Audit</h1>\n    </div>\n    <div class="modal-body" style="overflow:auto;min-height:200px;">\n        <!-- ko if: entries.length === 0 -->\n        <div class="centered">\n            <h1 class="empty-text">no audit history</h1>\n        </div>\n        <!-- /ko -->\n        <table>\n            <tbody>\n                <!-- ko foreach: entries -->\n                <tr>\n                    <td class="audit-detail">\n                    <div class="heading" style=\'background-color: #49AFCD;color: white;text-align: left;padding:2px 6px\'>\n                        <span data-bind="text: timestamp.format(\'m/d h:MM:ss TT\')"></span> <span data-bind="text: actor_name"></span> <span data-bind="text: client_type"></span> <span data-bind="text: client_ip_address"></span> <span data-bind="text: queue_time"></span> <span data-bind="text: transactional ? \'trans\' : \'non-trans\'"></span> <span data-bind="text: \'device: \' + client_device_id ? client_device_id : \'\'"></span>\n                    </div>\n                    <table>\n                        <tbody>\n                            <!-- ko foreach: added -->\n                            <tr style="border-bottom: 1px solid #BFBFBF;">\n                                <td class="name" data-bind="text:name"></td>\n                                <td class="old"></td>\n                                <!-- ko if: isObject -->\n                                <td class="new pointable" data-bind="click:$parent.showObject">Show Object...</td>\n                                <!-- /ko -->\n                                <!-- ko if: isKey -->\n                                <td class="new pointable" data-bind="text: \'\' + changed, click:$parent.objectForKey"></td>\n                                <!-- /ko -->\n                                <!-- ko if: !isObject && !isKey -->\n                                <td class="new" data-bind="text: \'\' + changed"></td>\n                                <!-- /ko -->\n\n                            </tr>\n                            <!-- /ko -->\n                            <!-- ko foreach: changed -->\n                            <tr style="border-bottom: 1px solid #BFBFBF;">\n                                <td class="name" data-bind="text:name"></td>\n\n                                <!-- ko if: isObject -->\n                                <td class="old pointable" data-bind="click:$parent.showObject">Show Object...</td>\n                                <!-- /ko -->\n                                <!-- ko if: isKey -->\n                                <td class="old pointable" data-bind="text: \'\' + old, click:$parent.objectForKey"></td>\n                                <!-- /ko -->\n                                <!-- ko if: !isObject && !isKey -->\n                                <td class="old" data-bind="text: \'\' + old"></td>\n                                <!-- /ko -->\n\n                                <!-- ko if: isObject -->\n                                <td class="new pointable" data-bind="click:$parent.showObject">Show Object...</td>\n                                <!-- /ko -->\n                                <!-- ko if: isKey -->\n                                <td class="new pointable" data-bind="text: \'\' + changed, click:$parent.objectForKey"></td>\n                                <!-- /ko -->\n                                <!-- ko if: !isObject && !isKey -->\n                                <td class="new" data-bind="text: \'\' + changed"></td>\n                                <!-- /ko -->\n                            </tr>\n                            <!-- /ko -->\n                            <!-- ko foreach: removed -->\n                            <tr style="border-bottom: 1px solid #BFBFBF;">\n                                <td class="name" data-bind="text:name"></td>\n                                <!-- ko if: isObject -->\n                                <td class="old pointable" data-bind="click:$parent.showObject">Show Object...</td>\n                                <!-- /ko -->\n                                <!-- ko if: isKey -->\n                                <td class="old pointable" data-bind="text: \'\' + old, click:$parent.objectForKey"></td>\n                                <!-- /ko -->\n                                <!-- ko if: !isObject && !isKey -->\n                                <td class="old" data-bind="text: \'\' + old"></td>\n                                <!-- /ko -->\n                                <td class="new"></td>\n                            </tr>\n                            <!-- /ko -->\n                        </tbody>\n                    </table></td>\n                </tr>\n                <!-- /ko -->\n            </tbody>\n        </table>\n    </div>\n    <div class="modal-footer">\n        <button class="btn btn-primary pull-right btn-large" data-bind="click: $parent.close">\n            Done\n        </button>\n    </div>\n</div>'}),tadpoles.define("text!view/modals/background.html",[],function(){return"<div>&nbsp;\n</div>"}),tadpoles.define("text!view/modals/copyLessonPlan.html",[],function(){return'<div style="float:left;background-color:#f8f8f8;min-width:180px;padding:15px;height:230px;overflow:hidden;">\n    <h3 style="color:gray;margin-bottom:15px;"><span style="font-size:30px;margin-right:10px;">1.</span>choose a <span data-bind="text:selectWeek() ? \'week\' : \'date\'"></span></h3>\n    <label class="checkbox" data-bind="visible:!sourceIsWeek()">\n        <input type="checkbox" name="copyweek" data-bind="checked: copyWeek">copy entire week\n    </label>\n    <div class="input-append">\n        <input style="width:130px;margin-bottom:0px;" type="text" data-bind="datepicker: date, datepickerOptions : { minDate : 0, selectWeek : selectWeek() }"/>\n        <span class="add-on" style="margin-left:-5px;"><i class="fa fa-calendar"></i></span>\n    </div>\n</div>\n<div style="margin-left:20px;float:left;background-color:#f8f8f8;padding:15px;height:230px;overflow:hidden;">\n    <div style="width:250px;">\n        <h3 style="color:gray;"><span style="font-size:30px;margin-right:10px;">2.</span>choose classrooms</h3></label>\n        <div style="max-height:180px;margin-top:15px;overflow:auto;">\n            <ul style="width:250px;" data-bind="visible: classrooms().length > 0, tiles: { bricks: classrooms(), template:\'view/tiles/copyClassTile\', numCols: 3, groutWidth: 4, textSizingRef: 105 }"></ul>\n        </div>\n    </div>\n</div>\n\n<div style="clear:both;"></div>\n'}),tadpoles.define("text!view/modals/dailyReport.html",[],function(){return'<div id="dr-modal-printable">\n    <div class="modal-header">\n        <!-- ko if: !isPrinting() -->\n        <i class="pull-right modal-close-button fa fa-times" data-bind="click: $parent.close"></i>\n        <!-- /ko -->\n        <h1 class="hero-h1" data-bind="text: getFirstMemberName(true), popover: $parent.isOpen() ? getModalPopoverParams() : false"></h1>\n        <h3><span style="text-transform:lowercase;" data-bind="text: $root.product.translate(\'daily report\')"></span>&nbsp;- <span data-bind="dateFormat: {date:getCurrentEventDateUTC(), format:\'mediumDate\'}"></span></h3>\n    </div>\n    <div class="modal-body" data-bind="style: { maxHeight: isPrinting() ? \'none\' : \'500px\' }" style="overflow:auto;">\n        <div data-bind="template: {name: \'view/dailyReport\'}"></div>\n    </div>\n    <!-- ko if: !isPrinting() -->\n    <div class="modal-footer">\n        <button class="btn btn-primary pull-right btn-large" data-bind="click: $parent.close">\n            Done\n        </button>\n        <button style="margin-right: 10px;" class="btn btn-success pull-left btn-large" data-bind="click: print">\n            Print\n        </button>\n    </div>\n    <!-- /ko -->\n</div>'}),tadpoles.define("text!view/modals/devices.html",[],function(){return'<div>\n    <div class="modal-header">\n        <i class="pull-right modal-close-button fa fa-times" data-bind="click: close"></i>\n        <h2>Devices</h2>\n    </div>\n    <div class="modal-body">\n        <div class="alert alert-block alert-error" style="padding-right:14px" data-bind="visible: hasErrors()">\n            <h3 class="alert-heading">Oops!</h3>\n            <span>Error loading devices, please try again</span>\n        </div>\n        <div class="pull-left" data-bind="visible: processing()">\n            <h2 class="alert-heading">Loading...&nbsp;<i class="fa fa-spinner fa-spin fa-lg"></i></h2>\n        </div>\n        <div class="attendance-details" data-bind="visible: !processing()">\n            <div class="alert alert-block alert-info">\n                <h3 class="alert-heading">The latest app version is <span data-bind="text:latestVersion()"></span></h3>\n                Devices highlighted red do not have the latest version installed.\n            </div>\n        <table style="width:100%;">\n            <thead>\n                <tr style="width:100%">\n                    <th class="student" data-bind="click: sortByProperty.bind($data, \'model\', true)">model</th>\n                    <th data-bind="click: sortByProperty.bind($data, \'className\', true)">classroom</th>\n                    <th data-bind="click: sortByProperty.bind($data, \'appVersion\', true)">app version</th>\n                    <th data-bind="click: sortByProperty.bind($data, \'osVersion\', true)">os version</th>\n                    <th data-bind="click: sortByProperty.bind($data, \'lastUsed\', true)">version last reported</th>\n                    <th data-bind="click: sortByProperty.bind($data, \'training_start\', true)">in training</th>\n                </tr>\n            </thead>\n            <tbody>\n                <!-- ko foreach: devices -->\n                <tr class="accounts-row" data-bind="css: { vacation : $data.isOutOfDate }">\n                    <td class="student" style="width:100px;" data-bind="text: model"></td>\n                    <td><div class="ellipsis" style="width:150px;"><span data-bind="text: className"></span></div></td>\n                    <td style="width:50px;" data-bind="text:appVersion"> </td>\n                    <td style="width:50px;" data-bind="text:osVersion"></td>\n                    <td style="width:95px;" data-bind="text:lastUsedDisplay"></td>\n                    <td style="width:95px;" data-bind="text:trainingStartDisplay"></td>\n                </tr>\n                <!-- /ko -->\n            </tbody>\n        </table>\n        </div>\n        <div style="clear:both"></div>\n    </div>\n    <!-- /ko -->\n</div>\n'}),tadpoles.define("text!view/modals/editAccount.html",[],function(){return'<div>\n    <style>\n        .input-container {\n            padding: 10px;\n        }\n\n        .setting-input {\n            margin-bottom: 0px;\n            margin-left: 6px;\n        }\n    </style>\n    <!-- ko if: $data -->\n    <div class="modal-header">\n        <i class="pull-right modal-close-button fa fa-times" data-bind="click: $parent.close"></i>\n        <h1 class="hero-h1"><span data-bind="text: friendlyName()"></span><span data-bind="text: \' (\' + name() + \')\'"></span></h1>\n    </div>\n    <div class="modal-body" style="max-height:500px; background-color: rgb(242,242,242)">\n        <div style="max-height: 450px;overflow:auto">\n            <div class="pull-left">\n                <ul class="nav nav-pills nav-tight-pills" style="margin-bottom:0px;">\n                    <li data-bind="css: { \'active\' : settings.nav() === \'Account\' }" class="active">\n                        <a href="#" class="dash top-tab" data-bind="click: settings.selectAccount"><h3 style="line-height:1">Account</h3></a>\n                    </li>\n                    <li data-bind="css: { \'active\' : settings.nav() === \'Locations\' }" class="active">\n                        <a href="#" class="dash top-tab" data-bind="click: settings.selectLocations"><h3 style="line-height:1">Locations</h3></a>\n                    </li>\n                </ul>\n            </div>\n            <div style="clear: both"></div>\n\n\n\n            <div style="background-color: white; margin-top: 20px; padding: 10px;" data-bind="with: settings, visible: settings.nav() === \'Account\'">\n                Account friendly name<input style="margin-left: 10px; margin-bottom: 0px;" type="text" data-bind="value: accountFriendlyName" />\n                <button style="margin-left: 10px" class="btn btn-mini btn-info" data-bind="click:updateAccount">Update</button>\n                <!--<button style="margin-left: 10px" class="btn btn-mini btn-warning" data-bind="visible: !tokens(), click:generateToken">Generate Token</button>-->\n                <div style="margin-top: 10px;" data-bind="visible: tokens()">\n                    API Token(s) <span style="font-weight: bolder" data-bind="text:tokens()"></span>\n                </div>\n            </div>\n\n            <div>\n                <div style="background-color: white; margin-top: 20px;" data-bind="visible: settings.nav() === \'Account\'">\n                    <div class="input-container">\n                        product <select class="setting-input" data-bind="options: $root.accounts.products, value: product, saveOnUpdate: \'product_template\', url: \'/admin/update_account\'"></select><br>\n                    </div>\n                    <div class="input-container">\n                        product status <select class="setting-input" data-bind="options: [\'Active\', \'Inactive\'], value: productStatus, saveOnUpdate: \'product_status\', url: \'/admin/update_account\'"></select><br>\n                    </div>\n                    <!-- ko if: product() === \'trial\' -->\n                    <div class="input-container">\n                        trial expiration <input class="setting-input" data-bind="datepicker: expiration, datepickerOptions: { }, saveOnUpdate: {name:\'product_trial_expiration_date\', value: expiration}, url: \'/admin/update_account\'" /><br>\n                    </div>\n                    <!-- /ko -->\n                    <div class="input-container">\n                        Stripe ID <input class="setting-input" data-bind="value: stripeId, saveOnUpdate: \'chargeable_customer_id\', url: \'/admin/update_account\'"/><br>\n                    </div>\n                    <div class="input-container">\n                        Subscription ID <input class="setting-input" data-bind="value: subscriptionId, saveOnUpdate: \'chargeable_subscription_id\', url: \'/admin/update_account\'"/><br>\n                    </div>\n                    <div class="input-container">\n                        Pricing Model <select class="setting-input" data-bind="options: $root.accounts.pricingModels, optionsText: \'name\', optionsValue: \'value\', value: pricingModel, optionsCaption: \'No Pricing Model\', saveOnUpdate: \'chargeable_pricing_model\', url: \'/admin/update_account\'"></select><br>\n                    </div>\n                    <div class="input-container">\n                        ARR <input class="setting-input" data-bind="value: arr, saveOnUpdate: \'chargeable_arr\', url: \'/admin/update_account\'"/><br>\n                    </div>\n                    <div class="input-container">\n                        Auth Policy <select class="setting-input" data-bind="options: $root.accounts.authPolicies, optionsText: \'name\', optionsValue: \'value\', value: authPolicy, optionsCaption: \'No Policy\', saveOnUpdate: \'authentication_policy\', url: \'/admin/update_account\'"></select><br>\n                    </div>\n                </div>\n                <!-- from settings -->\n                <div data-bind="with: settings">\n\n                    <div data-bind="visible: nav() === \'Account\'">\n                        <div style="background-color: white; margin-top: 20px;">\n                            <div data-bind="foreach: features">\n                                <div style="padding: 10px;" data-bind="template: $data.template, data:$data"></div>\n                            </div>\n                            <div class="input-container">\n                                Earliest daily report send time <input class="setting-input" type="text" class="time ui-timepicker-input" style="width:53px;" autocomplete="off" data-bind="timePicker: {observable: earliestDailyReportSendTime, step:5, scrollDefaultNow: true, disableTextInput: false, date: new Date()}" placeholder="default">\n                                <button style="margin-left: 10px" class="btn btn-mini btn-info" data-bind="click:updateEarliestDailyReportSendTime">Update</button>\n\n                            </div>\n                            <div class="input-container">\n                                Enable file sync <input style="margin-left: 10px;" type="checkbox" data-bind="checked: fileSyncEnabled" />\n                                <button style="margin-left: 10px" class="btn btn-mini btn-info" data-bind="click:updateFileSyncEnabled">Update</button>\n\n                            </div>\n                        </div>\n                    </div>\n\n                    <div style="background-color: white; margin-top: 20px" data-bind="visible: nav() === \'Locations\', foreach: locations">\n                        <div data-bind="template:{ name: \'view/modals/editLocation\'}"></div>\n                    </div>\n\n                </div>\n\n\n                <div style="float:right;width:280px">\n                    <!--&lt;!&ndash; ko if: errors().length > 0 &ndash;&gt;-->\n                    <!--<div class="alert alert-block alert-danger">-->\n                        <!--<h4 class="alert-heading">Error:</h4>-->\n                        <!--<ul data-bind="foreach: errors">-->\n                            <!--<li data-bind="text:$data"></li>-->\n                        <!--</ul>-->\n                    <!--</div>-->\n                    <!--&lt;!&ndash; /ko &ndash;&gt;-->\n                </div>\n                <div style="clear:both;"></div>\n            </div>\n        </div>\n\n    </div>\n    <div class="modal-footer">\n        <button class="btn btn-primary pull-right btn-large" data-bind="click: $parent.close">\n            Done\n        </button>\n    </div>\n    <!-- /ko -->\n</div>\n'}),tadpoles.define("text!view/modals/editChildProfile.html",[],function(){return'<div>\n    <!-- ko if: $data -->\n    <div class="modal-header">\n        <div class="alert alert-block" style="position:absolute;top:0;right:0;" data-bind="visible: isRemoteSaving() || isScheduleRemoteSaving()">\n            <h4 class="alert-heading">Saving...&nbsp;<i class="fa fa-spinner fa-spin"></i></h4>\n        </div>\n        <i class="pull-right modal-close-button fa fa-times" data-bind="click: valid() ? $parent.close : null, visible: !isRemoteSaving() && !isScheduleRemoteSaving()"></i>\n        <h1 class="hero-h1" data-bind="attr: { id: key +\'-pop\' }, popover: getPopoverParams()"><span data-bind="text: firstName"></span>&nbsp;<span data-bind="text: lastName"></span></h1>\n    </div>\n    <div class="modal-body" style="max-height:500px;overflow:auto;" >\n        <div class="profile-header">\n            <div class="alert alert-block alert-error" style="padding-right: 14px;" data-bind="visible: tsg_link_error">\n                <h3 class="alert-heading">This child could not be linked to Teaching Strategies Gold, name mismatch</h3>\n            </div>\n            <div style="clear: both;"></div>\n\n            <div class="span3 profile-column">\n                <h2 style="">profile</h2>\n                <div class="label-input">\n                    <div style="float: left; width: 105px;">\n                        <label><h4 style="color:gray;">first name</h4></label>\n                        <input style="width: 95px;"  id="firstName" type="text" data-bind="value: firstName, saveOnUpdate: \'first_name\'">\n                    </div>\n                    <div style="float: left; width: 105px; margin-left: 10px;">\n                        <label><h4 style="color:gray;">last name</h4></label>\n                        <input style="width: 95px;" id="lastName" type="text" data-bind="value: lastName, saveOnUpdate: \'last_name\'">\n                    </div>\n                </div>\n                <div class="label-input">\n                    <label><h4 style="color:gray;">birthday</h4></label>\n                    <input class="span3" data-bind="datepicker: birthDate, datepickerOptions: { }, saveOnUpdate: {name:\'birth_date\', value: birthDate}" />\n                </div>\n                <div class="label-input">\n                    <label><h4 style="color:gray;">next medical</h4></label>\n                    <input class="span3" data-bind="datepicker: nextMedicalDate, datepickerOptions: { }, saveOnUpdate: {name:\'nm\', value: nextMedicalDate}" />\n                </div>\n                <div class="label-input">\n                    <label><h4 style="color:gray;">note</h4></label>\n                    <input class="span3" type="text" data-bind="value: note, saveOnUpdate: \'note\'">\n                </div>\n                <div class="label-input">\n                    <label><h4 style="color:gray;">private note</h4></label>\n                    <input class="span3"type="text" data-bind="value: special_note, saveOnUpdate: \'special_note\'">\n                </div>\n                <div class="label-input">\n                    <label><h4 style="color:gray;">quick lists</h4></label>\n                    <!-- ko if: labels().length > 0 -->\n                    <div class="profile-detail" data-bind="template: {name: \'view/quickLists\'}"></div>\n                    <!-- /ko -->\n                    <div class="input-append add-input pull-left" data-bind="visible: isEditing() === false">\n                        <form data-bind="submit: addLabel">\n                            <input type="text" placeholder="new quick list" class="input-small" style="margin: 0 auto;" data-bind="value: newLabel,typeahead:$root.labels"/>\n                            <button type="button" class="btn btn-warning btn-small" data-bind="click: addLabel">\n                                Add\n                            </button>\n                        </form>\n                    </div>\n                </div>\n            </div>\n            <div class="span3 profile-column" style="width:205px;">\n                <h2 style="text-align:center;color:gray;padding-bottom: 10px;">enrollment</h2>\n                <!-- ko if:$root.currentUser.isCsr() || $root.currentUser.isRegionalAdmin() || $root.currentUser.isAccountAdmin() -->\n                <div class="label-input">\n                    <label><h4 style="color:gray;">location</h4></label>\n                    <select class="span3" data-bind="options: $root.locations(), optionsText: \'name\', optionsValue: \'key\', value: location_key, callOnUpdate: changeLocation"></select>\n                </div>\n                <!-- /ko -->\n                <div class="label-input">\n                    <label><h4 style="color:gray;">homeroom</h4></label>\n                    <select class="span3" data-bind="options: $root.groups.getActiveSimpleGroupsForLocation(location_key()), optionsText: \'name\', optionsValue: \'key\', optionsCaption: \'choose a homeroom...\', value: homeroom_key, callOnUpdate: moveHomeroom"></select>\n                </div>\n                <div class="label-input">\n                    <label><h4 style="color:gray;">curriculum</h4></label>\n                    <select class="span3" data-bind="options: curriculumChoices(), optionsText: \'name\', optionsValue: \'id\', value: curriculum_id, saveOnUpdate: \'curriculum_id\'"></select>\n                </div>\n                <div class="label-input">\n                    <label><h4 style="color:gray;">status</h4></label>\n                    <select class="span3" data-bind="options: $root._.values(Statuses), optionsText: getDisplayableStatus, value: status, confirm: { name : \'status\', observable : status, message : \'If you are setting the status to \\\'graduated\\\' or \\\'deleted\\\' please note that you will not be able access the child from the dashboard once it is saved. Continue?\' }, saveOnUpdate: \'status\'"></select>\n                </div>\n                <div class="label-input">\n                    <label><h4 style="color:gray;">schedule</h4></label>\n                    <div data-bind="with: schedule" style="padding-bottom: 10px; padding-top: 2px;">\n\n                        M\n                        <INPUT TYPE=CHECKBOX NAME="monday" data-bind="checked: monday, saveOnUpdate: {name: \'sb\', value: monday}, property: \'model\'">\n                        T\n                        <INPUT TYPE=CHECKBOX NAME="tuesday" data-bind="checked: tuesday, saveOnUpdate: {name: \'sb\', value: tuesday}, property:\'model\'">\n                        W\n                        <INPUT TYPE=CHECKBOX NAME="wednesday" data-bind="checked: wednesday, saveOnUpdate: {name: \'sb\', value: wednesday}, property:\'model\'">\n                        T\n                        <INPUT TYPE=CHECKBOX NAME="thursday" data-bind="checked: thursday, saveOnUpdate: {name: \'sb\', value: thursday}, property:\'model\'">\n                        F\n                        <INPUT TYPE=CHECKBOX NAME="friday"  data-bind="checked: friday, saveOnUpdate: {name: \'sb\', value: friday}, property:\'model\'">\n                        S\n                        <INPUT TYPE=CHECKBOX NAME="saturday"  data-bind="checked: saturday, saveOnUpdate: {name: \'sb\', value: saturday}, property:\'model\'">\n                        S\n                        <INPUT TYPE=CHECKBOX NAME="sunday"  data-bind="checked: sunday, saveOnUpdate: {name: \'sb\', value: sunday}, property:\'model\'">\n                    </div>\n                </div>\n\n                <div data-bind="with: schedule">\n                    <div class="label-input">\n                        <label><h4 style="color:gray;">enrollment</h4></label>\n                        <select class="span3" data-bind="options: enrollmentTypes, value: enrollment, saveOnUpdate: \'en\'"></select>\n                    </div>\n                    <div class="label-input">\n                        <label><h4 style="color:gray;">enrollment date</h4></label>\n                        <input class="span3" data-bind="datepicker: enrollment_date, datepickerOptions: {  }, saveOnUpdate: {name:\'ed\', value: enrollment_date}" />\n                    </div>\n                    <div class="label-input">\n                        <label><h4 style="color:gray;">graduation date</h4></label>\n                        <input class="span3" data-bind="datepicker: graduation_date, datepickerOptions: { }, saveOnUpdate: {name:\'gd\', value: graduation_date}" />\n                    </div>\n                    <div class="label-input" data-bind="visible: $parent.status() == \'suspended\'">\n                        <label><h4 style="color:gray;">return date</h4></label>\n                        <input class="span3" data-bind="datepicker: return_date, datepickerOptions: {  }, saveOnUpdate: {name: \'rd\', value: return_date}" />\n                    </div>\n                </div>\n                <div class="label-input" data-bind="visible: status() === \'interested\' || status() === \'touring\' || status() === \'visited\'">\n                    <label><h4 style="color:gray;">tour date</h4></label>\n                <input class="span3" data-bind="datepicker: tourDate, datepickerOptions: { minDate: 0  }, callOnUpdate: {method: setTourDate, value: tourDate}, enable: status() === \'interested\' || status() === \'touring\'" />\n                </div>\n            </div>\n            <div class="span3 profile-column">\n                <!-- ko if: errors().length > 0 -->\n                <div class="alert alert-block alert-info">\n                    <h4 class="alert-heading">Note:</h4>\n                    <ul data-bind="foreach: errors">\n                        <li data-bind="text:$data"></li>\n                    </ul>\n                </div>\n                <!-- /ko -->\n                <h2 style="text-align:center;color:gray;padding-bottom: 10px;">contacts</h2>\n                <div style="position:relative;height:100px;overflow:hidden;" data-bind="visible: $parent.loadingGuardians(), spin: {trigger:$parent.loadingGuardians(), color: \'#000\'}"></div>\n                <div class="alert alert-block alert-error" style="padding-right:14px" data-bind="visible: false">\n                    <h3 class="alert-heading">Oops!</h3>\n                    <div data-bind="foreach: []">\n                        <span data-bind="text: $data"></span>\n                        <br/>\n                    </div>\n                </div>\n                <div style="max-height:320px;" data-bind="visible: !$parent.loadingGuardians() && true">\n                    <ul style="width:200px;" data-bind="tiles: { bricks: guardiansForDisplay, template:\'view/tiles/guardianTile\', numCols: 2, groutWidth: 4 }"></ul>\n                </div>\n            </div>\n        </div>\n        <div style="clear:both"></div>\n    </div>\n    <div class="modal-footer">\n        <button class="btn btn-primary pull-right btn-large" data-bind="click: $parent.close, enable: (valid() && !isRemoteSaving() && !isScheduleRemoteSaving())">\n            Done\n        </button>\n    </div>\n    <!-- /ko -->\n</div>\n'}),tadpoles.define("text!view/modals/editLocation.html",[],function(){return'<div style="background-color: white; margin-bottom: 0px; padding: 10px;">\n    <input style="margin-left: 10px; margin-bottom: 0px;" type="text" data-bind="value: name" />\n    <button style="margin-left: 10px" class="btn btn-mini btn-warning" data-bind="visible: key(), click:toggleForm, text: showEditForm() ? \'Less...\' : \'More...\'"></button>\n    <div class="control-group" data-bind="visible:showEditForm()" style="background-color: rgb(227, 243, 248); margin-top: 8px;">\n        <div class="input-container" data-bind="visible: tokens()">\n            API Token(s) <span style="font-weight: bolder" data-bind="text:tokens()"></span>\n        </div>\n        <div class="input-container">\n            timezone <select class="setting-input" data-bind="options: $parent.timezones, optionsText: \'name\', optionsValue: \'key\', value: timezone"></select>\n        </div>\n        <div class="input-container">\n            student auto checkout <input class="setting-input" type="text" class="time ui-timepicker-input" style="width:53px;" autocomplete="off" data-bind="timePicker: {observable: studentAutoCheckoutTime, step:5, scrollDefaultNow: true, disableTextInput: false, date: new Date()}" placeholder="default">\n        </div>\n\n        <button style="margin-left: 10px; margin-bottom: 10px;" class="btn btn-mini btn-success" data-bind="click:generateToken, visible: !tokens()">Generate Token</button>\n        <button style="margin-left: 10px; margin-bottom: 10px;" class="btn btn-mini btn-warning" data-bind="visible: !isPlanningMaster(), click:makePlanningMaster">Make Planning Master</button>\n\n    </div>\n    <button style="margin-left: 10px;" class="btn btn-mini btn-info" data-bind="click:updateLocation, text: key() ? \'Update\' : \'Create\'"></button>\n    <span class="badge" style="background-color: #5bb75b; margin-left: 10px;" data-bind="visible: isPlanningMaster()">Planning Master </span>\n</div>\n'}),tadpoles.define("text!view/modals/editAccountBranding.html",[],function(){return'<div>\n    <!-- ko if:$data -->\n    <div class="modal-header">\n        <i class="pull-right modal-close-button fa fa-times" data-bind="click: $parent.close"></i>\n        <h1 class="hero-h1">Edit Account Branding</h1>\n    </div>\n    <div class="modal-body">\n        <form style="float:left; width: 275px;" class="form-horizontal" data-bind="submit: submit, fileUpload: files, uploadType: \'png|gif|jpg|jpeg\'">\n            <div class="control-group">\n                <div style="margin-top: 6px" class="alert alert-block alert-info">\n                    <h4 class="alert-heading">Email logo:</h4>\n                    This logo will appear in emails sent to parents and staff. Logo images should be 620 pixels wide and horizontally oriented.\n                    <h4 class="alert-heading">Logo link url:</h4>\n                    Clicking the logo will launch this link in a new browser window or tab.\n                </div>\n                <label><h4 style="color:gray;">email logo</h4></label>\n                <div>\n                    <div class="btn btn-success btn-small fileinput-button">\n                        <i class="fa fa-plus fa-white"></i>\n                        <span data-bind="text: brandLogoImageUrl() ? \'Update Image\' : \'Add Image\' "></span>\n                        <!-- not visible -->\n                        <input type="file" name="attachment" accept="image/*"/>\n                    </div><!--<div style="display: inline-block; position: relative;" data-bind="popover: getPopoverParams()" ><img  style="height: 28px;" data-bind="visible: logoUrl(), attr:{src:logoImageUrl()}"></div>-->\n\n                    <div data-bind="visible: hasAttachedFile()" style="width: 157px; padding-bottom: 4px; margin-bottom: 0px;" class="filename-box">\n                        <span style="max-width: 124px;" class="ellipsis filename" data-bind="text:fileName()"></span>\n                        <i class="fa fa-times pointable" style="float: right;margin-top: 3px;margin-left: 16px;margin-right: 4px;color: #666;font-size: 16px;" data-bind="click: clearFiles"></i>\n                    </div>\n                </div>\n                <label><h4 style="color:gray;margin-top: 20px;">logo link url</h4></label>\n                <input style="width:265px" type="text" data-bind="value: brandLogoLinkUrl, valueUpdate: \'keyup\'" placeholder="http://yourwebsite.com">\n            </div>\n            <div  class="control-group">\n                <button class="btn btn-success pull-right" type="submit" data-bind="enable: valid()">Upload</button>\n            </div>\n            <div class="alert alert-block" style="position:absolute;top:280px;left:260px;" data-bind="visible: showSpin()">\n               <h4 class="alert-heading">Saving... <i class="fa fa-spinner fa-spin"></i></h4>\n            </div>\n        </form>\n        <div style="float: right">\n            <label><h4 style="color:gray;">email preview</h4></label>\n            <table width="100%" cellspacing="0" cellpading="0" border="0" align="center">\n                <tbody>\n                    <tr>\n                        <td align="center">\n                            <table style="background-color:#eee" width="320" cellspacing="0" cellpadding="5" border="0" bgcolor="#FFF">\n                                <tbody>\n                                    <tr>\n                                        <td width="100%">\n                                            <table style="background-color:#FFF" width="310" cellpadding="0" cellspacing="0" border="0" bgcolor="#FFF">\n                                                <tr>\n                                                    <td style="text-align:left;font-family: Trebuchet MS,Helvetica,sans-serif;font-weight:normal;color:#000001;" align="center">\n                                                        <table style="background-color:transparent" id="logo" width="100%" cellpadding="0" cellspacing="0" border="0" bgcolor="transparent">\n                                                            <tbody>\n                                                                <tr>\n                                                                    <td>\n                                                                        <a data-bind="attr: {href: brandLogoLinkUrl()}" target="_blank" style="text-decoration:none;border:0">\n                                                                            <img style="display:block;margin:0" border="0" align="left" width="310" data-bind="attr: {src: brandLogoImageUrl() ? brandLogoImageUrl() : \'/images/1/sample-logo.png\'}" />\n                                                                        </a>\n                                                                    </td>\n                                                                </tr>\n                                                            </tbody>\n                                                        </table>\n                                                        <table width="100%" cellpadding="0" cellspacing="0" border="0">\n                                                            <tbody>\n                                                                <tr>\n                                                                    <td width="310">\n                                                                        <table width="100%" cellpadding="0" cellspacing="0" border="0">\n                                                                            <tbody>\n                                                                                <tr>\n                                                                                    <td width="100%">\n                                                                                    <!-- body here -->\n<table style="width:310px" width="310" cellpadding="0" cellspacing="0" border="0">\n    <tbody>\n        <tr>\n            <td style="width:310px" width="310">\n                    <img align="left" border="0" src="/images/1/sampleEmailPhoto.jpg" style="padding: 0; display: block; margin:0; width:310px; height:310px" width="310" height="310" alt="child photo"/>\n            </td>\n        </tr>\n    </tbody>\n</table>\n\n                                                                                    </td>\n                                                                                </tr>\n                                                                                <tr>\n                                                                                    <td>\n                                                                                        <table width="100%" cellspacing="0" cellpadding="10" border="0">\n                                                                                            <tr>\n                                                                                                <td align="left" width="50%">\n                                                                                                </td>\n                                                                                                <td align="right" width="50%">\n                                                                                                    <div>\n                                                                                                    Sent via Tadpoles\n                                                                                                    </div>\n                                                                                                </td>\n                                                                                            </tr>\n                                                                                        </table>\n                                                                                    </td>\n                                                                                </tr>\n                                                                            </tbody>\n                                                                        </table>\n                                                                    </td>\n                                                                </tr>\n                                                            </tbody>\n                                                        </table>\n                                                    </td>\n                                                </tr>\n                                            </table>\n                                        </td>\n                                    </tr>\n                                </tbody>\n                            </table>\n                        </td>\n                    </tr>\n                </tbody>\n            </table>\n        </div>\n        <div style="clear: both"></div>\n    </div>\n    <!-- /ko -->\n</div>'}),tadpoles.define("text!view/modals/editAutoCheckout.html",[],function(){return'<div class="control-group">\n    <label><h3 style="color:gray;">checkout students automatically after</h3></label>\n    <div class="food-row">\n        <input type="text" class="time ui-timepicker-input" style="width:53px;" autocomplete="off" data-bind="timePicker: {observable: student_auto_checkout_time, step:5, scrollDefaultNow: true, disableTextInput: false, date: new Date()}">\n        <div class="clearfix"></div>\n    </div>\n</div>\n\n<div class="clearfix"></div>'}),tadpoles.define("text!view/modals/editCheckpoint.html",[],function(){return'<div class="control-group">\n    <!-- ko foreach: sortedCheckpoints() -->\n        <!-- ko if: isAbsence() -->\n            <div class="food-row">\n                <select style="width:100px" data-bind="options: absenceTypeOptions(), value: action"></select>\n                <!-- ko if: action() === \'sick\' -->\n                    <input type="text" style="width:150px" data-bind="value: note, valueUpdate: \'afterkeydown\'" placeholder="sickness">\n                <!-- /ko -->\n                <!-- ko if: action() === \'other\' -->\n                    <input type="text" style="width:150px" data-bind="value: note, valueUpdate: \'afterkeydown\'" placeholder="note">\n                <!-- /ko -->\n                <select style="width:100px" data-bind="options: excusedOptions(), value: excused"></select>\n                <!-- ko if: $parent.sortedCheckpoints().length > 1-->\n                    <span style="margin-left:5px;margin-right:5px">at</span>\n                    <input type="text" class="time ui-timepicker-input" style="width:53px;" autocomplete="off" data-bind="timePicker: {observable: inTime, step:5, scrollDefaultNow: true, disableTextInput: false, date: $parent.date()}" placeholder="in">\n                <!-- /ko -->\n                <i style="margin-left:8px;" class="fa fa-times fa-muted fa-border delete-button" data-bind="click: $parent.deleteCheckpoint.bind($data, true), visible: $parent.canDelete()"></i>\n                <div class="clearfix"></div>\n            </div>\n        <!-- /ko -->\n        <!-- ko if: !isAbsence() -->\n            <div class="food-row">\n                <input type="text" class="time ui-timepicker-input" style="width:53px;" autocomplete="off" data-bind="timePicker: {observable: inTime, step:5, scrollDefaultNow: true, disableTextInput: false, date: $parent.date()}" placeholder="in">\n                <input type="text" class="time ui-timepicker-input" style="width:53px;" autocomplete="off" data-bind="timePicker: {observable: outTime, step:5, scrollDefaultNow: true, disableTextInput: false, date: $parent.date()}" placeholder="out">\n                <i style="margin-left:8px;" class="fa fa-times fa-muted fa-border delete-button" data-bind="click: $parent.deleteCheckpoint.bind($data, true), visible: $parent.canDelete()"></i>\n                <div class="clearfix"></div>\n            </div>\n        <!-- /ko -->\n    <!-- /ko -->\n    <!-- ko if: canAddInOutTimes() -->\n        <a class="add-food-button" href="#" style="display:block;color:#ddd" data-bind="click: addCheckpoint"> <i style="margin-right:5px;vertical-align:2px;" class="fa fa-plus fa-lg"></i> <h3 style="display:inline-block">add times</h3> </a>\n    <!-- /ko -->\n    <!-- ko if: canAddAbsence() -->\n        <a class="add-food-button" href="#" style="display:block;color:#ddd" data-bind="click: addAbsenceCheckpoint"> <i style="margin-right:5px;vertical-align:2px;" class="fa fa-plus fa-lg"></i> <h3 style="display:inline-block">add absence</h3> </a>\n    <!-- /ko -->\n</div>\n\n<div class="clearfix"></div>'}),tadpoles.define("text!view/modals/editClass.html",[],function(){return'<div>\n    <!-- ko if:$data -->\n    <div class="modal-header">\n        <div class="alert alert-block" style="position:absolute;top:0;right:0;" data-bind="visible: isRemoteSaving()">\n            <h4 class="alert-heading">Saving...&nbsp;<i class="fa fa-spinner fa-spin"></i></h4>\n        </div>\n        <i class="pull-right modal-close-button fa fa-times" data-bind="click: $parent.close,visible: !isRemoteSaving()"></i>\n        <h1 class="hero-h1">edit</h1>\n\n        <h3 data-bind="text: name"></h3>\n    </div>\n    <div class="modal-body" style="max-height:425px">\n        <div class="alert alert-block alert-error" style="padding-right:14px" data-bind="visible: $root.curricula.hasErrors()">\n            <h3 class="alert-heading">Oops!</h3>\n            <span>Error loading curriculum, please refresh the page and try again</span>\n        </div>\n        <div class="pull-left" data-bind="visible: $root.curricula.processing()">\n            <h2 class="alert-heading">Loading...&nbsp;<i class="fa fa-spinner fa-spin fa-lg"></i></h2>\n        </div>\n        \n        <div class="pull-left" data-bind="visible: !$root.curricula.hasErrors() && !$root.curricula.processing()">\n            <div class="label-input">\n                <label><h4 style="color:gray;">name</h4></label>\n                <input class="span3" type="text" data-bind="value: name, callOnUpdate: changeName"/>\n            </div>\n            <div class="label-input">\n                <label><h4 style="color:gray;">stage</h4></label>\n                <select class="span3" data-bind="options: $root.displayableChildTypes(), optionsValue: \'key\', optionsText: \'value\', value: child_type, callOnUpdate: changeType"></select>\n            </div>\n            <div class="label-input" data-bind="visible: $root.product.hasFeature($root.product.Features.CUSTOM_CURRICULUM)">\n                <label><h4 style="color:gray;">curriculum</h4></label>\n                <select class="span3" data-bind="options: $parent.curriculumChoices(), optionsValue: \'id\', optionsText: \'name\', value: curriculumId, callOnUpdate: changeCurriculumId"></select>\n            </div>\n            <div class="label-input">\n                <label><h4 style="color:gray;">sort order</h4></label>\n                <input class="span3" type="text" data-bind="value: sort, callOnUpdate: changeSort" placeholder="order value 1-100"/>\n            </div>\n            <div class="label-input">\n                <label><h4 style="color:gray;">spots for enrollment</h4></label>\n                <input class="span3" type="text" data-bind="numeric: capacity, value: capacity, callOnUpdate: changeCapacity" placeholder="4 for example"/>\n            </div>\n            <div class="label-input">\n                <label><h4 style="color:gray;">student ratio for ONE teacher</h4></label>\n                <input class="span3" type="text" data-bind="numeric: ratio1, value: ratio1, callOnUpdate: changeRatio1" placeholder="4 for example"/>\n            </div>\n            <div class="label-input">\n                <label><h4 style="color:gray;">student ratio for TWO teachers</h4></label>\n                <input class="span3" type="text" data-bind="numeric: ratio2, value: ratio2, callOnUpdate: changeRatio2" placeholder="8 for example"/>\n            </div>\n        </div>\n        <div class="pull-right" style="width:280px;" data-bind="visible: !$root.curricula.hasErrors()">\n            <div class="alert alert-block alert-info">\n                <h4 class="alert-heading">Note:</h4>\n                The <strong>stage</strong> for the classroom will affect daily reports and the tags for observations.\n                <br>\n                <h4 class="alert-heading">Sort Order:</h4>\n                The <strong>sort order</strong> for the classroom will change the order in which the classrooms are displayed on the dashboard.\n            </div>\n\n            <div class="label-input">\n                <label><h4 style="color:gray;">this class enrolls students at least age</h4></label>\n                <div>\n                    <select style="width: 65px;" data-bind="options: yearOptions, optionsText: \'text\', optionsValue: \'value\', value: minEnrollAgeYear, callOnUpdate: changeMinEnrollAgeInMonths"></select>\n                    <select style="width: 75px;" data-bind="options: monthOptions, optionsText: \'text\', optionsValue: \'value\', value: minEnrollAgeMonth, callOnUpdate: changeMinEnrollAgeInMonths"></select>\n                </div>\n            </div>\n            <div class="label-input">\n                <label><h4 style="color:gray;">and no older than age</h4></label>\n                <div>\n                    <select style="width: 65px;" data-bind="options: yearOptions, optionsText: \'text\', optionsValue: \'value\', value: maxEnrollAgeYear, callOnUpdate: changeMaxEnrollAgeInMonths"></select>\n                    <select style="width: 75px;" data-bind="options: monthOptions, optionsText: \'text\', optionsValue: \'value\', value: maxEnrollAgeMonth, callOnUpdate: changeMaxEnrollAgeInMonths"></select>\n                </div>\n            </div>\n\n        </div>\n        <div style="clear:both"></div>\n    </div>\n    <div class="modal-footer">\n        <button class="btn btn-primary pull-right btn-large" data-bind="click: $parent.close">\n            Done\n        </button>\n    </div>\n    <!-- /ko -->\n</div>\n'}),tadpoles.define("text!view/modals/editEmployee.html",[],function(){return'<!-- ko if: $data -->\n<div class="modal-header">\n    <div class="alert alert-block" style="position:absolute;top:0;right:0;" data-bind="visible: isRemoteSaving()">\n        <h4 class="alert-heading">Saving...&nbsp;<i class="fa fa-spinner fa-spin"></i></h4>\n    </div>\n    <i class="pull-right modal-close-button fa fa-times" data-bind="click: !userCanEdit() || valid() ? $parent.close : null, visible: !isRemoteSaving()"></i>\n\n    <h1 class="hero-h1" data-bind="popover: getPopoverParams()">\n        <span data-bind="text: firstName"></span>&nbsp;<span data-bind="text: lastName"></span></h1>\n</div>\n<div class="modal-body">\n        <div>\n            <div style="float:left;">\n                <div class="label-input">\n                    <div style="float: left; width: 105px;">\n                        <label><h4 style="color:gray;">first name</h4></label>\n                        <input style="width: 95px;" class="span3" type="text" data-bind="value: firstName, saveOnUpdate: \'first_name\', enable: userCanEdit()" placeholder="first name"/>\n                    </div>\n                    <div style="float: left; width: 105px; margin-left: 10px;">\n                        <label><h4 style="color:gray;">last name</h4></label>\n                        <input style="width: 95px;" class="span3" type="text" data-bind="value: lastName, saveOnUpdate: \'last_name\', enable: userCanEdit()" placeholder="last name"/>\n                    </div>\n                </div>\n\n                <label><h4 style="color:gray;">email address</h4></label>\n                <input class="span3" type="text" placeholder="teacher@email.address" data-bind="value: email, callOnUpdate: updateEmailWithConfirmation, enable: userCanEdit()"/>\n\n                <!-- ko if: isRole(\'Employee\') && email() -->\n                <div>\n                    <div style="float: left; width: 210px; margin-bottom: 10px;">\n                        <input style="margin-top: 0px;" type="checkbox" data-bind="checked: allowEmployeeWebLogin, callOnUpdate: $root._.bind(updateAllowEmployeeWebLogin, $data), enable: userCanEdit()" ><span style="margin-left: 4px;">&nbsp;Allow Web Login</span>\n                    </div>\n                </div>\n                <!-- /ko -->\n\n                <div class="label-input">\n                    <div style="float: left; width: 105px;">\n                        <label><h4 style="color:gray;">phone number</h4></label>\n                        <input style="width: 95px;" type="text" placeholder="123.456.7890" data-bind="value: mobile_number, saveOnUpdate: \'mobile_number\', enable: userCanEdit()"/>\n                    </div>\n                    <div style="float: left; width: 105px; margin-left: 10px;">\n                        <label><h4 style="color:gray;">4-digit pin</h4></label>\n                        <input style="width: 95px;" type="text" maxlength="4" data-bind="value: pin, saveOnUpdate: \'pin\', enable: userCanEdit() || isCurrentUser()"/>\n                    </div>\n                </div>\n\n                <label><h4 style="color:gray;">role</h4></label>\n                <!-- ko if: userCanChangeRole() -->\n                <select class="span3" style="margin-bottom: 10px;" data-bind="options: $root.roleChoices(), optionsText: \'name\', optionsValue: \'value\', value: role, optionsCaption: \'choose a role...\', callOnUpdate: updateRoleWithConfirmation"></select>\n                <!-- /ko -->\n                <!-- ko if: !userCanChangeRole() -->\n                <input class="span3" type="text" data-bind="value: roleName, enable: false"/>\n                <!-- /ko -->\n\n                <!-- ko if: isRole(\'AccountAdmin\') == false -->\n                <!-- ko if: userCanEdit() -->\n                <label><h4 style="color:gray;">location</h4></label>\n                <select class="span3" data-bind="options: $root.locations(), optionsText: \'name\', optionsValue: \'key\', value: location, optionsCaption: \'choose a location...\', saveOnUpdate: \'location\'"></select>\n                <!-- /ko -->\n                <!-- ko if: !userCanEdit() -->\n                <label><h4 style="color:gray;">location</h4></label>\n                <input class="span3" type="text" data-bind="value: locationName(), enable: false"/>\n                <!-- /ko -->\n                <!-- /ko -->\n\n                <!-- ko if: isRole(\'Employee\') && location() -->\n                <!-- ko if: userCanEdit() -->\n                <label><h4 style="color:gray;">classroom</h4></label>\n                <select class="span3" data-bind="options: simpleGroupsForLocation(), optionsText: \'name\', optionsValue: \'key\', value: homeroom_key, saveOnUpdate: \'homeroom_key\'"></select>\n                <!-- /ko -->\n                <!-- ko if: !userCanEdit() -->\n                <label><h4 style="color:gray;">classroom</h4></label>\n                <input class="span3" type="text" data-bind="value: classroomName(), enable: false"/>\n                <!-- /ko -->\n                <!-- /ko -->\n\n                <label><h4 style="color:gray;">note</h4></label>\n                <input class="span3" type="text" data-bind="value: note, saveOnUpdate: \'note\'">\n\n\n            </div>\n\n            <div style="float:right;width:280px">\n                <div class="alert alert-block alert-info">\n                    <h4 class="alert-heading">Note:</h4>\n                    First name, last name, and role are required.\n                </div>\n\n                <!-- ko if: isRole(\'Employee\') -->\n                <label><h4 style="color:gray;">schedule</h4></label>\n                <!-- ko if: userCanEdit() -->\n                <div data-bind="with: schedule" style="padding-bottom: 10px; padding-top: 2px;">\n\n                    M\n                    <INPUT TYPE=CHECKBOX NAME="monday" data-bind="checked: monday, saveOnUpdate: {name: \'sb\', value: monday}, property: \'model\'">\n                    T\n                    <INPUT TYPE=CHECKBOX NAME="tuesday" data-bind="checked: tuesday, saveOnUpdate: {name: \'sb\', value: tuesday}, property:\'model\'">\n                    W\n                    <INPUT TYPE=CHECKBOX NAME="wednesday" data-bind="checked: wednesday, saveOnUpdate: {name: \'sb\', value: wednesday}, property:\'model\'">\n                    T\n                    <INPUT TYPE=CHECKBOX NAME="thursday" data-bind="checked: thursday, saveOnUpdate: {name: \'sb\', value: thursday}, property:\'model\'">\n                    F\n                    <INPUT TYPE=CHECKBOX NAME="friday"  data-bind="checked: friday, saveOnUpdate: {name: \'sb\', value: friday}, property:\'model\'">\n                    S\n                    <INPUT TYPE=CHECKBOX NAME="saturday"  data-bind="checked: saturday, saveOnUpdate: {name: \'sb\', value: saturday}, property:\'model\'">\n                    S\n                    <INPUT TYPE=CHECKBOX NAME="sunday"  data-bind="checked: sunday, saveOnUpdate: {name: \'sb\', value: sunday}, property:\'model\'">\n                </div>\n                <!-- /ko -->\n                <!-- ko if: !userCanEdit() -->\n                <div data-bind="with: schedule" style="padding-bottom: 10px; padding-top: 2px;">\n\n                    M\n                    <INPUT TYPE=CHECKBOX NAME="monday" data-bind="checked: monday, saveOnUpdate: {name: \'sb\', value: monday}, property: \'model\', enable: false">\n                    T\n                    <INPUT TYPE=CHECKBOX NAME="tuesday" data-bind="checked: tuesday, saveOnUpdate: {name: \'sb\', value: tuesday}, property:\'model\', enable: false">\n                    W\n                    <INPUT TYPE=CHECKBOX NAME="wednesday" data-bind="checked: wednesday, saveOnUpdate: {name: \'sb\', value: wednesday}, property:\'model\', enable: false">\n                    T\n                    <INPUT TYPE=CHECKBOX NAME="thursday" data-bind="checked: thursday, saveOnUpdate: {name: \'sb\', value: thursday}, property:\'model\', enable: false">\n                    F\n                    <INPUT TYPE=CHECKBOX NAME="friday"  data-bind="checked: friday, saveOnUpdate: {name: \'sb\', value: friday}, property:\'model\', enable: false">\n                    S\n                    <INPUT TYPE=CHECKBOX NAME="saturday"  data-bind="checked: saturday, saveOnUpdate: {name: \'sb\', value: saturday}, property:\'model\', enable: false">\n                    S\n                    <INPUT TYPE=CHECKBOX NAME="sunday"  data-bind="checked: sunday, saveOnUpdate: {name: \'sb\', value: sunday}, property:\'model\', enable: false">\n                </div>\n                <!-- /ko -->\n                <!-- /ko -->\n\n\n                <div>\n                    <label><h4 style="color:gray;">birthday</h4></label>\n                    <input class="span3" data-bind="datepicker: birthDate, datepickerOptions: { }, saveOnUpdate: {name:\'birth_date\', value: birthDate}" />\n\n                    <label><h4 style="color:gray;">next cpr training date</h4></label>\n                    <input class="span3" data-bind="datepicker: cprTrainingDate, datepickerOptions: { }, saveOnUpdate: {name:\'cpr_training_date\', value: cprTrainingDate}" />\n\n                    <label><h4 style="color:gray;">next first aid training date</h4></label>\n                    <input class="span3" data-bind="datepicker: firstAidTrainingDate, datepickerOptions: { }, saveOnUpdate: {name:\'first_aid_training_date\', value: firstAidTrainingDate}" />\n\n                    <label><h4 style="color:gray;">next physical date</h4></label>\n                    <input class="span3" data-bind="datepicker: nextPhysicalDate, datepickerOptions: { }, saveOnUpdate: {name:\'next_physical_date\', value: nextPhysicalDate}" />\n                </div>\n                <!-- ko if: errors().length > 0 -->\n                <div class="alert alert-block alert-danger">\n                    <h4 class="alert-heading">Error:</h4>\n                    <ul data-bind="foreach: errors">\n                        <li data-bind="text:$data"></li>\n                    </ul>\n                </div>\n                <!-- /ko -->\n                <!-- ko if: isRole(\'LocationAdmin\') || isRole(\'AccountAdmin\') -->\n                <div>\n                    <label><h4 style="color:gray;">communications</h4></label>\n                    <input type="checkbox" data-bind="checked: receiveUnscheduledCheckins, callOnUpdate: $root._.bind(updateSubscriptionProperty, $data, TOPICS.UnscheduledCheckin, CHANNELS.Email), enable: userCanEdit()" ><span style="vertical-align:middle">&nbsp;Unscheduled Checkins</span>\n                </div>\n                <!-- /ko -->\n\n            </div>\n            <div style="clear:both;"></div>\n        </div>\n\n</div>\n<div class="modal-footer">\n    <button class="btn btn-danger pull-left btn-large" data-bind="visible: userCanDelete(), click: remove, enable: !isRemoteSaving()">\n        Delete\n    </button>\n    <button class="btn btn-primary pull-right btn-large" data-bind="click: $parent.close, enable: !userCanEdit() || (valid() && !isRemoteSaving())">\n        Done\n    </button>\n</div>\n<!-- /ko -->\n'}),tadpoles.define("text!view/modals/editEvent.html",[],function(){return'<div style="display:block">\n    <!-- ko if: canEditEventDestination() && inOutbox()-->\n    <div class="control-group" style="float:left" data-bind="style: {width: hasMedia() ? \'59%\' : \'100%\'}">\n        <label style="margin-left:2px"><h3 style="color:gray;">destination</h3></label>\n        <select class="span3" style="margin-bottom: 10px;" data-bind="options: deliveryChoices(), optionsText: \'name\', optionsValue: \'value\', value: destination, optionsCaption: \'choose a destination...\'"></select>\n    </div>\n    <!-- /ko -->\n    <!-- ko if: hasMedia() -->\n    <div style="float:right" data-bind="style: {width: inOutbox() ? \'40%\' : \'100%\'}">\n        <!-- ko if: hasMedia() -->\n            <!-- ko if: hasImage() -->\n                <label><h3 style="color:gray;">photo</h3></label>\n            <!-- /ko -->\n            <!-- ko if: hasVideo() -->\n                <label><h3 style="color:gray;">video</h3></label>\n            <!-- /ko -->\n            <img style="display:block;width:100%;margin-top:2px" data-bind="attr: {src: imageUrl()}, click: showDetails"/>\n        <!-- /ko -->\n\n        <a class="fancybox" data-bind="attr: {id: \'a\' + \'-\' + eventId, href: hasVideo() ? (\'#\' + eventId) : imageUrl(), type: hasVideo() ? \'inline\' : \'image\', title: note() }"></a>\n        <!-- ko if:hasVideo() -->\n            <!--<div class="play-icon">\n                <i class="fa fa-play-circle-o fa-3x" style="color:#FFF"></i>\n            </div>-->\n            <div style="display:none;background-color:black" data-bind="attr: {id: eventId, rel: imageUrl() }, style: {width:attachmentWidth+\'px\', height:attachmentHeight+\'px\'}"></div>\n        <!-- /ko -->\n    </div>\n    <!-- /ko -->\n\n    <!-- ko if: inOutbox() -->\n    <div class="control-group" style="float:left" data-bind="style: {width: hasMedia() ? \'59%\' : \'100%\'}">\n        <label style="margin-left:2px"><h3 style="color:gray;">tagged</h3></label>\n        <div class="clearfix"></div>\n        <!-- ko if: scope() === \'dependant\' -->\n            <ul style="width:100%" data-bind="delegatedHandler: \'click\', tiles: {bricks: taggedChildren, template: \'view/tiles/eventStudentTagTile\', numCols: 5, tileSize: 80, groutWidth: 4, textSizingRef:100}"></ul>\n        <!-- /ko -->\n        <!-- ko if: scope() === \'group\' -->\n            <ul style="width:100%" data-bind="delegatedHandler: \'click\', tiles: {bricks: taggedGroups, template: \'view/tiles/eventClassTagTile\', numCols: 1, tileSize: 80, groutWidth: 4, textSizingRef:100}"></ul>\n        <!-- /ko -->\n        <!-- ko if: scope() === \'location\' -->\n            <ul style="width:100%" data-bind="delegatedHandler: \'click\', tiles: {bricks: taggedLocation, template: \'view/tiles/eventLocationTagTile\', numCols: 1, tileSize: 80, groutWidth: 4, textSizingRef:100}"></ul>\n        <!-- /ko -->\n\n        <div style="margin-top:10px">\n            <div class="input-append pull-left" style="margin-left:2px;margin-bottom:0px;margin-top:0px">\n                <input style="margin-bottom:0px" id="inputTag" type="text" placeholder="add tag" data-bind="value: tagSearchText(), typeahead: typeahead()"/>\n                <span class="add-on" style="margin-left:-5px"><i class="fa fa-search"></i></span>\n            </div>\n        </div>\n    </div>\n    <!-- /ko -->\n    \n    <div class="clearfix"></div>\n</div>\n\n<div class="control-group">\n    <label><h3 style="color:gray;">note</h3></label>\n    <textarea style="height:50px;" type="text" data-bind="style: {width: hasMedia() ? \'680px\' : \'520px\'}, value: note, valueUpdate: \'afterkeydown\'"></textarea>\n    <label><h3 style="color:gray;">schedule</h3></label>\n    <div class="input-append" data-bind="visible: isScheduled()">\n        <input style="width:70px;margin-bottom:0px;" data-bind="datepicker: scheduleDate, datepickerOptions: { minDate : 0 }">\n        <span class="add-on" style="margin-left:-5px;"><i class="fa fa-calendar"></i></span>\n        <input type="text" class="time ui-timepicker-input" style="width:53px; margin-bottom: 0px;" autocomplete="off" data-bind="timePicker: {observable: scheduleTime, step:5, scrollDefaultNow: true, disableTextInput: true}">\n        <span class="add-on" style="margin-left:-5px;"><i class="fa fa-clock-o"></i></span>\n    </div>\n</div>\n'}),tadpoles.define("text!view/modals/editGuardian.html",[],function(){return'<div>\n    <!-- ko if: $data -->\n    <div class="modal-header">\n        <div class="alert alert-block" style="position:absolute;top:0;right:0;" data-bind="visible: isRemoteSaving()">\n            <h4 class="alert-heading">Saving...&nbsp;<i class="fa fa-spinner fa-spin"></i></h4>\n        </div>\n        <i class="pull-right modal-close-button fa fa-times" data-bind="click: $parent.close, visible: !isRemoteSaving()"></i>\n        <h1 data-bind="attr: { id: key +\'-pop\' }, popover: getPopoverParams()"><span data-bind="text: firstName"></span>&nbsp;<span data-bind="text: lastName"></span></h1>\n    </div>\n    <div class="modal-body" style="max-height:570px;">\n        <div style="max-height: 450px;overflow:auto">\n            <div>\n                <div style="float:left;">\n                    <label><h4 style="color:gray;">first name</h4></label>\n                    <input class="span3" type="text" data-bind="value: firstName, saveOnUpdate: \'first_name\'" placeholder="first name"/>\n                    <label><h4 style="color:gray;">last name</h4></label>\n                    <input class="span3" type="text" data-bind="value: lastName, saveOnUpdate: \'last_name\'" placeholder="last name"/>\n                    <label><h4 style="color:gray;">email address</h4></label>\n                    <input class="span3" type="text" data-bind="value: email, saveOnUpdate: \'email\'" placeholder="email address"/>\n                    <label><h4 style="color:gray;">type</h4></label>\n                    <select class="span3" data-bind="options: $root.guardianTypes(), value: type, saveOnUpdate: \'type\'"></select>\n                    <label><h4 style="color:gray;">pin code (4-digits)</h4></label>\n                    <input class="span3" type="text" maxlength="4" data-bind="value: pin, saveOnUpdate: \'pin\'" />\n                </div>\n\n                <div class=\'span3\' style="float:right">\n                    <div class="alert alert-block alert-info">\n                        <h4 class="alert-heading">Note:</h4>\n                        You must enter the first and last name of the guardian, or their email address (or both), as well as the guardian type.\n                    </div>\n                                        <label><h4 style="color:gray;">mobile phone</h4></label>\n                    <input class="span3" type="text" data-bind="value: mobile_number, saveOnUpdate: \'mobile_number\'" />\n                    <label><h4 style="color:gray;">home phone</h4></label>\n                    <input class="span3" type="text" data-bind="value: home_number, saveOnUpdate: \'home_number\'" />\n                    <label><h4 style="color:gray;">work phone</h4></label>\n                    <input class="span3" type="text" data-bind="value: work_number, saveOnUpdate: \'work_number\'" />\n                </div>\n                <div style="clear:both;"></div>\n\n                <div style="clear: both;"></div>\n                <div style="float:left;">\n                    <label><h4 style="color:gray;">note</h4></label>\n                    <textarea class="span3" style="height: 54px;" type="text" data-bind="value: note, saveOnUpdate: \'note\'" maxlength="250"></textarea>\n                </div>\n                <div style="float:right;">\n                    <label><h4 style="color:gray;">special note</h4></label>\n                    <textarea class="span3" style="height: 54px;" type="text" data-bind="value: special_note, saveOnUpdate: \'special_note\'" maxlength="250"></textarea>\n                </div>\n\n            </div>\n        </div>\n\n    </div>\n    <div class="modal-footer">\n        <button class="btn btn-danger pull-left btn-large" data-bind="click: remove, enable: !isRemoteSaving()">\n            Delete\n        </button>\n        <button class="btn btn-primary pull-right btn-large" data-bind="click: $parent.close">\n            Done\n        </button>\n    </div>\n    <!-- /ko -->\n</div>\n'}),tadpoles.define("text!view/modals/editReplyTo.html",[],function(){return'<label><h4 style="color:gray;">email address</h4></label>\n<input class="span3" type="text" data-bind="value: defaultReplyEmail, valueUpdate: \'afterkeydown\'" placeholder="email@school.com"/>\n<div style="float:right;width:280px">\n    <div class="alert alert-block alert-info">\n        <h4 class="alert-heading">Note:</h4>\n        Setting this email address will force all replies by parents for all correspondence go back to this address.\n    </div>\n</div>\n<div style="clear:both;"></div>'}),tadpoles.define("text!view/modals/editPeriods.html",[],function(){return'<div>\n    <!-- ko if:$data -->\n    <div class="modal-header">\n        <i class="pull-right modal-close-button fa fa-times" data-bind="click: $parent.close"></i>\n        <h1 class="hero-h1"><span data-bind="text:periodId() ? \'Edit\' : \'Add\'"></span> Period</h1>\n    </div>\n    <div class="modal-body">\n        <form style="float:left; width: 275px;" class="form-horizontal">\n            <div class="control-group">\n                <label><h4 style="color:gray;margin-top: 20px;">name</h4></label>\n                <input style="width:265px" type="text" data-bind="value: periodName">\n\n                <label><h4 style="color:gray;margin-top: 20px;">start date</h4></label>\n                <div class="input-append">\n                    <input style="width:70px;margin-bottom:0px;" data-bind="datepicker: periodStartDate, datepickerOptions: { maxDate : null }"/>\n                    <span style="margin-left:-5px;" class="add-on"><i class="fa fa-calendar"></i></span>\n                </div>\n\n\n                <label><h4 style="color:gray;margin-top: 20px;">end date</h4></label>\n                <div class="input-append">\n                    <input style="width:70px;margin-bottom:0px;" data-bind="datepicker: periodEndDate, datepickerOptions: { maxDate : null }"/>\n                    <span style="margin-left: -5px;" class="add-on"><i class="fa fa-calendar"></i></span>\n                </div>\n            </div>\n        </form>\n        <div style="clear: both"></div>\n    </div>\n    <div class="modal-footer">\n        <button style="margin-left: 5px;" data-bind="visible: periodId(), click: deletePeriod" class="btn btn-danger pull-left">Delete</button>\n        <button data-bind="click: updatePeriod" class="btn btn-success pull-right">Save</button>\n    </div>\n    <!-- /ko -->\n</div>'}),tadpoles.define("text!view/modals/fileAttachment.html",[],function(){return'<!-- ko if: attachments -->\n<div style="text-align:center; margin-top: 40px;" data-bind="foreach: attachments">\n    <div class="filename-box pointable" style="background:white" data-bind="click: download">\n        <span style="padding:8px;" data-bind="text: name"></span><img src=\'images/1/pdf_icon.png\' width="30" height="30"/>\n    </div>\n</div>\n<!-- /ko -->'}),tadpoles.define("text!view/modals/gallery.html",[],function(){return'<div style="background:black;padding:0;position:fixed;top:0;left:0;right:0;bottom:0;" data-bind="click:close">\n    <!-- ko if: currentObservation() -->\n    <div data-bind="centerWithImageOnLoad: currentObservation().attachmentUrl()"></div>\n    <!-- /ko -->\n</div>'}),tadpoles.define("text!view/modals/import.html",[],function(){return'<div>\n    <form class="form-horizontal" data-bind="submit: submit, fileUpload: files, uploadType: \'csv|xlsx|xls\', progress: progress">\n        <div class="control-group">\n            <span data-bind="visible: !showValidationResults() && !hasErrors()" class="btn btn-success btn-small fileinput-button">\n                <i class="icon-plus icon-white"></i>\n                <span>Choose File</span>\n                <input type="file" name="import_file" />\n            </span>\n            <span style="padding-bottom: 4px;" class="filename-box" data-bind="visible: hasAttachedFile()"><span class="ellipsis filename" style="max-width:150px;" data-bind="text:fileName()"></span>\n\n            <i class="fa fa-times pointable" style="float: right;margin-top: 1px;margin-left: 10px;margin-right: 4px;color: #666;font-size: 16px;" data-bind="click: clearFiles"></i>\n\n            </span>\n            <div>\n                <div data-bind="visible:showValidationResults()" class="alert alert-block alert-info">\n                    <h2>Upload summary</h2>\n                    <ul>\n                        <li><span data-bind="text: newStudentCount"></span> students will be created</li>\n                        <li><span data-bind="text: updateStudentCount"></span> students will be updated</li>\n                        <li><span data-bind="text: removedStudentCount"></span> students will be removed, or will not be created because they are suspended or graduated</li>\n                        <li><span data-bind="text: unchangedStudentCount"></span> students are unaffected by this upload</li>\n                    </ul>\n                </div>\n            </div>\n\n            <div class="progress" style="margin-top: 20px;" data-bind="visible: processing">\n                <div class="bar" role="progressbar" aria-valuenow="70" aria-valuemin="0" aria-valuemax="100" data-bind="style : {width:pctUploaded}"></div>\n            </div>\n\n        </div>\n    </form>\n</div>\n'}),tadpoles.define("text!view/modals/moveModal.html",[],function(){return'<div>\n    <!-- ko if: $data -->\n    <div class="modal-header">\n        <div class="alert alert-block" style="position:absolute;top:0;right:0;" data-bind="visible: isRemoteSaving()">\n            <h4 class="alert-heading">Saving...&nbsp;<i class="fa fa-spinner fa-spin"></i></h4>\n        </div>\n        <i class="pull-right modal-close-button fa fa-times" data-bind="click: $parent.close, visible: !isRemoteSaving()"></i>\n        <h1 class="hero-h1">move</h1>\n        \n        <h3 data-bind="text: displayName ? displayName() : \'\'"></h3>\n    </div>\n    <div class="modal-body" style="max-height:425px">\n        <div class="pull-left">\n            <!-- ko if: type() === \'employee\' -->\n                <!-- ko if: isRole(\'Employee\') -->\n                <div class="label-input">\n                    <label><h4 style="color:gray;">homeroom</h4></label>\n                    <select class="span3" data-bind="options: $root.groups.groupsForCurrentLocation, optionsValue: \'key\', optionsText: \'name\', value: homeroom_key, optionsCaption: \'None\', callOnUpdate: move"></select>\n                </div>\n                <!-- /ko -->\n            <div class="label-input" data-bind="visible: isIn()">\n                <label><h4 style="color:gray;">current room</h4></label>\n                <select class="span3" data-bind="enable: isIn(), options: $root.groups.groupsForCurrentLocation, optionsValue: \'key\', optionsText: \'name\', optionsCaption: \'None\', value: group, callOnUpdate: visit"></select>\n            </div>\n            <!-- /ko -->\n            <!-- ko if: type() !== \'employee\' -->\n            <div class="label-input">\n                <label><h4 style="color:gray;">homeroom</h4></label>\n                <select class="span3"\n                        data-bind="options: $root.groups.groupsForCurrentLocation, optionsValue: \'key\', optionsText: \'name\', value: homeroom_key, callOnUpdate: move"></select>\n            </div>\n            <div class="label-input" data-bind="visible: isIn()">\n                <label><h4 style="color:gray;">current room</h4></label>\n                <select class="span3"\n                        data-bind="enable: isIn(), options: $root.groups.groupsForCurrentLocation, optionsValue: \'key\', optionsText: \'name\', value: group, callOnUpdate: visit"></select>\n            </div>\n            <!-- /ko -->\n        </div>\n        <div class="pull-right" style="width:280px;">\n            <div class="alert alert-block alert-info">\n                <h4 class="alert-heading">Note:</h4>\n                The <strong>homeroom</strong> is the room where the <span data-bind="text: type() === \'employee\' ? \'employee\' : \'child\'"></span> starts his or her day.\n                <!-- ko if: isIn() -->\n                <p></p>\n                <p>The <strong>current room</strong> is the room where the <span data-bind="text: type() === \'employee\' ? \'employee\' : \'child\'"></span> is currently located.</p>\n                <!-- /ko -->\n            </div>\n\n        </div>\n        <div style="clear:both"></div>\n    </div>\n    <div class="modal-footer">\n        <button class="btn btn-primary pull-right btn-large" data-bind="click: $parent.close">\n            Done\n        </button>\n    </div>\n    <!-- /ko -->\n</div>\n'}),tadpoles.define("text!view/modals/moveClass.html",[],function(){return'\n<div style="margin-left:0px;float:left;background-color:#f8f8f8;padding:15px;height:230px;overflow:hidden;">\n    <div>\n        <h3 style="color:gray;">choose destination classroom or area</h3></label>\n        <div style="max-height:180px;margin-top:15px;overflow:auto;">\n            <ul style="width:620px;" data-bind="visible: classrooms().length > 0, tiles: { bricks: classrooms(), template:\'view/tiles/copyClassTile\', numCols: 8, groutWidth: 4, textSizingRef: 105 }"></ul>\n        </div>\n    </div>\n</div>\n\n<div style="clear:both;"></div>\n'}),tadpoles.define("text!view/modals/observations.html",[],function(){return'<div>\n<!-- ko if: child() -->\n<div class="modal-header">\n    <i class="pull-right modal-close-button fa fa-times" data-bind="click: $parent.close"></i>\n\n    <h1 data-bind="visible:child()"><span data-bind="text: child().displayName()"></span></h1>\n\n</div>\n<div class="modal-body" style="overflow:auto;min-height:450px;background-color:#f2f2f2">\n    <!-- ko if:$root.currentUser.isAdmin() || $root.atFacility-->\n    <!--<div class="pull-right">\n        <button class="btn btn-success btn-mini" data-bind="visible:assessmentActive() && assessment(), click:assessment() ? assessment().printWithoutPhotos : null">\n            Print Report\n        </button>\n    </div>-->\n    <div class="btn-group pull-right" style="margin-top:8px">\n        <button type="button" class="btn btn-success btn-mini dropdown-toggle" style="margin-right:4px" data-toggle="dropdown" data-bind="visible:assessmentActive() && assessment()">\n            Print Report <span class="caret"></span>\n        </button>\n        <ul class="dropdown-menu" role="menu">\n            <li><a href="#" data-bind="click: assessment() ? assessment().printWithPhotos : null">with photos</a></li>\n            <li><a href="#" data-bind="click: assessment() ? assessment().printWithoutPhotos : null">without photos</a></li>\n        </ul>\n    </div>\n    <!-- /ko -->\n    <!-- observations -->\n    <ul class="nav nav-pills" style="margin-bottom:0px;">\n        <!-- ko if: $root.product.hasFeature($root.product.Features.CUSTOM_CURRICULUM)-->\n        <li data-bind="css: { \'active\' : assessmentActive() }, visible: curriculum() && !curriculum().legacy">\n            <a href="#" class="dash nav-primary" data-bind="click: activeType.bind($data,EventTypes.ASSESSMENT)">\n                <h4 style="line-height:1">developmental goals</h4></a>\n        </li>\n        <!-- /ko -->\n        <li data-bind="css: { \'active\' : observationsActive() }">\n            <a href="#" class="dash nav-primary" data-bind="click: activeType.bind($data,EventTypes.OBSERVATIONS)">\n                <h4 style="line-height:1" data-bind="text:EventTypes.OBSERVATIONS"></h4></a>\n        </li>\n        <!-- ko if:$root.currentUser.isAdmin() || $root.atFacility-->\n        <li data-bind="css: { \'active\' : dailyReportsActive() }">\n            <a href="#" class="dash nav-primary" data-bind="click:  activeType.bind($data,EventTypes.DAILY_REPORTS)">\n                <h4 style="line-height:1;text-transform:lowercase;" data-bind="text: $root.product.translate(\'daily report\') + \'s\'"></h4></a>\n        </li>\n        <!-- /ko -->\n        <li data-bind="css: { \'active\' : notesActive() }">\n            <a href="#" class="dash nav-primary" data-bind="click:  activeType.bind($data,EventTypes.NOTES)">\n                <h4 style="line-height:1" data-bind="text:EventTypes.NOTES"></h4></a>\n        </li>\n        <!-- ko if:$root.currentUser.isAdmin() || $root.atFacility-->\n        <li data-bind="css: { \'active\' : incidentsActive() }">\n            <a href="#" class="dash nav-primary" data-bind="click:  activeType.bind($data,EventTypes.INCIDENTS)">\n                <h4 style="line-height:1" data-bind="text:EventTypes.INCIDENTS"></h4></a>\n        </li>\n        <!-- /ko -->\n        <!-- ko if:$root.currentUser.isAdmin() && !$root.config.isDemo -->\n        <li >\n            <a target=\'_new\' class="dash nav-primary" data-bind="attr: {href: \'/atwork/attendance/details?child_id=\' + child().key}">\n                <h4 style="line-height:1">attendance</h4></a>\n        </li>\n        <!-- /ko -->\n\n\n    </ul>\n    <div class="pull-right" style="width:57px;position:relative;overflow:auto;margin-top:13px;margin-right:-15px;padding-right:15px;max-height:400px">\n        <ul data-bind="style: { width : \'55px\' },tiles: {bricks: periods(), template: \'view/tiles/templateWrapper\', numCols: 1, groutWidth: 4, textSizingRef:65, tileSize: 55}"></ul>\n    </div>\n\n\n    <div class="pull-right" style="overflow:auto;max-height:400px;margin-top:15px;padding-right:15px;width:632px">\n    <div style="text-align:center;margin-top:10px;" data-bind="visible:assessmentLoader.processing() || processing()">\n        <i class="fa fa-4x fa-spinner fa-spin"></i>\n    </div>\n    <!-- ko if: observationsActive() && observations()-->\n    <div>\n        <div data-bind="if: !processing()">\n            <!-- ko foreach: observationDomains() -->\n            <!-- ko if: $parent.hasObservationsForDomain($data) -->\n            <div style="width:600px;padding:15px;margin-bottom:20px;background-color:#fff">\n                <h2 data-bind="text:$data" style="font-weight:normal"></h2>\n\n                <div style="margin-top:5px;">\n                    <ul style="width:580px;" data-bind="delegatedHandler: \'click\', tiles: {bricks: $parent.observationsForDomain($data), template: \'view/tiles/portfolioEventTile\', numCols:   8, groutWidth:  4, textSizingRef:100 }"></ul>\n                </div>\n            </div>\n            <!-- /ko -->\n            <!-- /ko -->\n            <!-- ko if: untaggedObservations() && untaggedObservations().length > 0 -->\n            <div style="width:600px;padding:15px;margin-bottom:20px;background-color:#fff">\n                <h2 style="font-weight:normal">Untagged</h2>\n\n                <div style="margin-top:5px;">\n                    <ul style="width:580px;" data-bind="visible:true, delegatedHandler: \'click\', tiles: {bricks: untaggedObservations(), template: \'view/tiles/portfolioEventTile\', numCols:   8, groutWidth:  4, textSizingRef:100 }"></ul>\n                </div>\n            </div>\n            <!-- /ko -->\n        </div>\n    </div>\n    <!-- /ko -->\n    <!-- ko if: assessmentActive() -->\n    <!-- add this to avoid requiring background graphics\n     style="-webkit-print-color-adjust: exact;"\n     http://stackoverflow.com/questions/14987496/background-color-not-showing-in-print-preview\n    -->\n    <div id="assess-printable" data-bind="style: { backgroundColor: assessment() && assessment().isPrinting() ? \'#FFF\' : \'#f2f2f2\' }">\n\n        <div data-bind="if: assessment()">\n            <!-- ko if: $root.product.getBrandImageUrl(\'assessment-logo\') -->\n            <img class="assessment-logo pull-right" style="height:70px;" data-bind="visible:assessment().isPrinting(), attr: { src : $root.product.getBrandImageUrl(\'assessment-logo\') }"/>\n            <!-- /ko -->\n            <h1 class="hero-h1" style="margin-left:13px;" data-bind="visible:assessment().isPrinting()"><span data-bind="text: child().displayName()"></span></h1>\n            <h2 style="margin-bottom:20px;" data-bind="visible:assessment().isPrinting(), style: { marginLeft: $parent.assessment().isPrinting() ? \'13px\' : \'auto\'}">Progress in <span data-bind="text: child().homeroom().name()"></span> as of <span class="stat-warn" data-bind="text: assessment().lastDate.format(\'mmmm yyyy\')"></span></h2>\n            <div class="clearfix"></div>\n            <!-- ko if: curriculum().assessableDomains && curriculum().assessableDomains.length === 0 -->\n            <div style="text-align:center;margin:30px 0px;">\n                <h1 style="color:gray">no developmental goals defined</h1>\n                <button class="btn btn-success btn-mini" style="margin-top:15px;" data-bind="visible: $root.currentUser.isAdmin(), click: function() { $data.close(); $root.curricula.editCurriculum() }">\n                    Manage Subjects and Goals\n                </button>\n            </div>\n            <!-- /ko -->\n            <!-- ko foreach: curriculum().assessableDomains -->\n            <div style="width:600px;padding:15px;margin-bottom:20px;background-color:#fff;" data-bind="style: { marginLeft: $parent.assessment().isPrinting() ? \'13px\' : \'auto\',border: $parent.assessment().isPrinting() ? \'1px solid #CCC\' : \'none\',\'page-break-inside\': $index() == 0 ? \'auto\' : \'avoid\' }">\n                <h2 data-bind="text:$data.name" style="font-weight:normal;margin-bottom:10px;"></h2>\n                <!-- ko if: $parent.evidenceForDomain($data.id).length > 0 -->\n                <div style="margin-top:5px;" data-bind="visible: !$parent.assessment().isPrinting() || $parent.assessment().includePhotosForPrinting">\n                    <ul style="width:580px;" data-bind="delegatedHandler: \'click\', tiles: {bricks: $parent.evidenceForDomain($data.id), template: \'view/tiles/evidenceTile\', numCols:   8, groutWidth:  4, textSizingRef:100 }"></ul>\n                </div>\n                <!-- /ko -->\n                <!-- ko if: $data.outcomes -->\n                <div style="margin-top:5px;margin-bottom:20px;">\n                    <table cellspacing="0" cellpadding="0">\n                        <thead>\n                        <tr>\n                            <th style="width:310px;text-align:left">\n                            </th>\n                            <th style="width:20px;"></th>\n                            <th style="width:10px;font-weight:normal"></th>\n                            <th style="width:70px;font-weight:normal" data-bind="text:$root.product.translate(\'assess:unmet\',\'unmet\')"></th>\n                            <th style="width:70px;font-weight:normal" data-bind="text:$root.product.translate(\'assess:improved\',\'improved\')"></th>\n                            <th style="width:70px;font-weight:normal" data-bind="text:$root.product.translate(\'assess:meets\',\'meets\')"></th>\n                            <th style="width:70px;font-weight:normal" data-bind="text:$root.product.translate(\'assess:exceeds\',\'exceeds\')"></th>\n                        </tr>\n                        </thead>\n                        <tbody>\n                        <!-- ko foreach: $data.outcomes -->\n                        <tr data-bind="css: { hgoal : $parents[2].highlightedOutcomesById()[$data.id] }" >\n                            <td style="text-align:right" data-bind="popover: $parents[1].ratingPopupForOutcome($data.id)">\n                                <div data-bind="style: { whiteSpace: $parents[1].assessment().isPrinting() ? \'normal\' : \'nowrap\'}" style="display:inline-block;vertical-align:middle;width:300px;overflow:hidden;text-overflow: ellipsis;">\n                                    <span style="" data-bind="text:$data.name + ($data.externalId ? \' \' + $data.externalId :\'\'), tooltip: { value: $data.name + ($data.externalId ? \' \' + $data.externalId :\'\'), trigger: \'truncate\'} "></span></div>\n                            </td>\n                            <td>&nbsp;</td>\n                            <!-- ko with: $parents[1].ratingForOutcome($data.id) -->\n                            <td class="pointable" data-bind="click: $parents[2].unlockAndApply.bind($parents[2], $parents[2].setRating, $data.goalId, 0)">\n                                <div style="width:100%;height:7px;margin-top:5px;margin-bottom:5px;" data-bind="style: { width: \'100%\', backgroundColor : color() }"></div>\n                            </td>\n                            <td class="pointable" data-bind="click: $parents[2].unlockAndApply.bind($parents[2], $parents[2].setRating, $data.goalId, 1)">\n                                <div style="width:100%;height:7px;margin-top:5px;margin-bottom:5px;" data-bind="style: { width: rating() === 0 ? \'0%\' : rating() === 1 ? \'50%\' : \'100%\', backgroundColor : rating() >= 1 ? color() : \'transparent\' }"></div>\n                            </td>\n                            <td class="pointable" data-bind="click: $parents[2].unlockAndApply.bind($parents[2], $parents[2].setRating, $data.goalId, 2)">\n                                <div style="width:100%;height:7px;margin-top:5px;margin-bottom:5px;" data-bind="style: { width: rating() === 2 ? \'50%\' : \'100%\', backgroundColor : rating() >= 2 ? color() : \'transparent\' }"></div>\n                            </td>\n                            <td class="pointable" data-bind="click: $parents[2].unlockAndApply.bind($parents[2], $parents[2].setRating, $data.goalId, 3)">\n                                <div style="width:100%;height:7px;margin-top:5px;margin-bottom:5px;" data-bind="style: { width: rating() === 3 ? \'50%\' : \'100%\', backgroundColor : rating() >= 3 ? color() : \'transparent\'}"></div>\n                            </td>\n                            <td class="pointable" data-bind="click: $parents[2].unlockAndApply.bind($parents[2], $parents[2].setRating, $data.goalId, 4)">\n                                <div style="width:100%;height:7px;margin-top:5px;margin-bottom:5px;" data-bind="style: { width: rating() === 4 ? \'50%\' : \'100%\', backgroundColor : rating() >= 4 ? color() : \'transparent\'}"></div>\n                            </td>\n                            <!-- /ko -->\n                        </tr>\n                        <!-- /ko -->\n                        </tbody>\n                    </table>\n                </div>\n                <!-- /ko -->\n                <!-- ko with: $parent.noteForDomain($data.id) -->\n                <div data-bind="visible: !$parents[1].assessment().isPrinting() || ($data.note() && $data.note().length > 0) ">\n\n                    <div class="curriculum-edit" style="margin-bottom:10px;" data-bind="click: $parents[1].unlockAndApply.bind($parents[1], $parents[1].assessment().editNote, $data), css: { editable: ($data.note() && $data.note().length > 0) } ">\n                    <h3 style="font-size:16px;" data-bind="visible: $data.note() && $data.note().length > 0">teacher comments</h3>\n                    <i class="fa fa-edit" data-bind="visible: !$parents[1].assessment().isPrinting()"></i>\n                    <span data-bind="text: $data.note() && $data.note().length > 0 ? $data.note() : \'add teacher comments...\'"></span>\n                    </div>\n\n                </div>\n                <!-- /ko -->\n            </div>\n            <!-- /ko -->\n            <!-- ko if: curriculum().assessableDomains && curriculum().assessableDomains.length > 0 -->\n            <!-- ko with: $parent.noteForDomain(\'__assess__\') -->\n            <div style="width:600px;padding:15px;margin-bottom:20px;background-color:#fff" data-bind="visible: !$parents[1].assessment().isPrinting() || ($data.note() && $data.note().length > 0), style: { marginLeft: $parents[1].assessment().isPrinting() ? \'13px\' : \'auto\',border: $parents[1].assessment().isPrinting() ? \'1px solid #CCC\' : \'none\' }">\n                <h2 style="font-weight:normal;margin-bottom:10px;">teacher comments</h2>\n                <div style="margin-top:5px;">\n\n                    <div class="curriculum-edit" style="margin-bottom:10px;" data-bind="click: $parents[1].unlockAndApply.bind($parents[1], $parents[1].assessment().editNote, $data), css: { editable: ($data.note() && $data.note().length > 0) } ">\n                    <i class="fa fa-edit" data-bind="visible: !$parents[1].assessment().isPrinting()"></i>\n                    <span data-bind="text: $data.note() && $data.note().length > 0 ? $data.note() : \'add teacher comments...\'"></span>\n                    </div>\n\n                </div>\n            </div>\n            <!-- /ko -->\n            <!-- /ko -->\n        </div>\n    </div>\n    <!--/ko -->\n    <!-- ko if: !observationsActive() && !assessmentActive()-->\n    <div>\n        <div data-bind="visible: !processing(), style: { paddingBottom : activeType() === EventTypes.INCIDENTS ? \'28px\' : \'0px\' }">\n            <ul style="width:595px;" data-bind="delegatedHandler: \'click\', tiles: {bricks: observations(), template: \'view/tiles/eventTile\', numCols:  6, groutWidth:  4, textSizingRef:100 }"></ul>\n        </div>\n    </div>\n    <!-- /ko -->\n    <div class="alert alert-block alert-error" style="padding-right:14px" data-bind="visible: hasErrors()">\n        <h3 class="alert-heading">An error occurred!</h3>\n\n        <div data-bind="foreach: results.errors()">\n            <span data-bind="text: $data"></span>\n            <br/>\n        </div>\n    </div>\n    <div style="text-align:center;margin:30px 0;" data-bind="visible: !processing() && !assessmentActive() && observations().length == 0 && !hasErrors()">\n        <h1 style="color:gray">no <span data-bind="text:!selectedPeriod() ? \'recent \' : \'\'"></span><span data-bind="text:activeType"></span>\n            <span style="color: #FAA732" data-bind="text:selectedPeriod() ? \' for \' + selectedPeriod().fullName() :\'\' "></span></h1>\n    </div>\n        </div>\n\n</div>\n<div class="modal-footer">\n    <div class="pull-right" style="margin-top:18px;">&nbsp;</div>\n    <!-- ko if: hasSelection() && ($root.currentUser.isAdmin() || $root.atFacility ) && observationsActive()-->\n    <div class="pull-left" style="text-align: left">\n        <div class="pull-left" style="margin-bottom: 5px;"><span data-bind="text: numSelections()"></span> selected</div>\n        <div class="clearfix"></div>\n        <div class="pull-left">\n            <div class="pull-left">\n                <button class="btn btn-primary" data-bind="click: showDetails">\n                    view\n                </button>\n                <button class="btn btn-success" data-bind="click: download">\n                    download\n                </button>\n            </div>\n            <div class="btn-group dropup pull-left" style="margin-left:10px;">\n                <button type="button" class="btn btn-warning dropdown-toggle" data-toggle="dropdown">\n                    organize <span class="caret"></span>\n                </button>\n                <ul class="dropdown-menu" role="menu">\n                    <li><a href="#" data-bind="click: resend">Resend to parents</a></li>\n                    <li><a href="#" data-bind="click: clearSelections">Clear selection</a></li>\n                </ul>\n            </div>\n            <!-- ko if: numSelections() == 1 -->\n            <div class="pull-left" style="margin-left:10px;">\n                 <button class="btn btn-info" data-bind="click: edit">\n                    edit\n                </button>\n            </div>\n            <!-- /ko -->\n        </div>\n\n    </div>\n    <!-- /ko -->\n    <!-- ko if: assessmentActive() -->\n    <div class="pull-right" style="display: table">\n        <!-- ko if: customCurriculaPeriodsActive() && selectedPeriod() -->\n        <div style="display: table-row">\n            <div style="display: table-cell; vertical-align: middle">\n                <span style="margin-right: 8px; vertical-align: middle;" data-bind="text: selectedPeriod().name()"> </span>\n            </div>\n            <div style="display: table-cell; vertical-align: middle">\n                <span style="vertical-align: middle" data-bind="text: selectedPeriodStartDateDisplay() + \' - \' + selectedPeriodEndDateDisplay()"></span>\n            </div>\n            <!-- ko if: $root.isMasterAccount() && ($root.currentUser.isAccountAdmin() || $root.currentUser.isCsr())-->\n            <div style="display:table-cell;">\n                <button style="vertical-align: middle; margin-left: 8px" data-bind="click: editPeriod" class="btn btn-success pull-right">Edit</button>\n            </div>\n            <!-- /ko -->\n        </div>\n        <!-- /ko -->\n    </div>\n    <!-- /ko -->\n</div>\n<!-- /ko -->\n</div>'}),tadpoles.define("text!view/modals/outTodayForm.html",[],function(){return'<div style="display:inline-block">\n    <div class="control-group">\n        <ul class="nav nav-pills pull-left" style="margin-bottom:5px;">\n            <li data-bind="css: { \'active\' : isSick() }" >\n                <a href="#" class="dash emphasized" data-bind="click: chooseSick"><h4 style="line-height:1">sick</h4></a>\n            </li>\n            <li data-bind="css: { \'active\' : isVacation() }">\n                <a href="#" class="dash emphasized" data-bind="click: chooseVacation"><h4 style="line-height:1">vacation</h4></a>\n            </li>\n            <li data-bind="css: { \'active\' : isOther() }">\n                <a href="#" class="dash emphasized" data-bind="click: chooseOther"><h4 style="line-height:1">other</h4></a>\n            </li>\n        </ul>\n    </div>\n\n    <div class="control-group" data-bind="visible:isSick() || isOther()">\n        <textarea style="width:520px;height:50px;" type="text" data-bind="value: reason, valueUpdate: \'afterkeydown\'" placeholder="reason"></textarea>\n    </div>\n\n    <div class="control-group" data-bind="visible:isVacation()">\n        <input class="span3" data-bind="datepicker: returnDate, datepickerOptions: { minDate : 1}" placeholder="return date" />\n    </div>\n</div>\n'}),tadpoles.define("text!view/modals/absenceForm.html",[],function(){return'<div style="display:block; min-height: 320px;">\n    <div style="float:left;width:50%">\n        <!--<label style="margin-left:0px;text-align:center"><h3 style="color:gray;">add new</h3></label>-->\n        <div class="control-group">\n            <div>\n                <!-- ko if:!activeType() -->\n                    <label><h4 style="color:gray;">select reason</h4></label>\n                <!-- /ko -->\n                <!-- ko if:activeType() -->\n                    <label><h4 style="color:gray;">reason</h4></label>\n                <!-- /ko -->\n                <ul class="nav nav-pills pull-left" style="margin-bottom:5px;">\n                    <li data-bind="css: { \'active\' : isSick() }" >\n                        <a href="#" class="dash emphasized" data-bind="click: chooseSick"><h4 style="line-height:1">sick</h4></a>\n                    </li>\n                    <li data-bind="css: { \'active\' : isVacation() }">\n                        <a href="#" class="dash emphasized" data-bind="click: chooseVacation"><h4 style="line-height:1">vacation</h4></a>\n                    </li>\n                    <li data-bind="css: { \'active\' : isOther() }">\n                        <a href="#" class="dash emphasized" data-bind="click: chooseOther"><h4 style="line-height:1">other</h4></a>\n                    </li>\n                </ul>\n            </div>\n            <!-- ko if:activeType() -->\n            <div style="display:inline-block">\n                <!--<label><h4 style="color:gray;">excused</h4></label>-->\n                <ul class="nav nav-pills pull-left" style="margin-bottom:5px;">\n                    <li data-bind="css: { \'active\' : excused() }" >\n                        <a href="#" class="dash emphasized" data-bind="click: setExcused.bind($data, true)"><h5 style="line-height:1">excused</h5></a>\n                    </li>\n                    <li data-bind="css: { \'active\' : !excused() }">\n                        <a href="#" class="dash emphasized" data-bind="click: setExcused.bind($data, false)"><h5 style="line-height:1">unexcused</h5></a>\n                    </li>\n                </ul>\n            </div>\n            <div style="display:inline-block">\n                <label><h4 style="color:gray;">first day out</h4></label>\n                <input class="span3" data-bind="datepicker: startDate, datepickerOptions: { minDate : 0 }"/>\n                <label><h4 style="color:gray;">returning on</h4></label>\n                <input class="span3" data-bind="datepicker: returnDate, datepickerOptions: { minDate : 1 }" />\n                <!-- ko if: !isVacation() -->\n                    <!-- ko if: isSick() -->\n                        <label><h4 style="color:gray;">sickness</h4></label>\n                    <!-- /ko -->\n                    <!-- ko if: isOther() -->\n                        <label><h4 style="color:gray;">note</h4></label>\n                    <!-- /ko -->\n                    <textarea style="height:50px;" type="text" data-bind="value: reason, valueUpdate: \'afterkeydown\'" placeholder="optional"></textarea>\n                <!-- /ko -->\n            </div>\n            <!-- /ko -->\n        </div>\n    </div>\n    <div style="float:right;width:50%">\n        <!-- -->\n        <div style="text-align: center;" data-bind="visible:absenceLoader.processing">\n            <i class="fa fa-4x fa-spinner fa-spin"></i>\n        </div>\n        <!-- ko if: currentAbsences().length > 0 -->\n        <div style="margin-bottom:10px" data-bind="visible:!absenceLoader.processing()">\n            <label style="margin-left:0px;text-align:left"><h4 style="color:gray;">today</h4></label>\n            <!-- ko if: currentAbsences().length == 0 -->\n            <div style="text-align:left">\n                <span>None</span>\n            </div>\n            <!-- /ko -->\n            <!-- ko foreach: currentAbsences() -->\n            <div style="margin-bottom:5px" class="food-row">\n                <div style="display:inline-block">\n                    <i style="margin-right:5px;font-size:1.0em" class="fa fa-times fa-muted fa-border delete-button" data-bind="click: $parent.deleteAbsence"></i>\n                    <span data-bind="text: absenceTextStart()"></span>\n                    <i style="margin-left:4px;margin-right:4px" class="fa fa-arrow-right"></i>\n                    <span data-bind="text: absenceTextEnd()"></span>\n                </div>\n                <!-- ko:if reason() -->\n                    <span class="absence-reason" data-bind="text: reason"></span>\n                <!-- /ko -->\n            </div>\n            <!-- /ko -->\n        </div>\n        <!-- /ko -->\n        <div data-bind="visible:!absenceLoader.processing()">\n            <label style="margin-left:0px;text-align:left"><h4 style="color:gray;">future</h4></label>\n            <!-- ko if: futureAbsences().length == 0 -->\n            <div style="text-align:left">\n                <span>None</span>\n            </div>\n            <!-- /ko -->\n            <!-- ko foreach: futureAbsences() -->\n            <div style="margin-bottom:5px" class="food-row">\n                <div style="display:inline-block">\n                    <i style="margin-right:5px;font-size:1.0em" class="fa fa-times fa-muted fa-border delete-button" data-bind="click: $parent.deleteAbsence"></i>\n                    <span data-bind="text: absenceTextStart()"></span>\n                    <i style="margin-left:4px;margin-right:4px" class="fa fa-arrow-right"></i>\n                    <span data-bind="text: absenceTextEnd()"></span>\n                </div>\n                <!-- ko:if reason() -->\n                    <span class="absence-reason" data-bind="text: reason"></span>\n                <!-- /ko -->\n            </div>\n            <!-- /ko -->\n        </div>\n    </div>\n    <div class="clearfix"></div>\n</div>\n'}),tadpoles.define("text!view/modals/communicationsModal.html",[],function(){return'<div>\n    <!-- ko if: $data -->\n    <div class="modal-header">\n        <i class="pull-right modal-close-button fa fa-times" data-bind="click: close"></i>\n        <h1 class="hero-h1">send a note</h1>\n        \n        <h3 data-bind="text:title()"></h3>\n    </div>\n    <div class="modal-body" style="max-height:425px">\n        <div data-bind="template:  { name: \'view/communications\' }">\n        </div>\n    </div>\n    <div class="modal-footer">\n        <button class="btn btn-primary pull-right btn-large" data-bind="enable: !processing() && valid(), click: submit">\n            <span data-bind="text: sendButtonText()"></span>\n        </button>\n\n    </div>\n    <!-- /ko -->\n</div>\n'}),tadpoles.define("text!view/modals/portfolioPrint.html",[],function(){return'<style>\n\n\n\n</style>\n<div>\n    <div class="portfolio-printable" data-bind="attr: {id: printId()}" class="modal-body" style="margin:0px 0px 10px 0px;padding:0px;">\n        <ul  data-bind="tiles: {bricks: selections(), template: \'view/tiles/portfolioPrintTile\', numCols:  numCols(), groutWidth: 6, textSizingRef:100 }"></ul>\n    </div>\n\n</div>'}),tadpoles.define("text!view/modals/procareForm.html",[],function(){return'<div>\n    <div class="pull-left">\n        <label style="color: #545454">\n            <h4>Name</h4>\n        </label>\n        <input type="text" data-bind="value:name, valueUpdate: \'afterkeydown\'" placeholder="my full name">\n        </input>\n        <label style="color: #545454">\n            <h4>Center Name</h4>\n        </label>\n        <input type="text" data-bind="value:center, valueUpdate: \'afterkeydown\'" placeholder="my childcare center name">\n        </input>\n        <label style="color: #545454">\n            <h4>Phone Number</h4>\n        </label>\n        <input type="text" data-bind="value:phone, valueUpdate: \'afterkeydown\'" placeholder="(555)-555-5555">\n        </input>\n        <label style="color: #545454">\n            <h4>Email Address</h4>\n        </label>\n        <input type="text" data-bind="value:email, valueUpdate: \'afterkeydown\'" placeholder="director@my.email.provider">\n        </input>\n    </div>\n    <div class="pull-right">\n        <div style="float:right;width:280px">\n            <div class="alert alert-block alert-info">\n                <h3 class="alert-heading">Thanks for reaching out!</h3>\n                <p style="margin-top:10px;">\n                    All we need is your name, phone number, and email address and we\'ll contact you within 24 hours.\n                </p>\n            </div>\n        </div>\n    </div>\n    <div class="clearfix"></div>\n</div>\n\n'}),tadpoles.define("text!view/modals/referInfoForm.html",[],function(){return'<div>\n    <div style="max-width:400px;margin-bottom:20px;">\n    <span style="font-weight:200;font-size:18px;" data-bind="text: description"></span>\n    </div>\n    <input type="text" style="width:280px" name="name" placeholder="your name" data-bind="value:name">\n    <input type="email" style="width:280px" name="email" placeholder="your email" data-bind="value:email">\n</div>'}),tadpoles.define("text!view/modals/resyncAccount.html",[],function(){return'<div>\n    <div class="modal-header">\n        <i class="pull-right modal-close-button fa fa-times" data-bind="click: close"></i>\n\n        <h1 class="hero-h1">Resync Location</h1>\n    </div>\n    <div class="modal-body">\n        <h2 style="color:gray" data-bind="visible: locationList().length === 0">no locations found</h2>\n\n        <div data-bind="visible: locationList().length > 0">\n            <label><h4 style="color:gray;">choose a location</h4></label>\n            <select class="span3" data-bind="options: locationList(), optionsValue: \'id\', optionsText: \'name\', value: location"></select>\n        </div>\n    </div>\n    <div class="modal-footer">\n        <button class="btn btn-primary pull-right btn-large" data-bind="click: resync, enable: location()">\n            Resync\n        </button>\n        <button class="btn pull-right btn-large" data-bind="click: close">\n            Cancel\n        </button>\n    </div>\n</div>\n'}),tadpoles.define("text!view/modals/signup.html",[],function(){return'<div>\n    <div class="modal-header">\n        <i class="pull-right modal-close-button fa fa-times" data-bind="click: $parent.close"></i>\n        <h1 >Step 1 - Google Account</h1>\n        <h3>Don\'t worry. There are only 2 steps!</h3>\n    </div>\n    <div class="modal-body" style="max-height:500px">\n        <div class="alert alert-block alert-info">\n            <h3 class="alert-heading">Why a Google Account?</h3>\n            <h4 class="alert-heading">Because we care about security!</h4>\n            <p style="margin-top:20px;">\n            We highly value your privacy and security and therefore use trusted third-party authentication rather than storing your passwords ourselves.\n            If you already have a Google or Gmail account, please click below to be authenticated by Google.\n            </p>\n        </div>\n        <div style="text-align:center">\n            <button class="btn btn-primary btn-large" style="margin-right:50px;">\n                Login to Google\n            </button>\n            <button class="btn btn-primary btn-large">\n                Create a Google Account\n            </button>\n        </div>\n\n    </div>\n</div>'}),tadpoles.define("text!view/modals/weeklyLessonPlan.html",[],function(){return'\n\n<div id="weeklylesson-printable" data-bind="style: {zoom: isPrinting() ? \'76%\' : \'100%\'}">\n\n    <!--ko if: isSizeLegal() && isPrinting() -->\n    <style type="text/css">\n        @media print {\n            @page {\n                size: 14in 8.5in;\n            }\n            .lesson-box .lesson-text {\n\n                font-size: 13px !important;\n                line-height: 100%;\n                height: 78px !important;\n                overflow: hidden;\n                word-break: break-word;\n            }\n\n\n            .lesson-box{\n                margin: 1px !important;\n                height: 90px !important;\n                width: 16%;\n                font-size: 70%;\n            }\n            .lesson-title {\n                width: 170px !important;\n            }\n        }\n    </style>\n    <!--/ko-->\n\n\n    <!--ko if: !isSizeLegal() && isPrinting()-->\n    <style type="text/css">\n         @media print {\n             @page {\n                size: landscape;\n             }\n         }\n    </style>\n    <!--/ko-->\n\n    <style type="text/css">\n\n        @media print{\n            @page {\n                margin: 2mm;\n            }\n            body {\n                background-color: white;\n                overflow-x: hidden;\n            }\n\n            .lesson-box .lesson-bg {\n                background-color: #EEE;\n            }\n\n            .lesson-box .lesson-text {\n                text-align:left;\n                color:#222;\n                margin: 6px 8px 8px 6px;\n                font-size: 12px;\n                line-height: 100%;\n                height: 68px;\n                overflow: hidden;\n                word-break: break-word;\n            }\n            .lesson-title {\n                text-align:left;\n                display:inline-block;\n                color:#FFF;\n                width:150px;\n                margin: 4px 2px 12px 2px;\n            }\n\n            .lesson-box{\n                margin: 1px !important;\n                height: 80px;\n                width: 16%;\n                font-size: 70%;\n            }\n            .lesson-grid{\n                width:100%;\n            }\n            .row-header\n            {\n                background-color: rgb(73, 175, 205);\n                color:white;\n                word-wrap:break-word;\n\n            }\n            .week-header\n            {\n                background-color: rgb(169, 169, 169);\n                color:#FFF;\n            }\n            .modal-body\n            {\n               top: 0;\n            }\n        }\n        @media screen{\n\n            .lesson-box .tile {\n\n            }\n\n            .lesson-box .lesson-bg {\n                background-color: #EEE;\n\n            }\n            .lesson-box{\n                margin: 1px !important;\n                height: 80px;\n                width: 144px;\n                font-size: 70%;\n            }\n            .lesson-grid{\n                width:888px;\n            }\n            .lesson-box .lesson-text {\n                text-align:left;\n                color:#222;\n                margin: 6px 8px 8px 6px;\n                font-size: 11px;\n                line-height: 100%;\n                height: 68px;\n                overflow: hidden;\n                word-break: break-word;\n            }\n            .lesson-title {\n                text-align:left;\n                display:inline-block;\n                color:#FFF;\n                margin: 4px 2px 4px 2px;\n                width:120px;\n            }\n            .row-header\n            {\n               background-color: rgb(73, 175, 205);\n               color:#FFF;\n               word-wrap:break-word;\n\n            }\n            .week-header\n            {\n                background-color: rgb(169, 169, 169);\n                color:#FFF;\n\n            }\n\n        }\n        .header-text{\n            text-align:left;\n            display:inline-block;\n        }\n\n\n    </style>\n<div class="modal-header">\n    <i class="pull-right modal-close-button fa fa-times" data-bind="click: $parent.close,visible:!isPrinting()"></i>\n    <div style="display:table;">\n        <!-- ko if: $root.product.getBrandImageUrl(\'lesson-logo\') -->\n        <div style="display: table-cell">\n            <img class="week-lesson-logo" style="height:70px;margin-right:20px;" data-bind="attr: { src : $root.product.getBrandImageUrl(\'lesson-logo\') }"/>\n        </div>\n        <!-- /ko -->\n        <div class="week-lesson-header-info" style="display: table-cell">\n            <h1 data-bind="text: (selectedClassroom() ? selectedClassroom().name() : $root.filter.location().name) + \' Lessons\'"></h1>\n            <span style="color:#999;font-weight:200;font-size:24px;" data-bind="text: date() ? \'the week of \' + date().format(\'m/d\') : \'\'"></span>\n            <!-- if lessonDetails() && lessonDetails().weeklyTheme() -->\n            <br/>\n            <span style="color:#49AFCD;font-weight:200;font-size:24px;line-height:1" data-bind="text:lessonDetails() ? lessonDetails().weeklyTheme():\'\'"></span>\n            <!-- /ko -->\n        </div>\n    </div>\n    <div class="clearfix"></div>\n</div>\n<div class="modal-body" style="overflow:auto" data-bind="style: {maxHeight: isPrinting() ? \'none\' : \'500px\', height: isPrinting() ? \'auto\' : \'500px\', padding: isPrinting() ? \'0px\' : \'15px\'}">\n\n    <!-- ko if: lessonDetails() -->\n    <div class=\'lesson-grid\'>\n        <ul style="margin: 0px;" class="thumbnails">\n            <li class="lesson-box">\n                <div class="tile week-header">\n                    <div style="height:100%">\n\n                        <div class="valign" style="height:100%">\n                            <div class="center">\n                                <div class="header-text">\n\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </li>\n            <li class="lesson-box">\n                <div class="tile week-header" >\n                    <div style="height:100%">\n                        <div class="valign" style="height:100%">\n                            <div class="center">\n                                <div class="header-text">\n                                    <span style="font-size:28px;" data-bind="text: days()[1]"></span>\n                                    <br>\n                                    <span style="font-size:14px;" data-bind="text: dates()[1]"></span>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </li>\n            <li class="lesson-box">\n                <div class="tile week-header">\n                    <div style="height:100%">\n                        <div class="valign" style="height:100%">\n                            <div class="center">\n                                <div class="header-text">\n                                    <span style="font-size:28px;" data-bind="text: days()[2]"></span>\n                                    <br>\n                                    <span style="font-size:14px;" data-bind="text: dates()[2]"></span>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </li>\n            <li class="lesson-box">\n                <div class="tile week-header">\n                    <div style="height:100%">\n                        <div class="valign" style="height:100%">\n                            <div class="center">\n                                <div class="header-text">\n                                    <span style="font-size:28px;" data-bind="text: days()[3]"></span>\n                                    <br>\n                                    <span style="font-size:14px;" data-bind="text: dates()[3]"></span>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </li>\n            <li class="lesson-box">\n                <div class="tile week-header">\n                    <div style="height:100%">\n                        <div class="valign" style="height:100%">\n                            <div class="center">\n                                <div class="header-text">\n                                    <span style="font-size: 28px;" data-bind="text: days()[4]"></span>\n                                    <br>\n                                    <span style="font-size:14px;" data-bind="text: dates()[4]"></span>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </li>\n            <li class="lesson-box">\n                <div class="tile week-header">\n                    <div style="height:100%">\n                        <div class="valign" style="height:100%">\n                            <div class="center">\n                                <div class="header-text">\n                                    <span style="font-size: 28px;" data-bind="text: days()[5]"></span>\n                                    <br>\n                                    <span style="font-size:14px;" data-bind="text: dates()[5]"></span>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </li>\n        </ul>\n\n\n        <!-- ko foreach: {data: lessonDetails().subjectAreas(), as: \'subjectArea\'} -->\n            <ul style="margin: 0px;" class="thumbnails">\n                <li class="lesson-box">\n                    <div class="tile row-header">\n                        <div style="height:100%">\n\n                            <div class="valign" style="height:100%">\n                                <div class="center">\n                                    <div class="lesson-title">\n                                        <span style="font-size: 20px;" data-bind="text:subjectArea.printableName"></span>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </li>\n                <!-- ko foreach: {data: subjectArea.plans, as: \'plan\'} -->\n                    <li class="lesson-box">\n                        <div class="tile lesson-bg">\n                            <div style="height:100%">\n\n                                <div class="valign" style="height:100%">\n                                    <div class="center">\n                                        <div class="lesson-text">\n\n                                            <span data-bind="text: plan"></span>\n\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </li>\n                <!-- /ko -->\n            </ul>\n        <!-- /ko -->\n    </div>\n    <!-- /ko -->\n\n\n</div>\n<div class="modal-footer" style="background-color:white;" data-bind="visible:!isPrinting()">\n    <button class="btn btn-large btn-success pull-right" style="margin-left:10px;margin-top:4px;" data-bind="click:print">Print Letter</button>\n    <button class="btn btn-large btn-success pull-right" style="margin-left:10px;margin-top:4px;" data-bind="click:printLegal">Print Legal</button>\n</div>\n</div>'}),tadpoles.define("text!view/modals/portfolioEventEdit.html",[],function(){return'<div class="steps edit-modal" style="background-color:#fff;margin:-15px;">\n    <div class="pull-left" style="padding:15px;height:485px;width:237px;background-color:#6f6e6f;color:#FFF;overflow:hidden">\n        <div style="width:237px;height:490px;overflow:auto;">\n            <label><h2 style="color:#f1f1f1;">\n                subject areas</h2></label>\n            <!-- ko if: domains().length > 0 -->\n            <div class="control-group">\n                <ul class="nav nav-pills nav-vert pull-left" style="margin-bottom:5px;width:100%" data-bind="foreach: domains()">\n                    <li data-bind="css: { \'active\' : $parent.domainSelected($data.id)  }">\n                        <a href="#" class="dash " data-bind="css: { \'nav-yellow\': $data.st !== \'d\', \'medium-dark-blue\': $data.st === \'d\', \'medium-dark\': $data.st !== \'d\' }, click: $parent.selectDomain">\n                            <h4 style="line-height:1" data-bind="text:$data.name"></h4>\n                        </a>\n                    </li>\n                </ul>\n                <div class="clearfix"></div>\n            </div>\n            <!-- /ko -->\n        </div>\n    </div>\n    <div class="pull-left" style="padding:15px;height:485px;width:237px;background-color:#f2f2f2;overflow:hidden" >\n        <div style="width:237px;height:490px;overflow:auto;">\n            <div class="control-group" data-bind="visible: curriculumGoals().length > 0 && curriculum()">\n                <label><h2 style="color:#444;">\n                    developmental goals</h2></label>\n                <ul class="nav nav-vert nav-pills pull-left" style="margin-bottom:5px;width:100%"\n                    data-bind="foreach: curriculumGoals()">\n                    <li data-bind="css: { \'active\' : $parent.goalSelected($data.id) }">\n                        <a href="#" class="dash white nav-labels" data-bind="click: $parent.selectGoal">\n                            <h4 style="line-height:1;"><span data-bind="text:$data.name + ($data.externalId ? \' \' + $data.externalId :\'\')"></span></h4>\n                        </a>\n                    </li>\n                </ul>\n                <div class="clearfix"></div>\n            </div>\n        </div>\n    </div>\n    <div class="pull-left" style="padding:15px;height:485px;width:356px;background-color:#FFF;overflow:hidden">\n        <div class="control-group" style="margin-bottom:5px;">\n            <label><h2 style="color:gray;">note</h2></label>\n            <textarea style="width:100%;height:80px;box-sizing:border-box" type="text" data-bind="value: description, valueUpdate: \'afterkeydown\',style:{ height:\'120px\'}"></textarea>\n        </div>\n    </div>\n    <div class="clearfix"></div>\n</div>\n\n'}),tadpoles.define("text!view/modals/daily_report/activityEdit.html",[],function(){return'<div class="steps edit-modal" style="background-color:#fff;margin:-15px;">\n    <div class="pull-left" style="padding:15px;height:485px;width:237px;background-color:#6f6e6f;color:#FFF;overflow:hidden">\n        <div style="width:237px;height:490px;overflow:auto;">\n            <!-- ko if: (mode() === MODES.Curriculum  && $root.product.hasFeatureLevel($root.product.Features.UNITS_OF_LEARNING, $root.product.Levels.UNITS_OF_LEARNING_LEVEL_BETA)) ||\n            $root.product.hasFeatureLevel($root.product.Features.UNITS_OF_LEARNING, $root.product.Levels.UNITS_OF_LEARNING_LEVEL_DEV)-->\n            <div class="control-group" style="margin-bottom:5px;">\n                <label><h2 style="color:#f1f1f1;">name</h2></label>\n                <input style="width:100%;height:25px;box-sizing:border-box" type="text" data-bind="value: name"/>\n            </div>\n            <!-- /ko -->\n            <label><h2 style="color:#f1f1f1;">\n                subject areas</h2></label>\n            <!-- ko if: domains().length > 0 -->\n            <div class="control-group">\n                <ul class="nav nav-pills nav-vert pull-left" style="margin-bottom:5px;width:100%" data-bind="foreach: domains()">\n                    <li data-bind="css: { \'used\': $parent.domainUsed($data), \'active\' : $parent.domainSelected($data.id)  }">\n                        <a href="#" class="dash " data-bind="css: { \'nav-yellow\': $data.st !== \'d\', \'medium-dark-blue\': $data.st === \'d\', \'medium-dark\': $data.st !== \'d\' }, click: $parent.selectDomain">\n                            <h4 style="line-height:1" data-bind="text:$data.name"></h4>\n                        </a>\n                    </li>\n                </ul>\n                <div class="clearfix"></div>\n            </div>\n            <!-- /ko -->\n        </div>\n    </div>\n    <div class="pull-left" style="padding:15px;height:485px;width:237px;background-color:#f2f2f2;overflow:hidden" data-bind="visible: isLesson(), style: {backgroundColor: color()}">\n        <div style="width:237px;height:490px;overflow:auto;">\n            <div class="control-group" data-bind="visible: curriculumGoals().length > 0 && curriculum()">\n                <label><h2 style="color:#444;">\n                    developmental goals</h2></label>\n                <ul class="nav nav-vert nav-pills pull-left" style="margin-bottom:5px;width:100%"\n                    data-bind="foreach: curriculumGoals()">\n                    <li data-bind="css: { \'active\' : $parent.goalSelected($data.id) }">\n                        <a href="#" class="dash white nav-labels" data-bind="click: $parent.selectGoal">\n                            <h4 style="line-height:1;"><span data-bind="text:$data.name + ($data.externalId ? \' \' + $data.externalId :\'\')"></span></h4>\n                        </a>\n                    </li>\n                </ul>\n                <div class="clearfix"></div>\n            </div>\n            <label data-bind="visible:isLesson()"><h2 style="color:#444;">curricular notes</h2></label>\n            <textarea style="width:100%;height:80px;box-sizing:border-box" type="text" data-bind="value: goals, valueUpdate: \'afterkeydown\',style:{ height: isLesson() ? \'80px\' : \'120px\'}"></textarea>\n        </div>\n    </div>\n    <div class="pull-left" style="padding:15px;height:485px;width:376px;background-color:#FFF;overflow:hidden">\n        <!-- ko template: \'view/modals/daily_report/activityOptions\' --><!-- /ko -->\n    </div>\n    <div class="clearfix"></div>\n</div>\n\n'}),tadpoles.define("text!view/modals/daily_report/activityOptions.html",[],function(){return'<div style="width:392px;height:490px;overflow:auto;">\n    <!-- ko if: canTagChildren() -->\n    <div class="control-group" style="margin-bottom:40px;">\n        <label style="margin-left:2px"><h2 style="color:gray;">children</h2></label>\n        <div class="clearfix"></div>\n            <ul style="width:373px;" data-bind="delegatedHandler: \'click\', tiles: {bricks: taggedChildren, template: \'view/tiles/eventStudentTagTile\', numCols: 3, tileSize: 70, groutWidth: 4, textSizingRef:100}"></ul>\n        <div style="margin-top:1px;">\n            <div class="input-append pull-left" style="margin-left:2px;margin-bottom:0px;margin-top:0px;width:373px;">\n                <input style="margin-bottom:0px;width:calc(373px - 38px);" id="inputTag" type="text" placeholder="select a child (leave blank to apply to all children)" data-bind="value: tagSearchText(), typeahead: tagtypeahead()"/>\n                <span class="add-on" style="margin-left:-5px;"><i class="fa fa-search"></i></span>\n            </div>\n        </div>\n    </div>\n    <!-- /ko -->\n    <div class="control-group" style="margin-bottom:5px;">\n        <label data-bind="visible:isLesson()"><h2 style="color:gray;">description</h2>\n            <span style="font-size:12px;color:#49AFCD"><i class="fa fa-exclamation-circle"></i>&nbsp;automatically copied to daily report</span></label>\n        <label data-bind="visible:!isLesson()"><h2 style="color:gray;">description</h2>\n            <span style="font-size:12px;color:#49AFCD"><i class="fa fa-exclamation-circle"></i>&nbsp;describe the activity in past tense</span></label>\n        <textarea style="width:373px;height:80px;box-sizing:border-box" type="text" data-bind="value: description, valueUpdate: \'afterkeydown\',style:{ height: isLesson() ? \'80px\' : \'120px\'}"></textarea>\n    </div>\n    <!-- ko if: (mode() === MODES.Curriculum  && $root.product.hasFeatureLevel($root.product.Features.UNITS_OF_LEARNING, $root.product.Levels.UNITS_OF_LEARNING_LEVEL_BETA)) ||\n                $root.product.hasFeatureLevel($root.product.Features.UNITS_OF_LEARNING, $root.product.Levels.UNITS_OF_LEARNING_LEVEL_DEV)-->\n    <div class="control-group" data-bind="visible:isLesson()">\n        <label><h2 style="color:gray;">instructions</h2></label>\n        <textarea style="width:373px;height:80px;box-sizing:border-box" type="text" data-bind="value: instructions, valueUpdate: \'afterkeydown\'"></textarea>\n    </div>\n    <!-- /ko -->\n    <div class="control-group" data-bind="visible:isLesson()">\n        <label><h2 style="color:gray;">materials</h2></label>\n        <textarea style="width:373px;height:80px;box-sizing:border-box" type="text" data-bind="value: materials, valueUpdate: \'afterkeydown\'"></textarea>\n    </div>\n\n    <div class="control-group" data-bind="visible: options().length > 0 && isLesson()">\n        <label><h2 style="color:gray;">options</h2></label>\n        <ul class="nav nav-pills pull-left" style="margin-bottom:5px;" data-bind="foreach: options()">\n            <li data-bind="css: { \'active\' : $parent.optionSelected($data) }">\n                <a href="#" class="dash light" data-bind="click: $parent.selectOption">\n                    <h4 style="line-height:1" data-bind="text:$data"></h4>\n                </a>\n            </li>\n        </ul>\n        <div class="clearfix"></div>\n    </div>\n</div>'}),tadpoles.define("text!view/modals/daily_report/entryEditModal.html",[],function(){return'<div>\n    <div class="modal-header" style="background-color:#f2f2f2; border-bottom:1px solid #999">\n        <i class="pull-right modal-close-button fa fa-times" data-bind="disable: processing(), click: saveAndClose"></i>\n\n        <div class="pull-right input-append" style="margin-right:283px;margin-top:3px;" data-bind="visible: isNew() && hasTypeahead()">\n            <input style="width:250px;margin-bottom:0px" type="text" placeholder="search..." data-bind="value: search, typeahead: typeahead()"/>\n            <span class="add-on" style="margin-left:-5px;"><i class="fa fa-search"></i></span>\n        </div>\n        <h1 data-bind="text: (isNew() ? \'add \' : \'edit \') + typeName()"></h1>\n    </div>\n    <div class="modal-body">\n        <div class="alert alert-block alert-danger" style="padding:5px 10px 5px 15px;max-width:500px;width:100%;box-sizing:border-box"\n          data-bind="visible: alert() && typeName() !== \'activity\'">\n         <i class="pull-left fa fa-3x fa-exclamation-circle"></i>\n         <p data-bind="text:alert()">\n         </p>\n        </div>\n        <div data-bind="visible: !processing() && !hasErrors()">\n            <div data-bind="template: { name: entryTemplate() }"></div>\n        </div>\n        <div class="alert alert-block alert-error" style="padding-right:14px" data-bind="visible: hasErrors()">\n            <h3 class="alert-heading">Oops!</h3>\n            <div data-bind="foreach: results.errors()">\n                <span data-bind="text: $data"></span>\n                <br/>\n            </div>\n        </div>\n        <div style="height:100px;width:100%" data-bind="visible: processing()">\n            <h1 class="alert-heading">Saving...&nbsp;<i class="fa fa-spinner fa-spin"></i></h1>\n        </div>\n    </div>\n    <div class="modal-footer" style="background-color:#f2f2f2; border-top:1px solid #999">\n        <form data-bind="fileUpload: files">\n            <button class="btn btn-danger pull-left btn-large" data-bind="disable: processing(), click: remove, visible:!isNew() && !hasErrors()">\n                Delete\n            </button>\n\n            <span class="btn btn-warning pull-left btn-large fileinput-button" data-bind="disable: processing(), visible: typeName() === \'activity\', tooltip: fileName()">\n                <i class="fa fa-plus fa-white"></i>\n                <span data-bind="text: fileName() ? \'Edit PDF\' : \'Add PDF\'"  ></span>\n                <input type="file" name="attachment" accept="application/pdf"/>\n            </span>\n            <button class="btn btn-danger btn-large pull-right" data-bind="click: results.clear, visible: hasErrors()">\n                try again\n            </button>\n            <button class="btn btn-primary pull-right btn-large" style="margin-left:10px;" data-bind="disable: processing(), click: saveAndClose, visible: !hasErrors()">\n                Save and Close\n            </button>\n            <!-- ko if: canSaveAndAddNew() && $root.config.isProviderApp -->\n            <button class="btn btn-success pull-right btn-large" style="margin-left:10px;" data-bind="disable: processing(), click: saveAndContinue, visible: !hasErrors()">\n                Save and Add New\n            </button>\n            <!-- /ko -->\n            <button class="btn pull-right btn-large" data-bind="disable: processing(), click: confirmAndClose">\n                Cancel\n            </button>\n            <div class="alert alert-block alert-danger" style="padding:5px 10px 5px 15px;margin:0 auto;width:400px;text-align:left" data-bind="visible: alert() && typeName() === \'activity\'">\n             <i class="pull-left fa fa-3x fa-exclamation-circle"></i>\n             <p data-bind="text:alert()">Lesson plan meal entries for the whole location will NOT be added to infant reports and "any age" classrooms.</p>\n            </div>\n        </form>\n    </div>\n</div>'}),tadpoles.define("text!view/modals/daily_report/mealEdit.html",[],function(){return'<div class="control-group" data-bind="visible:isInfant() && mealType() != \'fooddrop\'">\n    <label><h3 style="color:gray;">meal type</h3></label>\n    <ul class="nav nav-pills pull-left" style="margin-bottom:5px;" data-bind="foreach: $root._.values(MealTypes)">\n        <li data-bind="css: { \'active\' : $parent.mealType() === $data }" >\n            <a href="#" class="dash emphasized" data-bind="click: $parent.mealType"><h4 style="line-height:1" data-bind="text:$data"></h4></a>\n        </li>\n    </ul>\n    <div class="clearfix"></div>\n</div>\n<div class="control-group" data-bind="visible:isInfant() && mealType() != \'fooddrop\'">\n    <label><h3 style="color:gray;">time</h3></label>\n    <input type="text" class="time ui-timepicker-input" style="width:53px;" autocomplete="off" data-bind="timePicker: {observable: mealTime, step:5, scrollDefaultNow: true, disableTextInput: true}">\n    <i style="margin-left:5px;margin-right:5px;vertical-align:4px;" class="fa fa-arrow-left fa-lg fa-muted"></i>\n    <button class="btn" style="vertical-align:top" data-bind="click: setNow">\n        now\n    </button>\n</div>\n<div class="control-group" data-bind="visible:mealType() === MealTypes.BOTTLE">\n    <label><h3 style="color:gray;">ounces offered</h3></label>\n    <ul class="nav nav-pills pull-left" style="margin-bottom:5px;width:470px;" data-bind="foreach: BottleAmounts">\n        <li data-bind="css: { \'active\' : $parent.bottleAmountOffered() == $data.value }" >\n            <a href="#" class="dash emphasized" data-bind="click: $parent.bottleAmountOffered.bind($data, $data.value)"><h4 style="line-height:1" data-bind="text:$data.name"></h4></a>\n        </li>\n    </ul>\n    <div class="clearfix"></div>\n</div>\n<div class="control-group" data-bind="visible:mealType() === MealTypes.BOTTLE">\n    <label><h3 style="color:gray;">ounces taken</h3></label>\n    <ul class="nav nav-pills pull-left" style="margin-bottom:5px;width:470px;" data-bind="foreach: BottleAmounts">\n        <li data-bind="css: { \'active\' : $parent.bottleAmount() == $data.value }" >\n            <a href="#" class="dash emphasized" data-bind="visible:$parent.bottleAmountOffered() == null || $data.value <= $parent.bottleAmountOffered(), click: $parent.bottleAmount.bind($data, $data.value)"><h4 style="line-height:1" data-bind="text:$data.name"></h4></a>\n        </li>\n    </ul>\n    <div class="clearfix"></div>\n</div>\n<div class="control-group" data-bind="visible:mealType() === MealTypes.BOTTLE">\n    <label><h3 style="color:gray;">contents</h3></label>\n    <ul class="nav nav-pills pull-left" style="margin-bottom:5px" data-bind="foreach: BottleContents">\n        <li data-bind="css: { \'active\' : $parent.bottleContents() == $data }" >\n            <a href="#" class="dash emphasized" data-bind="click: $parent.bottleContents"><h4 style="line-height:1" data-bind="text:$data"></h4></a>\n        </li>\n    </ul>\n    <div class="clearfix"></div>\n</div>\n<div class="control-group" data-bind="visible:mealType() === MealTypes.FOOD && !isInfant()">\n    <label><h3 style="color:gray;">meal</h3></label>\n    <ul class="nav nav-pills pull-left" style="margin-bottom:5px;" data-bind="foreach: MealNames">\n        <li data-bind="css: { \'active\' : $parent.mealName() === $data }" >\n            <a href="#" class="dash emphasized" data-bind="click: $parent.mealName"><h4 style="line-height:1" data-bind="text:$data"></h4></a>\n        </li>\n    </ul>\n    <div class="clearfix"></div>\n</div>\n<div class="control-group" data-bind="visible:mealType() === MealTypes.FOOD">\n    <label><h3 style="color:gray;">food</h3></label>\n    <!-- ko foreach: foods -->\n    <div class="food-row">\n        <input class="span3" style="height:20px;margin-top:2px;" type="text" data-bind="value: food">\n        <i style="margin-left:8px;margin-right:8px;vertical-align:4px;" class="fa fa-arrow-right fa-lg fa-muted"></i>\n        <ul class="nav nav-pills" style="margin-bottom:5px;vertical-align:top;display:inline-block;" data-bind="foreach: $parent.MealAmounts">\n            <li data-bind="css: { \'active\' : $parent.amount() === $data }">\n                <a href="#" class="dash emphasized" data-bind="click: $parent.amount"><h4 style="line-height:1" data-bind="text:$data"></h4></a>\n            </li>\n        </ul>\n        <i style="margin-left:8px;" class="fa fa-times fa-muted fa-border delete-button" data-bind="click: $parent.deleteFoodRow"></i>\n        <div class="clearfix"></div>\n    </div>\n    <!-- /ko -->\n    <!-- ko if: $parent.foods().length < 7 -->\n    <a class="add-food-button" href="#" style="display:block;color:#ddd" data-bind="click: addFoodRow"> <i style="margin-right:5px;vertical-align:2px;" class="fa fa-plus fa-lg"></i> <h3 style="display:inline-block">add food</h3> </a>\n    <!-- /ko -->\n\n</div>\n<div class="control-group" data-bind="visible:mealType() === \'fooddrop\'">\n    <label><h3 style="color:gray;">food</h3></label>\n    <!-- ko foreach: foods -->\n    <div class="food-row">\n        <input class="span3" style="height:20px;margin-top:2px;" type="text" data-bind="value: food">\n        <i style="margin-left:8px;" class="fa fa-times fa-muted fa-border delete-button" data-bind="click: $parent.deleteFoodRow"></i>\n        <div class="clearfix"></div>\n    </div>\n    <!-- /ko -->\n    <!-- ko if: $parent.foods().length < 7 -->\n    <a class="add-food-button" href="#" style="display:block;color:#ddd" data-bind="click: addFoodRow"> <i style="margin-right:5px;vertical-align:2px;" class="fa fa-plus fa-lg"></i> <h3 style="display:inline-block">add food</h3> </a>\n    <!-- /ko -->\n\n</div>\n<div class="control-group">\n    <label><h3 style="color:gray;">notes</h3></label>\n    <textarea style="width:520px;height:50px;" type="text" data-bind="value: note, valueUpdate: \'afterkeydown\'"></textarea>\n</div>'}),tadpoles.define("text!view/modals/daily_report/napEdit.html",[],function(){return'<div class="control-group">\n\n    <div class="control-group" data-bind="visible: $root.config.isParentApp">\n        <ul class="nav nav-pills pull-left" style="margin-bottom:5px;">\n            <li data-bind="css: { \'active\' : $parent.sleep_type() === \'overnight\' }" >\n                <a href="#" class="dash emphasized" data-bind="click: $parent.setSleepType.bind($parent, \'overnight\')"><h4 style="line-height:1">overnight</h4></a>\n            </li>\n            <li data-bind="css: { \'active\' : $parent.sleep_type() === \'nap\' }" >\n                <a href="#" class="dash emphasized" data-bind="click: $parent.setSleepType.bind($parent, \'nap\')"><h4 style="line-height:1">nap</h4></a>\n            </li>\n        </ul>\n        <div class="clearfix"></div>\n    </div>\n\n    <!-- ko if: sleep_type() === \'nap\' -->\n    <label><h3 style="color:gray;">start time</h3></label>\n    <div class="control-group">\n        <input type="text" class="time ui-timepicker-input" style="width:53px;" autocomplete="off" data-bind="timePicker: {observable: startTime, step:5, scrollDefaultNow: true, disableTextInput: true}">\n        <i style="margin-left:5px;margin-right:5px;vertical-align:4px;" class="fa fa-arrow-left fa-lg fa-muted"></i>\n        <button class="btn" style="vertical-align:top" data-bind="click: setStartToNow">\n            now\n        </button>\n    </div>\n    <!-- /ko -->\n\n    <!-- ko if: sleep_type() === \'nap\' -->\n        <label><h3 style="color:gray;">end time</h3></label>\n    <!-- /ko -->\n    <!-- ko if: sleep_type() === \'overnight\' -->\n        <label><h3 style="color:gray;">wake time</h3></label>\n    <!-- /ko -->\n    <div class="control-group">\n        <input type="text" class="time ui-timepicker-input" style="width:53px;" autocomplete="off" data-bind="timePicker: {observable: endTime, step:5, scrollDefaultNow: true, disableTextInput: true}">\n        <i style="margin-left:5px;margin-right:5px;vertical-align:4px;" class="fa fa-arrow-left fa-lg fa-muted"></i>\n        <button class="btn" style="vertical-align:top" data-bind="click: setEndToNow">\n            now\n        </button>\n    </div>\n\n\n    <label><h3 style="color:gray;">notes</h3></label>\n    <textarea style="width:520px;height:50px;" type="text" data-bind="value: note, valueUpdate: \'afterkeydown\'"></textarea>\n\n</div>'}),tadpoles.define("text!view/modals/daily_report/noteEdit.html",[],function(){return'<div class="control-group">\n    <!-- ko if:$root.config.isParentApp -->\n    <label><h3 style="color:gray;" data-bind="text:\'today\\\'s contact \' + todaysContact()">today\'s contact</h3></label>\n    <ul style="width:500px;" data-bind="tiles: { bricks: child.guardians, template:\'view/tiles/guardianTile\', numCols: 5, tileSize: 90, groutWidth: 5, textSizingRef:100 }"></ul>\n\n    <label><h3 style="color:gray;">today\'s pickup time</h3></label>\n\n    <div class="control-group">\n        <input type="text" class="time ui-timepicker-input" style="width:53px;" autocomplete="off" data-bind="timePicker: {observable: pickupTime, step:5, scrollDefaultNow: true, disableTextInput: true}">\n        <i style="margin-left:5px;margin-right:5px;vertical-align:4px;" class="fa fa-arrow-left fa-lg fa-muted"></i>\n        <button class="btn" style="vertical-align:top" data-bind="click: setNow">\n            now\n        </button>\n    </div>\n\n    <div class="control-group">\n        <label><h3 style="color:gray;">was your child given medication?</h3></label>\n        <ul class="nav nav-pills pull-left" style="margin-bottom:5px;width:470px;" data-bind="foreach: YesNo">\n            <li data-bind="css: { \'active\' : $parent.wasMedicated() == $data.value }" >\n                <a href="#" class="dash emphasized" data-bind="click: $parent.wasMedicated.bind($data, $data.value)"><h4 style="line-height:1" data-bind="text:$data.name"></h4></a>\n            </li>\n        </ul>\n        <div class="clearfix"></div>\n    </div>\n\n    <div class="control-group">\n        <label><h3 style="color:gray;">will they be receiving medication?</h3></label>\n        <ul class="nav nav-pills pull-left" style="margin-bottom:5px;width:470px;" data-bind="foreach: YesNo">\n            <li data-bind="css: { \'active\' : $parent.needsMedication() == $data.value }" >\n                <a href="#" class="dash emphasized" data-bind="click: $parent.needsMedication.bind($data, $data.value)"><h4 style="line-height:1" data-bind="text:$data.name"></h4></a>\n            </li>\n        </ul>\n        <div class="clearfix"></div>\n    </div>\n\n    <label><h3 style="color:gray;">medication note</h3></label>\n    <textarea style="min-width:500px;width:100%;height:120px;box-sizing:border-box" type="text" data-bind="value: meds_note, valueUpdate: \'afterkeydown\'"></textarea>\n    <!-- /ko -->\n    <label><h3 style="color:gray;">note</h3></label>\n    <textarea style="min-width:500px;width:100%;height:120px;box-sizing:border-box" type="text" data-bind="value: note, valueUpdate: \'afterkeydown\'"></textarea>\n</div>\n'}),tadpoles.define("text!view/modals/daily_report/reportEditModal.html",[],function(){return'<div>\n    <div class="modal-header">\n        <i class="pull-right modal-close-button fa fa-times" data-bind="click: saveAndClose"></i>\n\n        <h1 data-bind="text: (isNew() ? \'add \' : \'edit \') + title()"></h1>\n    </div>\n    <div class="modal-body">\n        <div data-bind="visible: !processing() && !hasErrors()">\n            <div data-bind="template: { name: entryTemplate() }"></div>\n        </div>\n        <div class="alert alert-block alert-error" style="padding-right:14px" data-bind="visible: hasErrors()">\n            <h3 class="alert-heading">Oops!</h3>\n\n            <div data-bind="foreach: results.errors()">\n                <span data-bind="text: $data"></span>\n                <br/>\n            </div>\n        </div>\n        <div style="height:100px;width:100%" data-bind="visible: processing(), spin: { trigger: processing(), color: \'#000\'}"></div>\n    </div>\n    <div class="modal-footer">\n        <button class="btn btn-danger pull-left btn-large" data-bind="click: remove, visible:!isNew() && !hasErrors()">\n            Delete\n        </button>\n        <button class="btn btn-danger btn-large pull-right" data-bind="click: results.clear, visible: hasErrors()">\n            Try Again\n        </button>\n        <button class="btn btn-primary pull-right btn-large" style="margin-left:10px;" data-bind="click: saveAndClose, visible: !hasErrors()">\n            Save and Close\n        </button>\n        <button class="btn pull-right btn-large" data-bind="click: confirmAndClose">\n            Cancel\n        </button>\n    </div>\n</div>'}),tadpoles.define("text!view/modals/daily_report/themeEdit.html",[],function(){return'<div class="control-group">\n    <label><h3 style="color:gray;">name</h3></label>\n    <input style="width:100%;height:25px;box-sizing:border-box" type="text" data-bind="value: name, valueUpdate: \'afterkeydown\'"/>\n</div>'}),tadpoles.define("text!view/modals/daily_report/bathroomEdit.html",[],function(){return'<div class="control-group">\n    <label><h3 style="color:gray;">time</h3></label>\n    <div class="control-group">\n        <input type="text" class="time ui-timepicker-input" style="width:53px;" autocomplete="off" data-bind="timePicker: {observable: actionTime, step:5, scrollDefaultNow: true, disableTextInput: true}">\n        <i style="margin-left:5px;margin-right:5px;vertical-align:4px;" class="fa fa-arrow-left fa-lg fa-muted"></i>\n        <button class="btn" style="vertical-align:top" data-bind="click: setNow">\n            now\n        </button>\n    </div>\n\n    <div class="control-group" data-bind="visible: bathroom_type() === \'diaper\'">\n        <label><h3 style="color:gray;">details</h3></label>\n        <ul class="nav nav-pills pull-left" style="margin-bottom:5px;" data-bind="foreach: $parent.DiaperDetails">\n            <li data-bind="css: { \'active\' : $parent.detailSelected($data) }" >\n                <a href="#" class="dash emphasized" data-bind="click: $parent.toggleDetail.bind($parent, $data)"><h4 style="line-height:1" data-bind="text:$data"></h4></a>\n            </li>\n        </ul>\n        <div class="clearfix"></div>\n    </div>\n\n    <div class="control-group" data-bind="visible: bathroom_type() === \'potty\'">\n        <label><h3 style="color:gray;">details</h3></label>\n        <ul class="nav nav-pills pull-left" style="margin-bottom:5px;" data-bind="foreach: $parent.PottyDetails">\n            <li data-bind="css: { \'active\' : $parent.detailSelected($data) }" >\n                <a href="#" class="dash emphasized" data-bind="click: $parent.toggleDetail.bind($parent, $data)"><h4 style="line-height:1" data-bind="text:$data"></h4></a>\n            </li>\n        </ul>\n        <div class="clearfix"></div>\n    </div>\n\n    <label><h3 style="color:gray;">notes</h3></label>\n    <textarea style="width:520px;height:50px;" type="text" data-bind="value: note, valueUpdate: \'afterkeydown\'"></textarea>\n\n</div>'}),tadpoles.define("text!view/modals/assessment/editNoteModal.html",[],function(){return'<div>\n    <div class="modal-header">\n        <i class="pull-right modal-close-button fa fa-times" data-bind="click: saveAndClose"></i>\n\n        <h1 data-bind="text: \'edit note\'"></h1>\n    </div>\n    <div class="modal-body">\n        <div data-bind="visible: !processing() && !hasErrors()">\n            <form data-bind="submit: saveAndClose">\n            <div class="control-group">\n                <label><h3 style="color:gray;">note</h3></label>\n                <textarea style="min-width:500px;width:100%;height:120px;box-sizing:border-box" type="text" data-bind="hasfocus: focusTrigger, value: note, valueUpdate: \'afterkeydown\'"></textarea>\n            </div>\n            </form>\n        </div>\n        <div class="alert alert-block alert-error" style="padding-right:14px" data-bind="visible: hasErrors()">\n            <h3 class="alert-heading">Oops!</h3>\n            <div data-bind="foreach: results.errors()">\n                <span data-bind="text: $data"></span>\n                <br/>\n            </div>\n        </div>\n        <div style="height:100px;width:100%" data-bind="visible: processing(), spin: { trigger: processing(), color: \'#000\'}"></div>\n    </div>\n    <div class="modal-footer">\n        <button class="btn btn-danger pull-left btn-large" data-bind="click: remove, visible: !hasErrors() && (originalNote() && originalNote().date())">\n            Delete\n        </button>\n        <button class="btn btn-danger btn-large pull-right" data-bind="click: results.clear, visible: hasErrors()">\n            Try Again\n        </button>\n        <button class="btn btn-primary pull-right btn-large" style="margin-left:10px;" data-bind="click: saveAndClose, visible: !hasErrors()">\n            Save and Close\n        </button>\n        <button class="btn pull-right btn-large" data-bind="click: confirmAndClose">\n            Cancel\n        </button>\n    </div>\n</div>'}),tadpoles.define("text!view/modals/curriculum/activities.html",[],function(){return'<ul class="nav nav-vert nav-pills pull-left" style="margin-bottom:0;width:100%" data-bind="sortable: { isEnabled: !$parents[1].selectedCurriculum().external, data: activities() || [], beforeMove: onMove, options : { placeholder: \'tree-placeholder\', cursorAt : { top:0, left: 0 } } }">\n    <li style="position:relative" data-bind="click: !$parents[1].selectedCurriculum().external ? $root._.bind($parents[1].editActivity, $data, $data) : false">\n        <a href="#" class="dash white hidden">\n            <h4 style="line-height:1;" data-bind="text:$data.name"></h4>\n            <div style="margin-left:20px;margin-top:2px;">\n                <span style="font-size:10px;font-weight:bold;" data-bind="text: $root._.pluck(getDomains(), \'name\').join(\', \')"></span>\n                <span style="font-size:10px;" data-bind="text:description"></span>\n                <!-- ko if: goals && goals.length > 0 -->\n                <div>\n                    <span style="font-size:10px;font-weight:bold">goals</span> -\n                    <!-- ko foreach: getGoals() -->\n                    <span style="font-size:10px;" data-bind="text: $index() > 0 ? \', \' + displayText() : displayText(), tooltip: hierarchyText()"></span>\n                    <!-- /ko -->\n                </div>\n                <!-- /ko -->\n                <div data-bind="visible: (options && options.length > 0)">\n                    <span style="font-size:10px;font-weight:bold">options</span> -\n                    <span style="font-size:10px;" data-bind="text: options"></span>\n                </div>\n            </div>\n            <button class="btn btn-success btn-mini row-menu" style="position:absolute;top:5px;right:10px;" data-bind="click:$root._.bind($parents[1].editActivity, $data, $data), visible: !$parents[1].selectedCurriculum().external">\n                edit\n            </button>\n        </a>\n    </li>\n</ul>'}),tadpoles.define("text!view/modals/curriculum/applyCurriculum.html",[],function(){return'<div style="max-height:450px;overflow:hidden;">\n    <h3 style="color:gray;">choose classrooms</h3>\n    <div style="max-height:400px;margin-top:10px;overflow:auto;">\n        <ul style="width:493px;" data-bind="visible: classrooms().length > 0, tiles: { bricks: classrooms(), template:\'view/tiles/copyClassTile\', numCols: 6, groutWidth: 4, textSizingRef: 105 }"></ul>\n    </div>\n</div>\n'}),tadpoles.define("text!view/modals/curriculum/curriculaEdit.html",[],function(){return'<div>\n    <div class="modal-body" style="position:relative;padding:0">\n        <i class="modal-close-button fa fa-times" style="position:absolute;top:10px;right:15px" data-bind="click: close"></i>\n        <div class="pull-left" style="position:relative;background-color:#303030;color:#f1f1f1;padding:10px 15px 15px;margin:0; height:456px;width:196px;overflow:hidden">\n            <div style="height:456px;width:181px;padding-right:15px;" data-bind="fadeVisible: navOpen()">\n                <div style="padding-left:12px;width:184px;margin-bottom:15px;">\n                    <h2 class="pull-left" style="font-size:32px;line-height:1">\n                        <span>curricula</span>\n                    </h2>\n                    <button class="btn btn-info btn-mini row-menu pull-right" style="margin-top:10px;margin-right:10px" data-bind="click:$root._.bind(editCurriculum, null, null)">\n                       add\n                    </button>\n                    <div class="clearfix"></div>\n                </div>\n                <div class="scroll-dark" style="width:196px;height:402px;overflow:auto;">\n                    <div class="control-group">\n                        <ul class="nav nav-vert nav-pills pull-left" style="margin-bottom:0;width:100%">\n                            <!-- ko foreach: curricula() -->\n                            <li style="position:relative;margin-top:0;margin-bottom:0" data-bind="css: { \'active\' : $parent.selectedCurriculum() === $data }">\n                                <a href="#" class="dash dark nav-dark" data-bind="click: $parent.selectedCurriculum">\n                                    <h4 style="line-height:1;" data-bind="text:$data.name"></h4>\n                                    <button class="btn btn-success btn-mini row-menu" style="position:absolute;top:5px;right:10px;" data-bind="click:$root._.bind($parent.editCurriculum, null, $data), visible: !$data.external">\n                                        Edit\n                                    </button>\n                                </a>\n                            </li>\n                            <!-- /ko -->\n                        </ul>\n                    </div>\n                </div>\n                <div class="clearfix"></div>\n            </div>\n        </div>\n        <div class="pull-left" style="background-color:#fff;padding:0;margin:0;width:694px;">\n            <div style="padding:10px 15px 0 25px;background-color:#d8d8d9;border-bottom:1px solid #BBB;height:80px;">\n\n                <h2 class="ellipsis" style="max-width:600px;margin-bottom:8px;font-size:32px;" data-bind="style: { marginTop: $root.product.hasFeature($root.product.Features.UNITS_OF_LEARNING) ? \'0\' : \'15px\' }"><span data-bind="visible: selectedCurriculum(), text:selectedCurriculum() ? selectedCurriculum().name : \'\'"></span><span data-bind="visible: !selectedCurriculum()"><i class="fa fa-long-arrow-left"></i> choose a curriculum</span></h2>\n\n                <!-- ko if: $root.product.hasFeature($root.product.Features.UNITS_OF_LEARNING) -->\n                <ul class="nav nav-pills" style="width:100%;margin-bottom:0">\n                    <!-- ko foreach: panelList -->\n                    <li data-bind="css: { \'active\' : $parent.activePanel() === $data }">\n                        <a href="#" class="dash underline underline-green" style="margin-bottom:0" data-bind="click:$parent.activePanel.bind($data,$data)">\n                            <h4 style="line-height:1" data-bind="text:$data.name"></h4>\n                        </a>\n                    </li>\n                    <!-- /ko -->\n                </ul>\n                <!-- /ko -->\n            </div>\n            <div>\n                <!-- ko if: selectedCurriculum() -->\n                <!-- ko if: activePanel() === panels.SUBJECT_AND_GOALS -->\n                <div class="pull-left" style="padding:15px;height:360px;width:240px;background-color:#f2f2f2">\n                    <!-- ko if: selectedCurriculum() -->\n                    <div style="margin:0 0 5px 10px;">\n                        <h2 class="pull-left" style="color:#666;">\n                            <span>subjects</span>\n                        </h2>\n                        <button class="btn btn-info btn-mini row-menu pull-right" style="margin-top:10px;margin-right:10px;" data-bind="click:$root._.bind(editDomain, $data, null), visible: !selectedCurriculum().external">\n                           add subject\n                        </button>\n                        <div class="clearfix"></div>\n                    </div>\n                    <!-- /ko -->\n\n                    <div style="width:240px;height:320px;overflow:auto;">\n                        <div style="text-align: center;margin-top:20px;" data-bind="visible: !currentDomains() || currentDomains().length === 0">\n                            <h2 style="color:#CCC;cursor:pointer" data-bind="click:$root._.bind(editDomain, $data, null)">add a subject</h2>\n                        </div>\n                        <!-- ko if: currentDomains() -->\n                        <div class="control-group">\n                            <ul class="nav nav-pills nav-vert pull-left" style="margin-bottom:5px;width:100%">\n                                <!-- ko foreach: currentDomains() -->\n                                <li style="position:relative" data-bind="css: { \'active\' : $parent.selectedDomain() === $data }">\n                                    <a href="#" class="dash" data-bind="click: $parent.selectedDomain">\n                                        <h4 style="line-height:1" data-bind="text:$data.name"></h4>\n                                        <button class="btn btn-success btn-mini row-menu" style="position:absolute;top:5px;right:10px;" data-bind="click:$root._.bind($parent.editDomain, $parent, $data), visible: !$parent.selectedCurriculum().external && !ro">\n                                        edit\n                                        </button>\n                                    </a>\n                                </li>\n                                <!-- /ko -->\n                            </ul>\n                            <div class="clearfix"></div>\n                        </div>\n                        <!-- /ko -->\n                    </div>\n\n                </div>\n\n                <div class="pull-left" style="padding:15px;height:360px;width:394px;">\n                    <div style="margin:0 0 5px 10px;">\n                        <h2 class="pull-left" style="color:#666;">\n                            <span>goals</span>\n                        </h2>\n                        <!-- ko if: selectedDomain() -->\n                        <button class="btn btn-info btn-mini row-menu pull-right" style="margin-top:10px;margin-right:10px;" data-bind="click:$root._.bind(editOutcome, $data, null), visible: !selectedCurriculum().external && !selectedDomain().ro">\n                           add goal\n                        </button>\n                        <!-- /ko -->\n                        <div class="clearfix"></div>\n                    </div>\n                    <div class="" style="width:394px;height:320px;overflow:auto;background-color:#FFF">\n                        <!-- ko if: selectedDomain() -->\n                        <div style="text-align: center;margin-top:20px;" data-bind="visible: (!currentGoals() || currentGoals().length === 0) && selectedDomain() && !selectedDomain().ro">\n                            <h2 style="color:#CCC;cursor:pointer" data-bind="click:$root._.bind(editOutcome, $data, null)">add a goal</h2>\n                        </div>\n                        <div class="control-group">\n                            <ul class="nav nav-vert nav-pills pull-left" style="margin-bottom:5px;width:100%">\n                                <!-- ko foreach: currentGoals() -->\n                                <li style="position:relative">\n                                    <a href="#" class="dash white hidden" data-bind="click: (!$parent.selectedCurriculum().external && !ro )? $root._.bind($parent.editOutcome, $parent, $data): false ">\n                                        <h4 style="line-height:1;" data-bind="text:$data.name + ($data.externalId ? \' \' + $data.externalId :\'\')"></h4>\n                                        <button class="btn btn-success btn-mini row-menu" style="position:absolute;top:5px;right:10px;" data-bind="click:$root._.bind($parent.editOutcome, $parent, $data), visible: !$parent.selectedCurriculum().external && !ro">\n                                            edit\n                                        </button>\n                                    </a>\n                                </li>\n                                <!-- /ko -->\n                            </ul>\n                            <div class="clearfix"></div>\n                        </div>\n                        <!-- /ko -->\n                        <!-- ko if: !selectedDomain() -->\n                            <div style="text-align: center;margin-top:20px;">\n                                <h2 style="color:#CCC;">choose a subject</h2>\n                            </div>\n                        <!-- /ko -->\n                    </div>\n                </div>\n                <!-- /ko-->\n                <!-- ko if: activePanel() === panels.CURRICULUM -->\n                <div class="pull-left" style="padding:15px;height:360px;width:315px;background-color:#f2f2f2">\n                    <div style="margin:0 0 5px 10px;">\n                        <h2 class="pull-left" style="color:#666;">\n                            <span>units of learning</span>\n                        </h2>\n                        <!-- ko if: selectedCurriculum() -->\n                        <button class="btn btn-info btn-mini row-menu pull-right" style="margin-top:10px;margin-right:10px;" data-bind="click:$root._.bind(editUnit, $data, $data.unitTree.topUnit(), null), visible: selectedCurriculum() ? !selectedCurriculum().external : false">\n                           add unit\n                        </button>\n                        <!-- /ko -->\n                        <div class="clearfix"></div>\n                    </div>\n                    <div class="" style="width:315px;height:320px;overflow:auto">\n                    <!-- ko if: selectedCurriculum() -->\n                        <div class="alert alert-info" data-bind="fadeVisible: selectedCurriculum().loadingUnits()">\n                            <h3 class="alert-heading">Loading...&nbsp;<i class="fa fa-spinner fa-spin fa-lg"></i></h3>\n                        </div>\n                        <div style="text-align: center;margin-top:20px;" data-bind="visible: !selectedCurriculum().loadingUnits() && selectedCurriculum().units().length === 0">\n                            <h2 style="color:#CCC;cursor:pointer" data-bind="click:$root._.bind(editUnit, $data, $data.unitTree.topUnit(), null)">add a unit</h2>\n                        </div>\n                        <!-- Here we hack in a foreach to make use of the \'as\' so that the template can easily reference this object -->\n                        <!-- ko foreach: { data: [$data], as: \'curriculaEdit\' } -->\n                            <!-- ko template: { name: \'view/modals/curriculum/unitTree\', data: curriculaEdit.unitTree } --><!--/ko -->\n                        <!-- /ko -->\n                    <!-- /ko -->\n                    </div>\n\n                </div>\n\n                <div class="pull-left" style="padding:15px;height:360px;width:319px;">\n\n                    <div style="margin:0 0 5px 10px;">\n                        <h2 class="pull-left" style="color:#666;">\n                            <span>activities</span>\n                        </h2>\n                        <!-- ko if: selectedUnit() -->\n                        <button class="btn btn-info btn-mini row-menu pull-right" style="margin-top:10px;margin-right:10px;" data-bind="click:$root._.bind(editActivity, $data, null, null), visible: !selectedCurriculum().external">\n                           add activity\n                        </button>\n                        <!-- /ko -->\n                        <div class="clearfix"></div>\n                    </div>\n                    <div style="width:319px;height:320px;overflow:auto">\n                        <!-- ko if: selectedUnit() -->\n                            <div class="alert alert-info" data-bind="fadeVisible: selectedUnit().loadingActivities()">\n                                <h3 class="alert-heading">Loading...&nbsp;<i class="fa fa-spinner fa-spin fa-lg"></i></h3>\n                            </div>\n                            <div style="text-align: center;margin-top:20px;" data-bind="visible: !selectedUnit().loadingActivities() && selectedUnit().activities().length === 0">\n                                <h2 style="color:#CCC;cursor:pointer" data-bind="click:$root._.bind(editActivity, $data, null, null), visible: !$parent.selectedCurriculum().external">add an activity</h2>\n                            </div>\n                            <!-- ko template: { name: \'view/modals/curriculum/activities\', data: selectedUnit() } --><!--/ko -->\n                        <!-- /ko -->\n                        <!-- ko if: !selectedUnit() -->\n                            <div style="text-align: center;margin-top:20px;">\n                                <h2 style="color:#CCC">choose a unit</h2>\n                            </div>\n                        <!-- /ko -->\n                    </div>\n                </div>\n                <div class="clearfix"></div>\n                <!-- /ko -->\n                <!-- /ko -->\n            </div>\n        </div>\n         <div class="clearfix"></div>\n    </div>\n<div class="modal-footer">\n    <!-- ko if: selectedCurriculum() -->\n    <div class="pull-left" style="max-height:150px;overflow:auto;">\n        <div>\n            <h4 class="pull-left" style="margin-right:10px;" data-bind="visible: appliedClassrooms().length > 0">classrooms using\n                <span data-bind="text: selectedCurriculum().name"></span> curriculum</h4>\n            <button class="btn btn-success pull-left" data-bind="css: { \'btn-mini\' : appliedClassrooms().length > 0, \'btn-large\' : appliedClassrooms().length === 0 },click: applyToClass,text: appliedClassrooms().length > 0 ? \'Change\' : \'Apply to Classrooms\'">\n                None\n            </button>\n            <div class="clearfix"></div>\n\n        </div>\n        <ul class="nav nav-pills pull-left" style="margin-bottom:5px;width:100%">\n            <!-- ko foreach: appliedClassrooms() -->\n            <li class="active">\n                <a href="#" class="dash nav-gray" style="cursor:default">\n                    <h4 style="line-height:1" data-bind="text:$data.name"></h4>\n                </a>\n            </li>\n            <!-- /ko -->\n        </ul>\n        <div>\n            <h4 class="pull-left" style="margin-right:10px;" data-bind="visible: appliedStudents().length > 0">students using\n                <span data-bind="text: selectedCurriculum().name"></span> curriculum</h4>\n            <div class="clearfix"></div>\n        </div>\n        <ul class="nav nav-pills pull-left" style="margin-bottom:5px;width:100%">\n            <!-- ko foreach: appliedStudents() -->\n            <li class="active">\n                <a href="#" class="dash nav-gray" style="cursor:default">\n                    <h4 style="line-height:1" data-bind="text:$data.fullName"></h4>\n                </a>\n            </li>\n            <!-- /ko -->\n        </ul>\n    </div>\n    <!-- /ko -->\n</div>\n</div>\n'}),tadpoles.define("text!view/modals/curriculum/curriculumEdit.html",[],function(){return'<form data-bind="submit: saveAndClose">\n<div class="control-group">\n    <label><h3 style="color:gray;">name</h3></label>\n    <input style="width:250px;" type="text" data-bind="hasfocus: focusTrigger, value: curriculumName, valueUpdate: \'afterkeydown\'"/>\n</div>\n</form>\n'}),tadpoles.define("text!view/modals/curriculum/curriculumEditModal.html",[],function(){return'<div>\n    <div class="modal-header">\n        <i class="pull-right modal-close-button fa fa-times" data-bind="click: saveAndClose"></i>\n\n        <h1 data-bind="text: (isNew() ? \'add \' : \'edit \') + title()"></h1>\n    </div>\n    <div class="modal-body">\n        <div data-bind="visible: !processing() && !hasErrors()">\n            <div data-bind="template: { name: entryTemplate() }"></div>\n        </div>\n        <div class="alert alert-block alert-error" style="padding-right:14px" data-bind="visible: hasErrors()">\n            <h3 class="alert-heading">Oops!</h3>\n\n            <div data-bind="foreach: results.errors()">\n                <span data-bind="text: $data"></span>\n                <br/>\n            </div>\n        </div>\n        <div style="height:100px;width:100%" data-bind="visible: processing(), spin: { trigger: processing(), color: \'#000\'}"></div>\n    </div>\n    <div class="modal-footer">\n        <!-- ko if: typeName() !== \'curriculum\' || $root.currentUser.isAdmin() -->\n        <button class="btn btn-danger pull-left btn-large" data-bind="click: remove, visible:!isNew() && !hasErrors()">\n            Delete\n        </button>\n        <!-- /ko -->\n        <button class="btn btn-danger btn-large pull-right" data-bind="click: results.clear, visible: hasErrors()">\n            Try Again\n        </button>\n        <button class="btn btn-primary pull-right btn-large" style="margin-left:10px;" data-bind="click: saveAndClose, visible: !hasErrors()">\n            Save and Close\n        </button>\n        <!-- ko if: typeName() !== \'curriculum\' && typeName() !== \'unit\' && typeName() !== \'event\' -->\n        <button class="btn btn-success pull-right btn-large" style="margin-left:10px;" data-bind="click: saveAndContinue, visible: !hasErrors()">\n            Save and Add New\n        </button>\n        <!-- /ko -->\n        <button class="btn pull-right btn-large" data-bind="click: confirmAndClose">\n            Cancel\n        </button>\n    </div>\n</div>'}),tadpoles.define("text!view/modals/curriculum/domainEdit.html",[],function(){return'<form data-bind="submit: saveAndContinue">\n<div class="control-group">\n    <label><h3 style="color:gray;">name</h3></label>\n    <input style="width:250px;" type="text" data-bind="hasfocus: focusTrigger, value: name, valueUpdate: \'afterkeydown\'"/>\n</div>\n<div class="control-group">\n    <label><h3 style="color:gray;">sort</h3></label>\n    <input style="width:250px;" type="text" placeholder="order value 1-100" data-bind="value: sort, valueUpdate: \'afterkeydown\'"/>\n</div>\n</form>\n'}),tadpoles.define("text!view/modals/curriculum/outcomeEdit.html",[],function(){return'<form data-bind="submit: saveAndContinue">\n    <div class="control-group">\n        <label><h3 style="color:gray;">name</h3></label>\n        <textarea style="min-width:250px;width:100%;height:60px;box-sizing:border-box" type="text" data-bind="hasfocus: focusTrigger, value: name, valueUpdate: \'afterkeydown\'"></textarea>\n    </div>\n    <div class="control-group">\n        <label><h3 style="color:gray;">learning standard identifier</h3><span style="font-size:12px;color:#49AFCD">e.g. PDM1.1</span></label>\n        <input style="width:250px;" type="text" data-bind="value: externalId, valueUpdate: \'afterkeydown\'"/>\n    </div>\n    <div class="control-group">\n        <label><h3 style="color:gray;">learning standard hierarchy</h3><span style="font-size:12px;color:#49AFCD">e.g. Approaches Toward Learning, Creativity, Innovation and Invention</span></label>\n        <input style="width:250px;" type="text" data-bind="value: hierarchyOne, valueUpdate: \'afterkeydown\'"/><br/>\n        <i style="margin-left:5px;margin-right:5px;vertical-align:4px; color: #888" class="fa fa-lg" >&#x21B3;</i><input style="width:250px;" type="text" data-bind="value: hierarchyTwo, valueUpdate: \'afterkeydown\'"/><br/>\n        <i style="margin-left:30px;margin-right:5px;vertical-align:4px;color:#888" class="fa fa-lg">&#x21B3;</i><input style="width:250px;" type="text" data-bind="value: hierarchyThree, valueUpdate: \'afterkeydown\'"/>\n    </div>\n</form>\n'}),tadpoles.define("text!view/modals/curriculum/unitEdit.html",[],function(){return'<form data-bind="submit: saveAndClose">\n<div class="control-group">\n    <label><h3 style="color:gray;">name</h3></label>\n    <input style="width:250px;" type="text" data-bind="hasfocus: focusTrigger, value: name, valueUpdate: \'afterkeydown\'"/>\n</div>\n</form>'}),tadpoles.define("text!view/modals/curriculum/unitTree.html",[],function(){return'<ul class="nav nav-vert nav-pills sortable" style="width:100%;margin-bottom:0" data-bind=" sortable: { isEnabled: curriculaEdit.selectedCurriculum() ? !curriculaEdit.selectedCurriculum().external : false, data: units() || [], beforeMove: onMove, options : { placeholder: \'tree-placeholder\', start: onStart, sort: onSort, stop: onStop, cursorAt : { top:0, left: 0 } } }">\n    <li style="position:relative;" data-bind="visible: visible(), css: { \'active\' : curriculaEdit.selectedUnit() === $data }">\n        <a href="#" class="dash" style="padding:0 12px 0 0" data-bind="click: curriculaEdit.selectedUnit">\n            <button class="btn btn-info btn-mini row-menu" style="position:absolute;top:5px;right:10px;" data-bind="click:$root._.bind(curriculaEdit.editUnit, $data, $data, null), visible: !curriculaEdit.selectedCurriculum().external">\n                add sub-unit\n            </button>\n            <button class="btn btn-success btn-mini row-menu" style="position:absolute;top:5px;right:90px;" data-bind="click:$root._.bind(curriculaEdit.editUnit, $data, $data.parent(), $data), visible: !curriculaEdit.selectedCurriculum().external">\n                edit\n            </button>\n            <table cellspacing="0" cellpadding="0">\n                <tr>\n                    <td>\n                        <div style="width:20px;padding-top:8px;padding-bottom:8px" data-bind="style: { paddingLeft : (12 + getIndent(20)) + \'px\'}, click: function() {toggle();if(!expanded()) { curriculaEdit.selectedUnit(null); }}, clickBubble: false ">\n                            <i class="fa fa-lg" data-bind="visible: hasChildren(), css: { \'fa-caret-right\' : !expanded(), \'fa-caret-down\' : expanded()}"></i>\n                        </div>\n                    </td>\n                    <td>\n                        <h4 style="line-height:1;padding:8px 0" data-bind="text: name"></h4>\n                    </td>\n                </tr>\n            </table>\n        </a>\n    </li>\n</ul>'}),tadpoles.define("text!view/popovers/photoPopover.html",[],function(){return'<div style="text-align:left">\n    <div>\n        <h3 style="color:#ff9312;" data-bind="text:hasMedia() ? \'pictured\' : \'about\'"></h3>\n    </div>\n    <div data-bind="visible: memberNames().length === 0"><span data-bind="text:title()"></span>&nbsp;</div>\n    <div data-bind="visible: memberNames().length > 0, foreach: memberNames"><span data-bind="text:($index() > 0 ? \', \' : \'\') + $data"></span></div>\n    <div data-bind="visible: getDestinationType()">\n        <h3 style="color:#da4f49;">destination</h3>\n        <span style="white-space:pre-wrap" data-bind="text:getDestinationType().name"></span>\n    </div>\n    <div data-bind="visible: comment()">\n        <h3 style="color:#00C322;">note</h3>\n        <span style="white-space:pre-wrap" data-bind="text:comment()"></span>\n    </div>\n    <!-- ko if: goalLabels.length > 0 -->\n    <div>\n        <h3 style="color:#0772A1;">goals</h3>\n    </div>\n    <ul data-bind="foreach: goalLabels"><li data-bind="text:$data"></li></ul>\n    <!-- /ko -->\n    <!-- ko if: $root.currentUser.isCsr() -->\n    <br/>\n    <div style="word-wrap: break-word;">\n        <h3>Key:</h3><span data-bind="text: key"></span>\n        <br/>\n        <button class="btn btn-danger btn-mini" style="margin-left:5px;" data-bind="click: function() { audit(); }">Audit</button>\n    </div>\n    <!-- /ko -->\n</div>'}),tadpoles.define("text!view/popovers/checkpointPopover.html",[],function(){return'<div style="text-align:left;max-height:300px;overflow:auto">\n    <div data-bind="visible: wasAbsent()">\n        <h3 style="color:#da4f49;">absent</h3>\n        <span data-bind="text:absentNote()"></span>\n    </div>\n    <div data-bind="visible: !wasAbsent()">\n        <h3 style="color:#ff9312;">transitions</h3>\n        <ul class="unstyled" data-bind="foreach: activityHistory()">\n            <li data-bind="text:$data"></li>\n        </ul>\n    </div>\n    <div data-bind="visible: accidentalCheckoutTime()">\n        <h3 style="color:#da4f49;">accidental checkout</h3>\n        <span data-bind="text: displayAccidentalCheckoutTime()"></span>\n    </div>\n    <div data-bind="visible: getMealHistory() && mealHistory().length > 0">\n        <h3 style="color:#00C322;">meals provided</h3>\n        <ul class="unstyled" data-bind="foreach: mealHistory()">\n            <li data-bind="text:\'Received \' + $data"></li>\n        </ul>\n    </div>\n    <div data-bind="visible: hasNtfHistory()">\n        <h3 style="color:#0772A1;">name to face</h3>\n        <ul class="unstyled" data-bind="foreach: ntfHistory()">\n            <li data-bind="text:$data"></li>\n        </ul>\n    </div>\n\n</div>'}),tadpoles.define("text!view/popovers/kidsWithoutPhotos.html",[],function(){return'<div data-bind="visible: childrenWithoutPhotos().length > 20, text:childrenWithoutPhotos().length +  \' children without photos\'"></div>\n<div data-bind="visible: childrenWithoutPhotos().length <= 20,foreach: childrenWithoutPhotos()">\n    <span data-bind="text: $data.displayName()"></span><span style="font-style: italic; color: grey; margin-left: 8px;" data-bind="text: $parent.childrenWithoutPhotosDetail($data.key)"></span><br>\n</div>'}),tadpoles.define("text!view/popovers/notificationPopover.html",[],function(){return'<div>\n<span data-bind="visible: !$root.pushNotifications.isSupported()">Sorry, your browser doesn\'t support notifications!</span>\n<span data-bind="visible: $root.pushNotifications.isSupported() && $root.pushNotifications.isBlocked()">Notifications are blocked, you can re-enable them from the bell icon in the titlebar above.</span>\n<span data-bind="visible: $root.pushNotifications.isSupported() && $root.pushNotifications.isPushEnabled()">Notifications are currently enabled, click <i class=\'fa fa-bell\'></i> to disable.</span>\n<span data-bind="visible: $root.pushNotifications.isSupported() && !$root.pushNotifications.isPushEnabled()">Notifications are currently disabled, click <i class=\'fa fa-bell-o\'></i> enable.</span>\n <hr/>\n <form class="form-horizontal">\n     <div class="form-group">\n         <div class="checkbox">\n            <label>\n                <input data-bind="checked:$root.pushNotifications.pushNotificationsForRealtimeDailies" type="checkbox"> Get notified for feedings, naps, and potty\n            </label>\n        </div>\n     </div>\n</form>\n</div>'}),tadpoles.define("text!view/popovers/ratingRatios.html",[],function(){return'<div>\n    <table cellspacing="0" cellpadding="0" style="border-spacing: 0px;border-collapse:collapse;">\n        <style>\n            .poMetricCell {border-bottom: 1px solid #BFBFBF; padding:5px 5px;}\n            .poMetricHeader {background-color: #49AFCD; width: 68px; padding:5px 2px; color: #FFF; font-weight: bold; font-size: smaller}\n        </style>\n        <thead>\n        <tr>\n            <th style="padding-left: 4px; background-color: rgb(189, 143, 220);" class="poMetricHeader">rated</th>\n            <th class="poMetricHeader" data-bind="text:$root.product.translate(\'assess:unmet\',\'unmet\')"></th>\n            <th class="poMetricHeader" data-bind="text:$root.product.translate(\'assess:improved\',\'improved\')"></th>\n            <th class="poMetricHeader" data-bind="text:$root.product.translate(\'assess:meets\',\'meets\')"></th>\n            <th style="padding-right: 4px" class="poMetricHeader" data-bind="text:$root.product.translate(\'assess:exceeds\',\'exceeds\')"></th>\n        </tr>\n        </thead>\n        <tbody>\n        <tr>\n            <td  style="text-align: center;" class="poMetricCell" >\n                <span data-bind="text:$data.ratedRatio"></span>\n            </td>\n            <td  style="text-align: center; background-color: rgba(238, 238, 238, 0.22);" class="poMetricCell">\n                <span data-bind="text:$data.unmetRatio"></span>\n            </td>\n            <td  style="text-align: center; background-color: rgba(238, 238, 238, 0.22);" class="poMetricCell">\n                <span data-bind="text:$data.improvedRatio"></span>\n            </td>\n            <td  style="text-align: center;  background-color: rgba(238, 238, 238, 0.22);" class="poMetricCell">\n                <span data-bind="text:$data.meetsRatio"></span>\n            </td>\n            <td  style="text-align: center;  background-color: rgba(238, 238, 238, 0.22);" class="poMetricCell">\n                <span data-bind="text:$data.exceedsRatio"></span>\n            </td>\n        </tr>\n        </tbody>\n    </table>\n</div>\n'}),tadpoles.define("text!view/popovers/ratingHistory.html",[],function(){return'<!-- ko with: $parents[1].ratingForOutcome($data.id) -->\n<div>\n    <table cellspacing="0" cellpadding="0" style="border-spacing: 0px;border-collapse:collapse;">\n        <tbody>\n        <!-- ko foreach: history() -->\n        <tr>\n            <td  style="text-align: right; padding:0px 12px 0px 2px; font-size: smaller" >\n                <span data-bind="text:$data.date"></span>\n            </td>\n            <td style="width: 40px; height: 100%;">\n                <div style="width:100%;height:7px;margin-top:5px;margin-bottom:5px;" data-bind="style: { backgroundColor: rating > 0 ? $parent.getColorForRating(rating) : \'transparent\' }"></div>\n            </td>\n            <td style="width: 40px; height: 100%;">\n                <div style="width:100%;height:7px;margin-top:5px;margin-bottom:5px;" data-bind="style: { backgroundColor: rating > 1 ? $parent.getColorForRating(rating) : \'transparent\' }"></div>\n            </td>\n            <td style="width: 40px; height: 100%;">\n                <div style="width:100%;height:7px;margin-top:5px;margin-bottom:5px;" data-bind="style: { backgroundColor: rating > 2 ? $parent.getColorForRating(rating) : \'transparent\' }"></div>\n            </td>\n            <td style="width: 40px; height: 100%;">\n                <div style="width:100%;height:7px;margin-top:5px;margin-bottom:5px;" data-bind="style: { backgroundColor: rating > 3 ? $parent.getColorForRating(rating) : \'transparent\' }"></div>\n            </td>\n        </tr>\n        <!-- /ko -->\n        </tbody>\n    </table>\n</div>\n<!-- /ko -->\n'}),tadpoles.define("text!view/profile/profile_body.html",[],function(){return'<ul class="nav nav-tabs studentTabs">        \n    <li class="active"><a data-toggle="tab" href="#guardians" data-bind="click: selectGuardians">contacts</a></li>\n</ul>\n<div class="tab-content">     \n    <div class="tab-pane active tab-guardians" id="guardians"  data-bind="css: { active: selectedTab() === \'guardians\' }" >\n        <ul style="width:530px;" data-bind="tiles: { bricks: guardians_for_display, template:\'guardianTile\', numCols: 6, groutWidth: 4 }"></ul>             \n    </div>\n    \n</div> '}),tadpoles.define("text!view/profile/profile_header.html",[],function(){return'<div class="row">\n	<div class="span4">\n		<dl class="dl-horizontal dl-profile">    \n		      \n		    <dt>class</dt><dd data-bind="text: groupName()"></dd> \n		    <dt data-bind="visible: note() != null">note</dt><dd data-bind="visible: note() != null"><span data-bind="text: note"></span></dd>\n		    \n		    <dt data-bind="visible: special_note() != null">details</dt><dd data-bind="visible: special_note() != null"><span data-bind="html: displayableSpecialNote"></span></dd>\n		       \n		    <dt>quick lists</dt><dd><div class="profile-detail" data-bind="template: {name: \'view/quickLists\'}"></div></dd>\n		    <dd><div class="input-append add-input pull-left" data-bind="visible: isEditing() === false">\n		        <form data-bind="submit: addLabel">\n		        <input type="text" placeholder="new quick list" class="typeahead input-small" style="margin: 0 auto;" data-provide="typeahead" data-items="4" data-bind="value: newLabel"/><button type="button" class="btn btn-warning btn-small" data-bind="click: addLabel">Add</button>\n		        </form>\n		        </div>\n		    </dd>\n		</dl>   \n	</div>\n	<div class="span4">\n		<dl class="dl-horizontal dl-profile">  \n			<dt>schedule</dt>\n		    <dd>\n		        <span class="label" data-bind="css: {\'label-success\': schedule().monday}">M</span>\n		        <span class="label" data-bind="css: {\'label-success\': schedule().tuesday}">T</span>\n		        <span class="label" data-bind="css: {\'label-success\': schedule().wednesday}">W</span>\n		        <span class="label" data-bind="css: {\'label-success\': schedule().thursday}">T</span>\n		        <span class="label" data-bind="css: {\'label-success\': schedule().friday}">F</span>\n		        <span class="label" data-bind="css: {\'label-success\': schedule().saturday}">S</span>\n		        <span class="label" data-bind="css: {\'label-success\': schedule().sunday}">S</span>\n		    </dd>\n		    \n			<dt>status</dt>\n			<dd data-bind="text: displayableStatus"></dd>\n	        <div data-bind="with: schedule">\n	            <dt>enrollment</dt><dd data-bind="text: enrollment()"></dd>\n	            \n	            <dt>enrollment date</dt><dd data-bind="formattedDate: enrollment_date()"></dd>\n	            \n	            <dt>graduation date</dt><dd data-bind="formattedDate: graduation_date()"></dd>\n	            \n	            <dt>return date</dt><dd data-bind="formattedDate: return_date()"></dd>\n	        </div>\n       </dl>\n	</div>\n</div>'}),tadpoles.define("text!view/upgrade/ie7.html",[],function(){return'<div style="text-align: center; padding-top: 40px;">\n    <h1 style="color: gray; font-size: 100px; line-height: 1.2">woop woop!</h1>\n    <h1 style="color: #49AFCD; font-size: 60px; line-height: 1.2">incompatible browser alert</h1>\n    <div style="text-align:left;margin-top:50px;">\n        <div class="pull-right" style="text-align:center;width:282px;height:320px;background-color:#E2E2E2">\n\n                <div style="margin-top:50px;">\n                    <a href="http://www.google.com/chrome" style="text-decoration:none;" onclick="_gaq.push([\'_trackEvent\', \'UpgradeBrowser\', \'Chrome\']);">\n                    <img src="images/1/chrome.png" width="125" height="125"/><br/>\n                    <img src="images/1/up_arrow.png" width="45" height="45" style="margin:5px;"/>\n                    <h1 style="color:#555555;font-size:30px">click here</h1></a>\n                </div>\n        </div>\n        <div class="well" style="width:618px;height:280px;">\n        <h2 style="color:gray">The bad news</h2>\n        <span style="color: gray; font-size: 18px; line-height: 1;">Unfortunately your browser is not current enough to give you the great dashboard experience you deserve.</span>\n        <h1 style="color: #49AFCD;margin-top:20px;">The great news!</h1>\n        <span style="color: gray; font-size: 18px; line-height: 1;">You can easily switch to a state-of-the-art browser by clicking the Google Chrome icon to the right.\n            <br/>\n            &nbsp;\n            <br/>\n            We highly recommend Google Chrome because it is fast, secure and automatically stays up to date with the latest technology and security features.</span>\n        <br/>\n        &nbsp;\n        <br/>\n        <span style="color:gray">If you are unable to upgrade your browser please <a href="/contact" style="text-decoration:none" onclick="_gaq.push([\'_trackEvent\', \'UpgradeBrowser\', \'CantUpgrade\']);">contact us</a> and we will be glad to help!</span>\n        </div>\n        <div style="clear:both;"></div>\n    </div>\n</div>'}),tadpoles.define("services/templates",["require","text!view/attendance.html","text!view/branding.html","text!view/breadcrumb.html","text!view/classroomMetrics.html","text!view/classroomSelector.html","text!view/communications.html","text!view/curriculaMetrics.html","text!view/dailyReport.html","text!view/dailyReportDetail.html","text!view/dailyReports.html","text!view/dashboard.html","text!view/events.html","text!view/lessonDetail.html","text!view/lessons.html","text!view/metrics.html","text!view/notes.html","text!view/outbox.html","text!view/quickAdd.html","text!view/quickLists.html","text!view/roster.html","text!view/rosterOptions.html","text!view/rosterForecaster.html","text!view/stat_tiles.html","text!view/portfolioStatTiles.html","text!view/portfolioMetrics.html","text!view/custom/bh-witw.html","text!view/tiles/addChildGuardianTile.html","text!view/tiles/addChildStudentTile.html","text!view/tiles/addChildTinyGuardianTile.html","text!view/tiles/addTile.html","text!view/tiles/allKidsTile.html","text!view/tiles/classMetricTile.html","text!view/tiles/classSelectorTile.html","text!view/tiles/classTile.html","text!view/tiles/copyClassTile.html","text!view/tiles/corpClassTile.html","text!view/tiles/curriculumTile.html","text!view/tiles/dailyReportClassTile.html","text!view/tiles/dailyReportStudentTile.html","text!view/tiles/eventTile.html","text!view/tiles/evidenceTile.html","text!view/tiles/guardianTile.html","text!view/tiles/lessonTile.html","text!view/tiles/monthTile.html","text!view/tiles/parentChildTile.html","text!view/tiles/parentEventTile.html","text!view/tiles/plainClassTile.html","text!view/tiles/portfolioEventTile.html","text!view/tiles/portfolioPrintTile.html","text!view/tiles/rosterTile.html","text!view/tiles/rosterGridTile.html","text!view/tiles/snapshotTile.html","text!view/tiles/studentAndStaffTile.html","text!view/tiles/studentTile.html","text!view/tiles/studentTileMenu.html","text!view/tiles/templateWrapper.html","text!view/tiles/eventStudentTagTile.html","text!view/tiles/eventClassTagTile.html","text!view/tiles/eventLocationTagTile.html","text!view/tiles/custom/witwTile.html","text!view/modals/addClassForm.html","text!view/modals/addEmployeeForm.html","text!view/modals/addGuardianForm.html","text!view/modals/addModal.html","text!view/modals/addTour.html","text!view/modals/alertModal.html","text!view/modals/attendanceChart.html","text!view/modals/attendanceReport.html","text!view/modals/auditModal.html","text!view/modals/background.html","text!view/modals/copyLessonPlan.html","text!view/modals/dailyReport.html","text!view/modals/devices.html","text!view/modals/editAccount.html","text!view/modals/editChildProfile.html","text!view/modals/editLocation.html","text!view/modals/editAccountBranding.html","text!view/modals/editAutoCheckout.html","text!view/modals/editCheckpoint.html","text!view/modals/editClass.html","text!view/modals/editEmployee.html","text!view/modals/editEvent.html","text!view/modals/editGuardian.html","text!view/modals/editReplyTo.html","text!view/modals/editPeriods.html","text!view/modals/fileAttachment.html","text!view/modals/gallery.html","text!view/modals/import.html","text!view/modals/moveModal.html","text!view/modals/moveClass.html","text!view/modals/observations.html","text!view/modals/outTodayForm.html","text!view/modals/absenceForm.html","text!view/modals/communicationsModal.html","text!view/modals/portfolioPrint.html","text!view/modals/procareForm.html","text!view/modals/referInfoForm.html","text!view/modals/resyncAccount.html","text!view/modals/signup.html","text!view/modals/weeklyLessonPlan.html","text!view/modals/portfolioEventEdit.html","text!view/modals/daily_report/activityEdit.html","text!view/modals/daily_report/activityOptions.html","text!view/modals/daily_report/entryEditModal.html","text!view/modals/daily_report/mealEdit.html","text!view/modals/daily_report/napEdit.html","text!view/modals/daily_report/noteEdit.html","text!view/modals/daily_report/reportEditModal.html","text!view/modals/daily_report/themeEdit.html","text!view/modals/daily_report/bathroomEdit.html","text!view/modals/assessment/editNoteModal.html","text!view/modals/curriculum/activities.html","text!view/modals/curriculum/applyCurriculum.html","text!view/modals/curriculum/curriculaEdit.html","text!view/modals/curriculum/curriculumEdit.html","text!view/modals/curriculum/curriculumEditModal.html","text!view/modals/curriculum/domainEdit.html","text!view/modals/curriculum/outcomeEdit.html","text!view/modals/curriculum/unitEdit.html","text!view/modals/curriculum/unitTree.html","text!view/popovers/photoPopover.html","text!view/popovers/checkpointPopover.html","text!view/popovers/kidsWithoutPhotos.html","text!view/popovers/notificationPopover.html","text!view/popovers/ratingRatios.html","text!view/popovers/ratingHistory.html","text!view/profile/profile_body.html","text!view/profile/profile_header.html","text!view/upgrade/ie7.html"],function(e){return e("text!view/attendance.html"),e("text!view/branding.html"),e("text!view/breadcrumb.html"),e("text!view/classroomMetrics.html"),e("text!view/classroomSelector.html"),e("text!view/communications.html"),e("text!view/curriculaMetrics.html"),e("text!view/dailyReport.html"),e("text!view/dailyReportDetail.html"),e("text!view/dailyReports.html"),e("text!view/dashboard.html"),e("text!view/events.html"),e("text!view/lessonDetail.html"),e("text!view/lessons.html"),e("text!view/metrics.html"),e("text!view/notes.html"),e("text!view/outbox.html"),e("text!view/quickAdd.html"),e("text!view/quickLists.html"),e("text!view/roster.html"),e("text!view/rosterOptions.html"),e("text!view/rosterForecaster.html"),e("text!view/stat_tiles.html"),e("text!view/portfolioStatTiles.html"),e("text!view/portfolioMetrics.html"),e("text!view/custom/bh-witw.html"),e("text!view/tiles/addChildGuardianTile.html"),e("text!view/tiles/addChildStudentTile.html"),e("text!view/tiles/addChildTinyGuardianTile.html"),e("text!view/tiles/addTile.html"),e("text!view/tiles/allKidsTile.html"),e("text!view/tiles/classMetricTile.html"),e("text!view/tiles/classSelectorTile.html"),e("text!view/tiles/classTile.html"),e("text!view/tiles/copyClassTile.html"),e("text!view/tiles/corpClassTile.html"),e("text!view/tiles/curriculumTile.html"),e("text!view/tiles/dailyReportClassTile.html"),e("text!view/tiles/dailyReportStudentTile.html"),e("text!view/tiles/eventTile.html"),e("text!view/tiles/evidenceTile.html"),e("text!view/tiles/guardianTile.html"),e("text!view/tiles/lessonTile.html"),e("text!view/tiles/monthTile.html"),e("text!view/tiles/parentChildTile.html"),e("text!view/tiles/parentEventTile.html"),e("text!view/tiles/plainClassTile.html"),e("text!view/tiles/portfolioEventTile.html"),e("text!view/tiles/portfolioPrintTile.html"),e("text!view/tiles/rosterTile.html"),e("text!view/tiles/rosterGridTile.html"),e("text!view/tiles/snapshotTile.html"),e("text!view/tiles/studentAndStaffTile.html"),e("text!view/tiles/studentTile.html"),e("text!view/tiles/studentTileMenu.html"),e("text!view/tiles/templateWrapper.html"),e("text!view/tiles/eventStudentTagTile.html"),e("text!view/tiles/eventClassTagTile.html"),e("text!view/tiles/eventLocationTagTile.html"),e("text!view/tiles/custom/witwTile.html"),e("text!view/modals/addClassForm.html"),e("text!view/modals/addEmployeeForm.html"),e("text!view/modals/addGuardianForm.html"),e("text!view/modals/addModal.html"),e("text!view/modals/addTour.html"),e("text!view/modals/alertModal.html"),e("text!view/modals/attendanceChart.html"),e("text!view/modals/attendanceReport.html"),e("text!view/modals/auditModal.html"),e("text!view/modals/background.html"),e("text!view/modals/copyLessonPlan.html"),e("text!view/modals/dailyReport.html"),e("text!view/modals/devices.html"),e("text!view/modals/editAccount.html"),e("text!view/modals/editChildProfile.html"),e("text!view/modals/editLocation.html"),e("text!view/modals/editAccountBranding.html"),e("text!view/modals/editAutoCheckout.html"),e("text!view/modals/editCheckpoint.html"),e("text!view/modals/editClass.html"),e("text!view/modals/editEmployee.html"),e("text!view/modals/editEvent.html"),e("text!view/modals/editGuardian.html"),e("text!view/modals/editReplyTo.html"),e("text!view/modals/editPeriods.html"),e("text!view/modals/fileAttachment.html"),e("text!view/modals/gallery.html"),e("text!view/modals/import.html"),e("text!view/modals/moveModal.html"),e("text!view/modals/moveClass.html"),e("text!view/modals/observations.html"),e("text!view/modals/outTodayForm.html"),e("text!view/modals/absenceForm.html"),e("text!view/modals/communicationsModal.html"),e("text!view/modals/portfolioPrint.html"),e("text!view/modals/procareForm.html"),e("text!view/modals/referInfoForm.html"),e("text!view/modals/resyncAccount.html"),e("text!view/modals/signup.html"),e("text!view/modals/weeklyLessonPlan.html"),e("text!view/modals/portfolioEventEdit.html"),e("text!view/modals/daily_report/activityEdit.html"),e("text!view/modals/daily_report/activityOptions.html"),e("text!view/modals/daily_report/entryEditModal.html"),e("text!view/modals/daily_report/mealEdit.html"),e("text!view/modals/daily_report/napEdit.html"),e("text!view/modals/daily_report/noteEdit.html"),e("text!view/modals/daily_report/reportEditModal.html"),e("text!view/modals/daily_report/themeEdit.html"),e("text!view/modals/daily_report/bathroomEdit.html"),e("text!view/modals/assessment/editNoteModal.html"),e("text!view/modals/curriculum/activities.html"),e("text!view/modals/curriculum/applyCurriculum.html"),e("text!view/modals/curriculum/curriculaEdit.html"),e("text!view/modals/curriculum/curriculumEdit.html"),e("text!view/modals/curriculum/curriculumEditModal.html"),e("text!view/modals/curriculum/domainEdit.html"),e("text!view/modals/curriculum/outcomeEdit.html"),e("text!view/modals/curriculum/unitEdit.html"),e("text!view/modals/curriculum/unitTree.html"),e("text!view/popovers/photoPopover.html"),e("text!view/popovers/checkpointPopover.html"),e("text!view/popovers/kidsWithoutPhotos.html"),e("text!view/popovers/notificationPopover.html"),e("text!view/popovers/ratingRatios.html"),e("text!view/popovers/ratingHistory.html"),e("text!view/profile/profile_body.html"),e("text!view/profile/profile_header.html"),e("text!view/upgrade/ie7.html"),{}}),tadpoles.requirejs.config({waitSeconds:90,optimizeAllPluginResources:!0,paths:{modernizr:"lib/js/modernizr-2.5.3",jquery:"lib/js/jquery-1.11.1","jquery-noconflict":"lib/js/jquery-noconflict",jqueryui:"lib/js/jquery-ui-1.11.0.custom","jquery.ui.widget":"lib/js/jquery.ui.widget",lodash:"lib/js/lodash.compat.min","lodash-noconflict":"lib/js/lodash-noconflict",ko:"lib/js/knockout-3.4.0","knockout-amd-helpers":"lib/js/knockout-amd-helpers",text:"lib/js/text",selfish:"lib/js/selfish",compat:"services/compat",fileUpload:"lib/js/jquery.fileupload",bootstrap:"lib/js/bootstrap",jstz:"lib/js/jstz.min",fancybox:"lib/js/jquery.fancybox",fancyboxButtons:"lib/js/jquery.fancybox-buttons",date:"lib/js/date",dateformat:"lib/js/date_format",spinner:"lib/js/spin",channels:["/_ah/channel/jsapi?noext=","/javascript/2/dummyChannel"],signin:"https://apis.google.com/js/client:platform",google:"https://www.google.com/jsapi?noext=",EventEmitter:"lib/js/EventEmitter.min",emit:"lib/js/emit",sleep:"lib/js/sleep",print:"lib/js/jquery.jqprint-0.3",tilesGallery:"lib/js/jquery.tiles-gallery",koDelegatedEvents:"lib/js/knockout-delegatedEvents",timePicker:"lib/js/jquery.timepicker",monthPicker:"lib/js/jquery.mtz.monthpicker",sortable:"lib/js/knockout-sortable",videojs:"lib/video-js/video",test:"test"},namespace:"tadpoles",shim:{google:{exports:"google"},signin:{deps:["services/login"]}},map:{"*":{jquery:"jquery-noconflict",lodash:"lodash-noconflict"},"jquery-noconflict":{jquery:"jquery"},"lodash-noconflict":{lodash:"lodash"}}}),tadpoles.require(["compat","lodash","jquery","ko","services/config","services/analytics","utilities","services/unitTests","providerApp","signin","services/restrict","knockout-amd-helpers","text","services/sessionWatcher","selfish","knockout/handlers","fancybox","fancyboxButtons","date","dateformat","modernizr","jqueryui","videojs","google","channels","koDelegatedEvents","services/templates"],function(e,t,n,r,i,s,o,u,a){var f="/app/"+i.CB;r.amdTemplateEngine.defaultPath="",r.amdTemplateEngine.defaultSuffix=".html",r.amdTemplateEngine.defaultRequireTextPluginName="text",u.setup(a),r.applyBindings(a,document.getElementById("app")),o.prepareModernizer(),o.prepareFancyBox(),n(document).bind("drop dragover",function(e){e.preventDefault()})}),tadpoles.define("providerMain",function(){});